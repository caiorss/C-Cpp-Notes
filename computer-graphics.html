<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-09-16 Fri 07:37 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Computer Graphics with OpenGL</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="cpp c++ opengl sdl computer graphics 2d 3d"
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<link href="theme/org-nav-theme.css" rel="stylesheet">
<script src="theme/org-nav-theme.js"></script>
<link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "left",
        displayIndent: "2em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "%LINEBREAKS" },
                        webFont: "%FONT"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "%LINEBREAKS" },
              font: "%FONT"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "%AUTONUMBER"},
               MultLineWidth: "%MULTLINEWIDTH",
               TagSide: "%TAGSIDE",
               TagIndent: "%TAGINDENT"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_SVG"></script>
</head>
<body>
<div id="content">
<h1 class="title">Computer Graphics with OpenGL</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orged11168">1. Computer Graphics</a>
<ul>
<li><a href="#org746feab">1.1. Computer Graphics Overview [DRAFT]</a></li>
<li><a href="#org5afe449">1.2. GPU Accelerated Computer Graphics APIs</a></li>
<li><a href="#org2dac71b">1.3. OpenGL Documentation</a></li>
<li><a href="#org4a4261e">1.4. Terminology related to OpenGL and  Computer Graphics</a></li>
<li><a href="#orgc432dfc">1.5. OpenGL companion libraries and 3D models</a>
<ul>
<li><a href="#orgd98f7f4">1.5.1. OpenGL Companion Libraries</a></li>
<li><a href="#org221a10b">1.5.2. WebGL Companion Libraries</a></li>
<li><a href="#org8e2be3d">1.5.3. Sample 3D Models Repositories</a></li>
<li><a href="#org0d950fb">1.5.4. See also</a></li>
</ul>
</li>
<li><a href="#org1af44c0">1.6. Legacy/Obsolete OpenGL APIs / Subroutines</a></li>
<li><a href="#org492a3f6">1.7. Operating System Specific</a>
<ul>
<li><a href="#org6cae038">1.7.1. Microsoft Windows NT</a></li>
<li><a href="#org6e9ad1b">1.7.2. Linux-Based Operating Systems</a></li>
</ul>
</li>
<li><a href="#orge2845a2">1.8. Computer Graphics Math</a>
<ul>
<li><a href="#org24efdfc">1.8.1. Overview</a></li>
<li><a href="#org531672a">1.8.2. Vector Algebra</a></li>
<li><a href="#org75b5e6d">1.8.3. Affine Transforms</a></li>
<li><a href="#org6a33781">1.8.4. 2D Canonical Affine Transforms</a></li>
<li><a href="#orgc5a2068">1.8.5. 2D Window to Viewport transform</a></li>
<li><a href="#orgd5cf7e5">1.8.6. 3D Affine Transforms</a></li>
<li><a href="#org4d44c40">1.8.7. Camera View Transform</a></li>
<li><a href="#orgdc4ff0e">1.8.8. Camera Projection Transform</a></li>
<li><a href="#org4849fc1">1.8.9. Concatenating Affine Transforms</a></li>
<li><a href="#org9b417b8">1.8.10. 3D Scene Coordinate Transformations</a></li>
<li><a href="#orgd404c22">1.8.11. 2D Scene Transforms</a></li>
<li><a href="#orga708844">1.8.12. Default Coordinate Systems</a></li>
<li><a href="#org7b8b8af">1.8.13. Column-Major X Row-major Matrices</a></li>
<li><a href="#org2b87f66">1.8.14. Quaternions</a></li>
<li><a href="#org75dbfcc">1.8.15. Quaternions - Combining Scale and Position</a></li>
<li><a href="#org8362cf4">1.8.16. Quaternion in Julia Language</a></li>
</ul>
</li>
<li><a href="#orgb370110">1.9. Drawing Primitives</a></li>
<li><a href="#org4efe8b2">1.10. Library GLM - OpenGL Mathematics</a>
<ul>
<li><a href="#org6a68b02">1.10.1. Overview</a></li>
<li><a href="#org5823891">1.10.2. Testing in CERN's Root REPL</a></li>
</ul>
</li>
<li><a href="#org0ec74bf">1.11. [DRAFT] Debugging Computer Graphics Code</a></li>
<li><a href="#org168fd64">1.12. Minimal C++ GLFW project</a></li>
<li><a href="#org59ad1d8">1.13. Minimal Dlang (D) GLFW and XMake project</a></li>
<li><a href="#org6d6a1a2">1.14. Minimal SDL project</a></li>
<li><a href="#org35908ee">1.15. Minimal Qt5 OpenGL project</a></li>
<li><a href="#org9381847">1.16. Minimal WebGL-OpenGL project</a></li>
<li><a href="#org831be5e">1.17. Loading OpenGL without Glew</a></li>
<li><a href="#orgb98f4d6">1.18. 2D - using VAO</a></li>
<li><a href="#org45cee49">1.19. 2D - using shaders</a></li>
<li><a href="#org5bf4d70">1.20. 2D - Chart with orthographic projection</a></li>
<li><a href="#org24d5a33">1.21. 2D - IBO - Index Buffer Object</a></li>
<li><a href="#orgccf505e">1.22. 3D - Rotating cube/box</a></li>
<li><a href="#orga67b7f0">1.23. 3D - WebGL 3D Scene with grid and cube</a></li>
<li><a href="#orgeaadfa1">1.24. 3D - Quaternion</a></li>
<li><a href="#orge9dc045">1.25. 3D - Surface wireframe chart</a></li>
<li><a href="#org189b732">1.26. 3D - 3D model loading with illumination</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-orged11168" class="outline-2">
<h2 id="orged11168"><span class="section-number-2">1</span> Computer Graphics</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org746feab" class="outline-3">
<h3 id="org746feab"><span class="section-number-3">1.1</span> Computer Graphics Overview [DRAFT]</h3>
<div class="outline-text-3" id="text-1-1">
<p>
<b>Motivation</b> 
</p>

<p>
Outline of common computer graphics applications and a motivation for
the study of this field.
</p>

<ul class="org-ul">
<li>2D and 3D Games</li>

<li>Virtual Reality</li>

<li>Cartography</li>

<li>Topography</li>

<li>Charts and plotting</li>

<li>Scientific Visualization</li>

<li>Data visualization</li>

<li>Medical Images
<ul class="org-ul">
<li>See: <a href="https://www.computerhistory.org/makesoftware/exhibit/mri/">https://www.computerhistory.org/makesoftware/exhibit/mri/</a></li>
<li>See: <a href="http://www.gg.caltech.edu/brain/mri_research.html">Magnetic Resonance Imaging for Computer Graphics</a></li>
</ul></li>

<li>Physics and engineering simulations.</li>

<li>Implementation of CAD (Computer Aided Design) systems</li>

<li>Animation. See Pixar company that created many movies using computer graphics.</li>
</ul>


<p>
<b>Books</b> 
</p>

<ul class="org-ul">
<li><a href="https://www.amazon.com/OpenGL-Programming-Guide-Official-Learning-ebook/dp/B00C2SBOJE">OpenGL Programming Guide: The Official Guide to Learning OpenG, Version 4.3</a>
<ul class="org-ul">
<li>Note: Official Modern OpenGL documentation with lots of details and explanations.</li>
</ul></li>

<li><a href="https://www.amazon.com/Advanced-Graphics-Programming-Kaufmann-Computer/dp/1558606599">Advanced Graphics Programming Using OpenGL</a> - (The Morgan Kaufmann
Series in Computer Graphics) 1st Edition
<ul class="org-ul">
<li>Brief: "This book brings the graphics programmer beyond the
basics and introduces them to advanced knowledge that is hard
to obtain outside of an intensive CG work environment. The book
is about graphics techniques―those that don’t require
esoteric hardware or custom graphics libraries―that are
written in a comprehensive style and do useful things. It
covers graphics that are not covered well in your old graphics
textbook. But it also goes further, teaching you how to apply
those techniques in real world applications, filling real world
needs."</li>
<li>Note: Contains useful notes about data visualization and CAD
implementations.</li>
</ul></li>

<li><a href="https://www.amazon.com/Interactive-Computer-Graphics-Top-Down-Shader-Based/dp/0132545233">Interactive Computer Graphics: A Top-Down Approach With Shader-Based Opengl</a> -  6th Edition
<ul class="org-ul">
<li>Brief: "This book is suitable for undergraduate students in
computer science and engineering, for students in other
disciplines who have good programming skills, and for
professionals. Computer animation and graphics–once rare,
complicated, and comparatively expensive–are now prevalent in
everyday life from the computer screen to the movie
screen. Interactive Computer Graphics: A Top-Down Approach with
Shader-Based OpenGL, 6e, is the only introduction to computer
graphics text for undergraduates that fully integrates OpenGL
3.1 and emphasizes application-based programming. Using C and
C++, the top-down, programming-oriented approach allows for
coverage of engaging 3D material early in the text so readers
immediately begin to create their own 3D graphics. Low-level
algorithms (for topics such as line drawing and filling
polygons) are presented after readers learn to create
graphics."</li>
</ul></li>

<li><a href="http://opengl.czweb.org/ewtoc.html">OpenGL Super Bible</a> [ONLINE]</li>
</ul>


<p>
<b>Videos - Related to Computer Graphics</b> 
</p>

<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=pQcC2CqReSA">Tutorial 9 - Coordinate Systems in OpenGL</a> [BEST]</li>

<li><a href="https://www.youtube.com/watch?v=vQ60rFwh2ig">The True Power of the Matrix (Transformations in Graphics) - Computerphile</a></li>

<li><a href="https://www.youtube.com/watch?v=KdyvizaygyY">A universe of Triangles - Computerphile</a></li>

<li><a href="https://www.youtube.com/watch?v=U93RImC-by4">VOX - Why video games are made of tiny triangles</a></li>

<li><a href="https://www.youtube.com/watch?v=TPCpXXBHFSA">VOX - Why gamers use WASD to move</a></li>

<li><a href="https://www.youtube.com/watch?app=desktop&amp;v=TIxt9guMbXo">The World's Most Famous Teapot: The Utah Teapot</a></li>

<li><a href="https://www.youtube.com/watch?v=3NQuHpUyZbI">Computer - Breaking the Utah Teapot - 1989</a> (10 minutes)
<ul class="org-ul">
<li>"Alan Norton's groundbreaking graphics work from 1989 done at
IBM Research.  The Utah Teapot was the common object used
within graphics research.  Alan's notion was to tease the
community by breaking their common object.  This is my video of
Alan describing his research.  It was a wondrous experience to
work with him.  The video was for my international multimedia
magazine, a project I received after convincing an IBM Research
VP to let me do something other than language research based on
my fandom music video making."</li>
</ul></li>

<li><a href="https://www.youtube.com/watch?v=LetNCGeB67o">How a Teapot Revolutionized Computer Graphics</a> (2:41 minutes)
<ul class="org-ul">
<li>"Once upon a time, the field of computer graphics was just
getting started, and a simple teapot helped researchers develop
rendering techniques."</li>
</ul></li>

<li><a href="https://www.youtube.com/watch?v=cvcAjgMUPUA">How Rendering Graphics Works in Games!</a> (6:24 minutes)
<ul class="org-ul">
<li>"Going all the way from the bits of vertex coordinates to the
rasterizing of pixels, let's learn how rendering graphics
works!"</li>
</ul></li>

<li><a href="https://www.youtube.com/watch?v=_cyVDoyI6NE">CPU vs GPU (What's the Difference?) - Computerphile</a> (6:38 minutes)
<ul class="org-ul">
<li>"What does a GPU do differently to a CPU and why don't we use
them for everything? First of a series from Jem Davies, VP of
Technology at ARM."</li>
</ul></li>
</ul>

<p>
<b>Communities</b> 
</p>

<ul class="org-ul">
<li><a href="https://www.gamedev.net/">https://www.gamedev.net/</a></li>

<li><a href="https://forum.freegamedev.net/">https://forum.freegamedev.net/</a></li>

<li><a href="https://gamedev.stackexchange.com/">https://gamedev.stackexchange.com/</a></li>

<li><a href="https://old.reddit.com/r/gamedev/">https://old.reddit.com/r/gamedev/</a></li>

<li><a href="https://old.reddit.com/r/webgl/">https://old.reddit.com/r/webgl/</a></li>

<li><a href="https://old.reddit.com/r/opengl/">https://old.reddit.com/r/opengl/</a></li>

<li><a href="https://old.reddit.com/r/vulkan/">https://old.reddit.com/r/vulkan/</a></li>

<li><a href="https://old.reddit.com/r/GraphicsProgramming">https://old.reddit.com/r/GraphicsProgramming</a></li>

<li><a href="https://old.reddit.com/r/raytracing">https://old.reddit.com/r/raytracing</a></li>

<li><a href="https://old.reddit.com/r/linux_gaming/">https://old.reddit.com/r/linux_gaming/</a></li>

<li><a href="https://old.reddit.com/r/VFIO/">https://old.reddit.com/r/VFIO/</a> (Virtualization GPU passthrough.)</li>
</ul>
</div>
</div>

<div id="outline-container-org5afe449" class="outline-3">
<h3 id="org5afe449"><span class="section-number-3">1.2</span> GPU Accelerated Computer Graphics APIs</h3>
<div class="outline-text-3" id="text-1-2">
<p>
<b>Native Graphics APIs</b> (exposed as C-subroutines)
</p>

<ul class="org-ul">
<li><a href="https://www.opengl.org//">OpenGL</a> (Khronos Group) - Main OpenGL specification
<ul class="org-ul">
<li>=&gt; Open standard, cross-platform and vendor-independent API for
rendering 2D or 3D computer graphics with GPU (Graphics
Processing Unit) acceleration. OpenGL can be used for
implementing computer graphics, games, scientific vizualization,
virtual reality and CADs - Computer Aided Design
software. OpenGL API specificiation is maintained as an
open-standard by the Krhonos Group industry consortium.</li>

<li>=&gt; OpenGL has two modes, <span class="underline">immediate mode</span> (a.k.a fixed-function
pipeline, legacy-OpenGL) which is being depreacted, and <span class="underline">retained</span>
<span class="underline">mode</span> (modern OpenGL) that delivers more performance and is based
on buffer-objects and shaders.</li>

<li>=&gt; OpenGL Official Specification: <a href="https://www.khronos.org/registry/OpenGL/index_gl.php">Khronos OpenGL® Registry</a></li>
</ul></li>

<li><span class="underline">OpenGL ES</span>  (Khronos Group)
<ul class="org-ul">
<li>=&gt; OpenGL for embedded systems, mobile devices and touch screen
devices and so on. This API (Application Programming Interface)
is widely used by many mobile games.</li>

<li>=&gt; Similar to OpenGL specfication, but supports only the
<span class="underline">retained-mode</span>. OpenGL ES does not support <span class="underline">immediate-mode</span>. As a
result, calls to legacy OpenGL subroutines such as glBegin(),
glEnd(), glRotate(), glTranslate(), &#x2026;, are not supported.</li>
</ul></li>

<li><a href="https://www.khronos.org/vulkan/">Vulkan</a>_(Khronos Group)
<ul class="org-ul">
<li>=&gt; Graphics API with GPU acceleration that provides more
low-level GPU control and less overhead than OpenGL. This API is
designed for taking more advantag of multi-core CPU
architectures and performing tasks in parallel.</li>
</ul></li>

<li><a href="https://en.wikipedia.org/wiki/DirectX">DirectX</a> / Direct3D (Microsoft inc.) - Windows-only
<ul class="org-ul">
<li>=&gt; Microsoft's graphics API for accessing the GPU hardware. It
is only available on operating systems based Windows-NT kernel
and Windows-CE kernel (embedded version of Windows-NT).</li>
</ul></li>

<li><a href="https://developer.apple.com/metal/">Metal</a> (Apple inc.)
<ul class="org-ul">
<li>=&gt; Apple-only API for rendering 2D or 3D computer graphics with
GPU acceleration. This API is available only on iOS and MacOSX
operating systems. On iOS and MacOSX, Apple is deprecating and
phasing out OpenGL in favor of its own  API.</li>
</ul></li>
</ul>

<p>
<b>Web Computer Graphics APIs</b> (exposed as Javascript/ECMAScript subroutines)
</p>

<ul class="org-ul">
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Getting_started_with_WebGL">WebGL</a> (Khronos Group)  / Html5 API
<ul class="org-ul">
<li>=&gt; Based on OpenGL ES and implemented by major web
browsers. Unlike OpenGL or OpenGL ES, which are exposed via C
subroutines, WebGL is exposed to calling codes via JavaScript
(ECMAScript) and Html5 canvas.</li>

<li>=&gt; Note: This API does not support OpenGL immediate-mode or
legacy OpenGL. WebGL only supports <span class="underline">retained-mode</span>.</li>
</ul></li>

<li><a href="https://en.wikipedia.org/wiki/WebGPU">WebGPU</a> (W3C Consortium) - Upcoming Html5 standard.
<ul class="org-ul">
<li>=&gt; Upcoming graphics API for web browser, based on Vulkan,
Metal and DirectX which intends to deliver more low level GPU
control and higher performance. Unlike WebGL, this API is not a
direct port of any native graphics API such as Vulkan, Metal and
DirectX.</li>
<li><a href="https://gpuweb.github.io/gpuweb/">WebGPU - Editor’s Draft</a></li>
<li><a href="https://github.com/gpuweb/gpuweb/wiki/Implementation-Status">Implementation Status · gpuweb/gpuweb Wiki · GitHub</a></li>
<li><a href="https://github.com/gpuweb/gpuweb">GitHub - gpuweb/gpuweb: Where the GPU for the Web work happens!</a></li>
<li><a href="https://kvark.github.io/web/gpu/native/2020/05/03/point-of-webgpu-native.html">Point of WebGPU on native</a></li>
<li><a href="https://hacks.mozilla.org/2020/04/experimental-webgpu-in-firefox/">A Taste of WebGPU in Firefox - Mozilla Hacks - the Web developer blog</a></li>
</ul></li>
</ul>


<p>
<b>Further Reading</b>
</p>

<p>
General:
</p>

<ul class="org-ul">
<li><a href="https://github.com/KhronosGroup/MoltenVK">GitHub - KhronosGroup/MoltenVK</a>
<ul class="org-ul">
<li>"MoltenVK is a Vulkan Portability implementation. It layers a
subset of the high-performance, industry-standard Vulkan
graphics and compute API over Apple's Metal graphics framework,
enabling Vulkan applications to run on iOS and macOS."</li>
</ul></li>

<li><a href="https://www.pcgamer.com/doom-benchmarks-return-vulkan-vs-opengl/">Doom benchmarks return: Vulkan vs. OpenGL | PC Gamer</a></li>

<li><a href="https://linuxhint.com/vulkan-for-linux-users/">Vulkan for Linux Users – Linux Hint</a></li>

<li><a href="https://stackoverflow.com/questions/56766983/what-can-vulkan-do-specifically-that-opengl-4-6-cannot">What can Vulkan do specifically that OpenGL 4.6+ cannot? - Stack</a></li>

<li><a href="https://softwareengineering.stackexchange.com/questions/380832/opengl-and-global-state">design - OpenGL and global state - Software Engineering Stack Exchange</a></li>

<li><a href="https://www.collabora.com/news-and-blog/blog/2018/10/31/introducing-zink-opengl-implementation-vulkan/">ZINK - OpenGL Implementation on Top of Vulkan</a></li>
</ul>

<p>
GPU Listing:
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Mali_(GPU)">Mali GPU</a> - GPU used by most ARM-based mobile devices with ARM integrated GPUs.</li>

<li><a href="https://en.wikipedia.org/wiki/List_of_Nvidia_graphics_processing_units">List of Nvidia graphics processing units</a></li>

<li><a href="https://en.wikipedia.org/wiki/List_of_AMD_graphics_processing_units">List of AMD graphics processing units</a></li>

<li><a href="https://cacm.acm.org/magazines/2021/3/250710-the-decline-of-computers-as-a-general-purpose-technology/fulltext">The Decline of Computers as a General Purpose Technology</a> - ACM Communications.</li>

<li><a href="https://vulkan.gpuinfo.org/listdevices.php">Devices - Vulkan Hardware Database by Sascha Willems</a></li>

<li><a href="https://egpu.io/best-egpu-buyers-guide/">https://egpu.io/best-egpu-buyers-guide/</a></li>
</ul>


<p>
Image Resolution DPI, PPI and so on:
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Resolution_independence">Resolution Independence</a></li>

<li><a href="https://en.wikipedia.org/wiki/Pixel_density">Pixel Density</a></li>

<li><a href="https://en.wikipedia.org/wiki/Vector_graphics">Vector Graphics</a></li>

<li><a href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG - Scalable Vector Graphics</a></li>

<li><a href="https://en.wikipedia.org/wiki/Comparison_of_graphics_file_formats">Comparison of Graphic File Formats</a></li>

<li><a href="https://en.wikipedia.org/wiki/Retina_display">Retina Display - Apple</a></li>

<li><a href="https://www.atiz.com/resources/DPI-PPI-Megapixels-and-Resolution.pdf">Making sense of DPI, PPI, Megapixels and Resolution - Atiz Innovation</a></li>

<li><a href="https://cft.vanderbilt.edu/wp-content/uploads/sites/59/Image_resolutions.pdf">What Resolution Should Your Images Be?</a></li>

<li><a href="https://pixelcalculator.com/en">Pixelscalculator - Convert DPI / PPI to Pixels and cmm, cm, inches</a></li>

<li><a href="https://www.omnicalculator.com/other/pixels-per-inch">PPI - Calculator (Pixels Per Inch)</a></li>
</ul>
</div>
</div>

<div id="outline-container-org2dac71b" class="outline-3">
<h3 id="org2dac71b"><span class="section-number-3">1.3</span> OpenGL Documentation</h3>
<div class="outline-text-3" id="text-1-3">
<p>
<b>OpenGL:</b>
</p>

<ul class="org-ul">
<li><a href="http://docs.gl/">docs.gl</a> [BEST]
<ul class="org-ul">
<li>Allows searching and quickly browsing the OpenGL
documentation.</li>
</ul></li>

<li><a href="https://www.opengl.org/">https://www.opengl.org/</a></li>

<li><a href="https://docs.microsoft.com/en-us/windows/win32/opengl/opengl">Microsoft Windows OpenGL Implementation - WGL</a></li>

<li><a href="https://www.khronos.org/registry/OpenGL/index_gl.php">Khronos OpenGL® Registry</a>
<ul class="org-ul">
<li>OpenGL Official Specification.</li>
</ul></li>

<li><a href="https://www.khronos.org/opengl/wiki/Core_Language_(GLSL)">Core Language (GLSL) - OpenGL Wiki</a> / Khronos Group
<ul class="org-ul">
<li>Official Documentation of OpenGL shading language.</li>
</ul></li>

<li><a href="https://www.khronos.org/opengl/wiki/Data_Type_(GLSL)">Data Type (GLSL) - OpenGL Wiki</a> / Khronos Group
<ul class="org-ul">
<li>Data types of GLSL - OpenGL Shading Language.</li>
</ul></li>

<li><a href="https://thebookofshaders.com/">The Book of Shaders</a> - (Patricio Gonzalez and Jen Love)</li>

<li><a href="https://arm-software.github.io/opengl-es-sdk-for-android/index.html">OpenGL ES SDK for Android Documentation</a> (ARM Company)</li>

<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glEnable.xml">OpenGL Registry (Khronos Group) / glEnable()</a> =&gt; Documentation of
OpenGL glEnable options, which sets the capabilities.</li>

<li><a href="https://www.khronos.org/opengl/wiki/Common_Mistakes">Common Mistakes</a> (Khronos Group) =&gt;&gt; Useful for debugging.</li>

<li><a href="https://web.archive.org/web/20190629031543/http://antongerdelan.net/teaching/3dprog1/maths_cheat_sheet.pdf">3D Maths Cheat Sheet</a> - Reference Card for computer graphics
linear algebra. (homogeneous coordinates, rotation matrices,
translation matrices and etc.)</li>
</ul>

<p>
<b>WebGL:</b>
</p>

<ul class="org-ul">
<li><a href="https://www.khronos.org/webgl/">WebGL Overview - The Khronos Group Inc</a>
<ul class="org-ul">
<li>"WebGL is a cross-platform, royalty-free web standard for a
low-level 3D graphics API based on OpenGL ES, exposed to
ECMAScript via the HTML5 Canvas element. Developers familiar
with OpenGL ES 2.0 will recognize WebGL as a Shader-based API
using GLSL, with constructs that are semantically similar to
those of the underlying OpenGL ES API. It stays very close to
the OpenGL ES specification, with some concessions made for
what developers expect out of memory-managed languages such as
JavaScript. WebGL 1.0 exposes the OpenGL ES 2.0 feature set;
WebGL 2.0 exposes the OpenGL ES 3.0 API."</li>
</ul></li>

<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial">WebGL tutorial - Web APIs | MDN</a></li>

<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Tutorial/Getting_started_with_WebGL">Getting started with WebGL - Web APIs | MDN</a> - WebGL Documentation.</li>

<li><a href="https://webglfundamentals.org/">WebGL Fundamentals</a></li>
</ul>
</div>
</div>
<div id="outline-container-org4a4261e" class="outline-3">
<h3 id="org4a4261e"><span class="section-number-3">1.4</span> Terminology related to OpenGL and  Computer Graphics</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li><b>SIGGRAPH</b> - international Association for Computing Machinery's
Special Interest Group on Computer Graphics and Interactive
Technique.</li>

<li>API - Application Programming Interface</li>

<li><a href="https://en.wikipedia.org/wiki/Khronos_Group">Khronos Group</a> - Industry consortium that takes care of OpenGL and
Vulkan standards and specifications.</li>

<li>SGI - Silicon Graphics International - Company which developed
first version of OpenGL. It was known for its SGI workstations.</li>

<li><span class="underline">OpenGL</span> - Open Graphics Library</li>

<li><a href="https://www.khronos.org/opengl/wiki/OpenGL_Context">OpenGL Context</a></li>

<li><a href="http://glew.sourceforge.net/index.html">GLEW</a> - OpenGL Extension Wrangler</li>

<li>ARB - OpenGL Architecture Review Board</li>

<li>OpenGL <span class="underline">Immediate Mode</span> (Fixed-Function Pipeline, Legacy OpenGL)
<ul class="org-ul">
<li>Also known as: Legacy OpenGL, Fixed-Function Pipeline</li>
<li>Drawing is mostly performed without storing data on GPU and by
using subroutines calls to glScale(), glRotate(), glPush(), glPop(),
glTranslate(), glBegin(), glEnd() and so on.</li>
<li>Immediate-mode is not supported by OpenGL ES or WebGL.</li>
<li>See: <a href="https://www.khronos.org/opengl/wiki/Fixed_Function_Pipeline">Fixed Function Pipeline - OpenGL Wiki</a></li>
</ul></li>

<li>OpenGL <span class="underline">retained mode</span> (Programmable Pipeline, Modern OpenGL)
<ul class="org-ul">
<li>Also known as: Modern OpenGL, Programmable Pipeline</li>
<li>New and modern OpenGL API =&gt; Drawing is performed by storing
data on the GPU via VBO (Vertex Buffer Objects) and by using
<span class="underline">shaders</span>, programs that runs on GPU, for performing geometric
vertex transformations, color and texturing computations.</li>
<li>More peformant than <span class="underline">immediate-mode</span> as the data is not sent to
the GPU every frame.</li>
</ul></li>

<li><span class="underline">GPU</span> - Graphics Processing Unit</li>

<li><span class="underline">iGPU</span> - Integrated GPU - The GPU is in the same processor chip
silicon die. Most mobile GPUs are integrated. Most desktop
computers also have dedicated GPUs built in the same chip as the
CPU cores. This type of GPU is enough for most common tasks such
as lightweight games, 2D games and watching youtube videos, but
they are not suitable for heavy AAA (triple-A) games or for
running CAD applications. Note: Most server-grade processor IC
(Integrated Circuits), such as Intel Xeon lacks integrated GPU.</li>

<li><span class="underline">dGPU</span> - Dedicated GPU - GPU available as a separated card and
connected to the motherboard via PCI connection. They are suitable
for triple-A games and GPGPU (General Purpose GPU Computing). The
biggest manufacturers of those GPUs are <span class="underline">Nvidia</span> and <span class="underline">AMD</span> (Advanced
Micro Devices).</li>

<li><span class="underline">eGPU</span> - External GPU - GPU external to the motherboard and often
connected via <span class="underline">thunderbolt</span> cable. External GPUs can be used on
laptop machines, that often lack enough space for installing a
dedicated GPU. Disadvantage: only newer motherboards have support
for thunderbolt cables.</li>

<li><span class="underline">GPGPU</span> - General Purpose Computing on GPU
<ul class="org-ul">
<li>APIs: OpenCL, Cuda, and so on.</li>
<li>Parallel non-graphics computations on GPU. GPGPU APIs take
advantage of GPU parallel computing features for high
performance computing.</li>
</ul></li>

<li>AAA - Triple-A games.</li>

<li><a href="https://www.khronos.org/opengl/wiki/Direct_State_Access">DSA</a> - Direct State Access</li>

<li><span class="underline">Vertex</span> - 2D or 3D coordinates representing a point in the space.</li>

<li><span class="underline">DOF</span> - Degrees Of Freedom</li>

<li><span class="underline">2D</span> - 2 dimensions (plane) / 2 coordinates (X, Y)</li>

<li><span class="underline">3D</span> - 3 dimensions (space) / 3 coordinates (X, Y, Z)</li>

<li><span class="underline">Homogenous Coordinate</span> - Coordinate system using an extra dimension
for encoding translation coordinate transformation in the same way
as rotation matrices transformations.
<ul class="org-ul">
<li>2D homogeneous coordinates: (X, Y, W = 1)</li>
<li>3D homogeneous coordinates: (X, Y, Z, W = 1)</li>
</ul></li>

<li><span class="underline">NDC</span> - Normalized Device Coordinate
<ul class="org-ul">
<li>Default coordinates used by OpenGL (-1.0 to 1.0) for each
axis. Any vertex that falls out of this range will not be visible
on the screen.</li>
</ul></li>

<li><span class="underline">MCS</span> - Model Coordinate System</li>

<li><span class="underline">CTM</span> - Current Transform Matrix</li>

<li><a href="https://www.khronos.org/opengl/wiki/Buffer_Object">Buffer Object</a></li>

<li><span class="underline">VBO</span> - Vertex Buffer Object</li>

<li><span class="underline">VAO</span> - Vertex Array Object</li>

<li><span class="underline">FBO</span> - Framebuffer Object</li>

<li><span class="underline">IBO</span> - Index Buffer Object</li>

<li><span class="underline">UBO</span> - Uniform Buffer Object</li>

<li><span class="underline">FPS</span> - Frame Per Seconds</li>

<li><span class="underline">Shader</span> - Program that runs on the GPU and performs vertex
computations such as coordinate transformations (matrix
multiplications), colors and texture computations.</li>

<li><span class="underline">GLSL</span> - OpenGL shading programming language - for performing
computer graphics calculations on the GPU hardware.</li>

<li><span class="underline">HLSL</span> (High-Level Shader Language) - Microsft's DirectX shading language.</li>

<li><span class="underline">COP</span> - Center Of Projection</li>

<li><span class="underline">CAD</span> - Computer Aided Design</li>

<li><span class="underline">CAM</span> - Computer Aided Manufacturing</li>

<li><span class="underline">CSG</span> - Constructive Solid Geometry</li>

<li>Computer Graphics Data Structures
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Polygon_mesh">Mesh</a></li>
<li>Nurb</li>
<li>Voxel</li>
<li>Quad tree</li>
<li>Octo tree</li>
<li><a href="https://en.wikipedia.org/wiki/Digital_elevation_model">DEM - Digital Elevation Model</a></li>
</ul></li>

<li>Common Mesh File Formats (Standardized file formats for mesh storage)
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Wavefront_.obj_file">.obj File</a> - ASCII text file format for mesh storage.</li>
<li><a href="http://paulbourke.net/dataformats/ply/">.ply File</a> - Polygon File Format</li>
<li><a href="https://en.wikipedia.org/wiki/VRML">.vrml File</a> - VRM XML file format created by the W3C consortium.</li>
<li><a href="https://en.wikipedia.org/wiki/Blender_(software)#File_format">.blend File</a> - Blender File format</li>
</ul></li>

<li>Article Related to Meshes
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Types_of_mesh">Types of Meshes</a></li>
<li><a href="https://en.wikipedia.org/wiki/List_of_common_3D_test_models">Common 3D test models</a></li>
<li><a href="https://en.wikipedia.org/wiki/Mesh_generation">Mesh Generation</a></li>
<li><a href="https://en.wikipedia.org/wiki/Polygon_mesh">Polygon Mesh</a></li>
<li><a href="https://en.wikipedia.org/wiki/Triangulation_(geometry)">Triangulation (Geometry)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Wire-frame_model">Wire-frame model</a></li>
<li><a href="https://en.wikipedia.org/wiki/Point_cloud">Point Cloud</a></li>
<li><a href="http://wiki.gis.com/wiki/index.php/Polygon_mesh">Polygon mesh (GIS)</a></li>
</ul></li>

<li><span class="underline">Resolution</span>
<ul class="org-ul">
<li>PPI - Pixels Per Inch</li>
<li>DPI - Dots Per Inch</li>
</ul></li>

<li><span class="underline">Display Types</span>
<ul class="org-ul">
<li>CRT - Cathode Ray Tube</li>
<li>LCD - Liquid Crtystal Display</li>
<li>PDP - Plasma Display Panel</li>
<li>OLED</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgc432dfc" class="outline-3">
<h3 id="orgc432dfc"><span class="section-number-3">1.5</span> OpenGL companion libraries and 3D models</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-orgd98f7f4" class="outline-4">
<h4 id="orgd98f7f4"><span class="section-number-4">1.5.1</span> OpenGL Companion Libraries</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
<span class="underline">OpenGL Loaders:</span> [ESSENTIAL]
</p>

<ul class="org-ul">
<li>Libraries that abstracts OpenGL function pointers loading in a
platform-independent way.</li>

<li><a href="http://glew.sourceforge.net/index.html">GLEW</a> - OpenGL Extension Wrangler [MOST USED]
<ul class="org-ul">
<li>"The OpenGL Extension Wrangler Library (GLEW) is a
cross-platform open-source C/C++ extension loading library. GLEW
provides efficient run-time mechanisms for determining which
OpenGL extensions are supported on the target platform. OpenGL
core and extension functionality is exposed in a single header
file. GLEW has been tested on a variety of operating systems,
including Windows, Linux, Mac OS X, FreeBSD, Irix, and Solaris."</li>
</ul></li>

<li><a href="https://glad.dav1d.de/">GLAD</a> - [MOST-USED] Multi-Language GL/GLES/EGL/GLX/WGL
Loader-Generator based on the official specs.</li>

<li><a href="https://github.com/cginternals/glbinding">GitHub - cginternals/glbinding</a>
<ul class="org-ul">
<li>"A C++ binding for the OpenGL API, generated using the gl.xml
specification."</li>
</ul></li>

<li><a href="https://github.com/anholt/libepoxy">GitHub - anholt/libepoxy</a>
<ul class="org-ul">
<li>"Epoxy is a library for handling OpenGL function pointer
management for you."</li>
</ul></li>

<li><a href="https://github.com/imakris/glatter">GitHub - imakris/glatter</a>
<ul class="org-ul">
<li>"An OpenGL loading library, with support for GL, GLES, EGL, GLX and WGL"</li>
</ul></li>

<li><a href="https://galogen.gpfault.net/">Galogen OpenGL Loader Generator</a>
<ul class="org-ul">
<li>"Galogen is an OpenGL loader generator. Given an API version and
a list of extensions, Galogen will produce corresponding headers
and code that load the exact OpenGL entry points you need. The
produced code can then be used directly by your C or C++
application, without having to link against any additional
libraries."</li>
</ul></li>

<li><a href="https://github.com/SFML/SFML-glLoadGen">GitHub - SFML/SFML-glLoadGen</a>
<ul class="org-ul">
<li>Customized glLoadGen for SFML</li>
</ul></li>
</ul>


<p>
<span class="underline">Window System Abstraction</span> 
</p>

<p>
Libraries for window systems, event handling and OpenGL context abstraction: [ESSENTIAL]
</p>

<ul class="org-ul">
<li>Abstract platform-specific window system and event handling.</li>

<li><a href="https://www.glfw.org/">GLFW</a> [BEST] [MOST-USED]
<ul class="org-ul">
<li>C library that provides graphics windows for OpenGL, Vulkan,
OpenGL ES and deals with event handling.</li>
</ul></li>

<li><a href="https://www.libsdl.org/">SDL</a> (Simple Direct Media Layer) [BEST] [MOST-USED]
<ul class="org-ul">
<li>Cross-platform C library that provides windows and event
handling for many computer graphics APIs such as OpenGL, Vulkan
and DirectX. SLD also has facilities for dealing with audio,
joystick, CD-ROM, network and threads.</li>
</ul></li>

<li><a href="https://www.sfml-dev.org/">SFML</a> (Simple and Fast Multimedia Library) [MOST-USED]
<ul class="org-ul">
<li>"SFML provides a simple interface to the various components of
your PC, to ease the development of games and multimedia
applications. It is composed of five modules: system, window,
graphics, audio and network."</li>
</ul></li>

<li><a href="http://freeglut.sourceforge.net/">GLUT</a> (FreeGlut) - OpenGL Utility Toolkit
<ul class="org-ul">
<li>Deals with window creation, OpenGL initialization, event
handling and  so on.</li>
<li>Docs: <a href="https://www.glfw.org/documentation.html">https://www.glfw.org/documentation.html</a></li>
</ul></li>
</ul>


<p>
<span class="underline">Graphics Math Libraries</span> 
</p>

<p>
OpenGL Math and Computer Graphics Math: [ESSENTIAL]
</p>


<ul class="org-ul">
<li><a href="https://glm.g-truc.net/0.9.5/api/index.html">GLM</a> (OpenGL Mathematics Library) [MOST-USED]
<ul class="org-ul">
<li>Source code: <a href="https://github.com/g-truc/glm">https://github.com/g-truc/glm</a></li>
<li>Header-only C++ library that provides classes for computer
graphics mathematics such as: 2D, 3D and homogeneous coordinate
vector; 2D, 3D and homogeneous coordinate transformation
matrices; quaternions and subroutines for computing camera,
perspective or orthogonal transformation matrices.</li>
</ul></li>

<li><a href="https://github.com/Kazade/kazmath">GitHub - Kazade/kazmath</a> - A C math library targeted at games
<ul class="org-ul">
<li>"Kazmath is a simple 3D maths library written in C. It was
initially coded for use in my book, Beginning OpenGL Game
Programming - Second edition, but rapidly gained a life of its
own. Kazmath is now used by many different projects, and
apparently is used in 25% of the worlds mobile games (yeah, I
don't believe it either - but it's used in Cocos2d-x)."</li>
</ul></li>

<li><a href="https://github.com/recp/cglm">GitHub - recp/cglm</a> -  Highly Optimized Graphics Math (glm) for C</li>

<li>See: <a href="https://github.com/chunkyguy/Math-Library-Test">GitHub - chunkyguy/Math-Library-Test</a> - A comparison of the
various major math libraries for speed and ease of use.</li>
</ul>


<p>
<span class="underline">Image Loading for texture</span> 
</p>

<ul class="org-ul">
<li><a href="https://github.com/g-truc/gli">GLI - OpenGL Image</a>
<ul class="org-ul">
<li>"OpenGL Image (GLI) is a header only C++ image library for
graphics software. GLI provides classes and functions to load
image files (KTX and DDS), facilitate graphics APIs texture
creation, compare textures, access texture texels, sample
textures, convert textures, generate mipmaps, etc."</li>
</ul></li>

<li><a href="https://github.com/smoked-herring/sail">smoked-herring/sail</a> - Squirrel Abstract Image Library
<ul class="org-ul">
<li>"SAIL is a format-agnostic cross-platform image decoding
library providing rich APIs, from one-liners to complex use
cases with custom I/O sources. It enables a client to read and
write static, animated, multi-paged images along with their
meta data and ICC profiles."</li>
<li>Note: Supports APNG, BMP, GIF, JPEG, PNG and TIFF image formats.</li>
</ul></li>

<li><a href="https://github.com/nothings/stb/blob/master/stb_image.h">stb_image.h</a>  - single-file header-only C library for loading
images from several file formats including, jpeg, bmp, tga, ppm,
pgm, gif and so on.</li>

<li><a href="https://github.com/littlstar/soil">SOIL - Simple OpenGL Image Library</a>
<ul class="org-ul">
<li>"SOIL is a tiny C library used primarily for uploading textures
into OpenGL. It is based on stb_image version 1.16, the public
domain code from Sean Barrett (found here). It has been
extended to load TGA and DDS files, and to perform common
functions needed in loading OpenGL textures. SOIL can also be
used to save and load images in a variety of formats."</li>
</ul></li>

<li><a href="https://freeimage.sourceforge.io/">freeimage</a>
<ul class="org-ul">
<li>"FreeImage is an Open Source library project for developers who
would like to support popular graphics image formats like PNG,
BMP, JPEG, TIFF and others as needed by today's multimedia
applications. FreeImage is easy to use, fast, multithreading
safe, compatible with all 32-bit or 64-bit versions of Windows,
and cross-platform (works both with Linux and Mac OS X)."</li>
</ul></li>

<li><a href="https://github.com/cginternals/glraw">gldraw</a>
<ul class="org-ul">
<li>"With glraw you can preconvert your texture assets and load
them without the need of any image library. The generated raw
files can easily be read. For this, glraw also provides a
minimal Raw-File reader that you can either source-copy or
integrate as C++ library into your project. Image to OpenGL
texture conversion can be done either by glraws command line
interface, e.g., within an existing tool-chain, or at run-time
with glraw linked as asset library (requires linking Qt)."</li>
</ul></li>

<li><a href="https://lodev.org/lodepng/">lodepng</a>
<ul class="org-ul">
<li>"LodePNG is a PNG image decoder and encoder, all in one, no
dependency or linkage to zlib or libpng required. It's made for
C (ISO C90), and has a C++ wrapper with a more convenient
interface on top."</li>
</ul></li>

<li><a href="http://www.libpng.org/pub/png/libpng.html">libpng</a>
<ul class="org-ul">
<li>"libpng is the official PNG reference library. It supports
almost all PNG features, is extensible, and has been
extensively tested for over 23 years. The home site for
development versions (i.e., may be buggy or subject to change
or include experimental features) is
<a href="https://libpng.sourceforge.io/">https://libpng.sourceforge.io/</a>, and the place to go for
questions about the library is the png-mng-implement mailing
list. libpng is available as ANSI C (C89) source code and
requires zlib 1.0.4 or later (1.2.5 or later recommended for
performance and security reasons). The current public release,
libpng 1.6.37, fixes the use-after-free security vulnerability
noted below, as well as an ARM NEON memory leak in the
palette-to-RGB(A) expansion code (png_do_expand_palette())."</li>
</ul></li>

<li><a href="https://libspng.org/">libspng</a>
<ul class="org-ul">
<li>"libspng (simple png) is a C library for reading and writing
Portable Network Graphics (PNG) format files with a focus on
security and ease of use. It is licensed under the BSD 2-clause
“Simplified” License."</li>
</ul></li>

<li><a href="https://www.ijg.org/">IJG - Indepedent JPEG Group</a>
<ul class="org-ul">
<li>"IJG is an informal group that writes and distributes a widely
used free library for JPEG image compression. The first version
was released on 7-Oct-1991. The current version is release 9d
of 12-Jan-2020. This is a stable and solid foundation for many
application's JPEG support. You can find our original code and
some supporting documentation in the directory files. There is
a Windows format package in zip archive format jpegsr9d.zip and
a Unix format package in tar.gz archive format
jpegsrc.v9d.tar.gz. A collection of modified versions with
adaptions and error fixes for system maintenance is available
on jpegclub.org in the directory support."</li>
</ul></li>
</ul>

<p>
<span class="underline">Asset/Object Loaders - Mesh Importing Libraries</span> [ESSENTIAL]
</p>

<p>
Object loader / Asset import libraries: 
</p>

<ul class="org-ul">
<li><a href="http://www.assimp.org/">Assimp - The Open-Asset-Import Library</a> [MOST-USED]
<ul class="org-ul">
<li>"The Open Asset Import Library (short name: Assimp) is a
portable Open-Source library to import various well-known 3D
model formats in a uniform manner. The most recent version also
knows how to export 3d files and is therefore suitable as a
general-purpose 3D model converter. See the feature-list."</li>
<li>Note: Allows importing blender-generated models/assets in OpenGL.</li>
<li>Repository: <a href="https://github.com/assimp/assimp">https://github.com/assimp/assimp</a></li>
<li>See: <a href="https://www.khronos.org/opengl/wiki/Tools/Open_Asset_Import">https://www.khronos.org/opengl/wiki/Tools/Open_Asset_Import</a></li>
</ul></li>

<li><a href="https://github.com/Bly7/OBJ-Loader">OBJ-Loader</a>
<ul class="org-ul">
<li>"OBJ Loader is a simple, header only, .obj model file loader
that will take in a path to a file, load it into the Loader
class object, then allow you to get the data from each mesh
loaded. This will load each mesh within the model with the
corresponding data such as vertices, indices, and material. Plus
a large array of vertices, indices and materials which you can
do whatever you want with."</li>
</ul></li>

<li><a href="https://github.com/tinyobjloader/tinyobjloader">tinyobjloader/tinyobjloader</a>
<ul class="org-ul">
<li>"Tiny but powerful single file wavefront obj loader written in
C++03. No dependency except for C++ STL. It can parse over 10M
polygons with moderate memory and time. tinyobjloader is good
for embedding .obj loader to your (global illumination) renderer
;-)."</li>
</ul></li>

<li><a href="https://github.com/codelibs/libdxfrw">codelibs/libdxfrw</a>
<ul class="org-ul">
<li>"C++ library to read and write DXF/DWG (Autocad file format)
files. - libdxfrw is a free C++ library to read and write DXF
files in both formats, ascii and binary form. Also can read DWG
files from R14 to the last V2015. It is licensed under the terms
of the GNU General Public License version 2 (or at you option
any later version)."</li>
</ul></li>
</ul>


<p>
<span class="underline">Text and Font Rendering</span>
</p>

<ul class="org-ul">
<li><a href="https://www.freetype.org/">The FreeType Project</a>
<ul class="org-ul">
<li>Brief: "It is written in C, designed to be small, efficient,
highly customizable, and portable while capable of producing
high-quality output (glyph images) of most vector and bitmap
font formats."</li>
</ul></li>

<li><a href="http://oglft.sourceforge.net/">OGLFT: OpenGL-FreeType Library</a>
<ul class="org-ul">
<li>Brief: "This C++ library supplies an interface between the fonts
on your system and an OpenGL or Mesa application. It uses the
excellent FreeType library to read font faces from their files
and renders text strings as OpenGL primitives."</li>
</ul></li>

<li><a href="https://github.com/vallentin/glText">GitHub - vallentin/glText</a> - [HEADER-ONLY-LIBRARY]
<ul class="org-ul">
<li>Brief: "glText is a simple cross-platform single header text
rendering library for OpenGL. glText requires no additional
files (such as fonts or textures) for drawing text, everything
comes pre-packed in the header."</li>
</ul></li>

<li><a href="https://github.com/MartinPerry/OpenGL-Font-Rendering">GitHub - MartinPerry/OpenGL-Font-Rendering</a>
<ul class="org-ul">
<li>Brief: "Rendering UNICODE fonts with OpenGL This library is
still work-in-progress. This is a working beta version."</li>
</ul></li>

<li><a href="http://nuclear.mutantstargoat.com/sw/libdrawtext/">libdrawtext - OpenGL text rendering library</a>
<ul class="org-ul">
<li>Brief: "Libdrawtext uses freetype2 for glyph rasterization. If
you would rather avoid having freetype2 as a dependency, you can
optionally compile libdrawtext without it, and use pre-rendered
glyphmaps. Glyphmaps can be generated by the included
font2glyphmap tool, or by calling dtx_save_glyphmap."</li>
</ul></li>

<li><a href="https://github.com/codetiger/Font23D">GitHub - codetiger/Font23D</a> - Convert any text to a 3d mesh using any font style
<ul class="org-ul">
<li>Brief: "Font23D is a C++ library for creating a 3d mesh of any
Text in the given True type font."</li>
</ul></li>
</ul>


<p>
<span class="underline">C++ Wrappers</span>
</p>

<ul class="org-ul">
<li><a href="https://oglplus.org/">OGplus</a> - Self described as C++ Wrapper for modern OpengL.
<ul class="org-ul">
<li>Brief: "OGLplus is a header-only library which implements a thin
object-oriented facade over the OpenGL® (version 3 and higher)
C-language API. It provides wrappers which automate resource and
object management and make the use of OpenGL in C++ safer and
easier."</li>
<li>Repository: <a href="https://github.com/matus-chochlik/oglplu2">https://github.com/matus-chochlik/oglplu2</a></li>
</ul></li>

<li><a href="https://github.com/Tomius/oglwrap">Oglwrap</a>
<ul class="org-ul">
<li>Brief: "Oglwrap is a lightweight, cross-platform,
object-oriented, header-only C++ wrapper for modern (2.1+)
OpenGL, that focuses on preventing most of the trivial OpenGL
errors, and giving as much debug information about the other
errors, as possible."</li>
</ul></li>

<li><a href="https://globjects.org/">Globjects</a> - globjects is a cross-platform C++ wrapper for OpenGL
API objects
<ul class="org-ul">
<li>Brief: "globjects provides object-oriented interfaces to the
OpenGL API (3.0 and higher). It reduces the amount of OpenGL
code required for rendering and facilitates coherent OpenGL use
by means of an additional abstraction layer to glbinding and
GLM. Common rendering tasks and processes are automated and
missing features of specific OpenGL drivers are partially
simulated or even emulated at run-time."</li>
</ul></li>
</ul>

<p>
<span class="underline">Form-based Graphical User Interface</span>  
</p>

<ul class="org-ul">
<li><a href="https://github.com/ocornut/imgui">Dear imgui</a>
<ul class="org-ul">
<li>Brief: "Dear ImGui is a bloat-free graphical user interface
library for C++. It outputs optimized vertex buffers that you
can render anytime in your 3D-pipeline enabled application. It
is fast, portable, renderer agnostic and self-contained (no
external dependencies)."</li>
<li>See: <a href="https://blog.conan.io/2019/06/26/An-introduction-to-the-Dear-ImGui-library.html">An introduction to Dear Imgui Library</a></li>
</ul></li>
</ul>

<p>
<span class="underline">Non-categorized / Miscellaneous</span>
</p>


<ul class="org-ul">
<li><a href="https://github.com/bkaradzic/bgfx">bkaradzic/bgfx</a>  - "Bring Your Own Engine/Framework"
<ul class="org-ul">
<li>Brief: Library for providing a unified interface to many GPU
accelerated graphics APIs, including OpenGL, OpenGL ES, WebGL,
WebGPU (W3C consoritum), DirectX (Microsoft), Metal (Apple) and
Vulkan.</li>
<li>Note: This library also abstracts the shading language, a subset
of GLSL OpenGL, that works with all mentioned GPU accelerated
rendering backends.</li>
<li>Documentation:
<ul class="org-ul">
<li><a href="https://bkaradzic.github.io/bgfx/bgfx.html">https://bkaradzic.github.io/bgfx/bgfx.html</a></li>
<li><a href="https://bkaradzic.github.io/bgfx/examples.html">https://bkaradzic.github.io/bgfx/examples.html</a></li>
</ul></li>
<li>Community:
<ul class="org-ul">
<li><a href="https://gitter.im/bkaradzic/bgfx">https://gitter.im/bkaradzic/bgfx</a></li>
</ul></li>
<li>See:
<ul class="org-ul">
<li><a href="https://software.intel.com/content/www/us/en/develop/articles/shader-debugging-for-bgfx-rendering-engine.html">Shader Debugging for BGFX Rendering Engine</a> (Kai Wang)</li>
</ul></li>
</ul></li>

<li><a href="http://glsdk.sourceforge.net/docs/html/index.html">GLSDK - Unofficial OpenGL Software Development Kit</a>
<ul class="org-ul">
<li>Brief: "The Unofficial OpenGL Software Development Kit is a
collection of libraries and utilities that will help you get
started working with OpenGL. It provides a unified,
cross-platform build system to make compiling the disparate
libraries easier. Many of the components of the SDK are C++
libraries. Each component of the SDK specifies the terms under
which they are distributed. All licenses used by components are
approximately like the MIT license in permissivity. The parts of
the SDK responsible for maintaining the build, as well as all
examples, are distributed under the MIT License."</li>
</ul></li>

<li><a href="https://github.com/NXPmicro/gtec-demo-framework">NXPmicro/gtec-demo-framework</a>
<ul class="org-ul">
<li>"A multi-platform framework for fast and easy demo
development. The framework abstracts away all the boilerplate &amp;
OS specific code of allocating windows, creating the context,
texture loading, shader compilation, render loop, animation
ticks, benchmarking graph overlays etc. Thereby allowing the
demo/benchmark developer to focus on writing the actual 'demo'
code. Therefore demos can be developed on PC or Android where
the tool chain and debug facilities often allows for faster
turnaround time and then compiled and deployed without code
changes for other supported platforms. The framework also allows
for ‘real’ comparative benchmarks between the different OS and
windowing systems, since the exact same demo/benchmark code run
on all of them."</li>
<li>Supported Operating Systems: Android NDK; Linux with various
windowing systems (Yocto); Ubuntu 18.04; Windows 7+</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org221a10b" class="outline-4">
<h4 id="org221a10b"><span class="section-number-4">1.5.2</span> WebGL Companion Libraries</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
WebGL Companion Libraries: (OpenGL on the WEB)
</p>

<ul class="org-ul">
<li><a href="https://glmatrix.net/">glMatrix</a> - GLM math library ported to Javascript. Computer
graphics math library, similar to OpenGL GLM math library.</li>

<li><a href="https://math.gl/docs">Math.GL</a> - "math.gl is JavaScript math library focused on
geospatial and 3D use cases, designed as a composable, modular
toolbox. math.gl provides a core module with classic vector and
matrix classes, and a suite of optional modules implementing
various aspects of geospatial and 3D math. While the math.gl is
highly optimized for use with the WebGL and WebGPU APIs, math.gl
itself has no WebGL dependencies."</li>

<li><a href="https://humbletim.github.io/glm-js/">GLM-JS</a> - "glm-js is an experimental JavaScript implementation of
the OpenGL Mathematics (GLM) C++ Library."</li>

<li><a href="https://threejs.org/">Three.JS</a> - High level wrapper library around WebGL, that provides
many high level features that includes: camera objects; scene graphs;
geometry; perspective; forward kinematics, inverse kinematics;
graphics math library containing, matrices, vectors, quaternions;
image loaders; animation and more.</li>

<li><a href="https://github.com/kevinroast/phoria.js">phoria.js</a> - [NOT WEBGL] "JavaScript library for simple 3D graphics
and visualisation on a HTML5 canvas 2D renderer. It does not use
WebGL. Works on all HTML5 browsers, including desktop, iOS and
Android."
<ul class="org-ul">
<li>Note: It does use WebGL, but it is an interesting codebase about
computer graphics algorithms implementation.</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org8e2be3d" class="outline-4">
<h4 id="org8e2be3d"><span class="section-number-4">1.5.3</span> Sample 3D Models Repositories</h4>
<div class="outline-text-4" id="text-1-5-3">
<ul class="org-ul">
<li><a href="https://free3d.com/3d-models/obj-file">https://free3d.com/3d-models/obj-file</a></li>

<li><a href="https://github.com/alecjacobson/common-3d-test-models">common-3d-test-models</a>
<ul class="org-ul">
<li>"This is a repository containing common 3D test models in
original format with original source if known. While a similar
list exists on wikipedia, it does not host the actual models
and is incomplete."</li>
</ul></li>

<li><a href="https://github.com/pichiliani/ModelsOBJ">https://github.com/pichiliani/ModelsOBJ</a>
<ul class="org-ul">
<li>"ModelsOBJ - .OBJ files with free 3D models (CC license or
royalty free)"</li>
</ul></li>

<li><a href="https://gist.github.com/noonat/1131091/450ad7bbb6e0c8fba1854cc86a9f6b7a224fca56">Gist - cube.obj</a>
<ul class="org-ul">
<li>Gist containing a cube 3D model obj file with vertices and normals.</li>
</ul></li>

<li><a href="https://raw.githubusercontent.com/kevinroast/phoria.js/master/teapot.obj">Teapot.obj</a> - Teapot common 3D test model with normals.</li>
</ul>

<p>
Note: 3D models can be created using applications such as Blender,
MeshlLab, Autodesk Maya, Solidworks and so on. 
</p>

<p>
See also: 
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/List_of_common_3D_test_models">List of common 3D test models</a></li>

<li><a href="https://gurumulay.github.io/misc/misc-5/">Smoothing .obj 3D models</a> (Guru Mulay)</li>
</ul>

<p>
Obj File Documentation:
</p>

<ul class="org-ul">
<li><a href="https://docs.fileformat.com/3d/obj/">https://docs.fileformat.com/3d/obj/</a></li>

<li><a href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000507.shtml">Weverfron OBJ File Format</a> - Library of Congress</li>
</ul>
</div>
</div>

<div id="outline-container-org0d950fb" class="outline-4">
<h4 id="org0d950fb"><span class="section-number-4">1.5.4</span> See also</h4>
<div class="outline-text-4" id="text-1-5-4">
<ul class="org-ul">
<li><a href="https://www.khronos.org/opengl/wiki/OpenGL_Loading_Library">OpenGL Loading Library - OpenGL Wiki</a> / Khronos Group
<ul class="org-ul">
<li>Brief: "An OpenGL Loading Library is a library that loads
pointers to OpenGL functions at runtime, core as well as
extensions. This is required to access functions from OpenGL
versions above 1.1 on most platforms. Extension loading
libraries also abstracts away the difference between the loading
mechanisms on different platforms."</li>
</ul></li>

<li><a href="https://www.khronos.org/opengl/wiki/Load_OpenGL_Functions">Load OpenGL Functions - OpenGL Wiki</a>  / Khronos Group
<ul class="org-ul">
<li>Brief: "Loading OpenGL Functions is an important task for
initializing OpenGL after creating an OpenGL context. You are
strongly advised to use an OpenGL Loading Library instead of a
manual process. However, if you want to know how it works
manually, read on."</li>
</ul></li>

<li><a href="https://www.khronos.org/opengl/wiki/Image_Libraries">Image Libraries - OpenGL Wiki</a>  / Khronos Group</li>

<li><a href="https://stackoverflow.com/questions/27873784/when-do-i-need-to-use-an-opengl-function-loader">When do I need to use an OpenGL function loader? - Stack Overflow</a></li>

<li><a href="https://keyj.emphy.de/glext/">KeyJ's Blog : Blog Archive » Modern OpenGL with lcc-win32, the hard way</a></li>

<li><a href="https://apoorvaj.io/loading-opengl-without-glew/">Loading OpenGL without GLEW</a></li>

<li><a href="https://www.libsdl.org/release/SDL-1.2.15/docs/html/guidevideoopengl.html">Using OpenGL With SDL</a> - LibSDL</li>

<li><a href="https://www.khronos.org/opengl/wiki/Tutorial1:_Creating_a_Cross_Platform_OpenGL_3.2_Context_in_SDL_(C_/_SDL)">Tutorial1: Creating a Cross Platform OpenGL 3.2 Context in SDL (C / SDL) - OpenGL Wiki</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org1af44c0" class="outline-3">
<h3 id="org1af44c0"><span class="section-number-3">1.6</span> Legacy/Obsolete OpenGL APIs / Subroutines</h3>
<div class="outline-text-3" id="text-1-6">
<p>
The following OpenGL subroutines are from the OpenGL <span class="underline">immediate mode</span>
(fixed-function pipeline), which are obsolete and should be avoided as
they incur on a significant overhead and they lack portability since
they are not be available on OpenGL ES.
</p>

<p>
Note: The best way to check wether a OpenGL subroutine is obsolete is
by searching for its name at <a href="http://docs.gl/">http://docs.gl/</a>. Subroutines without ES2,
ES3 or GL4 hyperlinks are obsolete. For instance, by searching for
'glLight' at this web site, there are no ES2, ES3 or GL4 hyperlinks,
which indicates that this subroutine is outdated.
</p>


<p>
Obsolete Subroutines:
</p>

<ul class="org-ul">
<li>Vertex:
<ul class="org-ul">
<li>=&gt; Modern OpenGL replacement: VBO (Vertex Buffer Object) and VAO
(Vertex Array Object) and shader program.</li>
<li>glVertex2f()  =&gt; 2D coordinate of current vertex</li>
<li>glVertex3f()  =&gt; 3D Coordinate of current vertex</li>
<li>glNormal3f()  =&gt; Sets the surface normal vector for the current vertex.</li>
<li>glColor3f()   =&gt; Sets the color for the current vertex.</li>
<li>glColor4ub()  =&gt; Sets the color for the current vertex using RGB
in byte format from 0 to 255.</li>
</ul></li>

<li>Begin/End:
<ul class="org-ul">
<li>glEnd()</li>
<li>glBegin()</li>
</ul></li>

<li>Colors
<ul class="org-ul">
<li>glColor()   =&gt; Modern OpenGL replacement: Fragement shader</li>
<li>glMaterial()</li>
<li>glVertexPointer()</li>
</ul></li>

<li>Coordinate Transformation
<ul class="org-ul">
<li>Modern OpenGL Replacement: shader model matrix <span class="underline">uniform variable</span>
which is set by the calling code. Since the matrix math (linear
algebra) functionality is no longer provided by OpenGL, a third
party math library is necessary.</li>
<li>glLoadIdentity()  =&gt; Modern OpenGL replacement: glm::mat4(1.0);</li>
<li>glRotate()        =&gt; Modern OpenGL replacement: glm::rotate();</li>
<li>glTranslate()     =&gt; Modern OpenGL replacement: glm::translate();</li>
<li>glScale()         =&gt; Modern OpenGL replacement: glm::scale();</li>
<li>glRotate3f()</li>
<li>glMatrixMode()</li>
<li>glFrustum()       =&gt; Modern OpenGL replacement: glm::frustum();</li>
<li>gluLookAt()       =&gt; Modern OpenGL replacement: glm::lookAt();</li>
<li>gluPerspective()  =&gt; Modern OpenGL replacement: glm::perspective();</li>
<li>glMatrixMode()</li>
<li>glViewPort()</li>
<li>glOrtho()</li>
<li>glMultMatrix()</li>
</ul></li>

<li>Camera affine transforms:
<ul class="org-ul">
<li>gluLookAt() =&gt; Replacement: glm::lookAt()</li>
</ul></li>

<li>Save Context
<ul class="org-ul">
<li>glPop()</li>
<li>glPush()</li>
</ul></li>

<li>Matrix Stack [DEPRECATED!]
<ul class="org-ul">
<li>Modern OpenGL replacement: OpenGL since 3.0, no longer provides
a matrix stack. Now the calling code that has to keep track of
transformation state.</li>
<li>glPushMatrix()</li>
<li>glPopMatrix()</li>
</ul></li>

<li>Light and illumination:
<ul class="org-ul">
<li>Modern OpenGL Replacement: Light and illumination model are
computed on fragment shader or vertex shader.</li>
<li>glLight()</li>
<li>glLightModel()</li>
<li>glMaterial()</li>
<li>glNormal3f()</li>
</ul></li>

<li>Miscellaneous / Non Categorized
<ul class="org-ul">
<li>glEnableClientState()</li>
<li>glColorPointer()</li>
<li>glVertexPointer(*)</li>
<li>glLight*&#x2026;</li>
<li>glMaterial*&#x2026;</li>
<li>glDrawPixels()</li>
<li>glPixelZoom()</li>
<li>glRasterPos2i()</li>
</ul></li>
</ul>


<p>
See:
</p>

<ul class="org-ul">
<li><a href="https://glm.g-truc.net/0.9.1/api/a00003.html">glm - Deprecated function replacements</a>
<ul class="org-ul">
<li>"The OpenGL 3.0 specification deprecated some features, and most
of these have been removed from the OpenGL 3.1 specfication and
beyond. GLM provides some replacement functions. Many of these
functions come from the GLM_GTC_matrix_transform: Matrix
transform functions. extension."</li>
</ul></li>

<li><a href="https://github.com/fendevel/Guide-to-Modern-OpenGL-Functions">A Guide to Modern OpenGL Functions</a></li>

<li><a href="https://stackoverflow.com/questions/13647108/matrix-stacks-in-opengl-deprecated">Matrix stacks in OpenGL deprecated?</a></li>

<li><a href="https://stackoverflow.com/questions/3755998/what-is-the-point-of-the-matrix-stack-in-opengl">What is the point of the matrix stack in OpenGL?</a></li>

<li><a href="http://edeleastar.github.io/opengl-programming/topic05/pdf/3.MatrixStacks.pdf">OpenGL Matrix Stacks {PDF}</a></li>
</ul>
</div>
</div>

<div id="outline-container-org492a3f6" class="outline-3">
<h3 id="org492a3f6"><span class="section-number-3">1.7</span> Operating System Specific</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-org6cae038" class="outline-4">
<h4 id="org6cae038"><span class="section-number-4">1.7.1</span> Microsoft Windows NT</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
<b>Command Line Shortcuts for Troubleshooting</b> 
</p>

<p>
The following applications can be accessed either from command line
(cmd.exe shell) or via the shortcut Windows Key + R. 
</p>

<ul class="org-ul">
<li>$ <span class="underline">dxdiag</span> =&gt; Tool for DirectX and OpenGL diagnostics.</li>

<li>$ <span class="underline">devmgmt.msc</span> =&gt; Device manager shortcut.</li>

<li>$ <a href="https://support.microsoft.com/en-us/topic/description-of-microsoft-system-information-msinfo32-exe-tool-10d335d8-5834-90b4-8452-42c58e61f9fc">msinfo32</a> =&gt; View details about hardware.</li>

<li>$ <span class="underline">systeminfo</span> =&gt; View summarized information about operating
system, hardware, RAM memory, disk space and patches. Note: It
only works from command line.</li>
</ul>

<p>
<b>GPU details and OpenGL Implementation Information</b> 
</p>

<ul class="org-ul">
<li><a href="http://realtech-vr.com/home/glview">OpenGL Extensions Viewer 6 | realtech VR</a>
<ul class="org-ul">
<li>Graphical application that allows viewing details about Vulkan
and OpenGL implementation at the current machine.</li>
<li>Brief: "A reliable software which displays useful information
about the current OpenGL 3D accelerator and new Vulkan 3D
API. This program displays the vendor name, the version
implemented, the renderer name and the extensions of the current
OpenGL 3D accelerator."</li>
</ul></li>

<li><a href="https://www.geeks3d.com/20210125/gpu-caps-viewer-1-50-0-released/">GPU Caps View - Geeks3D</a>
<ul class="org-ul">
<li>Brief: "A new version of GPU Caps Viewer is available. GPU
Caps Viewer is a graphics card / GPU information and
monitoring utility that quickly describes the essential
capabilities of your GPU including GPU type, amount of VRAM ,
OpenGL, Vulkan, OpenCL and CUDA API support level."</li>
</ul></li>

<li><a href="https://www.geeks3d.com/gputest/">GPU Test</a>
<ul class="org-ul">
<li>Brief: "GpuTest is a cross-platform (Windows, Linux and Max OS
X) GPU stress test and OpenGL benchmark. GpuTest comes with
several GPU tests including some popular ones from
Windows'world (FurMark or TessMark)."</li>
</ul></li>
</ul>

<p>
<b>Setting Default GPU on Windows</b> 
</p>

<ul class="org-ul">
<li><a href="https://on1help.zendesk.com/hc/en-us/articles/115000138471">How to update Video Card Driver and Set Default GPU</a></li>
</ul>
</div>
</div>

<div id="outline-container-org6e9ad1b" class="outline-4">
<h4 id="org6e9ad1b"><span class="section-number-4">1.7.2</span> Linux-Based Operating Systems</h4>
<div class="outline-text-4" id="text-1-7-2">
<p>
<b>Install OpenGL development dependencies</b>
</p>

<p>
Install OpenGL development dependencies on Ubuntu or Debian-like
distributions:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ sudo apt-get install -y libgl1-mesa-dev libglu1-mesa-dev freeglut3-dev  libgl1-mesa-dev libxrandr-dev
$ sudo apt-get install -y libxinerama-dev libxcursor-dev libxi-dev
</pre>
</div>

<p>
<b>Information about OpenGL and graphics card</b>
</p>

<p>
Vendor:
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ &gt;&gt; glxinfo | grep -E <span class="org-string">"vendor"</span>
server glx vendor string: SGI
client glx vendor string: Mesa Project and SGI
OpenGL vendor string: Intel
</pre>
</div>

<p>
Rendering:
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ &gt;&gt; glxinfo | grep -E <span class="org-string">"rendering"</span>
direct rendering: Yes
</pre>
</div>

<p>
Version:
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ &gt;&gt; glxinfo | grep -E <span class="org-string">"version"</span>
server glx version string: 1.4
client glx version string: 1.4
GLX version: 1.4
    Max core profile version: 4.6
    Max compat profile version: 4.6
    Max GLES1 profile version: 1.1
    Max GLES[23] profile version: 3.2
OpenGL core profile version string: 4.6 (Core Profile) Mesa 20.3.2
OpenGL core profile shading language version string: 4.60
OpenGL version string: 4.6 (Compatibility Profile) Mesa 20.3.2
OpenGL shading language version string: 4.60
OpenGL ES profile version string: OpenGL ES 3.2 Mesa 20.3.2
OpenGL ES profile shading language version string: OpenGL ES GLSL ES 3.20
    GL_EXT_shader_implicit_conversions, GL_EXT_shader_integer_mix,
</pre>
</div>

<p>
Display:
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ &gt;&gt; glxinfo | grep -E <span class="org-string">"display"</span>
name of display: :1
<span class="org-function-name">display</span>: :1  screen: 0
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge2845a2" class="outline-3">
<h3 id="orge2845a2"><span class="section-number-3">1.8</span> Computer Graphics Math</h3>
<div class="outline-text-3" id="text-1-8">
</div>
<div id="outline-container-org24efdfc" class="outline-4">
<h4 id="org24efdfc"><span class="section-number-4">1.8.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-8-1">
<p>
Computer graphics math is based on vector algebra, linear algebra and
affine transforms. Those concepts are not exclusive to OpenGL, they
are essential and universal to all computer graphics APIS -
Application Programming Interfaces, including OpenGL, DirectX, Metal,
Vulkan, WebGL and html5 canvas.
</p>
</div>
</div>
<div id="outline-container-org531672a" class="outline-4">
<h4 id="org531672a"><span class="section-number-4">1.8.2</span> Vector Algebra</h4>
<div class="outline-text-4" id="text-1-8-2">
<p>
Given 2 3D vectors \(\vec{A} = [ x_A, y_A, z_A ]\) and \(\vec{B} = [ x_B, y_B, z_B ]\)
, the following properties can be defined:
</p>

<p>
<b>Vector Sum</b>
</p>

\begin{equation}
  \vec{C} = \vec{A} + \vec{B}
          = (x_A + x_B) \hat{i} + (y_A + y_B) \hat{j} + (z_A + z_B) \hat{k}
\end{equation}

<p>
<b>Vector Difference / Subtraction</b>
</p>

\begin{equation}
  \vec{C} = \vec{B} - \vec{A}
          = (x_B - x_A) \hat{i} + (y_B - y_A) \hat{j} + (z_B - z_A) \hat{k}
\end{equation}

<p>
<b>Vector Norm</b>
</p>

<p>
The <span class="underline">norm</span> or <span class="underline">magnitude</span> of A, \(|| \vec{A} ||\) is given by:
</p>

\begin{equation}
   || \vec{A} || = \sqrt{ x_A^2 + y_A^2 + z_A^2 }
\end{equation}


\begin{equation}
   || \vec{A} ||^2 = \vec{A} \cdot \vec{A}
\end{equation}

<p>
<b>Normalized Vector / Unit Vector</b>
</p>

<p>
A <span class="underline">normalized vector</span>, is a vector with the same direction than a given
vector, but with norm equal to one. A normalized vector of A can be
computed as:
</p>

\begin{equation}
    \text{normalized}( \vec{A} )
       = \frac{ \vec{A} }{ || A || }
       = \frac{1}{ \sqrt{ x_A^2 + y_A^2 + z_A^2 } } . \vec{A}
\end{equation}

\begin{equation}
   \text{ normalized }( \vec{A} )
   = \frac{1}{ \sqrt{ x_A^2 + y_A^2 + z_A^2 } } . ( x_A \cdot \hat{i} + y_A \cdot \hat{j} + z_A \cdot \hat{k} )
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>\(\hat{i}\), \(\hat{j}\), \(\hat{k}\) are the unit vectors of axis X, Y
and Z respectively.</li>
</ul>

\begin{equation}
    || \text{normalized}( \vec{A} ) || = 1
\end{equation}


<p>
<b>Distance between two position (point) vectors</b>
</p>

<p>
Given two vectors A and B which represent the position relative to the
coordinate system origin or point. (0, 0, 0). The distance between A
and B, or the length of the vector difference between A and B is
determined by the following relation.
</p>

\begin{eqnarray*}
   \text{distance}( \vec{A}, \vec{B}) &=& || \vec{A}  - \vec{B} || = || \vec{B}  - \vec{A} || \\
   \text{distance}( \vec{A}, \vec{B}) &=& \sqrt{ (x_A - x_B)^2 + (y_A - y_B)^2 + (z_A - z_B)^2 }
\end{eqnarray*}


<p>
<b>Element-wise Product</b> 
</p>

<p>
The element-wise product between two vectors is a vector which the
components are the product between the two vectors components. As
there is no standard mathematical notation for element-wise product
between two vectors, the symbol \(\odot\) will be used for denoting this
operation and avoiding confusion with dot product or vector
product. This notation is useful for describing illumination
(lighting) calculations, which most books and introduction materials
present without a clear notation. 
</p>


\begin{equation} 
   \vec{A} \odot \vec{B} = \begin{bmatrix} x_A \cdot x_B \\ y_A \cdot y_B \\ z_A \cdot z_B  \end{bmatrix} 
                         = \begin{bmatrix} 
                               x_A &   0  &  0  \\ 
                                 0 & y_A  &  0  \\ 
                                 0 &   0  & z_A  
                           \end{bmatrix}
                           \begin{bmatrix} x_B \\ y_B \\ z_B  \end{bmatrix}
\end{equation}

<p>
<b>Dot Product (a.k.a - Scalar Product)</b>
</p>

<p>
The vector <span class="underline">dot product</span> is:
</p>

\begin{equation}
  \text{dot}( \vec{A}, \vec{B} )
    = \vec{A} \cdot \vec{B}
    = x_A \cdot x_B + y_A \cdot y_B + z_A \cdot z_B
\end{equation}

<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>\(|| \vec{A} ||\) is the norm of vector A</li>
<li>\(|| \vec{B} ||\) is the norm of vector B</li>
</ul></li>

<li>The vectors \(\vec{A}\) and \(\vec{B}\) are <span class="underline">orthogonal</span>, the angle
between them is 90 degrees, when the dot product is zero.</li>
</ul>


<p>
The dot product has the property:
</p>

\begin{equation}
  \text{dot}( \vec{A}, \vec{B} )
    = \vec{A} \cdot \vec{B}
    = || \vec{A} || \cdot || \vec{B} || \cdot \cos \theta
\end{equation}

<p>
And also:
</p>

\begin{equation}
   \cos \theta =  \frac{ \vec{A} \cdot \vec{B}  }{ || \vec{A} || \cdot || \vec{B} ||  }
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>\(\theta\) is the angle between vectors A and B.</li>
</ul>


<p>
If the vectors \(\vec{A}\) and \(\vec{B}\) are expressed as column
matrices, the product can be computed as a matrix multiplication.
</p>

<ul class="org-ul">
<li>In the following equations. \(A^T\) is the transpose of matrix A.</li>
</ul>

\begin{equation}
  A = \begin{bmatrix} x_A \\ y_A \\ z_A  \end{bmatrix}
\end{equation}

\begin{equation}
  B = \begin{bmatrix} x_B \\ y_B \\ z_B  \end{bmatrix}
\end{equation}


\begin{equation}
  dot(\vec{A}, \vec{B})
     = \vec{A} \cdot \vec{B}
     = A^T \cdot B
     =
        \begin{bmatrix} x_A & y_A & z_A  \end{bmatrix}
        \cdot
        \begin{bmatrix} x_B \\ y_B \\ z_B  \end{bmatrix}
\end{equation}


<p>
<b>Cross Product</b> <b>(a.k.a - Vector product)</b>
</p>

<p>
The cross product between two vectors \(\vec{A}\) and \(\vec{B}\) results
in a vector which is perpendicular (orthogonal) to both A and B.
</p>

\begin{equation}
   \text{cross}( \vec{A}, \vec{B} )

        = \vec{A} \times \vec{B}

        = \begin{bmatrix}
             y_A \cdot z_B - z_A \cdot y_B   \\
             z_A \cdot x_B - x_A \cdot z_B   \\
             x_A \cdot y_B - y_A \cdot x_B   \\
          \end{bmatrix}

       = [A]_{\times} \cdot B
\end{equation}


<p>
Where \([A]_{\times}\) is the <span class="underline">cross product matrix</span>.
</p>

\begin{equation}
  [A]_{\times} =
     \begin{bmatrix}
          0   & -z_A  &  y_A  \\
          z_A &  0    & -x_A  \\
         -y_A &  x_A  &  0    \\
     \end{bmatrix}
\end{equation}

<p>
The cross product have the following properties:
</p>

\begin{equation}
  || \vec{A} \times \vec{B} || = || \vec{A} || \cdot || \vec{B} || \cdot \sin \theta
\end{equation}

\begin{equation}
  \vec{A} \times \vec{B} = || \vec{A} || \cdot || \vec{B} || \cdot \sin \theta \cdot \hat{n}
\end{equation}


\begin{equation}
   \vec{A} \times \vec{B} = - \vec{B} \times \vec{A}
\end{equation}


<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>\(\vec{n}\) is unit vector with the same direction as the cross
product vector.</li>
<li>\(\theta\) is the angle between the two underlying vectors.</li>
</ul></li>
</ul>


<p>
<b>Vector Triple Product</b>
</p>

\begin{equation}
   ( \vec{u} \times \vec{v} ) \times \vec{w}
         = ( \vec{v} \cdot \vec{w} ) \vec{u} + ( \vec{u} \cdot \vec{w}) \vec{v}
         = \text{dot}( \vec{v}, \vec{w} ) \vec{u} + \text{dot}( \vec{u}, \vec{w}) \vec{v}
\end{equation}


<p>
<b>Relation between vectors</b>
</p>

<p>
<span class="underline">Orthogonal (perpendicular) vectors:</span>
</p>

<p>
Two vectors \(\vec{A}\) and \(\vec{B}\) are orthogonal, the angle between
them is 90 degrees or PI/2 radians, if their dot product is zero.
</p>

\begin{equation}
   \vec{A} \cdot \vec{B} = 0
\end{equation}


<p>
<span class="underline">Parallel vectors</span>
</p>

<p>
Two vectors \(\vec{A}\) and \(\vec{B}\) are parallel when the angle between
them are zero or 180 degrees. When this happens, then:
</p>

\begin{equation}
   \vec{A} \times \vec{B} = 0
\end{equation}


<p>
<span class="underline">Same direction</span>
</p>

<p>
Let the unit vector that points in the same direction of a vector
\(\vec{A}\) be \([\vec{A}]_u\), where \([ \cdot ]_u\) is a operator that
determines the unit vector of a vector.
</p>

\begin{equation}
   [\vec{A}]_u = \frac{1}{|| \vec{A} || } \vec{A}
               = \frac{1}{|| \vec{A} || } (x_A \cdot \hat{i} + y_A \cdot \hat{j} + z_A \cdot \hat{k} )
\end{equation}

<p>
A pair of vector \(\vec{A}\) and \(\vec{B}\) have the same direction both
are parallel and the angle between them are zero. When this happens,
both have the same unit vector or then angle between the are zero:
</p>

\begin{equation}
   [ \vec{A} ]_u = [ \vec{B} ]_u
\end{equation}

<p>
Or: 
</p>

\begin{equation}
   \vec{A} \cdot \vec{B} - || \vec{A} || \cdot || \vec{B} || = 0
\end{equation}

<p>
Two vectors are parallel and have opposite direction (angle between
them is 180 degrees) if the following relation holds.
</p>

\begin{equation}
   \vec{A} \cdot \vec{B} + || \vec{A} || \cdot || \vec{B} || = 0
\end{equation}


<p>
<span class="underline">Angle between two vectors</span>
</p>

<p>
The angle between two 3D vectors can be determined by using their dot
product and cross product.
</p>

\begin{equation}
  \theta = \text{atan2}( || \vec{A} \times \vec{B} ||, \vec{A} \cdot \vec{B}  )
         = \text{atan2} \left( \text{norm}(  \text{cross}( \vec{A}, \vec{B})) , \text{dot}(\vec{A}, \vec{B})  \right)
\end{equation}
</div>
</div>
<div id="outline-container-org75b5e6d" class="outline-4">
<h4 id="org75b5e6d"><span class="section-number-4">1.8.3</span> Affine Transforms</h4>
<div class="outline-text-4" id="text-1-8-3">
<p>
Affine transforms, which are represented by matrices, are a particular
class of linear transforms which preserves ratios between distances,
colinearity and parallelism. Affine transforms has many applications
that includes, computer graphics, computer vision, image processing,
CAD (Computer Aided Design) and robotics.
</p>

<p>
Outline of properties preserved by affine transforms:
</p>

<ul class="org-ul">
<li>Ratios between distances.</li>

<li>Colinearity
<ul class="org-ul">
<li>=&gt; Points in the same line, remains in the same line, after the
transform was applied.</li>
</ul></li>

<li>Parallelism
<ul class="org-ul">
<li>=&gt; Lines that are parallels, remains parallel.</li>
</ul></li>
</ul>


<p>
Types of geometric linear transforms:
</p>

<ul class="org-ul">
<li>Affine Transforms
<ul class="org-ul">
<li>=&gt; Preserves ratios, colinearity and parallelism. Some affine
transforms are: <span class="underline">identity</span>, <span class="underline">translation</span>, <span class="underline">rotation</span> and <span class="underline">scaling</span>.</li>
</ul></li>

<li>Projection Transforms
<ul class="org-ul">
<li>=&gt; They not preserve parallelism. However, they preserve
colinearity. Affine transforms are a particular case of
projection transforms.</li>
<li>=&gt; Some projection transforms are:
<ul class="org-ul">
<li>Orthogonal view transform</li>
<li>Projection view transform</li>
</ul></li>
</ul></li>

<li>Rigid body transforms
<ul class="org-ul">
<li>=&gt; Are a particular case of affine transforms. The set of rigid
body transforms comprises: <span class="underline">identity</span>, <span class="underline">translation</span> and
<span class="underline">rotation</span>. This set of transforms does not include shear and scaling.</li>
<li>=&gt; Use cases: Computer graphics, Newtonian mechanics, robotics,
aerospace and many other cases.</li>
</ul></li>
</ul>


<p>
Some affine transforms are:
</p>

<ul class="org-ul">
<li>Identity (Identity matrix) =&gt; Represents no transform, all points
or vertices remain the same.</li>

<li>Translation</li>

<li>Scaling</li>

<li>Reflection</li>

<li>Rotation</li>

<li>Shear</li>
</ul>


<p>
<b>Further Reading</b>
</p>

<p>
General:
</p>

<ul class="org-ul">
<li><a href="http://graphics.cs.cmu.edu/nsp/course/15-462/Spring04/slides/04-transform.pdf">CMU - Transformations</a></li>

<li><a href="http://www.cs.cornell.edu/courses/cs4620/2013fa/lectures/04transforms2d.pdf">Cornell CS4620 - 2D Geometric Transformations</a></li>

<li><a href="https://web.iitd.ac.in/~hegde/cad/lecture/L6_3dtrans.pdf">AML170 CAD - 3D Transformations - Lecture 6</a></li>

<li><a href="https://mycourses.aalto.fi/pluginfile.php/352115/mod_resource/content/1/01_transform.pdf">CS_CS3100 (Introduction to) Computer Graphics</a></li>
</ul>

<p>
Coordinate Systems:
</p>

<ul class="org-ul">
<li><a href="https://en.m.wikipedia.org/wiki/Coordinate_system">Coordinate system - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "n geometry, a coordinate system is a system that uses
one or more numbers, or coordinates, to uniquely determine the
position of the points or other geometric elements on a manifold
such as Euclidean space."</li>
</ul></li>

<li><a href="https://en.m.wikipedia.org/wiki/Homogeneous_coordinates">Homogeneous coordinates - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "Homogeneous coordinates have a range of applications,
including computer graphics and 3D computer vision, where they
allow affine transformations and, in general, projective
transformations to be easily represented by a matrix."</li>
</ul></li>
</ul>

<p>
Rotation Matrix and right-hand-rule:
</p>

<ul class="org-ul">
<li><a href="https://en.m.wikipedia.org/wiki/Right-hand_rule">Right-hand rule - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "In mathematics and physics, the right-hand rule is a
common mnemonic for understanding orientation of axes in
three-dimensional space."</li>
</ul></li>

<li><a href="https://en.m.wikipedia.org/wiki/Rotation_matrix">Rotation matrix - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "In linear algebra, a rotation matrix is a transformation
matrix that is used to perform a rotation in Euclidean space."</li>
</ul></li>

<li><a href="https://en.m.wikipedia.org/wiki/Rotation_formalisms_in_three_dimensions">Rotation formalisms in three dimensions - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "In geometry, various formalisms exist to express a
rotation in three dimensions as a mathematical
transformation. In physics, this concept is applied to classical
mechanics where rotational (or angular) kinematics is the
science of quantitative description of a purely rotational
motion."</li>
</ul></li>

<li><a href="https://en.m.wikipedia.org/wiki/Axes_conventions">Axes conventions - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "In ballistics and flight dynamics, axes conventions are
standardized ways of establishing the location and orientation
of coordinate axes for use as a frame of reference."</li>
</ul></li>

<li><a href="https://en.m.wikipedia.org/wiki/Euler_angles">Euler angles - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "The Euler angles are three angles introduced by Leonhard
Euler to describe the orientation of a rigid body with respect
to a fixed coordinate system."</li>
</ul></li>

<li><a href="https://en.m.wikipedia.org/wiki/Aircraft_principal_axes">Yaw, Pitch, Roll angles - Aircraft principal axes - Wikipedia</a>
<ul class="org-ul">
<li>Brief: Rotation angles convention for aircrafts.</li>
</ul></li>

<li><a href="https://en.m.wikipedia.org/wiki/Celestial_coordinate_system">Celestial coordinate system - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "In astronomy, a celestial coordinate system (or
celestial reference system) is a system for specifying positions
of satellites, planets, stars, galaxies, and other celestial
objects relative to physical reference points available to a
situated observer (e.g. the true horizon and north cardinal
direction to an observer situated on the Earth's surface)"</li>
</ul></li>

<li><a href="https://en.m.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles">Conversion between quaternions and Euler angles - Wikipedia</a>
<ul class="org-ul">
<li>Brief: "Spatial rotations in three dimensions can be
parametrized using both Euler angles and unit quaternions. This
article explains how to convert between the two
representations. Actually this simple use of "quaternions" was
first presented by Euler some seventy years earlier than
Hamilton to solve the problem of magic squares."</li>
</ul></li>
</ul>

<p>
Affine Tranform Matrices in SVG, Html5 Canvas and WebGL:
</p>

<ul class="org-ul">
<li><a href="https://blog.carbonfive.com/taming-2d-transforms/">Taming 2D Transforms in Html5 Canvas</a></li>

<li><a href="https://www.w3resource.com/html5-canvas/html5-canvas-matrix-transforms.php">Html5 Canvas: Matrix Transforms</a></li>

<li><a href="https://www.html5rocks.com/en/tutorials/webgl/webgl_transforms/">Html5 Rocks - WebGL Transforms</a> (WebGL - OpenGL for the web)</li>

<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform">MDN - SVG Transform matrices (Mozilla)</a></li>

<li><a href="https://www.w3.org/TR/SVGTiny12/coords.html">W3C - 7 Coordinate Systems, Transformations and Units</a> (SVG)</li>

<li><a href="https://thesoftwaresimpleton.com/blog/2018/09/25/affine-matrix">SVG Transformations with affine matrices</a> (Paul Cowan)</li>

<li><a href="https://bl.ocks.org/helderdarocha/8b28505082bf1c81977d7dec797686c7">Examples using matrix transforms in SVG</a></li>
</ul>

<p>
Affine Transform Matrices in DirectX (Direct3D):
</p>

<ul class="org-ul">
<li><a href="https://docs.microsoft.com/en-us/windows/win32/direct3d9/transforms">MSDN - Transforms (Direct3D 9)</a></li>

<li><a href="https://docs.microsoft.com/en-us/windows/win32/direct3d9/world-transform">MSDN - World Transform</a></li>

<li><a href="https://docs.microsoft.com/en-us/windows/win32/direct3d9/view-transform">MSDN - View Transform</a></li>

<li><a href="https://docs.microsoft.com/en-us/windows/win32/direct3d9/projection-transform">MSDN - Projection Transform</a></li>

<li><a href="https://docs.microsoft.com/en-us/windows/win32/direct3d9/viewports-and-clipping">MSDN - Viewport and Clipping</a></li>

<li><a href="https://docs.microsoft.com/en-us/windows/win32/direct3d9/d3dxmatrixaffinetransformation">D3DXMatrixAffineTransformation function (D3dx9math.h)</a></li>
</ul>


<p>
Affine Transform Matrices in Java AWT:
</p>

<ul class="org-ul">
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/awt/geom/AffineTransform.html">Oracle - Class AffineTransform</a></li>

<li><a href="https://www.developer.com/net/vb/article.php/626051/Java-2D-Graphics-Simple-Affine-Transforms.htm">Java 2D Graphics, Simple Affine Transforms</a></li>
</ul>

<p>
Affine Transform Matrices in non-categorized APIs
</p>

<ul class="org-ul">
<li><a href="https://brlcad.org/OLD/reports/tr-313/chapt3.html">BRL Cad - Object Motion and Matrix Manipulation</a></li>

<li><a href="https://docs.geotools.org/latest/userguide/tutorial/affinetransform.html">Affine Transformation Tutorial - GeoTools OSGeo</a></li>

<li><a href="https://wiki.freecadweb.org/Macro_MatrixTransform">FreeCAD - Macro MatrixTransform</a></li>

<li><a href="https://cadbooster.com/complete-overview-of-matrix-transformations-in-the-solidworks-api/">A complete overview of matrix transformations in the SOLIDWORKS API</a>
(SolidWorks CAD for mechanical engineering)</li>
</ul>
</div>
</div>

<div id="outline-container-org6a33781" class="outline-4">
<h4 id="org6a33781"><span class="section-number-4">1.8.4</span> 2D Canonical Affine Transforms</h4>
<div class="outline-text-4" id="text-1-8-4">
<p>
<b>General form of 2D affine transforms</b>
</p>

<p>
2D affine transforms, including translation, rotation and scaling can
be represented by matrices with the following format, that transforms
homogeneous coordinates from one coordinate system to
another. <span class="underline">Homogeneous coordinates</span>, are 2D or 3D coordinates with an
extra pseudo-coordinate, often designated by 'w', for representing
translations affine transforms in the same way as rotations and
scaling.
</p>


\begin{equation}
  A =
   \begin{bmatrix}
     a_{11}   & a_{12}   &  a_{13} \\
     a_{21}   & a_{22}   &  a_{23} \\
     0        & 0        &  1 \\
   \end{bmatrix}
\end{equation}

<p>
This affine transform performs the coordinate transformation from the
coordinate frame C2 (which axis are x, y), which could an object
local-space coordinate, to coordinate frame C1 (which axis are x', y')
which could be a world-coordinate system. The matrix transforms
homogenous coordinates, which are coordinates with an extra parameter
w = 1 for allowing translation transformation to be expressed in the
same way as rotation transformations.
</p>


\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ w' = 1
      \end{bmatrix}
  =
    \begin{bmatrix}
      a_{11}   & a_{12}   &  a_{13} \\
      a_{21}   & a_{22}   &  a_{23} \\
      0        & 0        &  1      \\
   \end{bmatrix}

     \cdot

     \begin{bmatrix}
       x \\ y \\ w = 1
     \end{bmatrix}

    =

    \begin{bmatrix}
        a_{11} \cdot x + a_{12}  \cdot y + a_{13}  \\
        a_{21} \cdot x + a_{22}  \cdot y + a_{23}  \\
        1
    \end{bmatrix}
\end{equation}

<p>
The multiplication between two affine transforms also results in a
affine transform. Consider two affine transforms \(A = a_{ij}\) 
and \(B = b_{ij}\). The product between these two affine transforms is
also an affine transform. 
</p>

\begin{equation} 
   C = A \cdot B = 

   \begin{bmatrix}
     a_{11}   & a_{12}   &  a_{13} \\
     a_{21}   & a_{22}   &  a_{23} \\
     0        & 0        &  1 \\
   \end{bmatrix}

   \begin{bmatrix}
     b_{11}   & b_{12}   &  b_{13} \\
     b_{21}   & b_{22}   &  b_{23} \\
     0        & 0        &  1 \\
   \end{bmatrix}

  = 

   \begin{bmatrix}
       c_{11} & c_{12} & c_{13}  \\ 
       c_{21} & c_{22} & c_{23}  \\
         0    &  0     &  1 
   \end{bmatrix}
\end{equation}

<p>
Where: 
</p>

<ul class="org-ul">
<li>\(c_{11} = a_{11} \cdot b_{11} + a_{12} \cdot b_{21}\)</li>
<li>\(c_{12} = a_{11} \cdot b_{12} + a_{12} \cdot b_{22}\)</li>
<li>\(c_{21} = a_{21} \cdot b_{11} + a_{22} \cdot b_{21}\)</li>
<li>\(c_{22} = a_{21} \cdot b_{12} + a_{22} \cdot b_{22}\)</li>
<li>\(c_{13} = a_{11} \cdot b_{13} + a_{12} \cdot b_{23} + a_{13}\)</li>
<li>\(c_{23} = a_{21} \cdot b_{13} + a_{22} \cdot b_{23} + a_{23}\)</li>
</ul>



<p>
<b>2D Canonical Affine Transforms</b>
</p>


<p>
Identity matrix
</p>

<ul class="org-ul">
<li>Causes no coordinate transformation. The result coordinate system
and vertices remain at the same position. The identity matrix is
also a reasonable initial default value for the model matrix, view
matrix and projection matrix.</li>
</ul>

\begin{equation}
  I =
   \begin{bmatrix}
     1   & 0   &  0 \\
     0   & 1   &  0 \\
     0   & 0   &  1 \\
   \end{bmatrix}
\end{equation}


\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ 1
      \end{bmatrix}
  =

     I
     \cdot

   \begin{bmatrix}
       x \\ y \\ w = 1
   \end{bmatrix}
  =

   \begin{bmatrix}
     1   & 0   &  0 \\
     0   & 1   &  0 \\
     0   & 0   &  1 \\
   \end{bmatrix}


   \begin{bmatrix}
       x \\ y \\ 1 
   \end{bmatrix}

  = 
   \begin{bmatrix}
       x  \\ y  \\ 1
   \end{bmatrix}
\end{equation}


<p>
Translation:
</p>

<ul class="org-ul">
<li>Translate the coordinate system from one position into another and
translate vertices.</li>
</ul>

\begin{equation}
  T =
   \begin{bmatrix}
     1   & 0   &  \Delta_x \\
     0   & 1   &  \Delta_y \\
     0   & 0   &  1        \\
   \end{bmatrix}
\end{equation}


\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ 1
      \end{bmatrix}
  =

   \begin{bmatrix}
     1   & 0   &  \Delta_x \\
     0   & 1   &  \Delta_y \\
     0   & 0   &  1        \\
   \end{bmatrix}

     \cdot

   \begin{bmatrix}
       x \\ y \\ w = 1
   \end{bmatrix}

  =
   \begin{bmatrix}
       x + \Delta_x \\ y + \Delta_y \\ 1
   \end{bmatrix}
\end{equation}


<p>
Scaling:
</p>

<ul class="org-ul">
<li>Increases or decreases object size. This transformation allows
resizing an object without sending the vertices multiple times to
the GPU in the case of a GPU accelerated graphics API.</li>
<li>Where: \(s_x\) is the scale for X axis and \(s_y\) is the scale for
the y axis.</li>
</ul>

\begin{equation}
  S =
   \begin{bmatrix}
     s_x   & 0     &  0 \\
     0     & s_y   &  0 \\
     0     & 0     &  1 \\
   \end{bmatrix}
\end{equation}


\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ 1
      \end{bmatrix}
  =

   \begin{bmatrix}
     s_x   & 0     &  0 \\
     0     & s_y   &  0 \\
     0     & 0     &  1 \\
   \end{bmatrix}
     \cdot

   \begin{bmatrix}
       x \\ y \\ w = 1
   \end{bmatrix}

  =
   \begin{bmatrix}
       s_x \cdot x \\ s_y \cdot y \\ 1
   \end{bmatrix}
\end{equation}


<p>
Shear:
</p>

\begin{equation}
  H =
   \begin{bmatrix}
     1     & h_x  &  0 \\
     h_y   & 1    &  0 \\
     0     & 0    &  1 \\
   \end{bmatrix}
\end{equation}


<p>
Rotation around Z axis:
</p>

<ul class="org-ul">
<li>Where \(\theta\) is the angle of counterclockwise rotation around Z
axis. A negative angle results in a rotation in the opposite
direction.</li>
</ul>

\begin{equation}
  R  =
   \begin{bmatrix}
     \cos \theta     & -\sin \theta  &  0 \\
     \sin \theta     &  \cos \theta  &  0 \\
     0               &  0            &  1 \\
   \end{bmatrix}
\end{equation}


\begin{equation}
     \begin{bmatrix} x' \\ y' \\ 1  \end{bmatrix}

    =
      \begin{bmatrix}
        \cos \theta     & -\sin \theta  &  0 \\
        \sin \theta     &  \cos \theta  &  0 \\
        0               &  0            &  1 \\
      \end{bmatrix}

     \begin{bmatrix} x \\ y \\ 1  \end{bmatrix}
    =
     \begin{bmatrix}
          x \cos \theta - y \sin \theta  \\
          x \sin \theta + y \cos \theta \\
          1
     \end{bmatrix}
\end{equation}
</div>
</div>
<div id="outline-container-orgc5a2068" class="outline-4">
<h4 id="orgc5a2068"><span class="section-number-4">1.8.5</span> 2D Window to Viewport transform</h4>
<div class="outline-text-4" id="text-1-8-5">
<p>
The window-to-viewport affine transform maps coordinates from a
world-space window to a viewport (physical display coordinates). The
world-space window defines what region of the world-space will be
viewed. It is specified using the world-space coordinates \(x_{wmin}\),
\(x_{wmax}\), \(y_{wmin}\) and \(y_{wmax}\). The viewport is a rectangle
within the graphics display window to where the world-window
coordinates will be mapped to. The viewport window is defined by the
coordinates: \(x_{vmin}\), \(x_{vmax}\), \(y_{vmin}\), \(y_{vmax}\) - given in
screen device-coordinates with origin at the graphics display bottom
left corner.
</p>

<p>
Note: In OpenGL this transform can be obtained using the subroutines
glViewport() and glm::ortho().
</p>

<p>
<b>Applications</b>
</p>

<ul class="org-ul">
<li>Draw in a limited area of screen. (Note: it is often possible to
define multiple viewport windows.)</li>

<li>Draw using user-defined coordinates and make the drawing
independent of the screen size.</li>

<li>Draw multiple views of the world-space.</li>

<li>Draw charts (a.k.a curve plotting).</li>

<li>Draw multiple charts on the same screen.</li>
</ul>

<p>
<b>Parts:</b>
</p>

<ul class="org-ul">
<li><span class="underline">World-Window</span> (a.k.a clipping window) =&gt; Defines <span class="underline">what</span> the user wants to
see from the world-space. Define by: \(x_{wmin}\), \(x_{wmax}\),
\(y_{wmin}\) and \(y_{wmax}\).
<ul class="org-ul">
<li>\(x_{wmin}\) - Minimum X axis coordinate from window-space that can be viewed.</li>
<li>\(x_{wmax}\) - Maximum X axis coordinate from window-space that can be viewed.</li>
<li>\(y_{wmin}\) - Minimum y axis coordinate from window-space that can be viewed.</li>
<li>\(y_{wmax}\) - Maximum y axis coordinate from window-space that can be viewed.</li>
</ul></li>

<li><span class="underline">Viewport</span> =&gt; Defines <span class="underline">where</span> the user wants to see the <span class="underline">world-window</span>
within the graphics display window (a.k.a canvas).
<ul class="org-ul">
<li>\(x_{vmin}\)  =&gt; \(0 \leq x_{vmin} \leq w\)</li>
<li>\(x_{vmax}\)  =&gt; \(0 \leq x_{vmin} \leq w\)</li>
<li>\(y_{vmin}\)  =&gt; \(0 \leq y_{vmin} \leq h\)</li>
<li>\(y_{vmax}\)  =&gt; \(0 \leq y_{vmax} \leq h\)</li>
</ul></li>

<li>Default values of viewport:
<ul class="org-ul">
<li>\(x_{vmin} = 0\)</li>
<li>\(x_{vmax} = w\)</li>
<li>\(y_{vmin} = 0\)</li>
<li>\(y_{vmax} = h\)</li>
</ul></li>
</ul>

<p>
Where:
</p>
<ul class="org-ul">
<li>h - graphics display screen height, often in pixels.</li>
<li>w - graphics display screen width, often in pixelss</li>
</ul>


<div class="figure">
<p><a href="images/world-window-to-viewport.png"><img src="images/world-window-to-viewport.png" alt="world-window-to-viewport.png" /></a>
</p>
<p><span class="figure-number">Figure 1: </span>World-to-viewport transform</p>
</div>

<p>
The window-to-viewport transform matrix can be computed as:
</p>

\begin{equation}
   T_{ W \rightarrow V} =
       \begin{bmatrix}
           s_x  &  0    & t_x \\
           0    &  s_y  & t_y \\
           0    &  0    & 1   \\
       \end{bmatrix}
\end{equation}

<p>
Where:
</p>

\begin{eqnarray*}
   s_x &=& \frac{\Delta x_{v} }{ \Delta x_{w} }
       = \frac{ x_{vmax} - x_{vmin} }{x_{wmax} - x_{wmin}}  \\

   s_y &=& \frac{\Delta y_{v} }{ \Delta y_{w} }
           = \frac{ y_{vmax} - y_{vmin} }{y_{wmax} - y_{wmin}}  \\
   t_x &=& x_{vmin} - s_x \cdot x_{wmin}                      \\
   t_y &=& y_{vmin} - s_y \cdot y_{wmin}                      \\
\end{eqnarray*}

<p>
Coordinates from world-space can be mapped to the screen-device space
by applying the affine transform \(T_{ W \rightarrow V}\) to the
world-space coordinates, designated by \(x_w\), \(y_w\).
</p>

\begin{equation}
     \begin{bmatrix} x_v \\ y_v \\ 1 \end{bmatrix}
  =
    T_{ W \rightarrow V} \cdot
    \begin{bmatrix} x_w \\ y_w \\ 1 \end{bmatrix}
\end{equation}

\begin{equation}
     \begin{bmatrix} x_v \\ y_v \\ 1 \end{bmatrix}
  =
    \begin{bmatrix}
       s_x \cdot x_w + t_x \\
       s_y \cdot y_w + t_y \\
       1
    \end{bmatrix}
  =
    \begin{bmatrix}
       s_x (x_w - x_{wmin}) + x_{vmin} \\
       s_y (x_y - y_{wmin}) + y_{vmin} \\
       1
    \end{bmatrix}
\end{equation}

<p>
Finally, the coordinates \(x_v\) and \(y_v\) can be determined in a more
human-friendly way with the following expression:
</p>

\begin{eqnarray*}
   x_v &=&  s_x (x_w - x_{wmin}) + x_{vmin} \\
   y_v &=&  s_y (y_w - y_{wmin}) + y_{vmin} \\
\end{eqnarray*}

<p>
<b>Image distortion</b>
</p>

<p>
The world-space propotions will only be preserved when the following
predicate holds. For instance, a square in the world-space will look
like a rectangle if the rations \(s_x\) and \(s_y\) are not equal.
</p>

\begin{equation}
   s_x = s_y
\end{equation}

<p>
In orther words,
</p>

\begin{equation}
   \frac{ x_{vmax} - x_{vmin} }{x_{wmax} - x_{wmin}} = \frac{ y_{vmax} - y_{vmin} }{y_{wmax} - y_{wmin}}
\end{equation}

<p>
<b>Upper-left coordinate system</b>
</p>

<p>
If the graphics API has a default upper-left coordinate system, where
the origin is at the upper-left corner of the display window and Y
axis is pointing downwards. The viewport matrix transform becomes:
</p>

\begin{equation}
   T_{ W \rightarrow VU} =
       \begin{bmatrix}
           s_x  &  0     & t_x      \\
           0    &  -s_y  & h - t_y  \\
           0    &  0     &  1       \\
       \end{bmatrix}
\end{equation}

<p>
Then, the \(x_v\), \(y_v\) coordinates can be computed as: 
</p>


\begin{eqnarray*}
   x_v &=&  +s_x (x_w - x_{wmin}) + x_{vmin}       \\
   y_v &=&  -s_y (y_w - y_{wmin}) + (h - y_{vmin}) \\
\end{eqnarray*}

<p>
<b>References and further reading:</b>
</p>

<ul class="org-ul">
<li><a href="https://www.khronos.org/opengl/wiki/Vertex_Post-Processing#Viewport_transform">Khronos Group - Viewport transform</a>
<ul class="org-ul">
<li>"The viewport transform defines the transformation of vertex
positions from NDC space to window space. These are the
coordinates that are rasterized to the output image. The
viewport is defined by a number of viewport parameters. These
parameters are set by these functions: <span class="underline">glViewport</span>; <span class="underline">glDepthRange</span>;
<span class="underline">glDepthRangef</span>."</li>
</ul></li>

<li><a href="http://mcasjcet.weebly.com/uploads/4/4/7/9/4479347/computer_graphics_second_module_second.pdf">MCA - 301 - Computer Graphics</a></li>

<li><a href="https://eaymanelshenawy.files.wordpress.com/2016/02/gc-lecture-005-viewingand-clipping.pdf">Computer Graphics Viewing Objective</a></li>

<li><a href="https://www.sfu.ca/sasdoc/sashtml/iml/chap12/sect7.htm">Windows and viewports</a></li>

<li><a href="https://web.cse.ohio-state.edu/~shen.94/581/Site/Slides_files/2dDrawing.pdf">Drawing and coordinate system</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgd5cf7e5" class="outline-4">
<h4 id="orgd5cf7e5"><span class="section-number-4">1.8.6</span> 3D Affine Transforms</h4>
<div class="outline-text-4" id="text-1-8-6">
<p>
<b>Notations for homogenous coordinate</b>
</p>

<p>
Point-Vector - for denoting postion, location, point in space or vertex: 
</p>

<ul class="org-ul">
<li>It represents a point or a vertex in space, a coordinate relative
to the origin of the coordinate system. Some valid affinte
transform operations are translation, rotation, shear and scaling.</li>
</ul>

\begin{equation}
  p =
   \begin{bmatrix}
     x  \\ y \\ z \\ w = 1
   \end{bmatrix}
  = 
   \begin{bmatrix}
     x  \\ y \\ z \\ 1
   \end{bmatrix}

\end{equation}

<p>
Vector - for denoting force, acceleration, or difference between two
point-vectors, and so on:
</p>

<ul class="org-ul">
<li>It represents entities, such as difference between two
point-vectors, force, speed, angular speed, acceleration and so
on, with a magnitude and direction. It does not make sense to
apply translation and scaling to those entities, as a result the
pseudo coordinate w is zero for this case.</li>
</ul>


\begin{equation}
  v =
   \begin{bmatrix}
     x  \\ y \\ z \\ w = 0 
   \end{bmatrix}
   =
   \begin{bmatrix}
     x  \\ y \\ z \\ 0 
   \end{bmatrix}
\end{equation}


<p>
<b>3D Affine Transforms</b>
</p>

<p>
3D affine transforms can be represented by matrices with the following
format.
</p>

\begin{equation}
  A =
   \begin{bmatrix}
     a_{11}   & a_{12}   &  a_{13} & a_{14}  \\
     a_{21}   & a_{22}   &  a_{23} & a_{24}  \\
     a_{31}   & a_{32}   &  a_{33} & a_{34}  \\
     0        & 0        &  0      & 1       \\
   \end{bmatrix}
\end{equation}

<p>
An affine transformation maps the coordinate system (X, Y, Z), which
could be an object local coordinate system, to the coordinate system
(X', Y', Z'), which could be a world coordinate system. In a similar
manner to 2D homogeneous coordinates, an extra pseudo-coordinate w = 1
is added for expressing translations transformations as matrix
multiplications, in the same way as rotations.
</p>


\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ z' \\ w' = 1
      \end{bmatrix}
  =
    \begin{bmatrix}
      a_{11}   & a_{12}   &  a_{13} & a_{14} \\
      a_{21}   & a_{22}   &  a_{23} & a_{24} \\
      a_{31}   & a_{32}   &  a_{33} & a_{34} \\
      0        & 0        &  0      &   1    \\
   \end{bmatrix}

     \cdot

     \begin{bmatrix}
       x \\ y \\ z \\ w = 1
     \end{bmatrix}

\end{equation}


\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ z' \\ 1
      \end{bmatrix}
    =

    \begin{bmatrix}
        a_{11} \cdot x + a_{12}  \cdot y + a_{13} \cdot z + a_{14}  \\
        a_{21} \cdot x + a_{22}  \cdot y + a_{23} \cdot z + a_{24}  \\
        a_{31} \cdot x + a_{32}  \cdot y + a_{33} \cdot z + a_{34}  \\
        1
    \end{bmatrix}
\end{equation}

<p>
<span class="underline">Combination between affine transforms</span> 
</p>

<p>
Consider two affine transforms \(A = a_{ij}\) and \(B = b_{ij}\). The
product between those two transform is also an affine transform. 
</p>

\begin{equation} 
  C = A \cdot B 
   = 
    \left[\begin{matrix}a_{11} & a_{12} & a_{13} & a_{14}\\a_{21} & a_{22} & a_{23} 
         & a_{24}\\a_{31} & a_{32} & a_{33} & a_{34}\\0 & 0 & 0 & 1\end{matrix}\right]

    \left[\begin{matrix}b_{11} & b_{12} & b_{13} & b_{14}\\b_{21} & b_{22} & b_{23} 
         & b_{24}\\b_{31} & b_{32} & b_{33} & b_{34}\\0 & 0 & 0 & 1\end{matrix}\right]
\end{equation}


\begin{equation} 
   C = 
    \left[\begin{matrix}c_{11} & c_{12} & c_{13} & c_{14}\\c_{21} & c_{22} & c_{24} 
         & c_{23}\\c_{31} & c_{32} & c_{33} & c_{34}\\0 & 0 & 0 & 1\end{matrix}\right]
\end{equation}

<p>
<span class="underline">Rotation affine transforms</span> 
</p>


<p>
Rotation affine transforms represents rotation around some axis or
direction have the following form:
</p>

\begin{equation}
  R =
   \begin{bmatrix}
     r_{11}   & r_{12}   &  r_{13} & 0  \\
     r_{21}   & r_{22}   &  r_{23} & 0  \\
     r_{31}   & r_{32}   &  r_{33} & 0  \\
     0        & 0        &  0      & 1  \\
   \end{bmatrix}
\end{equation}


<p>
Properties of Rotation Matrix Affine Transforms:
</p>

<ul class="org-ul">
<li>Rotation matrices are <i>orthogonal</i> matrices and have the following properties:</li>
</ul>

\begin{equation}
   R^T \cdot R = R \cdot R^T = I 
\end{equation}

\begin{equation}
   det(R) = 1
\end{equation}

\begin{equation}
   R^T = R^{-1}
\end{equation}

<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>R is a rotation matrix</li>
<li>\(R^T\) is the transpose of the rotation matrix R.</li>
<li>\(R^{-1}\) is the inverse of the rotation matrix R.</li>
</ul></li>
</ul>


<p>
<b>3D Canonical Affine Transforms</b>
</p>

<p>
<span class="underline">Translation:</span>
</p>

<ul class="org-ul">
<li>Where: \(T^{-1}\) is the inverse transform.</li>
</ul>

\begin{equation}
  T =
   \begin{bmatrix}
     1   & 0   &  0 &  \Delta_x \\
     0   & 1   &  0 &  \Delta_y \\
     0   & 0   &  1 &  \Delta_z \\
     0   & 0   &  0 &   1      \\
   \end{bmatrix}
\end{equation}


\begin{equation}
  T^{-1} =
   \begin{bmatrix}
     1   & 0   &  0 &  -\Delta_x \\
     0   & 1   &  0 &  -\Delta_y \\
     0   & 0   &  1 &  -\Delta_z \\
     0   & 0   &  0 &   1        \\
   \end{bmatrix}
\end{equation}

<p>
Translation transform applied to an homogeneous vector (x, y, z, w = 1):
</p>


\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ z' \\ w' = 1
      \end{bmatrix}
  =

   \begin{bmatrix}
     1   & 0   & 0 &  \Delta_x \\
     0   & 1   & 0 &  \Delta_y \\
     0   & 0   & 1 &  \Delta_z \\
     0   & 0   & 0 &    1      \\
   \end{bmatrix}

     \cdot

   \begin{bmatrix}
       x \\ y \\ z \\ w = 1
   \end{bmatrix}

  =
   \begin{bmatrix}
       x + \Delta_x \\ y + \Delta_y \\ z + \Delta_z \\ 1
   \end{bmatrix}
\end{equation}


<p>
<span class="underline">Scaling:</span>
</p>

<ul class="org-ul">
<li>Where: \(s_x\),  \(s_y\), \(s_z\) are the scale factors for axis x, y, z
and  \(S^{-1}\) is the inverse transform (inverse matrix).</li>
</ul>

\begin{equation}
  S =
   \begin{bmatrix}
     s_x   & 0     &  0   &  0 \\
     0     & s_y   &  0   &  0 \\
     0     & 0     &  s_z &  0 \\
     0     & 0     &  0   &  1  \\
   \end{bmatrix}
\end{equation}


\begin{equation}
  S^{-1} =
   \begin{bmatrix}
     1 / s_x   & 0     &  0       &  0 \\
     0     & 1 / s_y   &  0       &  0 \\
     0     &    0      &  1 / s_z &  0 \\
     0     &    0      &  0       &  1 \\
   \end{bmatrix}
\end{equation}


<p>
Scaling transform applied to a homogeneous coordinate vector:
</p>

\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ z' \\ w' = 1
      \end{bmatrix}
  =

   S \cdot

   \begin{bmatrix}
       x \\ y \\ z \\ w = 1
   \end{bmatrix}

  =
   \begin{bmatrix}
       s_x \cdot x \\ s_y \cdot y \\ s_z \cdot z \\ 1
   \end{bmatrix}
\end{equation}



<p>
<span class="underline">Rotation around x axis</span>
</p>

<ul class="org-ul">
<li>\(R_x^{-1} = R_x^T\) =&gt; The inverse is equal to the transpose.</li>
</ul>

\begin{equation}
    R_x(\alpha) =
      \begin{bmatrix}
        1   & 0            &  0              & 0  \\
        0   & \cos{\alpha} & -\sin{\alpha}   & 0  \\
        0   & \sin{\alpha} &  \cos{\alpha}   & 0  \\
        0   & 0            &  0              & 1  \\
      \end{bmatrix}
\end{equation}


<p>
Transform \(R_x\) applied to a homogeneous vector (X, Y, Z, w = 1).
</p>

\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ z' \\ w' = 1
      \end{bmatrix}
  =

   R_x(\alpha) \cdot

   \begin{bmatrix}
       x \\ y \\ z \\ w = 1
   \end{bmatrix}

  =
   \begin{bmatrix}
       x                                            \\
       y \cdot \cos{\alpha} - z \cdot \sin{\alpha}  \\
       y \cdot \sin{\alpha} + z \cdot \cos{\alpha}  \\
       1                                            \\
   \end{bmatrix}
\end{equation}



<p>
<span class="underline">Rotation around y axis</span>
</p>

<ul class="org-ul">
<li>\(R_y^{-1} = R_y^T\)</li>
</ul>

\begin{equation}
 R_y(\beta) =
   \begin{bmatrix}
     \cos{\beta}    & 0   & \sin{\beta} & 0 \\
     0              & 1   & 0           & 0 \\
    -\sin{\beta}    & 0   & \cos{\beta} & 0 \\
    0               & 0   & 0           & 1
   \end{bmatrix}
\end{equation}


<p>
Transform \(R_y\) applied to a homogeneous vector:
</p>

\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ z' \\ w' = 1
      \end{bmatrix}
  =

   R_y(\beta) \cdot

   \begin{bmatrix}
       x \\ y \\ z \\ w = 1
   \end{bmatrix}

  =
   \begin{bmatrix}
       x \cdot \cos{\beta} + z \cdot \sin{\beta} \\
       y                             \\
     - x \cdot \sin{\beta} + z \cdot \cos{\beta} \\
   \end{bmatrix}
\end{equation}

<p>
<span class="underline">Rotation around z axis</span>
</p>

<ul class="org-ul">
<li>\(R_z^{-1} = R_z^T\)</li>
</ul>

\begin{equation}
 R_z(\theta) =
   \begin{bmatrix}
      \cos{\theta}  & -\sin{\theta} &  0 & 0 \\
      \sin{\theta}  &  \cos{\theta} &  0 & 0 \\
     0              & 0             &  1 & 0 \\
     0              & 0             &  0 & 1 \\
   \end{bmatrix}
\end{equation}


<p>
Transform \(R_z\) applied to a homogeneous vector:
</p>

\begin{equation}
     \begin{bmatrix}
       x' \\ y' \\ z' \\ w' = 1
      \end{bmatrix}
  =

   R_z(\theta) \cdot

   \begin{bmatrix}
       x \\ y \\ z \\ w = 1
   \end{bmatrix}

  =
   \begin{bmatrix}
       x \cdot \cos{\theta} - y \cdot \sin{\theta}   \\
       x \cdot \sin{\theta} + y \cdot \cos{\theta}   \\
       z                                             \\
       1
   \end{bmatrix}
\end{equation}



<p>
<span class="underline">Rotation around arbirtary axis</span>
</p>

<ul class="org-ul">
<li>Formula 1 : The axis is defined by unit vector \(\hat{n}\)
<ul class="org-ul">
<li>References:  <a href="http://www.chrobotics.com/library/understanding-quaternions">(Chrobotics)</a>, <a href="https://www.weizmann.ac.il/sci-tea/benari/sites/sci-tea.benari/files/uploads/softwareAndLearningMaterials/quaternion-tutorial-2-0-1.pdf">(Ben-Ari - Weizmann)</a> - derived from
quaternion equations.</li>
</ul></li>
</ul>

\begin{equation}
   T_n = \begin{bmatrix}

             a^2 + b^2 - c^2 - d^2
          &  2 (b \cdot c -  a \cdot d)
          &  2 (b \cdot d +  a \cdot c)
          &  0                            \\

             2 (b \cdot c +  a \cdot d )
          &  a^2 - b^2 + c^2 -d^2
          &  2 ( c \cdot d -  a \cdot b )
          &  0                            \\

             2 ( b \cdot d -  a \cdot c  )
          &  2 ( c \cdot d +  a \cdot b )
          &  a^2 - b^2 - c^2 + d^2
          &  0                            \\

             0 & 0 & 0 & 1 \\
         \end{bmatrix}
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>\(\hat{n}\) is a unit vector that designates the direction, thus: \(\hat{n} = 1\)</li>
<li>\(\hat{n} = [x_n \quad y_n \quad z_n]^T\)
<ul class="org-ul">
<li>\(x_n\), \(y_n\), \(z_n\) are the components of vector \(\hat{n}\).</li>
</ul></li>
<li>\(a = \cos( \theta / 2)\)</li>
<li>\(b = x_n \cdot \sin (\theta / 2)\)</li>
<li>\(c = y_n \cdot \sin (\theta / 2)\)</li>
<li>\(d = z_n \cdot \sin (\theta / 2)\)</li>
</ul>


<p>
<span class="underline">Rotation around arbirtary axis</span>
</p>
<ul class="org-ul">
<li>Reference:  <a href="https://cseweb.ucsd.edu/classes/wi18/cse169-a/slides/CSE169_03.pdf">(Steve Rotenberg - Computer Animation)</a></li>
</ul>


\begin{equation}
  T_n = \begin{bmatrix}
             x_n^2 + C \cdot (1 - x_n^2)
          &  x_n \cdot y_n \cdot (1 - C) - z_n \cdot S
          &  x_n \cdot z_n \cdot (1 - C)  + y_n \cdot S
          &  0
          \\

             x_n \cdot y_n \cdot (1 - C) + z_n \cdot S
          &  y_n^2 + C \cdot (1 - y_n^2)
          &  y_n \cdot z_n \cdot (1 - C) - x_n \cdot S
          &  0
          \\
               x_n \cdot z_n \cdot (1 - C) - y_n \cdot S
           &   y_n \cdot z_n \cdot (1 - C) +  x_n \cdot S
           &  z_n^2 + C \cdot (1 - z_n^2)
           &  0
           \\

           0 & 0 & 0 & 1

        \end{bmatrix}
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>\(\theta\) is the rotation angle around the unit vector \(\hat{n}\)</li>
<li>\(C = \sin \theta\)</li>
<li>\(S = \cos \theta\)</li>
<li>\(\hat{n}\) is a unit vector that designates the direction, thus: \(\hat{n} = 1\)</li>
<li>\(\hat{n} = [x_n \quad y_n \quad z_n]^T\)
<ul class="org-ul">
<li>\(x_n\), \(y_n\), \(z_n\) are the components of vector \(\hat{n}\).</li>
</ul></li>
</ul>


<p>
Testing formula in <a href="https://www.sympy.org/en/index.html">Sympy</a> - Python CAS (Computer Algebra System):
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">import</span> sympy

<span class="org-comment-delimiter"># </span><span class="org-comment">t represents the angle theta</span>
<span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>, <span class="org-variable-name">t</span> = symbols(<span class="org-string">'x y z t'</span>)
<span class="org-variable-name">C</span>, <span class="org-variable-name">S</span> = symbols(<span class="org-string">"C S"</span>)

<span class="org-variable-name">row1</span> = [ x**2 + C * (1 - x**2), x * y * (1 - C) - z * S, x * z * (1 - C)  + y * S ]
<span class="org-variable-name">row2</span> = [ x * y * (1 - C) + z * S, y**2 + C * (1 - y**2), y * z * (1 - C) - x * S ]
<span class="org-variable-name">row3</span> = [ x * z * (1 - C) - y * S,  y * z * (1 - C) +  x * S, z**2 + C * (1 - z**2) ]

<span class="org-variable-name">m</span> = Matrix([row1, row2, row3])

<span class="org-comment-delimiter"># </span><span class="org-comment">C = cos(t)</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">S = sin(t)</span>

In [7]: m
<span class="org-function-name">Out</span>[<span class="org-compilation-line-number">7</span>]:
&#9121;   &#9115;     2&#9118;    2                                          &#9124;
&#9122; C&#8901;&#9117;1 - x &#9120; + x     -S&#8901;z + x&#8901;y&#8901;(1 - C)  S&#8901;y + x&#8901;z&#8901;(1 - C) &#9125;
&#9122;                                                          &#9125;
&#9122;                       &#9115;     2&#9118;    2                      &#9125;
&#9122;S&#8901;z + x&#8901;y&#8901;(1 - C)    C&#8901;&#9117;1 - y &#9120; + y     -S&#8901;x + y&#8901;z&#8901;(1 - C)&#9125;
&#9122;                                                          &#9125;
&#9122;                                           &#9115;     2&#9118;    2  &#9125;
&#9123;-S&#8901;y + x&#8901;z&#8901;(1 - C)  S&#8901;x + y&#8901;z&#8901;(1 - C)    C&#8901;&#9117;1 - z &#9120; + z   &#9126;

<span class="org-comment-delimiter"># </span><span class="org-comment">--- Determine rotation matrix around Z axis (Particular case) ------#</span>
<span class="org-comment-delimiter">#</span>

In [8]: m.subs({x: 0, y: 0, z: 1})
<span class="org-function-name">Out</span>[<span class="org-compilation-line-number">8</span>]:
&#9121;C  -S  0&#9124;
&#9122;        &#9125;
&#9122;S  C   0&#9125;
&#9122;        &#9125;
&#9123;0  0   1&#9126;

In [11]: <span class="org-variable-name">rotZ</span> = m.subs({x: 0, y: 0, z: 1, C: cos(t), S: sin(t) })

In [12]: rotZ
<span class="org-function-name">Out</span>[<span class="org-compilation-line-number">12</span>]:
&#9121;cos(t)  -sin(t)  0&#9124;
&#9122;                  &#9125;
&#9122;sin(t)  cos(t)   0&#9125;
&#9122;                  &#9125;
&#9123;  0        0     1&#9126;


<span class="org-comment-delimiter">#</span><span class="org-comment">---- Determine rotation matrix around X axis (Particular case) ------#</span>
<span class="org-comment-delimiter">#</span>
In [14]: <span class="org-variable-name">rotX</span> = m.subs({x: 1, y: 0, z: 0, C: cos(t), S: sin(t) })

In [15]: rotX
<span class="org-function-name">Out</span>[<span class="org-compilation-line-number">15</span>]:
&#9121;1    0        0   &#9124;
&#9122;                  &#9125;
&#9122;0  cos(t)  -sin(t)&#9125;
&#9122;                  &#9125;
&#9123;0  sin(t)  cos(t) &#9126;

<span class="org-comment-delimiter">#</span><span class="org-comment">---- Determine rotation matrix around Y axis (Particular case) ------#</span>
<span class="org-comment-delimiter">#</span>
In [16]: <span class="org-variable-name">rotY</span> = m.subs({x: 0, y: 1, z: 0, C: cos(t), S: sin(t) })

In [17]: rotY
<span class="org-function-name">Out</span>[<span class="org-compilation-line-number">17</span>]:
&#9121;cos(t)   0  sin(t)&#9124;
&#9122;                  &#9125;
&#9122;   0     1    0   &#9125;
&#9122;                  &#9125;
&#9123;-sin(t)  0  cos(t)&#9126;

</pre>
</div>
</div>
</div>

<div id="outline-container-org4d44c40" class="outline-4">
<h4 id="org4d44c40"><span class="section-number-4">1.8.7</span> Camera View Transform</h4>
<div class="outline-text-4" id="text-1-8-7">
<p>
The camera view transform matrix transforms world-space coordinates to
camera-space coordinates. On old OpenGL versions, this matrix was
can be constructed through the OpenGL routine <span class="underline">gluLookAt</span> or the GLM
(OpenGL Mathematics) library routine glm::lookAt.
</p>

<p>
The GLM function glm::lookAt() has the following type signature.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-1">(</span>
                <span class="org-comment-delimiter">// </span><span class="org-comment">Eye vector - camera position in world-space coordinates</span>
                <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">eye</span>

                <span class="org-comment-delimiter">// </span><span class="org-comment">At vector - point to where camera is looking at</span>
                <span class="org-comment-delimiter">// </span><span class="org-comment">in world-space coordinates.</span>
              , <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">at</span>

                <span class="org-comment-delimiter">// </span><span class="org-comment">Up vector - camera's orientation. Often set to vertical axis</span>
                <span class="org-comment-delimiter">// </span><span class="org-comment">or Y axis up = (x = 0, y = 1, z = 0) by default.</span>
              , <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">up</span>
              <span class="org-rainbow-delimiters-depth-1">)</span>;

  <span class="org-comment-delimiter">// </span><span class="org-comment">--------- Usage ------------------------//</span>

  ... ... ... ... ...

<span class="org-function-name">glm</span>::mat4 camera_View_transform = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-1">(</span>  eye_camera_current_position
                                              , point_to_where_camera_is_looking_at
                                              , up_vector
                                              <span class="org-rainbow-delimiters-depth-1">)</span>;

  <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader ID of shader's view transform uniform variable.</span>
  <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_view_transform</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-1">(</span>prog, <span class="org-string">"u_view_transform"</span><span class="org-rainbow-delimiters-depth-1">)</span>;

  <span class="org-comment-delimiter">// </span><span class="org-comment">Set View tranform shader uniform variable</span>
  glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-1">(</span>u_view_transform, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-2">(</span>camera_View_transform<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>


<p>
This function has the following algorithm:
</p>

\begin{equation}
    T_{\text{view}} =
          \begin{bmatrix}
              X_x & X_y & X_z & -\vec{X} \cdot \vec{\text{eye}}  \\
              Y_x & Y_y & Y_z & -\vec{Y} \cdot \vec{\text{eye}}  \\
              Z_x & Z_y & Z_z & -\vec{Z} \cdot \vec{\text{eye}}  \\
              0   & 0   & 0   &  1
          \end{bmatrix}

     =
          \begin{bmatrix}
              X_x & X_y & X_z & - \text{dot}(\vec{X}, \vec{\text{eye}})  \\
              Y_x & Y_y & Y_z & - \text{dot}(\vec{Y}, \vec{\text{eye}})  \\
              Z_x & Z_y & Z_z & - \text{dot}(\vec{Z}, \vec{\text{eye}})  \\
              0   & 0   & 0   &  1
          \end{bmatrix}
\end{equation}

<p>
And the unit vectors, X, Y and Z are computed in the following manner:
</p>

\begin{eqnarray*}
    \vec{Z} &=&  \frac{ \vec{eye} - \vec{at} }{\left\| \vec{eye} - \vec{at}  \right\| }
              = \frac{ -\vec{\text{forward}}  }{\left\| \vec{\text{forward}}  \right\| } 
              = -\text{normalize}(  \vec{eye} - \vec{at}  )
              = -\text{normalize}( \vec{\text{forward}} )
               \\

    \vec{X} &=&  \frac{ \vec{up} \times \vec{Z} }{\left\| \vec{up} \times \vec{Z}  \right\| } 
               = \text{normalize}( \text{cross}( \vec{up}, \vec{Z}  ) ) 
               \\

    \vec{Y} &=&  \frac{ \vec{Z} \times \vec{X} }{\left\| \vec{Z} \times \vec{X}  \right\| }  
               =  \text{normalize}( \text{cross}( \vec{Z}, \vec{X}  ) ) 
               \\
\end{eqnarray*}

<p>
The vector \(\vec{Z}\) is the opposite direction, represented by a unit
vector, to where the camera is looking at. If this vector were an
input, and was directly set by the calling code, rotating that camera
viewing direction  would require just rotating this vector.
</p>

<p>
Where:
</p>
<ul class="org-ul">
<li>\(\vec{forward} = \vec{at} - \vec{eye}\) =&gt; Direction to where the camera is looking at (a.k.a pointing at).</li>
<li>INPUTS:
<ul class="org-ul">
<li>\(\vec{eye}\) (Eye vector) =&gt; Camera's position in world-space coordinates.</li>
<li>\(\vec{at}\)  (At vector) =&gt; Point in world-space coordinate where the camera is lookin at.</li>
<li>\(\vec{up}\)  (Up vector) =&gt; Camera orientation, often set by default to Y axis.</li>
</ul></li>
<li>Intermediate Outputs:
<ul class="org-ul">
<li>\(\vec{X} = [X_x \quad X_y \quad X_z]\)</li>
<li>\(\vec{Y} = [Y_x \quad Y_y \quad Y_z]\)</li>
<li>\(\vec{Z} = [Z_x \quad Z_y \quad Z_z]\)</li>
</ul></li>
<li>Notation Used:
<ul class="org-ul">
<li>\(\left\| \vec{vector}  \right\|\) - means the vector norm</li>
<li>\(\vec{A} \times \vec{B}\) - means vector cross product</li>
<li>\(\vec{A} \cdot \vec{B}\) - means vector dot product.</li>
</ul></li>
</ul>


<p>
The previous matrix turns world-space into camera-space coordinates in
the following mode:
</p>

\begin{equation}
   \begin{bmatrix}
       x_{\text{camera}} \\ y_{\text{camera}} \\ z_{\text{camera}} \\ 1
   \end{bmatrix}

   =  T_{\text{projection}} \cdot

   \begin{bmatrix}
       x_{\text{world}} \\ y_{\text{world}} \\ z_{\text{world}} \\ 1
   \end{bmatrix}
\end{equation}

<p>
Where:
</p>

<ul class="org-ul">
<li>The right-side (4 x 1) column vector (input) is the world-space coordinate.</li>

<li>The left-side (4 x 1) column vector (ouput) is the camera-space
coordinate.</li>
</ul>

<p>
<b>Pointing camera to specific direction</b>
</p>

<p>
The function lookAt() points the camera view to a specific point in
the space <span class="underline">at</span> vector in world-space coordinates. The following function
could be defined for pointing the camera at specific direction (vector
or normalized vector) instead of a point-vector.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">glm</span>::mat4
lookAt_direction<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">eye</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">forward</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">up</span>  <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">at</span> = eye + forward;
    <span class="org-keyword">return</span> lookAt<span class="org-rainbow-delimiters-depth-2">(</span>eye, at, up<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Where:
</p>

<ul class="org-ul">
<li><span class="underline">eye</span> - (point-verctor) Camera position in world-space coordinates</li>
<li><span class="underline">forward</span> - (vector) Direction to where camera is looking at.</li>
<li><span class="underline">up</span> (vector) Camera's orientation</li>
</ul>


<p>
<b>Algorithm Validation</b>
</p>

<p>
Testing GLM (OpenGL Mathematic Library) in CERN's root REPL:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">-------------- Case  1 --------------------- //</span>
<span class="org-comment-delimiter">//</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">eye</span> = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>3.0, 10.0, 20.0<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">at</span>  = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>50.0, 25.0, 10.0<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">up</span>  = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-1">)</span>;

root <span class="org-rainbow-delimiters-depth-1">[</span>108<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> view_matrix = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-1">(</span>eye, at, up<span class="org-rainbow-delimiters-depth-1">)</span>;
root <span class="org-rainbow-delimiters-depth-1">[</span>109<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>109<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"view = "</span>, view_matrix<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> view =  =
   0.208  -0.000   0.978 -20.186
  -0.291   0.955   0.062  -9.912
  -0.934  -0.298   0.199   1.808
   0.000   0.000   0.000   1.000
root <span class="org-rainbow-delimiters-depth-1">[</span>110<span class="org-rainbow-delimiters-depth-1">]</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">------------ Case 2 --------------------------//</span>
<span class="org-keyword">auto</span> eye = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>50.0, -10.0, 0.0<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">up</span> = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">at</span> = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>25.0, 5.615, -200.0<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">auto</span> <span class="org-variable-name">view_matrix</span> = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-1">(</span>eye, at, up<span class="org-rainbow-delimiters-depth-1">)</span>;

root <span class="org-rainbow-delimiters-depth-1">[</span>114<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>114<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"view = "</span>, view_matrix<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> view =  =
   0.992   0.000  -0.124 -49.614
   0.010   0.997   0.077   9.491
   0.124  -0.077   0.989  -6.956
   0.000   0.000   0.000   1.000

</pre>
</div>

<p>
Implement glm::lookAt() algorithm in Julia programming language:
</p>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter"># </span><span class="org-comment">Return vector v normalized =&gt;&gt; Returns column vector</span>
<span class="org-function-name">normalize</span>(v) = <span class="org-keyword">begin</span>
   x, y, z = v
   mag = sqrt(x * x + y * y + z * z)
   [ (x / mag) (y / mag) (z / mag)]'
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Vector cross product =&gt;&gt; Returns column vector</span>
<span class="org-keyword">function</span> <span class="org-function-name">cross</span>(va, vb)
   x, y, z = va
   T = [ 0 -z y ; z 0 -x; -y x 0]
   <span class="org-keyword">return</span> T * vb
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Vector Dot product via vector column X transpose multiplication</span>
<span class="org-function-name">dot</span>(va, vb) = va' * vb

<span class="org-comment-delimiter"># </span><span class="org-comment">Note: The inputs must be column vectors</span>
<span class="org-keyword">function</span> <span class="org-function-name">lookAt</span>(eye, at, up)
   <span class="org-comment-delimiter"># </span><span class="org-comment">The vector Z is the direction to where the camera is looking at.</span>
   Z = normalize( eye - at      )
   X = normalize( cross(up, Z)  )
   Y = normalize( cross(Z, X )  )
   t = [ dot(eye, X)  dot(eye, Y)  dot(eye, Z) ]

   <span class="org-comment-delimiter"># </span><span class="org-comment">Define identity matrix</span>
   matrix = [ 1.0 0.0 0.0 0.0 ; 0.0 1.0 0.0 0.0 ; 0.0 0.0 1.0 0.0; 0.0 0.0 0.0 1.0]

   <span class="org-comment-delimiter"># </span><span class="org-comment">Assign vector X to matrix's first row</span>
   matrix[1, 1:3] = X
   <span class="org-comment-delimiter"># </span><span class="org-comment">Assign vector Y to matrix's second row</span>
   matrix[2, 1:3] = Y
   <span class="org-comment-delimiter"># </span><span class="org-comment">Assign vector Z to matrix's third row</span>
   matrix[3, 1:3] = Z
   <span class="org-comment-delimiter"># </span><span class="org-comment">Assign forth (last) column to vector t</span>
   matrix[1:3, 4] = -t
   <span class="org-keyword">return</span> matrix
<span class="org-keyword">end</span>
</pre>
</div>

<p>
Test implementation:
</p>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter">#  </span><span class="org-comment">--------- Test Case 1 --------------------------#</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">=================================================#</span>
eye = [3.0 10.0 20.0  ]'
at  = [50.0 25.0 10.0 ]'
up  = [0.0   1.0 0.00 ]' <span class="org-comment-delimiter"># </span><span class="org-comment">Y axis</span>

julia&gt; eye
3&#215;1 LinearAlgebra.Adjoint{<span class="org-type">Float64</span>,<span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}}:
  3.0
 10.0
 20.0

<span class="org-comment-delimiter"># </span><span class="org-comment">Camera's view transform matrix</span>
julia&gt; Tview = lookAt(eye, at, up)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 -0.208108  0.0       -0.978106   20.1864
 -0.291457  0.954572   0.062012   -9.91159
  0.933672  0.297981  -0.198654  -52.1466
  0.0       0.0        0.0         1.0

<span class="org-comment-delimiter"># </span><span class="org-comment">Camera's view transform matrix rounded with 3 decimal digits</span>
julia&gt; map(x -&gt; round(x, digits=3), Tview)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
  0.208   0.0    0.978  -20.186
 -0.291   0.955  0.062   -9.912
 -0.934  -0.298  0.199    1.808
  0.0     0.0    0.0      1.0

<span class="org-comment-delimiter">#  </span><span class="org-comment">--------- Test Case 2 --------------------------#</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">=================================================#</span>
eye = [50.0 -10.0 0.0 ]'
up  = [0.0 1.0 0.0 ]'
at  = [25.0 5.615 -200.0]'

Tview = lookAt(eye, at, up)

julia&gt; map(x -&gt; round(x, digits=3), Tview)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 0.992   0.0    -0.124  -49.614
 0.01    0.997   0.077    9.491
 0.124  -0.077   0.989   -6.956
 0.0     0.0     0.0      1.0

</pre>
</div>


<p>
<b>References</b>
</p>

<ul class="org-ul">
<li><a href="http://ivl.calit2.net/wiki/images/2/2c/03_CoordinateSystemsS15.pdf">CSE 167: Introduction to Computer Graphics</a> - Lecture 3 - Coordinate Systems.</li>

<li><a href="https://www.cs.utexas.edu/~fussell/courses/cs354/lectures/lecture11.pdf">Viewing and Modelling - CS354</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgdc4ff0e" class="outline-4">
<h4 id="orgdc4ff0e"><span class="section-number-4">1.8.8</span> Camera Projection Transform</h4>
<div class="outline-text-4" id="text-1-8-8">
<p>
The camera's projection transform matrix turns camera-space
coordinates into clip-space coordinates, which are normalized NDC
(Normalized-Device Coordinates). Any coordinate in the clip-space
coordinate out of the range (-1.0 to 1.0) in the three axis X, Y and Z
will not be shown at the screen, they will be clipped. It is worth
noting that some projection matrices are not affine transforms.
</p>


<p>
<b>Ortographic Projection Transform</b> - <a href="https://cseweb.ucsd.edu/classes/wi18/cse167-a/lec4.pdf">(CSE167 - page 25)</a> ; <a href="https://docs.microsoft.com/en-us/windows/win32/opengl/glortho">(Microsoft- WGL)</a>
</p>

<p>
The orthographic perspective transformation preserves parallel lines
and provides no sense of depth. This type of projection is suitable
for charts, engineering drawing, engineering blueprints, CADs
(Computer Aided Design) views and so on.
</p>

<ul class="org-ul">
<li>Computed with subroutines:
<ul class="org-ul">
<li><span class="underline">glm::ortho</span> (xmin, xmax, ymin, ymax, zNear, zFar)  =&gt; GLM math library</li>
<li><span class="underline">glm::ortho</span> (left, right, bottom, top, near, far)</li>
<li>glOrtho(left, right, bottom, top, near, far) =&gt; Legacy OpenGL</li>
</ul></li>
</ul>


\begin{equation}
   T_{\text{ortho}} =
          \begin{bmatrix}
                  \frac{ 2 }{ x_{max} - x_{min} }
               &  0
               & 0
               & -\frac{ x_{max} + x_{min} }{ x_{max} - x_{min} }
               \\

                  0
               &  \frac{ 2 }{ y_{max} - y_{min} }
               &  0
               &  -\frac{ y_{max} + y_{min} }{ y_{max} - y_{min} }
               \\

                  0
               &  0
               &  - \frac{ 2 }{ z_{far} - z_{near} }
               &  - \frac{ z_{far} + z_{near} }{ z_{far} - z_{near} }
               \\

              0 & 0 & 0 & 1
          \end{bmatrix}
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>\(x_{min}\) (left)</li>
<li>\(x_{max}\) (right)</li>
<li>\(y_{min}\) (bottom)</li>
<li>\(y_{max}\) (top)</li>
<li>\(z_{near}\)  (near) =&gt; Distance from the camera coordinate system to the nearest clipping plane.</li>
<li>\(z_{far}\)  (far)   =&gt; Distance from the camera coordinate system to the farthest clipping plane.</li>
</ul>

<p>
Observations:
</p>
<ul class="org-ul">
<li>The axis Z points the opposite direction to where the camera is looking at.</li>
<li>Any coordinate outside the range (\(x_{min}\), \(x_{max}\)), (\(y_{min}\), \(y_{max}\)) and (\(z_{far}\), \(z_{near}\)) will not be visible.</li>
<li>Those parameters are in the camera's coordinate system.</li>
</ul>


<p>
If a camera looking at the negative direction of Z axi is positioned
at (x = 0, y = 0, z = 0) in world-coordinate origin. The ortographic
projection for OpenGL's canonical view volume is the identity matrix.
</p>

<ul class="org-ul">
<li>\(x_{min} = -1\), \(x_{min} = +1\)</li>
<li>\(y_{min} = -1\), \(z_{min} = +1\)</li>
<li>\(z_{near} = +1\)</li>
<li>\(z_{far} =  -1\)</li>
</ul>

\begin{equation}
   T_{\text{ortho}} =  \text{ortho}(-1, +1, -1, +1, +1, -1)
        \\  =
          \begin{bmatrix}
                  \frac{ 2 }{ (+1) - (-1) }
               &  0
               & 0
               & -\frac{ (+1) + (-1) }{ (+1) - (-1) }
               \\

                  0
               &  \frac{ 2 }{ (+1) - (-1) }
               &  0
               &  -\frac{ (+1) +  (-1) }{ (+1) - (-1) }
               \\

                  0
               &  0
               &  - \frac{ 2 }{ -(-1) + (+1) }
               &  - \frac{ (-1) + (+1) }{ (-1) - (+1) }
               \\

              0 & 0 & 0 & 1
          \end{bmatrix}

    \\ =   \begin{bmatrix}
            1 & 0 & 0 & 0 \\
            0 & 1 & 0 & 0 \\
            0 & 0 & 1 & 0 \\
            0 & 0 & 0 & 1
         \end{bmatrix}
\end{equation}



<p>
<b>Ortographic Projection for 2D drawing</b>
</p>

<p>
The ortographic projection can be used 2D drawing by setting the
coordinate Z of any vertex to zero, \(z_{near} = -1\) and \(z_{far} = +1\).
Then, the ortographic projection becomes:
</p>


\begin{equation}
   T_{\text{ortho2D}} =
          \begin{bmatrix}
                  \frac{ 2 }{ x_{max} - x_{min} }
               &  0
               & 0
               & -\frac{ x_{max} + x_{min} }{ x_{max} - x_{min} }
               \\

                  0
               &  \frac{ 2 }{ y_{max} - y_{min} }
               &  0
               &  -\frac{ y_{max} + y_{min} }{ y_{max} - y_{min} }
               \\

                  0  &  0  &  1 &  0    \\
                  0 & 0 & 0 & 1
          \end{bmatrix}
\end{equation}

<p>
If the transform is applied to any vertex with z = 0, the following
outcome is achieved.
</p>

\begin{equation}
   \begin{bmatrix} x' \\ y' \\ z' \\ 1 \end{bmatrix}

  =

  T_{ortho2D}

   \begin{bmatrix} x \\ y \\ z = 0 \\ w = 1 \end{bmatrix}

  =

   \begin{bmatrix}
        \frac{ 2 }{ x_{max} - x_{min} } \cdot x  -  \frac{ x_{max} + x_{min} }{ x_{max} - x_{min} }  \\
        \frac{ 2 }{ y_{max} - y_{min} } \cdot y  -  \frac{ y_{max} + y_{min} }{ y_{min} - y_{min} }  \\
         0  \\
         1  \\
   \end{bmatrix}
\end{equation}



<p>
<b>Perspective projection matrix</b> (with FOV - Field-of-View)
</p>

<ul class="org-ul">
<li>This matrix is generated by the following subroutines:
<ul class="org-ul">
<li><span class="underline">glm::perspective</span> (FOV, aspect_ratio, zNear, zFar) =&gt; GLM library</li>
<li><span class="underline">glPerspective</span> (FOV, aspect_ratio, zNear, zFar)  =&gt; Old OpenGL.</li>
</ul></li>
</ul>

\begin{equation}
   T_{\text{perspective}} =  \begin{bmatrix}
                 a_{11}&  0     &  0     &  0      \\
                  0    & a_{22} &  0     &  0      \\
                  0    &  0     & a_{33} &  a_{34} \\
                  0    &  0     & -1     &  0      \\
             \end{bmatrix}
\end{equation}

<p>
The matrix elements are:
</p>

\begin{eqnarray*}
   a_{11} &=& 1 / ( k \cdot \tan( \theta / 2 ) )                           \\
   a_{22} &=& 1 / \tan( \theta / 2 )                                              \\
   a_{33} &=& \frac{ \text{zN} + \text{zF} }{ \text{zN} - \text{zF} }             \\
   a_{43} &=& \frac{ 2 \cdot \text{zN} \cdot \text{zF} }{ \text{zN} - \text{zF} } \\
\end{eqnarray*}


<p>
Where:
</p>
<ul class="org-ul">
<li>k - is the window aspect ration, the ratio between the window
width and its height. So:
<ul class="org-ul">
<li>\(k = \text{width} / \text{height}\)</li>
</ul></li>
<li>\(\theta\) - is the FOV (Field-Of-View angle)</li>
<li>\(zN\) (zNear) - Distance to near plane.</li>
<li>\(zF\) (zFar) - Distance to far plane.</li>
<li>Only camera-space coordinates within the range \(zN\) to \(zF\) will
be displayed on the screen. Anything out of this range will be
clipped.</li>
</ul>

<p>
This matrix transform coordinates in the following manner:
</p>

\begin{equation}
   \begin{bmatrix}
       x_{\text{clip}} \\ y_{\text{clip}} \\ z_{\text{clip}} \\ 1
   \end{bmatrix}

   =  T_{\text{projection}} \cdot

   \begin{bmatrix}
       x_{\text{camera}} \\ y_{\text{camera}} \\ z_{\text{camera}} \\ 1
   \end{bmatrix}
\end{equation}

<p>
Where:
</p>

<ul class="org-ul">
<li>The right-side (4 x 1) column vector (input) is the camera-space coordinate.</li>

<li>The left-side (4 x 1) column vector (ouput) is the clip-space
coordinate. Any clip-space (NDC coordinates) coordinate out of the
range -1.0 to 1.0 on each axis will not be displayed on the
screen.</li>
</ul>



<p>
<b>Perspective Projection Matrix</b> (defined from View frustum) - <a href="https://cseweb.ucsd.edu/classes/wi18/cse167-a/lec4.pdf">(CSE167)</a>,
</p>

<p>
The perspective projection matrix provides a sense of depth, objects
that are far from the camera will look like smaller and objects near
the camera will look like smaller. Note: parallel lines are not
preserved by this transform and also this transform is not affine.
</p>


<ul class="org-ul">
<li>This matrix can be computed by using subroutines:
<ul class="org-ul">
<li><span class="underline">glm::frustum</span> (Xmin, Xmax, Ymin, Ymax, Zmin, Zmax)</li>
<li><span class="underline">glm::frustum</span> (left, right, bottom, top, near, far)</li>
</ul></li>
</ul>


\begin{equation}
   T_{\text{perspective}} =
          \begin{bmatrix}
                  \frac{ 2 \cdot z_{near} }{ x_{max} - x_{min} }
               &  0
               & \frac{ x_{max} + x_{min} }{ x_{max} - x_{min} }
               & 0
               \\

                  0
               &  \frac{ 2 \cdot z_{near} }{ y_{max} - y_{min} }
               &  \frac{ y_{max} + y_{min} }{ y_{max} - y_{min} }
               &  0
               \\

                  0
               &  0
               &  - \frac{ z_{far} + z_{near} }{ z_{far} - z_{near} }
               &  - \frac{ z_{far} \cdot z_{near} }{ z_{far} - z_{near} }
               \\

              0 & 0 & -1 & 0
          \end{bmatrix}
\end{equation}

<p>
Aspect ratio and field of view (FOV) angle:
</p>

\begin{eqnarray*}
   \text{aspect ratio} &=& \frac{x_{max} - x_{min}}{ y_{min} - y_{max} }  \\
   \tan( \text{FOV} / 2) &=& \frac{ y_{max} }{ z_{min} }
\end{eqnarray*}

<p>
Where:
</p>

<ul class="org-ul">
<li>\(x_{min}\) =&gt; (left)   - Minimum X coordinate
<ul class="org-ul">
<li>Coordinate for the <span class="underline">left</span> clipping plane.</li>
</ul></li>

<li>\(x_{max}\) =&gt; (right)  - Maximum X coordinate
<ul class="org-ul">
<li>Coordinate for the <span class="underline">right</span> clipping plane.</li>
</ul></li>

<li>\(y_{min}\) =&gt; (bottom) - Minimum Y coordinate
<ul class="org-ul">
<li>Coordinate for the <span class="underline">bottom</span> clipping plane.</li>
</ul></li>

<li>\(y_{max}\) =&gt; (top)    - Maximum Y coordinate
<ul class="org-ul">
<li>Coordinate for the <span class="underline">top</span> clipping plane.</li>
</ul></li>

<li>\(z_{near}\)  =&gt; (near)
<ul class="org-ul">
<li>Minimum Z coordinate - distance to the <span class="underline">near</span> depth clipping
plane. The \(z_{near}\) value should never be zero, in this case,
the \(z_{near}\) value should as close as possible to zero.</li>
</ul></li>

<li>\(z_{far}\)  =&gt; (far)
<ul class="org-ul">
<li>Maximum Z coordinate  - distance to the <span class="underline">far</span> depth clippling plane.</li>
</ul></li>
</ul>

<p>
Notes:
</p>
<ul class="org-ul">
<li>The camera is looking at the opposite direction of Z axis.</li>
<li>Any point in camera-space coordinate outside of the previous range
will not be visible on the screen.</li>
<li>The parameters \(z_{far}\) and \(z_{near}\) must be positive.</li>
</ul>


<p>
<b>Perspective and orthogonal transform matrix formula validation - in Julia Language</b>
</p>

<p>
Running GLM math library in CERN's Root RPL:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">]</span> .I .

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/io.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-function-name">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-1">(</span>5<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Note: GLM matrices are stored in Column-major order</span>
<span class="org-type">void</span> <span class="org-function-name">show_matrix</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">label</span>, <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">m</span><span class="org-rainbow-delimiters-depth-1">){</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"\n [MATRIX] "</span> &lt;&lt; label &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-2">(</span>5<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0; i &lt; 4; i++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">size_t</span> <span class="org-variable-name">j</span> = 0; j &lt; 4; j++<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-4">(</span>10<span class="org-rainbow-delimiters-depth-4">)</span> &lt;&lt; m<span class="org-rainbow-delimiters-depth-4">[</span>j<span class="org-rainbow-delimiters-depth-4">][</span>i<span class="org-rainbow-delimiters-depth-4">]</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">float</span> <span class="org-variable-name">xmin</span>, <span class="org-variable-name">xmax</span>, <span class="org-variable-name">ymin</span>, <span class="org-variable-name">ymax</span>, <span class="org-variable-name">zmin</span>, <span class="org-variable-name">zmax</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- Test Case 1 --------------------------//</span>
<span class="org-comment-delimiter">//</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>58<span class="org-rainbow-delimiters-depth-1">]</span> xmin = 4.0, xmax = 10.0, ymin = 0.1, ymax = 25.0, zmin = 8.0, zmax = 20.0;

root <span class="org-rainbow-delimiters-depth-1">[</span>59<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::mat4 T = <span class="org-constant">glm</span>::frustum<span class="org-rainbow-delimiters-depth-1">(</span>xmin, xmax, ymin, ymax, zmin, zmax<span class="org-rainbow-delimiters-depth-1">)</span>;

root <span class="org-rainbow-delimiters-depth-1">[</span>60<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" T = "</span> &lt;&lt; T &lt;&lt; <span class="org-string">'\n'</span>
 T =
<span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span>    2.667,    0.000,    2.333,    0.000<span class="org-rainbow-delimiters-depth-2">]</span>
 <span class="org-rainbow-delimiters-depth-2">[</span>    0.000,    0.643,    1.008,    0.000<span class="org-rainbow-delimiters-depth-2">]</span>
 <span class="org-rainbow-delimiters-depth-2">[</span>    0.000,    0.000,   -2.333,  -26.667<span class="org-rainbow-delimiters-depth-2">]</span>
 <span class="org-rainbow-delimiters-depth-2">[</span>    0.000,    0.000,   -1.000,    0.000<span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">------- Test Case 2 ------------------------------//</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>93<span class="org-rainbow-delimiters-depth-1">]</span> xmin = -20.0, xmax = 50.0, ymin = -10.0, ymax = 25.0, zmin = 0.1, zmax = 100.0;
root <span class="org-rainbow-delimiters-depth-1">[</span>94<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>94<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::mat4 T = <span class="org-constant">glm</span>::frustum<span class="org-rainbow-delimiters-depth-1">(</span>xmin, xmax, ymin, ymax, zmin, zmax<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat4</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f73c3d5d490
root <span class="org-rainbow-delimiters-depth-1">[</span>95<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>95<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"T"</span>, T<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> T =
   0.00286   0.00000   0.42857   0.00000
   0.00000   0.00571   0.42857   0.00000
   0.00000   0.00000  -1.00200  -0.20020
   0.00000   0.00000  -1.00000   0.00000
root <span class="org-rainbow-delimiters-depth-1">[</span>96<span class="org-rainbow-delimiters-depth-1">]</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">------- Test Case 3 - Ortographics Matrix  -----------//</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>96<span class="org-rainbow-delimiters-depth-1">]</span> xmin = -20.0, xmax = 50.0, ymin = -10.0, ymax = 25.0, zmin = 0.1, zmax = 100.0;
root <span class="org-rainbow-delimiters-depth-1">[</span>97<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>97<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::mat4 T = <span class="org-constant">glm</span>::ortho<span class="org-rainbow-delimiters-depth-1">(</span>xmin, xmax, ymin, ymax, zmin, zmax<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat4</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f73c3d5d4d0
root <span class="org-rainbow-delimiters-depth-1">[</span>98<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>98<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"T"</span>, T<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> T =
   0.02857   0.00000   0.00000  -0.42857
   0.00000   0.05714   0.00000  -0.42857
   0.00000   0.00000  -0.02002  -1.00200
   0.00000   0.00000   0.00000   1.00000

</pre>
</div>

<p>
Test in Julia programming language:
</p>

<div class="org-src-container">
<pre class="src src-julia"> <span class="org-keyword">function</span> <span class="org-function-name">frustum</span>(xmin, xmax, ymin, ymax, zmin, zmax)
      a11 = 2 * zmin / (xmax - xmin)
      a22 = 2 * zmin / (ymax - ymin)
      a13 = (xmax + xmin) / (xmax - xmin)
      a23 = (ymax + ymin) / (ymax - ymin)
      a33 = -(zmax + zmin) / (zmax - zmin)
      a34 = -2 * zmax * zmin / (zmax - zmin)
      T = [ a11 0 a13 0 ; 0 a22 a23 0; 0 0 a33 a34; 0 0 -1 0]
      <span class="org-keyword">return</span> T
  <span class="org-keyword">end</span>

  <span class="org-keyword">function</span> <span class="org-function-name">ortho</span>(xmin, xmax, ymin, ymax, zmin, zmax)
        a11 = 2 / (xmax - xmin)
        a22 = 2 / (ymax - ymin)
        a33 = -2 / (zmax - zmin)
        a14 = -(xmax + xmin ) / (xmax - xmin)
        a24 = -(ymin + ymax) / (ymax - ymin)
        a34 = -(zmax + zmin) / (zmax - zmin)
        T = [ a11 0 0 a14; 0 a22 0 a24 ; 0 0 a33 a34; 0 0 0 1]
        <span class="org-keyword">return</span> T
  <span class="org-keyword">end</span>


 <span class="org-comment-delimiter">## </span><span class="org-comment">--------- Test Case 1 --------------------------##</span>

 julia&gt; xmin = 4.0; xmax = 10.0; ymin = 0.1; ymax = 25.0; zmin = 8.0; zmax = 20.0;

 julia&gt; frustum(xmin, xmax, ymin, ymax, zmin, zmax)
 4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
  2.66667  0.0       2.33333    0.0
  0.0      0.64257   1.00803    0.0
  0.0      0.0      -2.33333  -26.6667
  0.0      0.0      -1.0        0.0

 <span class="org-comment-delimiter">## </span><span class="org-comment">--------- Test Case 2 --------------------------##</span>

julia&gt; xmin = -20.0; xmax = 50.0; ymin = -10.0; ymax = 25.0; zmin = 0.1; zmax = 100.0;

julia&gt; frustum(xmin, xmax, ymin, ymax, zmin, zmax)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 0.00285714  0.0          0.428571   0.0
 0.0         0.00571429   0.428571   0.0
 0.0         0.0         -1.002     -0.2002
 0.0         0.0         -1.0        0.0

<span class="org-comment-delimiter">## </span><span class="org-comment">-------- Test Case 3 - Ortographic Projection ---##</span>

julia&gt; xmin = -20.0; xmax = 50.0; ymin = -10.0; ymax = 25.0; zmin = 0.1; zmax = 100.0;

julia&gt; ortho(xmin, xmax, ymin, ymax, zmin, zmax)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 0.0285714  0.0         0.0      -0.428571
 0.0        0.0571429   0.0      -0.428571
 0.0        0.0        -0.02002  -1.002
 0.0        0.0         0.0       1.0

</pre>
</div>


<p>
<b>References</b>
</p>

<ul class="org-ul">
<li><b>GlFrustum - Khronos Group</b> (Documentation of function glFrustum())
<ul class="org-ul">
<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glFrustum.xml">https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glFrustum.xml</a></li>
</ul></li>

<li><b>Projection and viewing - Computer Graphics - CSE167 - Lecture 4</b> [BEST]
<ul class="org-ul">
<li><a href="https://cseweb.ucsd.edu/classes/wi18/cse167-a/lec4.pdf">https://cseweb.ucsd.edu/classes/wi18/cse167-a/lec4.pdf</a></li>
<li>glFrustum() - perspective transform formula located at page 20.</li>
</ul></li>

<li><b>View Frustum Clipping</b> - University of Texas - CS354 [BEST]
<ul class="org-ul">
<li><a href="https://www.cs.utexas.edu/~fussell/courses/cs354-fall2015/lectures/lecture9.pdf">https://www.cs.utexas.edu/~fussell/courses/cs354-fall2015/lectures/lecture9.pdf</a></li>
<li>glFrustum() - formula located at page</li>
</ul></li>

<li><b>glOrtho - Khronos Grouo</b> (Documentation of function glOrtho())
<ul class="org-ul">
<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glOrtho.xml">https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glOrtho.xml</a></li>
</ul></li>

<li><b>Ortographic Projection</b>
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Orthographic_projection">https://en.wikipedia.org/wiki/Orthographic_projection</a></li>
</ul></li>

<li><b>Computergrafik - Matthias Zwicker Universität Bern - Herbst 2016</b>
<ul class="org-ul">
<li><a href="https://www.cs.umd.edu/~zwicker/courses/computergraphics/03_Projection.pdf">https://www.cs.umd.edu/~zwicker/courses/computergraphics/03_Projection.pdf</a></li>
</ul></li>

<li><b>Matrix4x4.Ortho - Unity 3D engine</b>
<ul class="org-ul">
<li><a href="https://docs.unity3d.com/ScriptReference/Matrix4x4.Ortho.html">https://docs.unity3d.com/ScriptReference/Matrix4x4.Ortho.html</a></li>
</ul></li>

<li><b>Microsoft WGL Docs</b> - glFrustum() [BEST]
<ul class="org-ul">
<li><a href="https://docs.microsoft.com/en-us/windows/win32/opengl/glfrustum">https://docs.microsoft.com/en-us/windows/win32/opengl/glfrustum</a></li>
</ul></li>

<li><b>Microsoft WGL Docs</b> - glOrtho() [BEST]
<ul class="org-ul">
<li><a href="https://docs.microsoft.com/en-us/windows/win32/opengl/glortho">https://docs.microsoft.com/en-us/windows/win32/opengl/glortho</a></li>
</ul></li>

<li><b>CSE - 420 Computer Graphics</b> - California State University [BEST]
<ul class="org-ul">
<li><a href="http://cse.csusb.edu/tongyu/courses/cs420/notes/viewing2.php">http://cse.csusb.edu/tongyu/courses/cs420/notes/viewing2.php</a></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org4849fc1" class="outline-4">
<h4 id="org4849fc1"><span class="section-number-4">1.8.9</span> Concatenating Affine Transforms</h4>
<div class="outline-text-4" id="text-1-8-9">
<p>
<b>Concatenating / Combinating of affine transforms</b>
</p>

<p>
Multiple affine transforms can be combined or concatenated as a single
affine transform, just by multiplying matrices. Considering the
following sequence of 3D affine transforms, such as:
</p>

<ol class="org-ol">
<li>scale(3, 3, 3) - scale by 3 on all axis.</li>
<li>translate(x = 25, y = 10, z = 20) - translate to point (25, 30, 2)</li>
<li>rotX(30) - rotate 30 degrees around X axis</li>
<li>rotZ(54) - rotate by 54 degrees around Z axis.</li>
</ol>

<p>
Let V = [ x y z 1 ]' to be (4 x 1 - 4 rows and 1 column) a column
vector containing the current vertice homogeneous coordinates.
</p>

<p>
Those transforms can be combined in the following way:
</p>

<ul class="org-ul">
<li>Node: the symbol (·) means multiplication.</li>
</ul>

<div class="org-src-container">
<pre class="src src-js"><span class="org-comment-delimiter">// </span><span class="org-comment">Where:</span>
<span class="org-comment-delimiter">//  </span><span class="org-comment">=&gt;  scale(3, 3, 3) is the scaling affine transform matrix.</span>
<span class="org-comment-delimiter">//  </span><span class="org-comment">=&gt;  Va is the vertex coordinate after applying rotZ(54)</span>
<span class="org-comment-delimiter">//</span>
Va = rotZ(54) &#183; V

<span class="org-comment-delimiter">// </span><span class="org-comment">Where:</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">=&gt; translate(25, 10, 20) is the translation affine transfom matrix.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">=&gt; Vb is the result, vertex coodinate after the transform was applied.</span>
Vb = rotX(30) &#183; Va

Vc = translate(25, 10, 20) &#183; Vb
Vd = scale(3, 3, 3) &#183; Vc

<span class="org-comment-delimiter">// </span><span class="org-comment">V' (V - prime) - overall transformation result (end result)</span>
V<span class="org-string">' = Vd</span>
</pre>
</div>

<p>
By performing algebraics substitution, the overall transform result
becomes:
</p>

<div class="org-src-container">
<pre class="src src-text">STEP 1:
 Vb = rotX(30) &#183; Va
 Vb = rotX(30) &#183; ( rotZ(54) &#183; Va )

STEP 2:
  Vc = translate(25, 10, 20) &#183; Vb
  Vc = translate(25, 10, 20) &#183;  ( rotX(30) &#183; ( rotZ(54) &#183; Va ) )

STEP 3:
  Vd = scale(3, 3, 3) &#183; Vc
  Vd = scale(3, 3, 3) &#183; ( translate(25, 10, 20) &#183;  rotX(30) &#183;  rotZ(54) &#183; Va )

STEP 4:  - End result
  V' = Vd
  V' = scale(3, 3, 3) &#183; translate(25, 10, 20) &#183;  rotX(30) &#183;  rotZ(54) &#183; Va 
</pre>
</div>

<p>
The final vertex position can be stated as:
</p>

<div class="org-src-container">
<pre class="src src-text">   V' = scale(3, 3, 3) &#183; translate(25, 10, 20) &#183;  rotX(30) &#183;  rotZ(54) &#183; Va 

OR:

   V' =  [ scale(3, 3, 3) &#183; translate(25, 10, 20) &#183;  rotX(30) &#183;  rotZ(54) ] &#183; V
</pre>
</div>

<p>
All the sequence of transformations can be combined as a single
transform, designated by T, which is the multiplication between all
transforms in reverse order that they were applied. The last transform
is multiplied first and first transform is multiplied last. In the
same that matrix multiplication is not commutative, the operation
result depends on the order that of matrices, transform combinations
are not commutative, they also depends on the order that transforms
were applied.
</p>

<div class="org-src-container">
<pre class="src src-text">V' = T &#183; V

Where:
   T =  scale(3, 3, 3) &#183; translate(25, 10, 20) &#183;  rotX(30) &#183;  rotZ(54)
</pre>
</div>

<p>
Multiple transforms can be combined as:
</p>

<div class="org-src-container">
<pre class="src src-text">Tranform_combined = Transform[1] &#183; Transform[2] &#183; ... &#183; Transform[N-1] &#183; Transform[N]
</pre>
</div>


<p>
<b>Combining 2D canonical transforms in Sympy - Python CAS</b>
</p>

<p>
Sympy - Python CAS (Computer Algebra System) can be used for debugging
and testing affine transforms in a symbolic way.
</p>

<p>
Define 2D canonical affine transforms:
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> sympy <span class="org-keyword">import</span> *

<span class="org-variable-name">x</span>,  <span class="org-variable-name">y</span>  = symbols(<span class="org-string">"x y"</span>)
<span class="org-variable-name">dx</span>, <span class="org-variable-name">dy</span> = symbols(<span class="org-string">"dx dy"</span>)
<span class="org-variable-name">sx</span>, <span class="org-variable-name">sy</span> = symbols(<span class="org-string">"sx sy"</span>)
<span class="org-variable-name">t</span>      = symbols(<span class="org-string">"t"</span>)  <span class="org-comment-delimiter"># </span><span class="org-comment">t represents the rotation angle theta (&#952;)</span>


<span class="org-comment-delimiter"># </span><span class="org-comment">Column vector representing - generic Vertex (aka point) in homogeneous coordinate</span>
<span class="org-comment-delimiter">#</span>
<span class="org-variable-name">v</span> = Matrix([x, y, 1])

&gt;&gt;&gt; pprint(v)
&#9121;x&#9124;
&#9122; &#9125;
&#9122;y&#9125;
&#9122; &#9125;
&#9123;1&#9126;

<span class="org-comment-delimiter"># </span><span class="org-comment">Translation of (dx, dy) coordinate transform</span>
&gt;&gt;&gt; <span class="org-variable-name">Translate</span> = Matrix([[1, 0, dx], [0, 1, dy], [0, 0, 1]])

&gt;&gt;&gt; pprint(Translate)
&#9121;1  0  dx&#9124;
&#9122;        &#9125;
&#9122;0  1  dy&#9125;
&#9122;        &#9125;
&#9123;0  0  1 &#9126;


<span class="org-comment-delimiter"># </span><span class="org-comment">Scale affine transform</span>
&gt;&gt;&gt; <span class="org-variable-name">Scale</span> = Matrix([[sx, 0, 0], [0, sy, 0], [0, 0, 1]])

&gt;&gt;&gt; pprint(Scale)
&#9121;sx  0   0&#9124;
&#9122;         &#9125;
&#9122;0   sy  0&#9125;
&#9122;         &#9125;
&#9123;0   0   1&#9126;


<span class="org-comment-delimiter"># </span><span class="org-comment">Rotation around Z axis</span>
&gt;&gt;&gt; <span class="org-variable-name">RotZ</span>  = Matrix([[ cos(t), -sin(t), 0], [ sin(t), cos(t), 0], [0, 0, 1]])

&gt;&gt;&gt; pprint( RotZ )
&#9121;cos(t)  -sin(t)  0&#9124;
&#9122;                  &#9125;
&#9122;sin(t)  cos(t)   0&#9125;
&#9122;                  &#9125;
&#9123;  0        0     1&#9126;

</pre>
</div>

<p>
Apply single transforms to vertex <b>v</b>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">Apply translation affine transform to vertex V</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">-------------------------------------------</span>
&gt;&gt;&gt; pprint( Translate * v )
&#9121;dx + x&#9124;
&#9122;      &#9125;
&#9122;dy + y&#9125;
&#9122;      &#9125;
&#9123;  1   &#9126;

<span class="org-comment-delimiter"># </span><span class="org-comment">Apply scale to vertex v</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">-------------------------------------------</span>

&gt;&gt;&gt; Scale * v
Matrix([
[sx*x],
[sy*y],
[   1]])

&gt;&gt;&gt; pprint( Scale * v )
&#9121;sx&#8901;x&#9124;
&#9122;    &#9125;
&#9122;sy&#8901;y&#9125;
&#9122;    &#9125;
&#9123; 1  &#9126;

&gt;&gt;&gt; pprint( (Scale * v).subs({sx: 10, sy: 10}) )
&#9121;10&#8901;x&#9124;
&#9122;    &#9125;
&#9122;10&#8901;y&#9125;
&#9122;    &#9125;
&#9123; 1  &#9126;


&gt;&gt;&gt; pprint( (Scale * v).subs({sx: 10, sy: 20}) )
&#9121;10&#8901;x&#9124;
&#9122;    &#9125;
&#9122;20&#8901;y&#9125;
&#9122;    &#9125;
&#9123; 1  &#9126;


<span class="org-comment-delimiter"># </span><span class="org-comment">Apply rotation to vertex v</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">------------------------------</span>

&gt;&gt;&gt; <span class="org-variable-name">v_rot</span> = RotZ * v

&gt;&gt;&gt; pprint( v_rot )
&#9121;x&#8901;cos(t) - y&#8901;sin(t)&#9124;
&#9122;                   &#9125;
&#9122;x&#8901;sin(t) + y&#8901;cos(t)&#9125;
&#9122;                   &#9125;
&#9123;         1         &#9126;

&gt;&gt;&gt; pprint( v_rot.subs(t, 0) )
&#9121;x&#9124;
&#9122; &#9125;
&#9122;y&#9125;
&#9122; &#9125;
&#9123;1&#9126;

<span class="org-comment-delimiter"># </span><span class="org-comment">Rotate by 90 degrees (pi / 2 radians)</span>
&gt;&gt;&gt; pprint( v_rot.subs(t, pi / 2) )
&#9121;-y&#9124;
&#9122;  &#9125;
&#9122;x &#9125;
&#9122;  &#9125;
&#9123;1 &#9126;

<span class="org-comment-delimiter"># </span><span class="org-comment">Rotate by 60 degreees (pi / 3)</span>
&gt;&gt;&gt; pprint( v_rot.subs(t, pi / 3) )
&#9121;x   &#8730;3&#8901;y&#9124;
&#9122;&#9472; - &#9472;&#9472;&#9472;&#9472;&#9125;
&#9122;2    2  &#9125;
&#9122;        &#9125;
&#9122;&#8730;3&#8901;x   y&#9125;
&#9122;&#9472;&#9472;&#9472;&#9472; + &#9472;&#9125;
&#9122; 2     2&#9125;
&#9122;        &#9125;
&#9123;   1    &#9126;
</pre>
</div>

<p>
Combine 2 tranforms in multiple orders and check the outcome.
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter"># </span><span class="org-comment">Combine transforms: 1st - translation; 2nd - scale.</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">--------------------------------------------------</span>

  &gt;&gt;&gt; <span class="org-variable-name">T</span> = Scale * Translate

  &gt;&gt;&gt; pprint(T)
  &#9121;sx  0   dx&#8901;sx&#9124;
  &#9122;             &#9125;
  &#9122;0   sy  dy&#8901;sy&#9125;
  &#9122;             &#9125;
  &#9123;0   0     1  &#9126;


  <span class="org-comment-delimiter"># </span><span class="org-comment">Apply to vertex</span>
  &gt;&gt;&gt; pprint( T * v )
  &#9121;dx&#8901;sx + sx&#8901;x&#9124;
  &#9122;            &#9125;
  &#9122;dy&#8901;sy + sy&#8901;y&#9125;
  &#9122;            &#9125;
  &#9123;     1      &#9126;


<span class="org-comment-delimiter"># </span><span class="org-comment">Combine transforms: 1st - scale; 2nd - translation.</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">--------------------------------------------------</span>

   &gt;&gt;&gt; <span class="org-variable-name">T</span> = Translate * Scale

   &gt;&gt;&gt; pprint( T )
   &#9121;sx  0   dx&#9124;
   &#9122;          &#9125;
   &#9122;0   sy  dy&#9125;
   &#9122;          &#9125;
   &#9123;0   0   1 &#9126;

   <span class="org-comment-delimiter"># </span><span class="org-comment">Apply to vertex</span>
   &gt;&gt;&gt; pprint(T * v)
   &#9121;dx + sx&#8901;x&#9124;
   &#9122;         &#9125;
   &#9122;dy + sy&#8901;y&#9125;
   &#9122;         &#9125;
   &#9123;    1    &#9126;


<span class="org-comment-delimiter"># </span><span class="org-comment">Combine transforms: 1st - rotation; 2nd - translation.</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">--------------------------------------------------</span>

   &gt;&gt;&gt; <span class="org-variable-name">T</span> = Translate * RotZ

   &gt;&gt;&gt; pprint( T )
   &#9121;cos(t)  -sin(t)  dx&#9124;
   &#9122;                   &#9125;
   &#9122;sin(t)  cos(t)   dy&#9125;
   &#9122;                   &#9125;
   &#9123;  0        0     1 &#9126;


   <span class="org-comment-delimiter"># </span><span class="org-comment">Apply to vertex</span>
   &gt;&gt;&gt; pprint( T * v )
   &#9121;dx + x&#8901;cos(t) - y&#8901;sin(t)&#9124;
   &#9122;                        &#9125;
   &#9122;dy + x&#8901;sin(t) + y&#8901;cos(t)&#9125;
   &#9122;                        &#9125;
   &#9123;           1            &#9126;

<span class="org-comment-delimiter"># </span><span class="org-comment">Combine transforms: 1st - translation ; 2nd - rotation</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">------------------------------------------------------</span>

   &gt;&gt;&gt; <span class="org-variable-name">T</span> = RotZ * Translate

   &gt;&gt;&gt; pprint( T )
   &#9121;cos(t)  -sin(t)  dx&#8901;cos(t) - dy&#8901;sin(t)&#9124;
   &#9122;                                      &#9125;
   &#9122;sin(t)  cos(t)   dx&#8901;sin(t) + dy&#8901;cos(t)&#9125;
   &#9122;                                      &#9125;
   &#9123;  0        0               1          &#9126;


   <span class="org-comment-delimiter"># </span><span class="org-comment">Apply to vertex</span>
   &gt;&gt;&gt; pprint( T * v )
   &#9121;dx&#8901;cos(t) - dy&#8901;sin(t) + x&#8901;cos(t) - y&#8901;sin(t)&#9124;
   &#9122;                                           &#9125;
   &#9122;dx&#8901;sin(t) + dy&#8901;cos(t) + x&#8901;sin(t) + y&#8901;cos(t)&#9125;
   &#9122;                                           &#9125;
   &#9123;                     1                     &#9126;


</pre>
</div>

<p>
Combine transforms in the following order: 1st - rotation; 2nd -
scaling; 3rd - translation:
</p>

<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span class="org-variable-name">T</span> = Translate * Scale * RotZ

&gt;&gt;&gt; pprint( T )
&#9121;sx&#8901;cos(t)  -sx&#8901;sin(t)  dx&#9124;
&#9122;                         &#9125;
&#9122;sy&#8901;sin(t)  sy&#8901;cos(t)   dy&#9125;
&#9122;                         &#9125;
&#9123;    0          0       1 &#9126;

&gt;&gt;&gt; pprint( T * v )
&#9121;dx + sx&#8901;x&#8901;cos(t) - sx&#8901;y&#8901;sin(t)&#9124;
&#9122;                              &#9125;
&#9122;dy + sy&#8901;x&#8901;sin(t) + sy&#8901;y&#8901;cos(t)&#9125;
&#9122;                              &#9125;
&#9123;              1               &#9126;
</pre>
</div>
</div>
</div>
<div id="outline-container-org9b417b8" class="outline-4">
<h4 id="org9b417b8"><span class="section-number-4">1.8.10</span> 3D Scene Coordinate Transformations</h4>
<div class="outline-text-4" id="text-1-8-10">
<p>
In a 3D scene, the following typical transformations happens to the
vertex coordinates of some object to be rendered. The model matrix
transform, \(T_m\), converts the object vertex coordinates from the
local-space (a.k.a object-space) to world-space, then the view-matrix,
\(T_v\), converts vertex world-space coordinates to the camera-space,
finally the projection matrix transform, \(T_p\), turns the camera-space
coordinates into clip-space coordinates (NDC - Normalized Device
Coordinates) within the range -1.0 to 1.0 on each axis. Any NDC
coordinate out of the range -1.0 to 1.0 will not be visible on the
canvas, graphics window screen. 
</p>


<div class="org-src-container">
<pre class="src src-tex">             +---------+              +---------+ Space      +---------------+  Clip-Space
 Local       |         |  World       |         |  Camera    |               |  (NDC - Coordinates)
Space        |   Model |  Space       |  View   |  Space     |  Projection   | 
   +-------&gt;&gt;+  Matrix +------&gt;&gt;-----&gt;+ Matrix  +----------&gt;&gt;+   Matrix      +-------&gt;&gt;&gt;
 V           |         |   Vw         |         |   Vc       |               |  Vndc
             | Tm      |              |  Tv     |            |    Tp         |
             +---------+              +---------+            +---------------+


   Tm - (4x4) Model matrix transform 
   Tv - (4x4) View matrix transform 
   Tp - (4x4) Projection matrix transform. 

   V    - Vertex coordinate in local space 
   Vw   - Vertex coordinate in world-space
   Vc   - Vertex coordinate in camera-space coordinate (a.k.a eye-space)
   Vndc - Vertex coordinate in clip-space coordinate (NDC)
</pre>
</div>


<ul class="org-ul">
<li>Transform from local-space coordinates to world-space coordinates
<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>\(T_m\) - is the <span class="underline">model-matrix</span>, often comprised of rotation,
scaling and translation concatened canonical transforms.</li>
<li>v - Vertex coordinate in local-space.
<ul class="org-ul">
<li>\(v = \begin{bmatrix} x & y & z & 1 \end{bmatrix}^T\)</li>
</ul></li>
<li>\(v_w\) - Vertex coordinate in world-space
<ul class="org-ul">
<li>\(v_w = \begin{bmatrix} x_w & y_w & z_w & 1 \end{bmatrix}^T\)</li>
</ul></li>
</ul></li>
</ul></li>
</ul>

\begin{equation} 
   v_w = T_m \cdot v
\end{equation}


<ul class="org-ul">
<li>Transform from world-space coordinates to camera-space coordinates
(a.k.a eye space).
<ul class="org-ul">
<li>\(T_v\) - is the <span class="underline">view matrix</span>, computed using the eye vector,
camera position; up vector - camera orientation; at
point-vector, point which the camera is looking at.</li>
</ul></li>
</ul>

\begin{equation}
  v_c = T_v \cdot v_w 
\end{equation}

<ul class="org-ul">
<li>Transform from camera-space to clip-space coordinates.
<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>\(T_p\) - is the <span class="underline">projection matrix</span> which can be either the
<span class="underline">perspective</span> projection matrix or <span class="underline">ortographic</span> projection
matrix.</li>
<li>\(v_{\text{ndc}}\) - is the vertex NDC coordinate.</li>
</ul></li>
</ul></li>
</ul>

\begin{equation}
  v_{\text{ndc}} = T_p \cdot v_c 
\end{equation}

<ul class="org-ul">
<li>Overall scene transform from local-space to clip-space
coordinates.</li>
</ul>

\begin{equation}
  v_{\text{ndc}} = \left( T_p \cdot T_v \cdot T_m \right) v
\end{equation}


<ul class="org-ul">
<li>MVP transform - The overall transform is often designated as
Model-View-Projection transform ( \(T_{mvp}\) ).</li>
</ul>

\begin{eqnarray*}
   v_{\text{ndc}} &=&  T_{mvp} \cdot v \\
   T_{mvp}        &=&  T_p \cdot T_v \cdot T_m 
\end{eqnarray*}

\begin{equation}
     T_{\text{ModelViewProjection}} =T_{\text{Projection}} \cdot T_{\text{View}} \cdot T_{\text{Model}}
\end{equation}

<ul class="org-ul">
<li>The <span class="underline">Model-View transform</span> is the product between the model and view
transforms.</li>
</ul>

\begin{eqnarray*}
   T_{mv}                    &=& T_v \cdot T_m  \\
   T_{\text{ModelView}} &=& T_{\text{View}} \cdot T_{\text{Model}}
\end{eqnarray*}


<ul class="org-ul">
<li><span class="underline">Normal transform matrix</span> ( \(T_{normal}\) ) is used for illumination
calculations, such as Phong illumination model, and is computed as
the transpose of model-view matrix inverse. This transform maps
vertex <span class="underline">normal</span> vector in the local-space coordinates to
camera-space coordinates, also known as eye-space coordinates.

<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>n - is the normal vector in local-space coordinates.
<ul class="org-ul">
<li>\(n = \begin{bmatrix} x_n & y_n & z_n & 0 \end{bmatrix}^T\)</li>
</ul></li>
<li>\(n_c\) is the normal vector in camera-space (eye-space) coordinates.</li>
</ul></li>
</ul></li>
</ul>

\begin{equation}
   T_{normal} = \left[ T_{\text{ModelView}}^{-1}  \right]^T = \left[ ( T_{\text{View}} \cdot T_{\text{Model}}  )^{-1}  \right]^T
\end{equation} 

\begin{equation}
   T_{normal} =  \left[ ( T_{\text{View}} )^{-1} \right]^T  \cdot  \left[ ( T_{\text{Model}} )^{-1}  \right]^T  
\end{equation} 

\begin{equation}
   n_c = T_{normal} \cdot n 
\end{equation} 

<p>
<b>References</b> 
</p>

<ul class="org-ul">
<li>Chapter 8 - OpenGL – A 3D Graphics API 8.1 - Pipeline architecture
<ul class="org-ul">
<li><a href="https://people.cs.clemson.edu/~dhouse/courses/817/notes/OpenGL-pipeline.pdf">https://people.cs.clemson.edu/~dhouse/courses/817/notes/OpenGL-pipeline.pdf</a></li>
</ul></li>

<li>CS315 Lab 3: 3D Transformations
<ul class="org-ul">
<li><a href="https://www.cs.uregina.ca/Links/class-info/315/WebGL2/Lab3/">https://www.cs.uregina.ca/Links/class-info/315/WebGL2/Lab3/</a></li>
</ul></li>

<li>Appendix F - Homogeneous Coordinates and Transformation Matrices
/ OpenGL Programming Guide
<ul class="org-ul">
<li><a href="https://www.glprogramming.com/red/appendixf.html">https://www.glprogramming.com/red/appendixf.html</a></li>
</ul></li>

<li>GLSL Programming/Vertex Transformations - Wikibooks
<ul class="org-ul">
<li><a href="https://en.wikibooks.org/wiki/GLSL_Programming/Vertex_Transformations">https://en.wikibooks.org/wiki/GLSL_Programming/Vertex_Transformations</a></li>
</ul></li>

<li>OpenGL Normal Vector Transformation - Song ho Ahn
<ul class="org-ul">
<li><a href="http://www.songho.ca/opengl/gl_normaltransform.html">http://www.songho.ca/opengl/gl_normaltransform.html</a></li>
</ul></li>

<li>The normal matrix - Light House 3D
<ul class="org-ul">
<li><a href="https://www.lighthouse3d.com/tutorials/glsl-12-tutorial/the-normal-matrix/">https://www.lighthouse3d.com/tutorials/glsl-12-tutorial/the-normal-matrix/</a></li>
</ul></li>

<li>Normal Vector Transform
<ul class="org-ul">
<li><a href="https://www.cs.upc.edu/~robert/teaching/idi/normalsOpenGL.pdf">https://www.cs.upc.edu/~robert/teaching/idi/normalsOpenGL.pdf</a></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgd404c22" class="outline-4">
<h4 id="orgd404c22"><span class="section-number-4">1.8.11</span> 2D Scene Transforms</h4>
<div class="outline-text-4" id="text-1-8-11">
<p>
A 2D scene can be generated as particular case of a 3D scene by
setting the vertex  Z coordinate to always zero, replacing the view
transform matrix with identity matrix and setting the projection matrix
as the ortographic projection matrix. This approach only works if the
graphics API default coordinate system is the same as the OpenGL one,
where the Y and X axis are on the screen and the Z axis positive
direction goes from the screen towards the viewer (computer user).
</p>

\begin{equation}
  v_{\text{ndc}} = \left( T_p \cdot T_v \cdot T_m \right) v
\end{equation}

<p>
By following the previous approach for a 2D scene, the vertex
transformation becomes: 
</p>

\begin{equation}
  v_{\text{ndc}} = \left( T_{\text{ortographic}} \cdot T_{\text{model}} \right)  
                     \begin{bmatrix} x \\ y \\ 0 \\ 1 \end{bmatrix}
\end{equation}

<p>
The model matrix is a combination of translation affine transforms
with z set as zero, scaling affine transforms with Z set as zero and
rotations around Z axis. 
</p>

<p>
Some matrices that can be used for building the model matrix are: 
</p>

<ul class="org-ul">
<li>2D translation</li>
</ul>

\begin{equation}
   T_{\text{translation-2D}} = 
   \begin{bmatrix}
     1   & 0   &  0 &  \Delta_x \\
     0   & 1   &  0 &  \Delta_y \\
     0   & 0   &  1 &   0       \\
     0   & 0   &  0 &   1       \\
   \end{bmatrix}
\end{equation}

<ul class="org-ul">
<li>2D scaling</li>
</ul>

\begin{equation}
  T_{\text{scaling-2D}} =
   \begin{bmatrix}
     s_x   & 0     &  0   &  0 \\
     0     & s_y   &  0   &  0 \\
     0     & 0     &  0   &  0 \\
     0     & 0     &  0   &  1  \\
   \end{bmatrix}
\end{equation}

<ul class="org-ul">
<li>2D rotation (rotation around Z axis)</li>
</ul>

\begin{equation}
   T_{\text{rotation-2D}} =
     \begin{bmatrix}
        \cos{\theta}  & -\sin{\theta} &  0 & 0 \\
        \sin{\theta}  &  \cos{\theta} &  0 & 0 \\
       0              & 0             &  1 & 0 \\
       0              & 0             &  0 & 1 \\
     \end{bmatrix}
\end{equation}
</div>
</div>

<div id="outline-container-orga708844" class="outline-4">
<h4 id="orga708844"><span class="section-number-4">1.8.12</span> Default Coordinate Systems</h4>
<div class="outline-text-4" id="text-1-8-12">
<p>
In order to properly use a graphics application programming interface,
one must know the default coordinate system and conventions defined by
the graphics API. This convention includes: the coordinate system
origin, which may be on the upper left corner of drawing window or
lower left corner of drawing window; the default direction of axis and
whether the coordinate system is RHS (Right-Handed System) or LHS
(Left-Handed System).
</p>

<p>
<b>OpenGL Default Coordinate System</b>
</p>

<p>
OpenGL API uses a default coordinate system with the origin place at
the screen center, X axis as the horizontal axis, Y axis as the
vertical axis and Z axis going from the screen center towards the
user. This default coordinate system NDC is normalized, each dimension
X, Y and Z has the range from -1.0 to +1.0. Any vertex with any
dimension out of this range is not displayed on the screen.
</p>

<p>
In this coordinate system, the coordinate of points: point A at the OpenGL
window top right corner is (x = 1, y = 1); the coordinate of point B
is (x = 1,y= -1); the coordinate of the point C is (x = -1, y = -1).
</p>


<div class="figure">
<p><a href="images/default-coordinate-system1.png"><img src="images/default-coordinate-system1.png" alt="default-coordinate-system1.png" /></a>
</p>
<p><span class="figure-number">Figure 2: </span>OpenGL default coordinate system (NDC - Normalized Device Coordinate)</p>
</div>


<p>
<b>OpenGL Coordinate System X Math-textbook Coordinate System</b>
</p>

<p>
OpenGL default coordinate system should not be confused with the
coordinate system commonly found in math and physics textbooks, where
Z axis is the vertical axis, Y axis is the horizontal axis and the X
axis is going from the screen twoards the screen observer (out of
screen). The advantage of OpenGL coordinate system over the coordinate
system used by textbooks is that 2D drawing requires just ignoring the
Z axis, setting any Z coordinate to zero. If one does not like the
OpenGL default coordinate system, it is possible to obtain the math
textbook coordinate system just by applying affine rotation transform
the OpenGL default coordinate system.
</p>


<div class="figure">
<p><a href="images/default-coordinate-system2.png"><img src="images/default-coordinate-system2.png" alt="default-coordinate-system2.png" /></a>
</p>
<p><span class="figure-number">Figure 3: </span>OpenGL coordinate system versus math or physics coordinate system.</p>
</div>


<p>
The transform matrix that maps coordinates from the math and physics
style coordinate system (M) to the OpenGL coordinate (C) can be obtained by: 
</p>


\begin{equation}
   T_{M -> C} = \text{Rot}_x(-90) \cdot \text{Rot}_z(-90)  
\end{equation}

\begin{equation}
   T_{M -> C} = 
           \begin{bmatrix}
               1 &  0  & 0 & 0  \\
               0 &  0  & 1 & 0  \\ 
               0 & -1  & 0 & 0  \\
               0 &  0  & 0 & 1 
           \end{bmatrix}

           \begin{bmatrix}
               0 &  1  & 0 & 0  \\
              -1 &  0  & 0 & 0  \\ 
               0 &  0  & 1 & 0  \\
               0 &  0  & 0 & 1 
           \end{bmatrix}
\end{equation}


\begin{equation}
   T_{M -> C} = \begin{bmatrix}
                    0 & 1 & 0 & 0  \\
                    0 & 0 & 1 & 0  \\ 
                    1 & 0 & 0 & 0  \\
                    0 & 0 & 0 & 1 
                \end{bmatrix}
\end{equation}


\begin{equation}
    \underset{ \text{OpenGL Coord.} }{ \begin{bmatrix} x_o \\ y_o \\ z_o \\ 1 \end{bmatrix}  }

    = \begin{bmatrix}
          0 & 1 & 0 & 0  \\
          0 & 0 & 1 & 0  \\ 
          1 & 0 & 0 & 0  \\
          0 & 0 & 0 & 1 
      \end{bmatrix}

   \underset{ \text{Math Coord.} }{ \begin{bmatrix} x_m \\ y_m \\ z_m \\ 1 \end{bmatrix}  }
\end{equation}


<p>
Where: 
</p>

<ul class="org-ul">
<li>\(Rot_x\) - Is the X axis rotation matrix.</li>
<li>\(Rot_z\) - Is the Z axis rotation matrix.</li>
<li>\(T_{M -> C}\) - Is the affine matrix transform that maps
coordinates from math-and-physics coordinate system to OpenGL
coordinate system.</li>
<li>M - designates the coordinate system similar to the
math-and-physics textbooks as in the right side of the previous
picture.</li>
<li>C - designates the openGL coordinate system.</li>
</ul>

<p>
Coordinates from math textbook style coordinate systems can be mapped
to OpenGL by using the previous affine transform matrix.
</p>

\begin{equation} 
   \begin{bmatrix} x_c \\ y_c \\ z_c \\ 1 \end{bmatrix}

     =   T_{M -> C} 
        \begin{bmatrix} x_m \\ y_m \\ z_m \\ 1 \end{bmatrix}
\end{equation}

<p>
With the previous equation it is possible to verify that the Y axis,
vector (0, 1, 0) from the M coordinate system corresponds to the axis
X (1, 0, 0) in the openGL (C) coordinate system. 
</p>

\begin{equation} 
     \begin{bmatrix} 1 \\ 0 \\ 0 \\ 1 \end{bmatrix}
      = 
         \begin{bmatrix}
             0 & 1 & 0 & 0  \\
             0 & 0 & 1 & 0  \\ 
             1 & 0 & 0 & 0  \\
             0 & 0 & 0 & 1 
         \end{bmatrix}    
        \begin{bmatrix} 0 \\ 1 \\ 0 \\ 1 \end{bmatrix}
\end{equation}

<p>
The same procedure can be applied to X axis in (M) coordinate system,
which is mapped to Z axis in OpenGL coordinate system and to Z axis
from (M)  coordinate system which is mapped to Y axis in OpenGL
coordinate system. 
</p>

<p>
<b>Coordinate System positions from other computer graphics APIS</b>
</p>

<p>
The following diagram shows the possible default coordinate systems
positions from many computer graphics APIS:
</p>


<div class="figure">
<p><a href="images/default-coordinate-system3.png"><img src="images/default-coordinate-system3.png" alt="default-coordinate-system3.png" /></a>
</p>
<p><span class="figure-number">Figure 4: </span>Default coordinate systems positions</p>
</div>

<ul class="org-ul">
<li>(C) =&gt; Center of display screen
<ul class="org-ul">
<li>Default position of OpenGL NDC coordinate system (clip-space).</li>
</ul></li>

<li>(B) =&gt; Lower-left corner of display screen
<ul class="org-ul">
<li>Default position of OpenGL screen coordinate system</li>
</ul></li>

<li>(U) =&gt; Upper-left corner of display screen
<ul class="org-ul">
<li>=&gt; The Y axis is inverted, it is positive in the downward
direction instead of upward direction.</li>
<li>Default position of most 2D graphics APIs including: Html5
canvas; SVG; Java AWT 2D.</li>
</ul></li>
</ul>


<p>
Transform matrix, \(T_{B \rightarrow U}\), that maps coordinates from
lower-left corner (B) coordinate system to upper-left-corner
coordinate system.
</p>

\begin{equation}
   T_{B \rightarrow U} =
           \begin{bmatrix}
               1 &  0 & 0  \\
               0 & -1 & h  \\
               0 &  0 & 1
           \end{bmatrix}
\end{equation}

<p>
Transform matrix, \(T_{C \rightarrow U}\), that maps coordinates from
(C) window-center coordinate system to upper-left corner (U)
coordinate system. This transform is useful for drawing with origin on
screen center when using gaphics APIs which the default coordinate
system is located at the upper-left corner.
</p>

\begin{equation}
   T_{C \rightarrow U} =
           \begin{bmatrix}
               1 &  0 & w/2  \\
               0 & -1 & h/2  \\
               0 &  0 & 1
           \end{bmatrix}
\end{equation}

\begin{equation}
   V_U = T_{C \rightarrow U} \cdot V_C
\end{equation}

\begin{equation}
   \begin{bmatrix} x_u \\ y_u \\ 1 \end{bmatrix}
   =
   T_{C \rightarrow U}
   \begin{bmatrix} x_c \\ y_c \\ 1 \end{bmatrix}

   =
   \begin{bmatrix}
        x_c + w/2  \\
       -y_c + h/2  \\
        1
   \end{bmatrix}
\end{equation}

<p>
Transform matrix, \(T_{B \rightarrow C}\), that maps coordinates from
lower-left corner (B) to screen-center origin, OpenGL normalized
coordinate system (C).
</p>

\begin{equation}
   T_{B \rightarrow C} =
           \begin{bmatrix}
               2/w &  0  & -1  \\
               0   & 2/h & -1  \\
               0   &  0  &  1
           \end{bmatrix}
\end{equation}

<p>
The matrix transform, \(T_{C \rightarrow B}\), that maps from coordinate
system C to coordinate system B can be computed as the inverse of
\(T_{B \rightarrow C}\).
</p>

\begin{equation}
   T_{C \rightarrow B} = T_{B \rightarrow C}^{-1}
   =
           \begin{bmatrix}
               w/2 &  0  & w/2  \\
               0   &  h/2 & h/2  \\
               0   &  0  &  1
           \end{bmatrix}
\end{equation}
</div>
</div>

<div id="outline-container-org7b8b8af" class="outline-4">
<h4 id="org7b8b8af"><span class="section-number-4">1.8.13</span> Column-Major X Row-major Matrices</h4>
<div class="outline-text-4" id="text-1-8-13">
<p>
OpenGL ES (embedded version of OpenGL) and WebGL APIs no longer
support matrices in row-major order memory layout, where elements of
rows are contiguous in memory. Instead, those APIs only support
matrices in <span class="underline">column-major</span> memory layout, where elements of columns are
contiguous in memory. 
</p>

<p>
So, in modern OpenGL, the following API no longer works with boolean
value 'true' that indicates that the matrix passed as a argument is in
row-major oder format:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">WebGL API - (NO LONGER POSSIBLE =&gt;&gt; ERROR!) </span>
gl.uniformMatrix4fv<span class="org-rainbow-delimiters-depth-1">(</span>u_model, <span class="org-constant">true</span>, matrix_in_row_major_order<span class="org-rainbow-delimiters-depth-1">)</span>; 

 <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL ES - API (NO LONGER POSSIBLE!!!! =&gt;&gt; ERROR!!!)</span>
 <span class="org-comment-delimiter">// </span><span class="org-comment">Where u_model is a shader uniform variable </span>
 glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-1">(</span>u_model, 1, GL_TRUE,  matrix_in_row_major_order <span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Now, only this following usage works:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">WebGL API </span>
gl.uniformMatrix4fv<span class="org-rainbow-delimiters-depth-1">(</span>u_model, <span class="org-constant">false</span>, matrix_in_column_major_order<span class="org-rainbow-delimiters-depth-1">)</span>; 

 <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL ES - API </span>
 <span class="org-comment-delimiter">// </span><span class="org-comment">Where u_model is a shader uniform variable </span>
 glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-1">(</span>u_model, 1, GL_FALSE,  matrix_in_column_major_order<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>


<p>
Further reading: 
</p>

<ul class="org-ul">
<li><a href="https://en.m.wikipedia.org/wiki/In-place_matrix_transposition">In-place matrix transposition</a></li>

<li><a href="https://en.m.wikipedia.org/wiki/Row-_and_column-major_order">Row- and column-major order - Wikipedia</a></li>

<li><a href="https://fgiesen.wordpress.com/2012/02/12/row-major-vs-column-major-row-vectors-vs-column-vectors/">Row major vs. column major, row vectors vs. column vectors | The ryg blog</a></li>

<li><a href="https://www.scratchapixel.com/lessons/mathematics-physics-for-computer-graphics/geometry/row-major-vs-column-major-vector">Geometry (Row Major vs Column Major Vector)</a></li>

<li><a href="https://www.mathworks.com/help/coder/ug/what-are-column-major-and-row-major-representation-1.html">Matlab - Row-Major and Column-Major Array Layouts</a></li>

<li><a href="https://scicomp.stackexchange.com/questions/4796/row-major-versus-column-major-layout-of-matrices">Row major versus Column major layout of matrices</a></li>

<li><a href="https://seanmiddleditch.github.io/matrices-handedness-pre-and-post-multiplication-row-vs-column-major-and-notations/">Matrices, Handedness, Pre and Post Multiplication, Row vs Column Major, and Notations</a></li>

<li><a href="https://eli.thegreenplace.net/2015/memory-layout-of-multi-dimensional-arrays">Memory layout of multi-dimensional arrays - Eli Bendersky's website</a></li>

<li><a href="https://jblevins.org/log/efficient-code">Writing Efficient Code</a></li>
</ul>


<p>
<b>Row-major matrices</b> 
</p>

<p>
Let the array T of type float[16], containing 16 32 bits floating point
numbers, be a comumn-major matrix represeting some affine transform or
projection transform. 
</p>


<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">T</span>: <span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">[</span>16<span class="org-rainbow-delimiters-depth-1">]</span> = <span class="org-rainbow-delimiters-depth-1">[</span> <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>1<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>2<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>3<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>5<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>6<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>7<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>8<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>9<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>11<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>12<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>13<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>14<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>15<span class="org-rainbow-delimiters-depth-2">]</span> <span class="org-rainbow-delimiters-depth-1">]</span>
</pre>
</div>

<p>
The array T float[16], represents the following matrix in row-major order: 
</p>

<div class="org-src-container">
<pre class="src src-text">     /                           \
     |  T[00] T[01] T[02]  T[03]  |   
     |  T[04] T[05] T[06]  T[07]  | 
 T = |  T[08] T[09] T[10]  T[11]  |
     |  T[12] T[13] T[14]  T[15]  |
     \                            /

     /                             \       
     |  A(1,1) A(1,2) A(1,3) A(1,4) |  
     |  A(2,1) A(2,2) A(2,3) A(2,4) |
 T = |  A(3,1) A(3,2) A(3,3) A(3,4) |
     |  A(4,1) A(4,2) A(4,3) A(4,4) |
     \                             /

It follows that: 

  T[00] = A(1,1) ; T[01] = A(1,2) ; T[02] = A(1,3) ; T[03] = A(1,4)
  T[04] = A(2,1) ; T[05] = A(2,2) ; T[06] = A(2,3) ; T[07] = A(2,4)
  T[08] = A(3,1) ; T[09] = A(3,2) ; T[10] = A(3,3) ; T[11] = A(3,4)
  T[12] = A(4,1) ; T[13] = A(4,2) ; T[14] = A(4,3) ; T[15] = A(4,4)


 T: float[16] = [  A(1,1), A(1,2), A(1,3), A(1,4)
                 , A(2,1), A(2,2), A(2,3), A(2,4)
                 , A(3,1), A(3,2), A(3,3), A(3,4)
                 , A(4,1), A(4,2), A(4,3), A(4,4)
               ];
</pre>
</div>

<p>
<b>Column-major matrices</b> 
</p>

<p>
Let the array T of type float[16], containing 16 32 bits floating point
numbers, be a comumn-major matrix represeting some affine transform or
projection transform. 
</p>


<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">T</span>: <span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">[</span>16<span class="org-rainbow-delimiters-depth-1">]</span> = <span class="org-rainbow-delimiters-depth-1">[</span> <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>1<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>2<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>3<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>5<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>6<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>7<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>8<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>9<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>11<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>12<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>13<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>14<span class="org-rainbow-delimiters-depth-2">]</span>, <span class="org-constant">T</span><span class="org-rainbow-delimiters-depth-2">[</span>15<span class="org-rainbow-delimiters-depth-2">]</span> <span class="org-rainbow-delimiters-depth-1">]</span>
</pre>
</div>

<p>
The array T represents the following column-major matrix: 
</p>

<div class="org-src-container">
<pre class="src src-text">             Matrix in Column-Major Order  
       _                                        _ 
      /                                          \
     +                                            +
T  = | COLUMN[0], COLUMN[1], COLUMN[2], COLUMN[3] |
     +                                            +
      \_                                        _/  

    /                           \
    |  T[00] T[04] T[08]  T[12]  |
    |  T[01] T[05] T[09]  T[13]  |
T = |  T[02] T[06] T[10]  T[14]  |
    |  T[03] T[07] T[11]  T[15]  |
    \                            /

  Where:

                   | T[0] |               | T[4] |              | T[8]  |              | T[12] |
                   | T[1] |               | T[5] |              | T[9]  |              | T[13] |
       COLUMN[0] = | T[2] |   COLUMN[1] = | T[6] |  COLUMN[2] = | T[10] |  COLUMN[3] = | T[14] |
                   | T[3] |               | T[7] |              | T[11] |              | T[15] |

</pre>
</div>

<p>
By applying the previous idea to this matrix, it is possible to find:
</p>

<div class="org-src-container">
<pre class="src src-text">    /                             \       
    |  A(1,1) A(1,2) A(1,3) A(1,4) |  
    |  A(2,1) A(2,2) A(2,3) A(2,4) |
T = |  A(3,1) A(3,2) A(3,3) A(3,4) |
    |  A(4,1) A(4,2) A(4,3) A(4,4) |
    \                             /

T[00] = A(1,1) ; T[01] = A(2,1) ; T[02] = A(3,1) ; T[03] = A(4,1)
T[04] = A(1,2) ; T[05] = A(2,2) ; T[06] = A(3,2) ; T[07] = A(4,2)
T[08] = A(1,3) ; T[09] = A(2,3) ; T[10] = A(3,3) ; T[11] = A(4,3)
T[12] = A(1,4) ; T[13] = A(2,4) ; T[14] = A(3,4) ; T[15] = A(4,4)


T: float[16] = [  A(1,1), A(2,1), A(3,1), A(4,1)
                , A(1,2), A(2,2), A(3,2), A(4,2)
                , A(1,3), A(2,3), A(3,3), A(4,3)
                , A(1,3), A(2,4), A(3,4), A(4,4)
              ];
</pre>
</div>

<p>
<b>Example:</b> Given the translation matrix T 
</p>

<div class="org-src-container">
<pre class="src src-text">     | 1  0  0  tx |
     | 0  1  0  ty |
 T = | 0  0  1  tz |
     | 0  0  0   1 |

 T[00] = A(1,1) = 1 ; T[01] = A(2,1) = 0 ; T[02] = A(3,1) = 0 ; T[03] = A(4,1) = 0 (column 1)
 T[04] = A(1,2) = 0 ; T[05] = A(2,2) = 1 ; T[06] = A(3,2) = 0 ; T[07] = A(4,2) = 0 (column 2)
 T[08] = A(1,3) = 0 ; T[09] = A(2,3) = 0 ; T[10] = A(3,3) = 1 ; T[11] = A(4,3) = 0 (column 3)
 T[12] = A(1,4) = tx; T[13] = A(2,4) = ty; T[14] = A(3,4) = tz; T[15] = A(4,4) = 1 (column 4)

Hence, 

 T: float[16] = {  1,  0,  0,  0
                 , 0,  1,  0,  0
                 , 0,  0,  1,  0
                 , tx, ty, tz, 1 }; 

 T: float[16] = { 1,  0,  0,  0, 0,  1,  0,  0, 0,  0,  1,  0, tx, ty, tz, 1 }

 gl.uniformMatrix4fv(u_model, flase, T);
</pre>
</div>

<p>
This matrix in column-major order is represented as:
</p>

<div class="org-src-container">
<pre class="src src-text">                                | 1   0   0  0 |
                                | 0   1   0  0 |
T             =  TRANSPOSE(T) = | 0   0   1  0 |
 column-major                   | tx ty  tz  1 |
</pre>
</div>
</div>
</div>


<div id="outline-container-org2b87f66" class="outline-4">
<h4 id="org2b87f66"><span class="section-number-4">1.8.14</span> Quaternions</h4>
<div class="outline-text-4" id="text-1-8-14">
<p>
Quaternions are a generalization of complex numbers, that was proposed
and formulated by the irish mathematician and physicist William Rowan
<a href="https://en.wikipedia.org/wiki/William_Rowan_Hamilton">Hamilton</a>, in 1843. This mathematical construct provides a convenient
notation for expressing rotation and has a broad range of
applications, including computer graphics, computer vision, robotics,
orbital mechanics, aerospace and flight dynamics.
</p>

<p>
A quaternion <b>q</b> is defined as:
</p>

\begin{equation}
   q = w + x \cdot i + y \cdot j + z \cdot k
\end{equation}

<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>w, x, y, z are real numbers.</li>
<li>w =&gt; is the quaternion's real (scalar) component.</li>
<li>[x, y, z] =&gt; is the quaternion's vector componet</li>
<li>i, j, k are unit vectors (basis elements) that satisfies a set
of properties.</li>
</ul></li>
</ul>

<p>
The quaternion <b>q</b> can be represented in the following manner:
</p>

\begin{align*}
    q &= [w, x, y, z]  \quad & \text{Tuple representation}         \\
    q &= (u, \vec{v})  \quad & \text{Scalar/vector representation} \\
\end{align*}

<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>\(\vec{v} = [x, y, z]\) is the quaternion vector component.</li>
</ul></li>
</ul>

<p>
The quaternion unit vectors or basis elements satifies the following
properties:
</p>

\begin{equation}
   i^2 = j^2 = k^2 = i \cdot j \cdot k = -1
\end{equation}

<p>
And also:
</p>

\begin{align*}
    i \cdot j = k  & \quad & j \cdot i = -k  \\
    j \cdot k = i  & \quad & k \cdot j = -i  \\
    k \cdot i = j  & \quad & i \cdot k = -j  \\
\end{align*}


<p>
<b>Types of Quaternion</b>
</p>

<ul class="org-ul">
<li>Real quaternion</li>
</ul>

<p>
Real quaternion, is a quaterion which all elements of vector
components are zero.
</p>

\begin{equation}
   q = w + 0 \cdot i + 0 \cdot j + 0 \cdot k
\end{equation}

<ul class="org-ul">
<li>Pure quaternion</li>
</ul>

<p>
A pure quaternion, has the real part equal to zero. It can represent a
vector in the space.
</p>

\begin{equation}
  q = 0 + x \cdot i + y \cdot j + z \cdot k
\end{equation}

<ul class="org-ul">
<li>Unit quaternion</li>
</ul>

<p>
A quaternion which the norm or magnitude is equal to one.
</p>

\begin{equation}
  || q || = 1
\end{equation}

<ul class="org-ul">
<li>Identity quaternion</li>
</ul>

<p>
An identity quaternion when multiplied by another quaternion results
in no rotation.
</p>

\begin{equation}
   q_i = 1 + 0 \cdot i + 0 \cdot j + 0 \cdot k
\end{equation}

<p>
In similar way to identity matrices, the following is valid:
</p>

\begin{equation}
  q_i \cdot q_a = q_a \cdot q_i = q_a
\end{equation}

<p>
<b>Quaternion Conjugate</b>
</p>

<p>
The conjugate of a quaternion, \(q^*\), is defined as:
</p>

\begin{equation}
  q^{*} = w - \vec{v}
        = w - (x \cdot i + y \cdot j + z \cdot k)
        = w + (-x) i + (-y) j + (-z) k
\end{equation}

<p>
<b>Inverse Quaternion</b> \(q^{-1}\)
</p>

\begin{equation}
  q^{-1} = \frac{q^{*}}{ || q ||^2 }
\end{equation}

<p>
The inverse quaternion satifies the following equality:
</p>

\begin{equation}
  q^{-1} \cdot q = q \cdot q^{-1} = 1
\end{equation}

<p>
<b>Quaternion Norm</b>
</p>

<p>
The norm (magnitude) of a quaternion is given by:
</p>

\begin{equation}
   || q ||^2 = q \cdot q^{*} =  w^2 + x^2 + y^2 + z^2
\end{equation}

<p>
<b>Unit quaternion</b>
</p>

<p>
An unit quaternion \(q_u\) has norm equal to one.
</p>

\begin{equation}
   || q_u || = 1
\end{equation}

<p>
An unit quaternion is equal to its conjugate:
</p>

\begin{equation}
   q^* = q^{-1}
\end{equation}

<p>
<b>Quaternion Dot Product</b>
</p>

<p>
A quaternion dot product is similar to vector dot product. The
quaternion dot product between two quaternions q1 and q2 is defined as
the sum of the product between the quaternions components.
</p>

\begin{equation}
   \text{dotquat}(q_1, q_2) = q_1 \cdot q_2 = w_1 \cdot w_2 + x_1 \cdot x_2 + y_1 \cdot y_2 + z_1 \cdot z_2
\end{equation}

<p>
<b>Angle between two quaternion</b>
</p>

<p>
The angle between two quaternions q1 and q2 is defined as:
</p>

\begin{equation}
    \cos \theta = \frac{ q_1 \cdot q_2 }{ || q_1 || \cdot || q_2 ||  }
                = \frac{ \text{dotquat}(q_1, q_2) }{ \text{norm}( q_1) \cdot \text{norm}(q_2)  }
                = \frac{  w_1 \cdot w_2 + x_1 \cdot x_2 + y_1 \cdot y_2 + z_1 \cdot z_2  }{  || q_1 || \cdot || q_2 ||  }
\end{equation}

<p>
<b>Quaternion Sum</b>
</p>

<p>
The sum of two quaternions q1 and q2 is:
</p>

\begin{equation}
   q_1 + q_2 = (w_1 + w_2) + (x_1 + x_2) i + (y_1 + y_2)j + (z_1 + z_2) k
\end{equation}

<p>
<b>Quaternion Product</b> (a.k.a Hamilton Product)
</p>

<p>
The product <b>p</b> of two quaternons q1 and q2 can be computed as:
</p>

<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>p is the quaternion product between q1 and q2</li>
<li>\(\vec{v_1} \cdot \vec{v_2}\) is the scalar product between \(\vec{v_1}\) and \(\vec{v_2}\).</li>
<li>\(\vec{v1} \times \vec{v_2}\) is the cross product between  \(\vec{v_1}\) and \(\vec{v_2}\).</li>
<li>\(p_v\) is the vector component of p</li>
<li>\(p_w\) is the scalar/real component of p.</li>
</ul></li>
</ul>

\begin{align*}
  p &= q_1 \cdot q_2 = ( w_1 \cdot w_2 - \vec{v_1} \cdot \vec{v_2} \quad ; \quad
                       w_1 \cdot \vec{v_2} + w_2 \cdot \vec{v_1} + \vec{v1} \times \vec{v_2} )  \\

    &= ( w_1 \cdot w_2 - \vec{v_1} \cdot \vec{v_2} )  +
                      ( w_1 \cdot \vec{v_2} + w_2 \cdot \vec{v_1} + \vec{v1} \times \vec{v_2} )
\end{align*}

<p>
The components of vector p are:
</p>

\begin{align*}
    p_w &= w_1 \cdot w_2 - \vec{v_1} \cdot \vec{v_2}                             \\
    p_v &= w_1 \cdot \vec{v_2} + w_2 \cdot \vec{v_1} + \vec{v1} \times \vec{v_2} \\
\end{align*}

<p>
The quaternion product is non commuative, as a result, the following
holds:
</p>

\begin{equation}
      q_1 \cdot q_2 \neq q_2 \cdot q_2
\end{equation}

<p>
The quaternion product satifies the following properties:
</p>

\begin{align*}
    || q_1 \cdot q_2 ||  &= ||q_1|| \cdot || q_2 ||   \\
     (q_1 \cdot q_2)^* &= q_2^* \cdot q_1^*
\end{align*}

<p>
<b>Quaternion product between pure quaternions</b>
</p>

<p>
The product between two pure quaternions yields the dot product and
cross simultaneously, the dot product as the real part of the
operation result and cross product as the vector part of the result.
</p>

\begin{equation}
    p \cdot q = - (p \cdot q) + (p \times q)
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>Note: A pure quaternion, is the same as space vector, the real
part is zero, w = 0.</li>
<li>\(p = 0 + x_p \cdot i + y_p \cdot j + z_p \cdot k\)</li>
<li>\(q = 0 + x_q \cdot i + y_q \cdot j + z_q \cdot k\)</li>
<li>\(p \cdot q\) is the dot product between the vector parts of p and q.</li>
<li>\(p \times q\) is the cross product (vector product) between p and q.</li>
</ul>


<p>
<b>Quaternion division</b> (<a href="http://www.math.umd.edu/~immortal/MATH431/lecturenotes/ch_quaternions.pdf">MATH432</a> - page 11)
</p>

<p>
The division between two quaternions q1 and q2 is defined as:
</p>

\begin{equation}
   \frac{q_1}{q_2} = \frac{q_1 \cdot q_2^* }{ || q_2 ||^2 } = \frac{1}{ || q_2 ||^2 } ( q_1 \cdot q_2^* )
\end{equation}

<p>
<b>Quaternion product using matrices representation</b>
</p>

<p>
The product of two quaternions q1 and q2 can be computed
in a more convenient and faster way by using matrices and column
vectors multiplication, instead of dot product and cross product.
</p>

<p>
Let \([q]_v\) be the vector column representation of a quaternion:
</p>

\begin{equation}
  [q]_v = \begin{bmatrix} w \\ x \\ y \\ z  \end{bmatrix}
\end{equation}

<p>
Let \([q]_m\) be the following matrix representation of a quaternion:
</p>

\begin{equation}
  [q]_m = \begin{bmatrix}
               w  & -x & -y & -z  \\
               x  &  w & -z &  y  \\
               y  &  z &  w & -x  \\
               z  & -y &  x &  w  \\
          \end{bmatrix}
\end{equation}

<p>
The quaternion product between q1 and q2, designated by \([q_r]_v\), can
be expressed as a matrix-column vector multiplication, which is best
suitable for a computer implementation.
</p>

\begin{equation}
  [q_r]_v = q_1 \cdot q_2 = [q_1]_m \cdot [q_2]_v
          =
          \begin{bmatrix}
               w_1  & -x_1 & -y_1 & -z_1  \\
               x_1  &  w_1 & -z_1 &  y_1  \\
               y_1  &  z_1 &  w_1 & -x_1  \\
               z_1  & -y_1 &  x_1 &  w_1  \\
          \end{bmatrix}

          \begin{bmatrix}
              w_2 \\ x_2 \\ y_2 \\ z_2 \\
          \end{bmatrix}
\end{equation}

<p>
By performing the previous matrix multiplication, the quaternion
product becomes:
</p>

\begin{equation}
     [q_r]_v = q_1 \cdot q_2 =
       \begin{bmatrix}
            w_1 \cdot w_2 - x_1 \cdot x_2 - y_1 \cdot y_2 - z_1 \cdot z_2  \\
            x_1 \cdot w_2 + w_1 \cdot x_2 - z_1 \cdot y_2 + y_1 \cdot z_2  \\
            y_1 \cdot w_2 + z_1 \cdot x_2 + w_1 \cdot y_2 - x_1 \cdot z_2  \\
            z_1 \cdot w_2 - y_1 \cdot x_2 + x_1 \cdot y_2 + w_1 \cdot z_2  \\
       \end{bmatrix}
\end{equation}


<p>
<b>Rotation Quaternion</b>
</p>

<p>
A rotation around an axis \(\hat{n}\) (unit vector) by angle \(\theta\)
can be encoded by quaternion \(q_r\):
</p>

\begin{equation}
   q_r = \cos \frac{\theta}{2}  + \sin \frac{\theta}{2} \cdot \hat{n}
       = \cos \frac{\theta}{2}  + \sin \frac{\theta}{2} ( x_n \cdot i + y_n \cdot j + z_n \cdot k  )
\end{equation}

<ul class="org-ul">
<li>Where:
<ul class="org-ul">
<li>\(\hat{n}\) is a unit vector.</li>
<li>\(\hat{n} = x_n \cdot i + y_n \cdot j + z_n \cdot k\)</li>
<li>\(|| \hat{n} || = 1\)</li>
</ul></li>
</ul>

<p>
The norm of quaternion \(q_r = 1\), thus the following holds:
</p>

\begin{equation}
  || q_r || = 1
\end{equation}

<p>
The coordinate transformation from a vector in reference frame A to a
reference frame B, obtained by the rotation of coordinate frame A
around a unit vector \(\hat{n}\) can be computed as:
</p>

\begin{equation}
   q_B = q_r \cdot q_A \cdot q_r^{-1}
       = q_r \cdot q_A \cdot q_r^{*}
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>\(q_A\) is the coordinate of a vector in the reference frame A (aka
coordinate system, aka coordinate frame).</li>
<li>\(q_B\) is the coordinate of a the same vector in the reference frame B.</li>
<li>\(q_A = 0 + x_A \cdot i + y_A \cdot j + z_A \cdot k\)</li>
<li>\(q_B = 0 + x_B \cdot i + y_B \cdot j + z_B \cdot k\)</li>
</ul>


<p>
The previous rotation coordinate transformation can be determined in a
more efficient way by applying the following algorithm. <a href="https://fgiesen.wordpress.com/2019/02/09/rotating-a-single-vector-using-a-quaternion/">(The-Ryg-Blog)</a>
</p>


\begin{eqnarray*}
   v_t &=& 2 ( v_r \times v_a)                    \\
   q_B &=&  v_A + w_r \cdot v_t + v_r \times v_t
\end{eqnarray*}

<p>
Where:
</p>
<ul class="org-ul">
<li>\([ Q ]_w\) - real part of a quaternion Q</li>
<li>\([ Q ]_v\) - vector part of a quaterion Q</li>
<li>\(w_r = \cos ( \theta / 2)\) - real part of rotation quaternion \(q_r\)</li>
<li>\(v_r = \hat{n} \cdot \sin( \theta / 2 )\) - vector part of rotation quaternion \(q_r\)</li>
<li>\(v_B\) - vector part of quaternion \(q_B\)</li>
<li>\(v_A\) - Vector part of quaternion \(q_A\)</li>
<li>\(v_r \times v_a\) - Cross product between those two vectors.</li>
</ul>


<p>
<b>Determining rotation and axis from a normalized quaternion</b>
</p>

<p>
Supposing that the components (w, x, y, z) of normalized quaternion <b>q</b>
are known. The represented rotation angle, \(\theta\) and rotation axis
(a.k.a orientation) vector, \(\hat{n} = [x_n \quad y_n \quad z_n]\), can
be determined in the following way.
</p>

<p>
Rotation quaternion (known: x, y, z, w)
</p>

\begin{eqnarray*}
  q  &=& w + x \cdot i + y \cdot j + z \cdot k  \\
     &=& \cos \frac{\theta}{2} + \sin \frac{\theta}{2}  \hat{n} \\
     &=& \cos \frac{\theta}{2} + \sin \frac{\theta}{2} (x_n \cdot i + y_n \cdot j + z_n \cdot k) \\
\end{eqnarray*}

<p>
Rotation angle \(\theta\)
</p>

\begin{equation}
  \theta  = 2 \text{atan2}( || \vec{v} ||, w  ) = 2 \text{atan2}( \sqrt{x^2 + y^2 + z^2} , w  )
\end{equation}

<p>
Rotation axis: \(\hat{n} = x_n \cdot i + y_n \cdot j + z_n \cdot k\)
</p>

\begin{eqnarray*}
   x_n &=& x / \sqrt{1 - w^2} \\
   y_n &=& y / \sqrt{1 - w^2} \\
   z_n &=& z / \sqrt{1 - w^2} \\
\end{eqnarray*}

<p>
Where:
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Atan2">Atan2</a>(Y, X) is the 2-argument tangent function which determines
the angle quadrant.</li>

<li>\(q = w + x \cdot i + y \cdot j + z \cdot k\) - is a unitary
quaternion, which components x, y and z are assumed to be
known. The quaternion <b>q</b> is presumed to be normalized.</li>

<li>\(\theta\) is the rotation angle. Assumed to be unknown.</li>

<li>\(\hat{n}\) - is the rotation axis vector. Also assumed to be
unknown, which components are \(x_n\), \(y_n\) and \(z_n\).
<ul class="org-ul">
<li>\(\hat{n} = 0 + x_n \cdot i + y_n + \cdot j + z_n \cdot k\)</li>
</ul></li>
</ul>



<p>
<b>Quaternion to rotation matrix conversion</b>
</p>

<p>
The rotation matrix that transforms coordinates from reference frame A
to reference frame B can be computed as:  <a href="https://www.weizmann.ac.il/sci-tea/benari/sites/sci-tea.benari/files/uploads/softwareAndLearningMaterials/quaternion-tutorial-2-0-1.pdf">(Moti Ben-Ari - Wizmann)</a>, <a href="http://barbic.usc.edu/cs520-s12/quaternions/quaternions-cs520.pdf">(Jernej Barbic)</a>
</p>

\begin{equation}
   R_n = \begin{bmatrix}

             a^2 + b^2 - c^2 - d^2
          &  2 (b \cdot c -  a \cdot d)
          &  2 (b \cdot d +  a \cdot c)  \\

             2 (b \cdot c +  a \cdot d )
          &  a^2 - b^2 + c^2 -d^2
          &  2 ( c \cdot d -  a \cdot b ) \\

             2 ( b \cdot d -  a \cdot c  )
          &  2 ( c \cdot d +  a \cdot b )
          &  a^2 - b^2 - c^2 + d^2     \\

         \end{bmatrix}
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>a, b, c, d are the components of the unit quaternion \(q_r\)</li>
<li>\(a = \cos( \theta / 2)\)</li>
<li>\(b = x_n \cdot \sin (\theta / 2)\)</li>
<li>\(c = y_n \cdot \sin (\theta / 2)\)</li>
<li>\(d = z_n \cdot \sin (\theta / 2)\)</li>
</ul>

<p>
The matrix \(R_n\) can also be simplified to: <a href="https://www.weizmann.ac.il/sci-tea/benari/sites/sci-tea.benari/files/uploads/softwareAndLearningMaterials/quaternion-tutorial-2-0-1.pdf">(Moti Ben-Ari - Wizmann)</a>
</p>

\begin{equation}
   R_n = 2 \begin{bmatrix}
              a^2 + b^2 - 1/2  &
              b \cdot c - a \cdot d  &
              a \cdot c + b \cdot d  \\

              a \cdot d + b \cdot c  &
              a^2  + c^2 - 1/2 &
              c \cdot d - a \cdot b  \\

              b \cdot d - a \cdot c &
              a \cdot b + c \cdot d &
              a^2 + d^2 - 1/2 \\

          \end{bmatrix}
\end{equation}

<p>
Coordinates from frame A can be turned into coordinates from frame B
by performing the following  matrix multiplication.
</p>

\begin{equation}
    \begin{bmatrix} x_B \\ y_B \\ z_B \end{bmatrix}
    = R_n  \begin{bmatrix} x_A \\ y_A \\ z_A \end{bmatrix}
\end{equation}


<p>
From the previous matrix \(R_n\) it is possible to determine the
yaw-pitch-roll (Z-X-Y) Euler's angles. <a href="http://www.chrobotics.com/library/understanding-quaternions">(chrobotics)</a>
</p>

\begin{eqnarray*}
    \phi   &=&  \arctan\left( \frac{ 2 a \cdot b + 2 c \cdot d } { a^2 - b^2 - c^2 + d^2 } \right )  \\
    \theta &=& -\arcsin\left( 2 b \cdot d - 2 a \cdot c  \right )                                    \\
    \psi   &=&  \arctan\left( \frac{ 2 a \cdot d + 2 b \cdot c}{ a^2 + b^2 - c^2 - d^2 } \right )    \\
\end{eqnarray*}

<p>
Where:
</p>
<ul class="org-ul">
<li>\(\phi\)   - is the yaw angle</li>
<li>\(\theta\) - is the pitch angle</li>
<li>\(\psi\)   -is the roll angle</li>
</ul>


<p>
<b>Quaternion to homogeneous coordinate rotation matrix</b>
</p>

<p>
The matrix \(R_n\) can be converted to a homogenous coordinate form,
\(T_n\), which is more convenient, since homogenous coordinate allows
expressing translations in a similar fashion to rotation
transformations, just as vector-matrix multiplication.
</p>


\begin{equation}
   T_n = \begin{bmatrix}

             a^2 + b^2 - c^2 - d^2
          &  2 (b \cdot c -  a \cdot d)
          &  2 (b \cdot d +  a \cdot c)
          &  0                            \\

             2 (b \cdot c +  a \cdot d )
          &  a^2 - b^2 + c^2 -d^2
          &  2 ( c \cdot d -  a \cdot b )
          &  0                            \\

             2 ( b \cdot d -  a \cdot c  )
          &  2 ( c \cdot d +  a \cdot b )
          &  a^2 - b^2 - c^2 + d^2
          &  0                            \\

             0 & 0 & 0 & 1 \\
         \end{bmatrix}
\end{equation}

<p>
Homogeneous coordinates from frame A can be turned into coordinates of
frame B by using the following expression:
</p>

\begin{equation}
    \begin{bmatrix} x_B \\ y_B \\ z_B \\ 1 \end{bmatrix}
    = T_n  \begin{bmatrix} x_A \\ y_A \\ z_A \\ 1 \end{bmatrix}
\end{equation}


<p>
<b>Table with Useful Normalized Quaternions (Rotation Quaternions)</b> - <a href="http://wiki.ogre3d.org/Quaternion+and+Rotation+Primer">(Ogre3D Game Engine)</a>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">w</th>
<th scope="col" class="org-right">x</th>
<th scope="col" class="org-right">y</th>
<th scope="col" class="org-right">z</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Identity quaternion, represents no rotation.</td>
</tr>

<tr>
<td class="org-left">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">180°  (π radians) rotation around X axis</td>
</tr>

<tr>
<td class="org-left">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">180° rotation around Y axis</td>
</tr>

<tr>
<td class="org-left">0</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">180° rotation around Z axis.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">\(\sqrt{1/2}\)</td>
<td class="org-right">\(\sqrt{1/2}\)</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">90° rotation around X axis.</td>
</tr>

<tr>
<td class="org-left">\(\sqrt{1/2}\)</td>
<td class="org-right">0</td>
<td class="org-right">\(\sqrt{1/2}\)</td>
<td class="org-right">0</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">90° rotation around Y axis.</td>
</tr>

<tr>
<td class="org-left">\(\sqrt{1/2}\)</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">\(\sqrt{1/2}\)</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">90° rotation around Z axis.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">\(\sqrt{1/2}\)</td>
<td class="org-right">\(-\sqrt{1/2}\)</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">-90° rotation around X axis.</td>
</tr>

<tr>
<td class="org-left">\(\sqrt{1/2}\)</td>
<td class="org-right">0</td>
<td class="org-right">\(-\sqrt{1/2}\)</td>
<td class="org-right">0</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">-90° rotation around Y axis.</td>
</tr>

<tr>
<td class="org-left">\(\sqrt{1/2}\)</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">\(-\sqrt{1/2}\)</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">-90° rotation around Z axis.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Note:
</p>
<ul class="org-ul">
<li>\(\sqrt{1/2} = \sqrt{0.5} \approx 0.70710\)</li>
<li>\(\pi = pi = \approx 3.14159265\)</li>
</ul>


<p>
<b>Further Reading</b>
</p>


<p>
Quaternions:
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/Quaternion">Quaternions</a> - Wikipedia</li>

<li><a href="https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation">Quaternions and spatial rotation</a></li>

<li><a href="https://en.wikipedia.org/wiki/History_of_quaternions">History of Quaternions</a></li>

<li><a href="https://arxiv.org/pdf/2009.00425.pdf">An algorithm for dividing quaternions</a> [PAPER]</li>

<li><a href="https://web.archive.org/web/20200211220142/http://www.chrobotics.com/library/understanding-quaternions">Understanding Quaternions</a>  - ChRobotics</li>

<li><a href="http://www.chrobotics.com/library/understanding-quaternions">Understanding Euler Angles</a> - ChRobotics</li>

<li><a href="https://www.energid.com/resources/orientation-calculator">Quaternion Calculator</a> - Energid / Actin Advanced Control For Robotics
<ul class="org-ul">
<li>Note: Online calculator for Quaternions.</li>
</ul></li>

<li><a href="https://www.weizmann.ac.il/sci-tea/benari/sites/sci-tea.benari/files/uploads/softwareAndLearningMaterials/quaternion-tutorial-2-0-1.pdf">A Tutorial on Euler Angles and Quaternions</a> - Weizmann Institute of Science</li>

<li><a href="http://wiki.ogre3d.org/Quaternion+and+Rotation+Primer">Quaternion Rotation Primer / Ogre3D Game Engine</a></li>

<li><a href="https://web.cs.ucdavis.edu/~amenta/3dphoto/quaternion.pdf">https://web.cs.ucdavis.edu/~amenta/3dphoto/quaternion.pdf</a></li>

<li><a href="https://www.mathworks.com/help/aerotbx/ug/quatinterp.html">quatinterp() - Quaternion interpolation between two quaternions</a> - Matlab Aerospace Toolbox</li>

<li><a href="https://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/index.htm">Maths - Quaternion Interpolation (SLERP)</a> - Euclidianspace.com</li>

<li><a href="https://www.3dgep.com/understanding-quaternions/">Understanding Quaternions</a> - 3DGEP - 3D Game Engine Programming</li>

<li><a href="http://www2.cs.uregina.ca/~anima/408/Notes/Quaternions/Quaternions.htm">Quaternion - in computer animation</a></li>

<li><a href="https://theory.org/software/qfa/writeup/node12.html">Quaternion interpolation</a></li>

<li>[PDF] <a href="http://web.archive.org/web/20130116192343/https://www.crytek.com/download/izfrey_siggraph2011.pdf">Spherical Skinning withDual-Quaternions and QTangents</a>  - Spherical
Skinning withDual-Quaternions and QTangentsIvo Zoltan FreyCrytek
R&amp;D</li>

<li>[PDF] <a href="https://web.archive.org/web/20210506185442/https://www.cs.utexas.edu/~fussell/courses/cs384g-spring2016/lectures/7a-Quaternions_Orientation.pdf">Orientation &amp; Quaternions - University of Texas</a></li>

<li>[PDF] <a href="https://atcm.mathandtech.org/EP/2002/ATCMA107/fullpaper.pdf">Quaternions: From Classical Mechanics to Computer Graphics, and Beyond</a></li>

<li>[PDF] <a href="http://www.space.bas.bg/Aerospace_research/arhiv/n%2028/Articles/8.pdf">QUATERNION-BASED AUTOPILOT FOR DODECACOPTERS - PART I</a></li>

<li>[PDF] <a href="https://web.archive.org/web/20210508223059/https://www.tu-berlin.de/fileadmin/fg169/miscellaneous/Quaternions.pdf">Introduction into quaternions for spacecraft attitude representation</a></li>

<li><a href="https://github.com/mattlisle/quaternion-ukf">https://github.com/mattlisle/quaternion-ukf</a> (Kalman-Filter and Quaternion)
<ul class="org-ul">
<li>"This implementation of a UKF for tracking orientation of a
drone with gyro and accelerometer data follows closely that
described in the paper "A Quaternion-based Unscented Kalman
Filter for Orientation Tracking" by Edgar Kraft."</li>
</ul></li>

<li><a href="https://stackoverflow.com/questions/tagged/quaternions">https://stackoverflow.com/questions/tagged/quaternions</a></li>

<li><a href="https://stackoverflow.com/questions/tagged/gyroscope">https://stackoverflow.com/questions/tagged/gyroscope</a></li>
</ul>


<p>
Dual Quaternion:
</p>

<ul class="org-ul">
<li>Dual quaternions are a combination of quaternions and dual
numbers. Unlike ordinary quaternions, which can only express
rotation, dual quaternions can express both rotation and
translation in a more concise and efficient way than
transformation matrices. Some applications of this mathematical
construct are: computer graphics; robotics; aerospace engineering
and more.</li>

<li><a href="https://en.m.wikipedia.org/wiki/Dual_quaternion">Dual Quaternions</a></li>

<li><a href="https://doc.magnum.graphics/magnum/transformations.html">Feature guide » 2D and 3D transformations</a> - Magnum Engine</li>

<li>[PDF] - Paper: <a href="https://web.archive.org/web/20220212092311/https://cs.gmu.edu/~jmlien/teaching/cs451/uploads/Main/dual-quaternion.pdf">A Beginners Guide to Dual-Quaternions</a> - What They
Are, How They Work, and How to Use Them for 3D Character
Hierarchies</li>

<li>[PDF] - Paper: <a href="https://web.archive.org/web/20210412220257/https://dcsl.gatech.edu/papers/acc18c.pdf">Modeling of Spacecraft-Mounted Robot Dynamics and Control Using Dual Quaternions</a></li>

<li>[PDF] - Paper: <a href="https://web.archive.org/web/20210617042645/https://www.scss.tcd.ie/publications/tech-reports/reports.06/TCD-CS-2006-46.pdf">Dual Quaternions for Rigid Transformation Blending</a></li>

<li>[PDF] - Report: <a href="https://web.archive.org/web/20211018040425/https://faculty.sites.iastate.edu/jia/files/inline-files/dual-quaternion.pdf">Dual Quaternions - Yan-Bin Jia</a></li>

<li><a href="https://www.mathworks.com/matlabcentral/fileexchange/39288-dual-quaternion-toolbox">Matalab File Exchange - Dual quaternion toolbox</a></li>
</ul>


<p>
Quaternion Computer Implementations:
</p>

<ul class="org-ul">
<li><a href="http://docs.ros.org/en/kinetic/api/tf/html/c++/classtf_1_1Quaternion.html">t::Quaternion - ROS Framework</a> (C++)</li>

<li><a href="https://doc.qt.io/qt-5/qquaternion.html">Qt5 C++ Framework - QQuaternion class</a> (C++)</li>

<li><a href="https://doc.qt.io/qt-5/qtdatavisualization-rotations-example.html">Qt5 - Rotation Example</a></li>

<li><a href="https://ivlab.github.io/MinGfx/classmingfx_1_1_quaternion.html">MinGfx C++ - OpenGL Wrapper</a> (C++)</li>

<li><a href="https://docs.unrealengine.com/en-US/API/Runtime/Core/Math/FQuat/index.html">FQuat</a> - Unreal Game Engine (C++)
<ul class="org-ul">
<li>Brief: "Floating point quaternion that can represent a rotation
about an axis in 3-D space."</li>
</ul></li>

<li><a href="https://web.archive.org/web/20210507012307/https://docs.unrealengine.com/en-US/API/Runtime/Core/Math/FTransform/index.html">FTransform</a> - Unreal Game Engine (C++)
<ul class="org-ul">
<li>Brief: "Transform composed of Scale, Rotation (as a
quaternion), and Translation."</li>
<li>Note: It has three member variables: Rotation (class FQaut),
Scale3D (FVector) and Translation (FVector).</li>
</ul></li>

<li><a href="https://web.archive.org/web/20210507005525/https://docs.unrealengine.com/en-US/API/Runtime/Core/Math/FRotator/index.html">FRotator</a>  - Unreal Gamer Engine (C++)
<ul class="org-ul">
<li>Brief: "Implements a container for rotation information. All rotation
values are stored in degrees."</li>
</ul></li>

<li><a href="https://docs.unity3d.com/ScriptReference/Quaternion.html">Unity3D - Quaternion</a> (C#, CSharp - Unity Game Engine)
<ul class="org-ul">
<li>Brief: "Quaternions are used to represent rotations. They are
compact, don't suffer from gimbal lock and can easily be
interpolated. Unity internally uses Quaternions to represent
all rotations. They are based on complex numbers and are not
easy to understand intuitively. You almost never access or
modify individual Quaternion components (x,y,z,w); most often
you would just take existing rotations (e.g. from the
Transform) and use them to construct new rotations (e.g. to
smoothly interpolate between two rotations). The Quaternion
functions that you use 99% of the time are:
Quaternion.LookRotation, Quaternion.Angle, Quaternion.Euler,
Quaternion.Slerp, Quaternion.FromToRotation, and
Quaternion.identity. (The other functions are only for exotic
uses.)"</li>
</ul></li>

<li><a href="https://doc.magnum.graphics/magnum/classMagnum_1_1Math_1_1Quaternion.html">Magnum Graphics Library - Quaternion</a> (C++)</li>

<li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.numerics.quaternion?view=net-5.0">Quaternion Struct</a> - Dotnet (C#)</li>

<li><a href="https://octave.sourceforge.io/quaternion/overview.html">Octave - Quaternion Library</a> (OCtave Language, akin to Matlab)</li>

<li><a href="https://docs.blender.org/api/2.33/Mathutils-module.html">Blender - MathUtils module</a></li>
</ul>
</div>
</div>

<div id="outline-container-org75dbfcc" class="outline-4">
<h4 id="org75dbfcc"><span class="section-number-4">1.8.15</span> Quaternions - Combining Scale and Position</h4>
<div class="outline-text-4" id="text-1-8-15">
<p>
Quaternions (non-dual quaternions) can only encode and represent
rotations around some orientation, which is not enough to specify
position and scaling. As a result, quaternions rotation matrices need
to be concatenated with translation and scaling transform matrices for
computing an object's model transform matrix, which is often passed to
a shader program via uniform variables.
</p>

<p>
Assuming that a rendered object has a transform member variable of
type RendererTransform containing a a quaternion, for representing
rotation; a scale vector and a position vector. The method
get_transform() compute the rendered object transform matrix, which is
the concatenation of rotation (quaternion), scaling and translation
transforms. The model transform determined by get_transform() method
can be passed to a shader uniform variable.
</p>

<p>
Note: Dual-quaternions, which are a combination of <span class="underline">dual-numbers</span> and
ordinary quaternions, can express both rotation and translation.
</p>


<ul class="org-ul">
<li>Class RendererTransform:</li>
</ul>


<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">struct</span> <span class="org-type">RenderTransform</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
      <span class="org-comment-delimiter">// </span><span class="org-comment">Rotation quaternion</span>
      <span class="org-comment-delimiter">// </span><span class="org-comment">Set to identity quaternion by default.</span>
      <span class="org-comment-delimiter">// </span><span class="org-comment">Members. The quaternion has the fields (w, x, y, z)</span>
      <span class="org-type">quaternion</span> <span class="org-variable-name">rotation</span> <span class="org-rainbow-delimiters-depth-2">{</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-2">}</span>;

      <span class="org-comment-delimiter">// </span><span class="org-comment">Scale vector containing scales (sx, sy, sz) of axis (X, Y, Z)</span>
      <span class="org-type">vec3</span> <span class="org-variable-name">scale</span><span class="org-rainbow-delimiters-depth-2">(</span>1.0, 1.0, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;

      <span class="org-comment-delimiter">// </span><span class="org-comment">Contains object's position</span>
      <span class="org-type">vec3</span> <span class="org-function-name">position</span><span class="org-rainbow-delimiters-depth-2">(</span>tx, ty, tz<span class="org-rainbow-delimiters-depth-2">)</span>;

      <span class="org-comment-delimiter">// </span><span class="org-comment">??? Get overall (end result) transform matrix that</span>
      <span class="org-comment-delimiter">// </span><span class="org-comment">will be passed to shader uniform variable.</span>
      <span class="org-type">mat4</span> <span class="org-function-name">get_transform</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> ????? <span class="org-rainbow-delimiters-depth-2">}</span>

      <span class="org-type">void</span> <span class="org-function-name">translate</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">dx</span>, <span class="org-type">float</span> <span class="org-variable-name">dy</span>, <span class="org-type">float</span> <span class="org-variable-name">dz</span><span class="org-rainbow-delimiters-depth-2">)</span>
      <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-keyword">this</span>-&gt;position.x += dx;
          <span class="org-keyword">this</span>-&gt;position.y += dy;
          <span class="org-keyword">this</span>-&gt;position.z += dz;
      <span class="org-rainbow-delimiters-depth-2">}</span>

      <span class="org-type">void</span> <span class="org-function-name">set_position</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-type">float</span> <span class="org-variable-name">y</span>, <span class="org-type">float</span> <span class="org-variable-name">z</span><span class="org-rainbow-delimiters-depth-2">)</span>
      <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-keyword">this</span>-&gt;position.x = x;
          <span class="org-keyword">this</span>-&gt;position.y = y;
          <span class="org-keyword">this</span>-&gt;position.z = z;
      <span class="org-rainbow-delimiters-depth-2">}</span>

      <span class="org-type">void</span> <span class="org-function-name">set_scale</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">sx</span> <span class="org-type">float</span> sy, <span class="org-type">float</span> <span class="org-variable-name">sz</span><span class="org-rainbow-delimiters-depth-2">)</span>
      <span class="org-rainbow-delimiters-depth-2">{</span>
         <span class="org-keyword">this</span>-&gt;scale.x = sx;
         <span class="org-keyword">this</span>-&gt;scale.y = sy;
         <span class="org-keyword">this</span>-&gt;scale.z = sz;
      <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
The transforms are often applied in the following sequence, first
scaling, then rotation and finally translation.
</p>

\begin{equation}
   T = T_t \cdot  T_r \cdot T_s = \text{Translation} \cdot \text{Rotation} \cdot \text{Scaling}
\end{equation}

<p>
Where:
</p>
<ul class="org-ul">
<li>T is the total transform matrix, which is the product between
intermediate transforms and later can be passed to a shader
uniform variable.</li>
<li>\(T_s\) - is the scale transform, determined from the scale vector.</li>
<li>\(T_t\) - is the translation transform, computed from the position vector.</li>
<li>\(T_r\) - is the quaternion rotation transform.</li>
</ul>


<p>
Intermediate transforms:
</p>

<ul class="org-ul">
<li>Translation affine transform form position vector.</li>
</ul>

\begin{equation}
  T_t =
   \begin{bmatrix}
     1   & 0   &  0 &  t_x \\
     0   & 1   &  0 &  t_y \\
     0   & 0   &  1 &  t_z \\
     0   & 0   &  0 &   1  \\
   \end{bmatrix}
\end{equation}

<ul class="org-ul">
<li>Scaling affine transform from scale vector.</li>
</ul>

\begin{equation}
  T_s =
   \begin{bmatrix}
     s_x   & 0     &  0   &  0 \\
     0     & s_y   &  0   &  0 \\
     0     & 0     &  s_z &  0 \\
     0     & 0     &  0   &  1  \\
   \end{bmatrix}
\end{equation}

<ul class="org-ul">
<li>Rotation affine transform obtainted from rotation quaternion.
<ul class="org-ul">
<li>Note: most linear algebrar or computer graphics math libraries
provide subroutines (aka functions) or class methods for
converting quaternions to 4x4 rotation matrices. Those libraries
also provide subroutines for determining a quaternion's yaw,
pitch and roll angles and constructing the quaternion from yaw,
pitch and roll angles.</li>
</ul></li>
</ul>

\begin{equation}
  T_r =
   \begin{bmatrix}
     a_{11}   & a_{12}   &  a_{13} & 0  \\
     a_{21}   & a_{22}   &  a_{23} & 0  \\
     a_{32}   & a_{32}   &  a_{33} & 0  \\
     0        & 0        &  0      & 1  \\
   \end{bmatrix}
\end{equation}

<p>
The end transform T is determined by concatenating all intermediate
transforms:
</p>

\begin{equation}
     T = T_t \cdot  T_r \cdot T_s
\end{equation}


\begin{equation}
     T =
  \begin{bmatrix}
     1   & 0   &  0 &  t_x \\
     0   & 1   &  0 &  t_y \\
     0   & 0   &  1 &  t_z \\
     0   & 0   &  0 &   1  \\
   \end{bmatrix}

   \begin{bmatrix}
     a_{11}   & a_{12}   &  a_{13} & 0  \\
     a_{21}   & a_{22}   &  a_{23} & 0  \\
     a_{31}   & a_{32}   &  a_{33} & 0  \\
     0        & 0        &  0      & 1  \\
   \end{bmatrix}

   \begin{bmatrix}
     s_x   & 0     &  0   &  0 \\
     0     & s_y   &  0   &  0 \\
     0     & 0     &  s_z &  0 \\
     0     & 0     &  0   &  1  \\
   \end{bmatrix}
\end{equation}

<p>
Finally, the model transform becomes:
</p>

\begin{equation}

  T =
   \begin{bmatrix}
     s_x \cdot a_{11} & s_y \cdot a_{12}  & s_z \cdot a_{13}  &  t_x \\
     s_x \cdot a_{21} & s_y \cdot a_{22}  & s_z \cdot a_{23}  &  t_y \\
     s_x \cdot a_{31} & s_y \cdot a_{32}  & s_z \cdot a_{33}  &  t_z \\
      0               &   0               &   0               &   1  \\
   \end{bmatrix}

\end{equation}

<p>
Then, the algorithm for determing the object model matrix, designated
by the transform T, could be written as the following pseudo-code:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">mat4</span> <span class="org-constant">RenderTransform</span>::<span class="org-function-name">get_transform</span><span class="org-rainbow-delimiters-depth-1">()</span> <span class="org-keyword">const</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Convert quaternion to a 4x4 rotation matrix (affine transform)</span>
    <span class="org-type">mat4</span> <span class="org-variable-name">model_transform</span> = quaternion_to_rotation_transform<span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-keyword">this</span>-&gt;quaternion <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Multiply all elements of first column by X axis scale</span>
    model_transform.comlumn<span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span> = scale.x * model_transform.column<span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Multiply all elemnts of second column by Y axis scale</span>
    model_transform.comlumn<span class="org-rainbow-delimiters-depth-2">[</span>1<span class="org-rainbow-delimiters-depth-2">]</span> = scale.y * model_transform.column<span class="org-rainbow-delimiters-depth-2">[</span>1<span class="org-rainbow-delimiters-depth-2">]</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Multiply all elemnts of third column by Z axis scale</span>
    model_transform.comlumn<span class="org-rainbow-delimiters-depth-2">[</span>2<span class="org-rainbow-delimiters-depth-2">]</span> = scale.z * model_transform.column<span class="org-rainbow-delimiters-depth-2">[</span>2<span class="org-rainbow-delimiters-depth-2">]</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set all elements of forth column as the 4x1  column vector</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">column4 = [position.x position.y position.z 1.0 ]</span>
    model_transform.column<span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span> = vec4<span class="org-rainbow-delimiters-depth-2">(</span> position.x, position.y, position.z, 1.0f <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">return</span> model_transform;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
To rotate the rendered object, it is only necessary to multiply the
quaternion variable, called 'rotation' by another quaternion. So, a
C++-like pseudo-code for setting or adding a new rotation could be
written as:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">RenderTransform</span> <span class="org-variable-name">object_transform</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Set a new rotation - overriding the old one.</span>
<span class="org-type">void</span> <span class="org-constant">RenderTransform</span>::<span class="org-function-name">set_rotation</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">angle_radians</span>, <span class="org-type">vec3</span> <span class="org-variable-name">axis_direction</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Normalize axis</span>
    <span class="org-type">vec3</span> <span class="org-variable-name">axis</span> = axis_direction.normalize<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Make explicit assumption the assumption that the quaternion is normalized.</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span> norm<span class="org-rainbow-delimiters-depth-3">(</span>axis<span class="org-rainbow-delimiters-depth-3">)</span> ~= 1.0  <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">this</span>-&gt;object_transform.quaternion = make_quaternion_from_AngleAxis<span class="org-rainbow-delimiters-depth-2">(</span>angle, axis<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Add a new rotation, rotate the previous quaternion.</span>
<span class="org-type">void</span> <span class="org-constant">RenderTransform</span>::<span class="org-function-name">rotate</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">angle_radians</span>, <span class="org-type">vec3</span> <span class="org-variable-name">axis_direction</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">vec3</span> <span class="org-variable-name">axis</span> = axis_direction.normalize<span class="org-rainbow-delimiters-depth-2">()</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> norm<span class="org-rainbow-delimiters-depth-3">(</span>axis<span class="org-rainbow-delimiters-depth-3">)</span> ~= 1.0  <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">quaternon</span> <span class="org-variable-name">q</span> = make_quaternion_from_AngleAxis<span class="org-rainbow-delimiters-depth-2">(</span>angle, axis<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">this</span>-&gt;object_transform.quaternion = <span class="org-keyword">this</span>-&gt;object_transform.quaternion * q;
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Set a new Yaw-Pitch-Roll Euler's angles rotation.</span>
<span class="org-type">void</span> <span class="org-constant">RenderTransform</span>::<span class="org-function-name">set_rotation_YRP</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">yaw</span>, <span class="org-type">float</span> <span class="org-variable-name">pitch</span>, <span class="org-type">float</span> <span class="org-variable-name">roll</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">vec3</span> <span class="org-variable-name">axis</span> = axis_direction.normalize<span class="org-rainbow-delimiters-depth-2">()</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> norm<span class="org-rainbow-delimiters-depth-3">(</span>axis<span class="org-rainbow-delimiters-depth-3">)</span> ~= 1.0  <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">quaternon</span> <span class="org-variable-name">q</span> = make_quaternion_from_YAW_PITCH_ROLL<span class="org-rainbow-delimiters-depth-2">(</span>yaw, pitch, roll<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> norm<span class="org-rainbow-delimiters-depth-3">(</span>q<span class="org-rainbow-delimiters-depth-3">)</span> ~= 1.0 <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">this</span>-&gt;object_transform.quaternion = q;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<b>See also:</b>
</p>

<ul class="org-ul">
<li><a href="https://tech.metail.com/performance-quaternions-gpu/">Performance of quaternions in the GPU</a> - Metail Tech</li>

<li><a href="https://stackoverflow.com/questions/8594102/matrix-multiply-with-position-quaternion-and-scale-components">c++ - Matrix multiply with position, quaternion and scale components - Stack Overflow</a></li>

<li><a href="https://www.gamasutra.com/view/feature/131686/rotating_objects_using_quaternions.php">Rotating Objects Using Quaternions</a> - Noick Bobic / Gamasutra</li>
</ul>
</div>
</div>

<div id="outline-container-org8362cf4" class="outline-4">
<h4 id="org8362cf4"><span class="section-number-4">1.8.16</span> Quaternion in Julia Language</h4>
<div class="outline-text-4" id="text-1-8-16">
<p>
It is worth prototyping quaternion math in a numerically-oriented programming
language such as <a href="https://en.wikipedia.org/wiki/Julia_(programming_language)">Julia Language</a> is helpful for understanding and
validating the inner works of quaternion computations. This
implementation of quaternion math represents quaternion as an array of
four elements and uses a matrix representation for implemeting
quaternion multiplication.
</p>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter"># </span><span class="org-comment">Struct for storing quaternion</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">q = w + x&#183;i + y&#183;j + z&#183;k</span>
struct quatp
   arr<span class="org-default">::</span><span class="org-type">Array</span>{<span class="org-type">Float64</span>,1}
<span class="org-keyword">end</span>

<span class="org-keyword">function</span> <span class="org-function-name">quat</span>(x, y, z, w)
  <span class="org-keyword">return</span> quatp([x ; y; z; w])
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Turns a quaternion into 4x4 matrix representation</span>
<span class="org-keyword">function</span> <span class="org-function-name">quat_to_mat4x4</span>(q<span class="org-default">::</span><span class="org-type">quatp</span>)
    w, x, y, z  = q.arr
    mat = [  w -x -y -z
           ; x  w -z  y
           ; y  z  w -x
           ; z -y x w ]
    <span class="org-keyword">return</span> mat
 <span class="org-keyword">end</span>

<span class="org-keyword">function</span> Base.<span class="org-function-name">getproperty</span>(q<span class="org-default">::</span><span class="org-type">quatp</span>, sym<span class="org-default">::</span><span class="org-type">Symbol</span>)
    <span class="org-keyword">if</span> sym == <span class="org-julia-quoted-symbol">:arr</span>
        <span class="org-keyword">return</span> getfield(q, <span class="org-julia-quoted-symbol">:arr</span>)
    <span class="org-keyword">elseif</span> sym == <span class="org-julia-quoted-symbol">:w</span>
        <span class="org-keyword">return</span> getfield(q, <span class="org-julia-quoted-symbol">:arr</span>)[1]
    <span class="org-keyword">elseif</span> sym == <span class="org-julia-quoted-symbol">:x</span>
        <span class="org-keyword">return</span> getfield(q, <span class="org-julia-quoted-symbol">:arr</span>)[2]
    <span class="org-keyword">elseif</span> sym == <span class="org-julia-quoted-symbol">:y</span>
        <span class="org-keyword">return</span> getfield(q, <span class="org-julia-quoted-symbol">:arr</span>)[3]
    <span class="org-keyword">elseif</span> sym == <span class="org-julia-quoted-symbol">:z</span>
        <span class="org-keyword">return</span> getfield(q, <span class="org-julia-quoted-symbol">:arr</span>)[4]
    <span class="org-keyword">elseif</span> sym == <span class="org-julia-quoted-symbol">:v</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">Return only the quaternion (vector part)</span>
        <span class="org-keyword">return</span> getfield(q, <span class="org-julia-quoted-symbol">:arr</span>)[2:<span class="org-keyword">end</span>]
    <span class="org-keyword">end</span>
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Norm - quaternion magnitude, akin to vector norm</span>
<span class="org-keyword">function</span> <span class="org-function-name">norm</span>(q<span class="org-default">::</span><span class="org-type">quatp</span>)
   w, x, y, z = q.arr
   <span class="org-keyword">return</span> sqrt(w * w + x * x + y * y + z * z)
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Conjugate of a quaternion</span>
<span class="org-keyword">function</span> <span class="org-function-name">conj</span>(q<span class="org-default">::</span><span class="org-type">quatp</span>)
  <span class="org-keyword">return</span> quat(q.w, -q.x, -q.y, -q.z)
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Inverse of quaternion q^-1</span>
<span class="org-keyword">function</span> <span class="org-function-name">Base</span>.:inv(q<span class="org-default">::</span><span class="org-type">quatp</span>)
   w, x, y, z = q.arr
   norm_square =  w * w +  x * x + y * y + z * z
   <span class="org-keyword">return</span>  quat(w, -x, -y, -z) / norm_square
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Quaternion sum</span>
<span class="org-function-name">Base.</span>:+(q1<span class="org-default">::</span><span class="org-type">quatp</span>, q2<span class="org-default">::</span><span class="org-type">quatp</span>) = quat(q1.w + q2.w, q1.x + q2.x, q1.y + q2.y, q1.z + q2.z)
<span class="org-function-name">Base.</span>:-(q1<span class="org-default">::</span><span class="org-type">quatp</span>, q2<span class="org-default">::</span><span class="org-type">quatp</span>) = quat(q1.w - q2.w, q1.x - q2.x, q1.y - q2.y, q1.z - q2.z)

<span class="org-function-name">Base.</span>:+(q<span class="org-default">::</span><span class="org-type">quatp</span>,   w<span class="org-default">::</span><span class="org-type">Float64</span>) = quat(w + q.w, q.x, q.y, q.z)
<span class="org-function-name">Base.</span>:+(w<span class="org-default">::</span><span class="org-type">Float64</span>, q<span class="org-default">::</span><span class="org-type">quatp</span>  ) = quat(w + q.w, q.x, q.y, q.z)
<span class="org-function-name">Base.</span>:-(q<span class="org-default">::</span><span class="org-type">quatp</span>,   w<span class="org-default">::</span><span class="org-type">Float64</span>) = quat(q.w - w, q.x, q.y, q.z)

<span class="org-comment-delimiter"># </span><span class="org-comment">Mutliplication =&gt; scalar X quaternion</span>
<span class="org-function-name">Base.</span>:*(a<span class="org-default">::</span><span class="org-type">Float64</span>, q<span class="org-default">::</span><span class="org-type">quatp</span>) = quat( a * q.w, a * q.x, a * q.y, a * q.z)
<span class="org-function-name">Base.</span>:*(q<span class="org-default">::</span><span class="org-type">quatp</span>, a<span class="org-default">::</span><span class="org-type">Float64</span>) = quat( a * q.w, a * q.x, a * q.y, a * q.z)

<span class="org-function-name">Base.</span>:/(q<span class="org-default">::</span><span class="org-type">quatp</span>, a<span class="org-default">::</span><span class="org-type">Float64</span>) = quat( q.w / a, q.x / a, q.y / a, q.z / a)

<span class="org-comment-delimiter"># </span><span class="org-comment">Quaternion multiplication / product</span>
<span class="org-function-name">Base.</span>:*(q1<span class="org-default">::</span><span class="org-type">quatp</span>, q2<span class="org-default">::</span><span class="org-type">quatp</span>) = <span class="org-keyword">begin</span>
     A = quat_to_mat4x4(q1)
     <span class="org-keyword">return</span> quatp( A * q2.arr )
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Unit quaternions i, j, k</span>
<span class="org-keyword">const</span> i = quat(0.0, 1.0, 0.0, 0.0)
<span class="org-keyword">const</span> j = quat(0.0, 0.0, 1.0, 0.0)
<span class="org-keyword">const</span> k = quat(0.0, 0.0, 0.0, 1.0)


<span class="org-comment-delimiter"># </span><span class="org-comment">Obtain a rotation quaternion that represents a rotation</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">by some angle around some direction (normalized vector 'vec')</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; The angle is given in degrees.</span>
<span class="org-keyword">function</span> <span class="org-function-name">rot_quat</span>(angle<span class="org-default">::</span><span class="org-type">Float64</span>, vec)
   <span class="org-comment-delimiter"># </span><span class="org-comment">Normalize vector vec and store the result in v</span>
   xv, yv, zv = vec
   x, y, z = vec / sqrt( xv * xv + yv * yv + zv * zv )
   S = cosd(angle / 2)
   C = sind(angle / 2)
   <span class="org-keyword">return</span> quat(C, S * x, S * y, S * z)
<span class="org-keyword">end</span>

<span class="org-comment-delimiter">## </span><span class="org-comment">Vector cross product VA x VB of two column vectors (3 x 1)</span>
<span class="org-keyword">function</span> <span class="org-function-name">cross</span>(va, vb)
     x, y, z = va
     T = [ 0 -z y ; z 0 -x; -y x 0]
     T * vb
 <span class="org-keyword">end</span>

<span class="org-comment-delimiter">## </span><span class="org-comment">Apply a rotation quaternion to a vector (column vector 3 x 1)</span>
<span class="org-comment-delimiter">##  </span><span class="org-comment">=&gt;&gt; Vector 3 rows and 1 column</span>
<span class="org-comment-delimiter">## </span><span class="org-comment">Algorithm from:</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">=&gt;&gt; https://fgiesen.wordpress.com/2019/02/09/rotating-a-single-vector-using-a-quaternion/</span>
<span class="org-keyword">function</span> <span class="org-function-name">apply_rot</span>(qr<span class="org-default">::</span><span class="org-type">quatp</span>, va)
   wr = qr.w <span class="org-comment-delimiter"># </span><span class="org-comment">Scalar/real part of rotation quaternion</span>
   vr = qr.v <span class="org-comment-delimiter"># </span><span class="org-comment">Vector part of rotation quaternion</span>
   vt = 2 * cross(vr, va)
   vb = va + wr * vt + cross(vr, vt)
   <span class="org-keyword">return</span> vb
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Obtain a rotation matrix - that represents rotation</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">around an arbitrary axis (vector)</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Note: The angle is should be in degrees.</span>
<span class="org-comment-delimiter">#</span>
<span class="org-keyword">function</span> <span class="org-function-name">make_rotmat</span>(angle<span class="org-default">::</span><span class="org-type">Float64</span>, vec)
   <span class="org-comment-delimiter"># </span><span class="org-comment">Normalize vector vec and store components in x, y, z</span>
   x, y, z = vec
   x, y, z = vec / sqrt( x * x + y * y + z * z )
   <span class="org-comment-delimiter"># </span><span class="org-comment">sin and cos caching</span>
   C = cosd(angle / 2)
   S = sind(angle / 2)
   <span class="org-comment-delimiter"># </span><span class="org-comment">Parameters a, b, c, d =&gt; Components of the rotation</span>
   <span class="org-comment-delimiter"># </span><span class="org-comment">quaternion</span>
   a = C
   b = x * S
   c = y * S
   d = z * S
   <span class="org-comment-delimiter"># </span><span class="org-comment">rotation matrix</span>
   mat = [
        ( a^2 + b^2 - c^2 - d^2 )  ( 2 * (b * c - a * d )  ) ( 2 * (b * d + a * c)   )  0
     ;  ( 2 * (b * c + a * d)   )  ( a^2 - b^2 + c^2 - d^2 ) ( 2 * (c * d - a * b)   )  0
     ;  ( 2 * (b * d - a * c)   )  ( 2 * (c * d + a * b)   ) ( a^2 - b^2 - c^2 + d^2 )  0
     ;  0                          0                         0                          1
   ]
   <span class="org-keyword">return</span> mat
<span class="org-keyword">end</span>
</pre>
</div>

<p>
Quaternion components:
</p>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter"># </span><span class="org-comment">Construct a quaternion</span>

julia&gt; q = quat(10.5, -25.1, 4.5, 5.6)
quatp([10.5, -25.1, 4.5, 5.6])

julia&gt; q.w <span class="org-comment-delimiter"># </span><span class="org-comment">Real part</span>
10.5

julia&gt; q.x <span class="org-comment-delimiter"># </span><span class="org-comment">Imaginary part - i axis component</span>
-25.1

julia&gt; q.y <span class="org-comment-delimiter"># </span><span class="org-comment">Imaginary part - j axis component</span>
4.5

julia&gt; q.z <span class="org-comment-delimiter"># </span><span class="org-comment">Imaginary part - k axis component (Z axis)</span>
5.6

julia&gt; q.arr <span class="org-comment-delimiter"># </span><span class="org-comment">Internal array data representation</span>
4-element <span class="org-type">Array</span>{<span class="org-type">Float64</span>,1}:
  10.5
 -25.1
   4.5
   5.6

julia&gt; q.v <span class="org-comment-delimiter"># </span><span class="org-comment">Vector component (i, j, k) components only</span>
3-element <span class="org-type">Array</span>{<span class="org-type">Float64</span>,1}:
 -25.1
   4.5
   5.6
</pre>
</div>

<p>
Quaternion conjugate and inverse:
</p>

<div class="org-src-container">
<pre class="src src-julia">julia&gt; q = quat(1.0, 2.0, 3.0, 4.0)
quatp([1.0, 2.0, 3.0, 4.0])

julia&gt; inv(q)
quatp([0.03333333333333333, -0.06666666666666667, -0.1, -0.13333333333333333])

<span class="org-comment-delimiter"># </span><span class="org-comment">Expected (-1.0)</span>
julia&gt; q * inv(q)
quatp([1.0, 0.0, 0.0, 0.0])

<span class="org-comment-delimiter"># </span><span class="org-comment">Expected (-1.0)</span>
julia&gt; inv(q) * q
quatp([1.0, -5.551115123125783e-17, -6.938893903907228e-18, 5.551115123125783e-17])
</pre>
</div>

<p>
Normalize a quaternion:
</p>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter"># </span><span class="org-comment">Expected normalized to be: (w = 0.18257, x = 0.36515, y = 0.54772, z = 0.7303)</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Test case from: Matlab Robotics Toolbox - https://www.mathworks.com/help/robotics/ref/quaternion.normalize.html</span>

 julia&gt; q = quat(1.0, 2.0, 3.0, 4.0)
 quatp([1.0, 2.0, 3.0, 4.0])

 julia&gt; qn = normalize(q)
 quatp([0.18257418583505536, 0.3651483716701107, 0.5477225575051661, 0.7302967433402214])

 julia&gt; norm(qn)
 0.9999999999999999

</pre>
</div>

<p>
Test case 1 - for quaternion multiplication:
</p>

<ul class="org-ul">
<li>Test quaternion laws:</li>
<li>Expected: i * i = j * j = k * k = -1</li>
<li>Expected: i * j = k</li>
<li>Expected: j * k = i</li>
<li>Expected: k * i = j</li>
<li>Expected: j * i = -k</li>
</ul>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter"># </span><span class="org-comment">---- Show components i, j, k --------#</span>

julia&gt; i
quatp([0.0, 1.0, 0.0, 0.0])

julia&gt; j
quatp([0.0, 0.0, 1.0, 0.0])

julia&gt; k
quatp([0.0, 0.0, 0.0, 1.0])

<span class="org-comment-delimiter"># </span><span class="org-comment">----- Check multiplication of i, j, k by themselves -----------#</span>
<span class="org-comment-delimiter">#</span>

julia&gt; i * i <span class="org-comment-delimiter"># </span><span class="org-comment">Expected -1 or (-1) + 0&#183;i + 0&#183;j + 0&#183;k</span>
quatp([-1.0, 0.0, 0.0, 0.0])

julia&gt; j * j <span class="org-comment-delimiter"># </span><span class="org-comment">Expected -1</span>
quatp([-1.0, 0.0, 0.0, 0.0])

julia&gt; k * k <span class="org-comment-delimiter"># </span><span class="org-comment">Expected -1</span>
quatp([-1.0, 0.0, 0.0, 0.0])

<span class="org-comment-delimiter">#</span><span class="org-comment">------- Check multiplication i * j, j * k, k * i and j * i</span>
<span class="org-comment-delimiter">#</span>
julia&gt; i * j <span class="org-comment-delimiter"># </span><span class="org-comment">Expected k</span>
quatp([0.0, 0.0, 0.0, 1.0])

julia&gt; j * i <span class="org-comment-delimiter"># </span><span class="org-comment">Expected -k</span>
quatp([0.0, 0.0, 0.0, -1.0])

julia&gt; k * i <span class="org-comment-delimiter"># </span><span class="org-comment">Expected j</span>
quatp([0.0, 0.0, 1.0, 0.0])

julia&gt; i * k <span class="org-comment-delimiter"># </span><span class="org-comment">Expected -j</span>
quatp([0.0, 0.0, -1.0, 0.0])

</pre>
</div>

<p>
Test case 2 - for quaternion multiplication:
</p>

<ul class="org-ul">
<li>From:  <a href="https://www.mathworks.com/help/aerotbx/ug/quatmultiply.html">Matlab Aerospace Toolbox</a></li>
<li>q1 = [ 1.0 0.0 1.0 0.00 ]</li>
<li>q2 = [ 1.0 0.5 0.5 0.75 ]</li>
<li>Expected result =&gt;&gt; q1 * q2 = [ 0.5 1.25 1.5 0.25 ]</li>
</ul>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter"># </span><span class="org-comment">-------- Test A ------------------------#</span>
julia&gt; q1 = quat(1.0, 0.0, 1.0, 0.0)
quatp([1.0, 0.0, 1.0, 0.0])

julia&gt; q2 = quat(1.0, 0.5, 0.5, 0.75)
quatp([1.0, 0.5, 0.5, 0.75])

<span class="org-comment-delimiter"># </span><span class="org-comment">------- Test B ---------------------#</span>

julia&gt; q1 = 1.0 + 0.0i + 1.0j + 0.0k
quatp([1.0, 0.0, 1.0, 0.0])

julia&gt; q2 = 1.0 + 0.5i + 0.5j + 0.75k
quatp([1.0, 0.5, 0.5, 0.75])

julia&gt; q1 * q2
quatp([0.5, 1.25, 1.5, 0.25])
</pre>
</div>

<p>
Test case 3 - for quaternion multiplication:
</p>

<ul class="org-ul">
<li>From: <a href="https://www.maplesoft.com/applications/view.aspx?SID=4886&amp;view=html">Maplesoft - Quaternion</a></li>
<li>q1 = ( -6) +  (-8)i +  (-5)j +     7k</li>
<li>q2 = (-14) + (-12)i + (-19)j + (-17)k</li>
<li>Expected: q1 * q2 = 12 +   402i + (-36)j +   96k</li>
<li>Expected: q2 * q1 = 12 + (-34)i +   404j + (-88)k</li>
<li>Expected: q2 + q1 = (-20) + (-20)i + (-24)j + (-10)k</li>
</ul>

<div class="org-src-container">
<pre class="src src-julia">julia&gt; q1 = -6.0 + -8.0i + -5.0j + 7.0k
quatp([-6.0, -8.0, -5.0, 7.0])

julia&gt; q2 = -14.0 + -12.0i + -19.0j + -17.0k
quatp([-14.0, -12.0, -19.0, -17.0])

julia&gt; q1 * q2
quatp([12.0, 402.0, -36.0, 96.0])

julia&gt; q2 * q1
quatp([12.0, -34.0, 404.0, -88.0])

julia&gt; q1 + q2
quatp([-20.0, -20.0, -24.0, -10.0])

julia&gt; q2 + q1
quatp([-20.0, -20.0, -24.0, -10.0])


</pre>
</div>

<p>
<b>Test algorithm - make_rotmat</b> that computes rotation matrices around
an arbitrary axis:
</p>

<p>
Define functions for computing rotation matrices:
</p>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter"># </span><span class="org-comment">Rotation around X axis</span>
<span class="org-keyword">function</span> <span class="org-function-name">rot_x</span>(angle<span class="org-default">::</span><span class="org-type">Float64</span>)
   C = cosd(angle)
   S = sind(angle)
   <span class="org-keyword">return</span> [  1   0   0  0
           ; 0   C  -S  0
           ; 0   S   C  0
           ; 0   0   0  1
          ]
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Rotation around X axis</span>
<span class="org-keyword">function</span> <span class="org-function-name">rot_y</span>(angle<span class="org-default">::</span><span class="org-type">Float64</span>)
   c = cosd(angle)
   s = sind(angle)
   <span class="org-keyword">return</span> [  c   0   s  0
           ; 0   1   0  0
           ;-s   0   c  0
           ; 0   0   0  1
          ]
<span class="org-keyword">end</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Returns homogeneous rotation matrix around Z axis</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">=&gt; The angle must be in degrees, not radians</span>
<span class="org-keyword">function</span> <span class="org-function-name">rot_z</span>(angle<span class="org-default">::</span><span class="org-type">Float64</span>)
   c = cosd(angle)
   s = sind(angle)
   <span class="org-keyword">return</span> [  c  -s  0  0
           ; s   c  0  0
           ; 0   0  1  0
           ; 0   0  0  1
          ]
<span class="org-keyword">end</span>
</pre>
</div>

<p>
Test rotation matrices:
</p>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-keyword">const</span> axis_x = [1.0 0.0 0.0]';
<span class="org-keyword">const</span> axis_y = [0.0 1.0 0.0]';
<span class="org-keyword">const</span> axis_z = [0.0 0.0 1.0]';

<span class="org-comment-delimiter"># </span><span class="org-comment">-------- Rotation around Z axis ---------- #</span>
<span class="org-comment-delimiter">#</span>

julia&gt; rot_z(90.0)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 0.0  -1.0  0.0  0.0
 1.0   0.0  0.0  0.0
 0.0   0.0  1.0  0.0
 0.0   0.0  0.0  1.0

julia&gt; make_rotmat(90.0, axis_z)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 0.0  -1.0  0.0  0.0
 1.0   0.0  0.0  0.0
 0.0   0.0  1.0  0.0
 0.0   0.0  0.0  1.0


julia&gt; rot_z(45.0)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 0.707107  -0.707107  0.0  0.0
 0.707107   0.707107  0.0  0.0
 0.0        0.0       1.0  0.0
 0.0        0.0       0.0  1.0

julia&gt; make_rotmat(45.0, axis_z)
]4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 0.707107  -0.707107  0.0  0.0
 0.707107   0.707107  0.0  0.0
 0.0        0.0       1.0  0.0
 0.0        0.0       0.0  1.0

julia&gt; rot_z(125.0)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 -0.573576  -0.819152  0.0  0.0
  0.819152  -0.573576  0.0  0.0
  0.0        0.0       1.0  0.0
  0.0        0.0       0.0  1.0

julia&gt; make_rotmat(125.0, axis_z)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 -0.573576  -0.819152  0.0  0.0
  0.819152  -0.573576  0.0  0.0
  0.0        0.0       1.0  0.0
  0.0        0.0       0.0  1.0


<span class="org-comment-delimiter"># </span><span class="org-comment">----- Rotation around X axis ------------#</span>
<span class="org-comment-delimiter">#</span>
julia&gt; rot_x(0.0)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 1.0  0.0   0.0  0.0
 0.0  1.0  -0.0  0.0
 0.0  0.0   1.0  0.0
 0.0  0.0   0.0  1.0

julia&gt; make_rotmat(0.0, axis_x)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 1.0  0.0  0.0  0.0
 0.0  1.0  0.0  0.0
 0.0  0.0  1.0  0.0
 0.0  0.0  0.0  1.0


julia&gt; rot_x(45.0)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 1.0  0.0        0.0       0.0
 0.0  0.707107  -0.707107  0.0
 0.0  0.707107   0.707107  0.0
 0.0  0.0        0.0       1.0

julia&gt; make_rotmat(45.0, axis_x)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 1.0  0.0        0.0       0.0
 0.0  0.707107  -0.707107  0.0
 0.0  0.707107   0.707107  0.0
 0.0  0.0        0.0       1.0


julia&gt; rot_x(90.0)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 1.0  0.0   0.0  0.0
 0.0  0.0  -1.0  0.0
 0.0  1.0   0.0  0.0
 0.0  0.0   0.0  1.0

julia&gt; make_rotmat(90.0, axis_x)
4&#215;4 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
 1.0  0.0   0.0  0.0
 0.0  0.0  -1.0  0.0
 0.0  1.0   0.0  0.0
 0.0  0.0   0.0  1.0

</pre>
</div>

<p>
Test rotation quaternions:
</p>

<div class="org-src-container">
<pre class="src src-julia"><span class="org-comment-delimiter"># </span><span class="org-comment">Rotation around X axis</span>
<span class="org-keyword">function</span> <span class="org-function-name">rot_xx</span>(angle<span class="org-default">::</span><span class="org-type">Float64</span>)
   C = cosd(angle)
   S = sind(angle)
   <span class="org-keyword">return</span> [ 1  0  0  ; 0   C  -S   ; 0   S   C     ]
<span class="org-keyword">end</span>

julia&gt; va = [6.0 10.5 2.56]'
3&#215;1 LinearAlgebra.Adjoint{<span class="org-type">Float64</span>,<span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}}:
  6.0
 10.5
  2.56

angle = 60.0 <span class="org-comment-delimiter"># </span><span class="org-comment">60 degrees</span>

julia&gt; vb_rotmat = rot_xx(angle) * va
3&#215;1 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
  6.0
  3.032974966311837
 10.373266739736605

<span class="org-comment-delimiter"># </span><span class="org-comment">Rotation quaternion that represents rotation of 60 degrees around X axis.</span>
julia&gt; qr = rot_quat(60.0, [1.0 0.0 0.0]')
quatp([0.8660254037844386, 0.5, 0.0, 0.0])

<span class="org-comment-delimiter"># </span><span class="org-comment">Apply transform to vector va</span>
julia&gt; vb_qr = apply_rot(qr, va)
3&#215;1 <span class="org-type">Array</span>{<span class="org-type">Float64</span>,2}:
  6.0
  3.032974966311837
 10.373266739736607

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb370110" class="outline-3">
<h3 id="orgb370110"><span class="section-number-3">1.9</span> Drawing Primitives</h3>
<div class="outline-text-3" id="text-1-9">
<p>
OpenGL can draw only points, lines, triangles and quads as
primitives. Complex models, solids, surfaces and curves can be drawn
combining those primitives.
</p>

<p>
Drawing is perfomed by using the <span class="underline">glDrawArrays()</span> subroutine, that draws
using the vertices from the current bound VBO - Vertex Buffer Object
or VAO - Vertex Array Object.
</p>

<p>
Primitives:
</p>

<ul class="org-ul">
<li><span class="underline">GL_POINTS</span> =&gt; Draw a point for each vertex.</li>

<li><span class="underline">GL_LINES</span> =&gt; Unconnected lines - useful for drawing grids and
coordinate axis. Each two vertices are considered the beginning
and the end of the current line. For instance, if there are 6
vertices, V0, V1, V2, V3, V4, V5. The primitive GL_LINES, will
result in the following lines: Line(V0, V1) - line  from V0 to V1;
Line(V2, V3); Line(V4, V5).</li>

<li><span class="underline">GL_LINE_STRIP</span>  =&gt; Draw connected lines for each pair of
consecutive vertices. For each, if there is a set of 4 vertices,
named V0, V1, V2, V3. This primitive will draw the following
lines: Line(V0, V1) - line from V0 to V1; Line(V1, V2) and
Line(V2, V3). q</li>

<li><span class="underline">GL_LINE_LOOP</span> =&gt; Similar, to GL_LINE_STRIP primitive, although this
primitive draws a line between the first and the last vertex. This
primitive is suitable for drawing poligons.</li>

<li><span class="underline">GL_TRIANGLES</span> =&gt; Draws a triangle for each three vertices. This
primitive is useful for drawing surfaces and solids. Any complex
OpenGL surface can be approximated using triangles. This primitive
draws a triangle for each three vertices. If there is a set of
vertices V0, V1, V2, V3, V4 and V5, the primitive will draw the
following triangles Triangle(V0, V1, V2) and Triangle(V3, V4,
V5).</li>

<li><span class="underline">GL_TRIANGLE_FAN</span></li>

<li><span class="underline">GL_TRIANGLE_STRIP</span></li>
</ul>


<div class="org-src-container">
<pre class="src src-cpp">glBindVertexArray<span class="org-rainbow-delimiters-depth-1">(</span>my_vao<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Draw points lines - using the vertices coordinates from VAO 'my_vao'.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">(current bounded VAO)</span>
glDrawArrays<span class="org-rainbow-delimiters-depth-1">(</span>GL_POINTS, 0, n_vertices<span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">Draw unconnected lines - using the vertices coordinates from VAO 'my_vao'.</span>
glDrawArrays<span class="org-rainbow-delimiters-depth-1">(</span>GL_LINES, 0, n_vertices<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Draw connected lines - using the vertices coordinates from VAO 'my_vao'.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">(current bounded VAO)</span>
glDrawArrays<span class="org-rainbow-delimiters-depth-1">(</span>GL_LINE_STRIP, 0, n_vertices<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-org4efe8b2" class="outline-3">
<h3 id="org4efe8b2"><span class="section-number-3">1.10</span> Library GLM - OpenGL Mathematics</h3>
<div class="outline-text-3" id="text-1-10">
</div>
<div id="outline-container-org6a68b02" class="outline-4">
<h4 id="org6a68b02"><span class="section-number-4">1.10.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-10-1">
<p>
The library GLM (OpenGL math library) contains many classes and
subroutines for computer graphics computations, such as: homogeneous
coordinates; quaternios; 1D, 2D, 3D and homogeneous coordinates
vectors; vector-matrix operations and so on. Aside those facilities,
the library also provides the subroutines <span class="underline">glm::lookAt()</span>, for computing
view matrix transform, that turns world coordinates into camera
coordinates; <span class="underline">glm::perspective()</span> - for computing the projection matrix,
that turns camera coordinates into clip-space coordinates (NDC
coordinates with range -1.0 to 1.0) and also <span class="underline">glm::ortho</span> for computing
the orthogonal perspective matrix. The GLM library is designed with
syntax based on GLSL (OpenGL shading language).
</p>

<p>
Web Site:
</p>

<ul class="org-ul">
<li><a href="https://glm.g-truc.net/0.9.9/index.html">OpenGL Mathematics</a></li>
</ul>

<p>
Repository:
</p>

<ul class="org-ul">
<li><a href="https://github.com/g-truc/glm">https://github.com/g-truc/glm</a></li>
</ul>

<p>
Other Documentations:
</p>

<ul class="org-ul">
<li><a href="https://openframeworks.cc/documentation/glm/">https://openframeworks.cc/documentation/glm/</a></li>
</ul>


<p>
<b>Type signature of most relevant GLM functions:</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp">
<span class="org-comment-delimiter">// </span><span class="org-comment">Converts an input angle in degrees to radians.</span>
<span class="org-comment-delimiter">//</span>
<span class="org-comment-delimiter">//  </span><span class="org-comment">angle_radians = angle_degrees * (PI / 180.0 )</span>
<span class="org-comment-delimiter">//</span>
<span class="org-type">float</span> <span class="org-constant">glm</span>::<span class="org-function-name">radians</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">foat</span>  <span class="org-variable-name">degrees</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">------ Basic Matrix Transformation =&gt;&gt; Useful for model matrix ---------------//</span>
<span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::rotate   <span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">m</span>, <span class="org-type">float</span> <span class="org-variable-name">angle</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">axis</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::scale    <span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">m</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">factors</span>           <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">m</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">translation</span>       <span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">---- Camera View matrix and Camera's matrix -------------//</span>
<span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">eye</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">look</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span> &amp; <span class="org-variable-name">up</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::ortho<span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">float</span> <span class="org-variable-name">left</span>, <span class="org-type">float</span> <span class="org-variable-name">right</span>, <span class="org-type">float</span> <span class="org-variable-name">bottom</span>, <span class="org-type">float</span> <span class="org-variable-name">top</span>, <span class="org-type">float</span> <span class="org-variable-name">near</span>, <span class="org-type">float</span> <span class="org-variable-name">far</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::ortho<span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">float</span> <span class="org-variable-name">left</span>, <span class="org-type">float</span> <span class="org-variable-name">right</span>, <span class="org-type">float</span> <span class="org-variable-name">bottom</span>, <span class="org-type">float</span> <span class="org-variable-name">top</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::frustum<span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">float</span> <span class="org-variable-name">left</span>, <span class="org-type">float</span> <span class="org-variable-name">right</span>, <span class="org-type">float</span> <span class="org-variable-name">bottom</span>, <span class="org-type">float</span> <span class="org-variable-name">top</span>, <span class="org-type">float</span> <span class="org-variable-name">near</span>, <span class="org-type">float</span> <span class="org-variable-name">far</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-function-name">glm</span>::mat4 <span class="org-constant">glm</span>::perspective<span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">float</span> <span class="org-variable-name">fovy</span>, <span class="org-type">float</span> <span class="org-variable-name">aspect</span>, <span class="org-type">float</span> <span class="org-variable-name">near</span>, <span class="org-type">float</span> <span class="org-variable-name">far</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
<b>Subroutines for vector computations</b>
</p>

<ul class="org-ul">
<li>glm::normalize()
<ul class="org-ul">
<li>=&gt; Normalize a vector.</li>
</ul></li>

<li>glm::dot(vec1, vec2)
<ul class="org-ul">
<li>=&gt; Vector dot product.</li>
</ul></li>

<li>glm::length(vec)
<ul class="org-ul">
<li>=&gt; Vector norm, aka magnitude.</li>
</ul></li>

<li>glm::distance(vec1, vec2)
<ul class="org-ul">
<li>=&gt; Distance between two vectors thatrepresents position.</li>
</ul></li>

<li>glm::cross(vec1, vec2)
<ul class="org-ul">
<li>=&gt; Returns the cross product between two vectors.</li>
</ul></li>
</ul>

<p>
<b>Subroutine for Camera Implementation</b>
</p>

<p>
Camera's View Matrix:
</p>

<ul class="org-ul">
<li>glm::mat4 <span class="underline">glm::lookAt</span> (eye, look, up );
<ul class="org-ul">
<li>Brief: Return <b>View matrix transform</b> - which transforms world coordinates to camera's space coordinates.</li>
<li>eye  =&gt; Vector containing the camera's current position in world coordinates.</li>
<li>look =&gt; Vector (Position) to where camera is looking at.</li>
<li>up   =&gt; Camera orientation. Suitable fault value Y axis or (x =  0, y = 1, z = 0).</li>
</ul></li>
</ul>

<p>
Camera's Projection Matrix:
</p>

<ul class="org-ul">
<li>glm::mat4 <span class="underline">glm::perspective</span> ( fovy, float aspect, near, far);
<ul class="org-ul">
<li>Returns projection matrix that transforms camera-space
coordinates to clip-space coordinates (NDC - Normalized Device
Coordinates within range -1.0 to 1.0). Anything out of the <span class="underline">near</span>,
<span class="underline">far</span> range is not visible.</li>
<li>fovy =&gt; Field view angle in radians.</li>
<li>near =&gt; Distance to near plane.</li>
<li>far  =&gt; Distance to far plane.</li>
</ul></li>

<li>glm::mat4 <span class="underline">glm::ortho</span> ( left, right, bottom, top );
<ul class="org-ul">
<li>Returns a projection matrix for ortographic projection. This
type projection is most suitable for 2D drawing; CAD - Computer
Aided Design; Technical drawing view and on.</li>
</ul></li>
</ul>


<p>
<b>GLM functions - transform matrix multiplication order</b>
</p>

<p>
Consider the subroutine, glm::translate() - which translate a
coordinate system.
</p>

<pre class="example">
glm::mat4 SOURCE_MATRIX = something();
glm::mat4 OUTPUT_MATRIX =  glm::translate( SOURCE_MATRIX, glm::vec3(DX, DY, DZ));
</pre>

<p>
GLM computes the OUTPUT_MATRIX by performing the matrix multiplication
in the following way. The same logic is applicable to the subroutines:
glm::rotate, glm::scale and so on.
</p>

<div class="org-src-container">
<pre class="src src-cpp">OUTPUT_MATRIX = SOURCE_MATRIX * Translate_Transform<span class="org-rainbow-delimiters-depth-1">(</span>DX, DY, DZ<span class="org-rainbow-delimiters-depth-1">)</span>

                                | 1  0  0  DX |
OUTPUT_MATRIX = SOURCE_MATRIX * | 0  1  0  DY |
                                | 0  0  1  DZ |
                                | 0  0  0  1  |
</pre>
</div>

<p>
Consider the following sequence of operations:
</p>

<div class="org-src-container">
<pre class="src src-cpp"> <span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">vec4</span> <span class="org-variable-name">axis_Z</span> = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>0, 0, 1<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Reset model matrix to identity matrix</span>
 <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">model</span><span class="org-rainbow-delimiters-depth-1">(</span>1.0<span class="org-rainbow-delimiters-depth-1">)</span>;

 <span class="org-comment-delimiter">// </span><span class="org-comment">Move to (X, Y) position</span>
 <span class="org-comment-delimiter">// </span><span class="org-comment">model = model * T_translate(_x, y, 0.0)</span>
 <span class="org-comment-delimiter">// </span><span class="org-comment">model = identity * T_translate(_x, y, 0.0) = T_translate(_x, y, 0.0)</span>
 model = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-1">(</span> model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>_x, _y, 0.0<span class="org-rainbow-delimiters-depth-2">)</span>  <span class="org-rainbow-delimiters-depth-1">)</span>;

 <span class="org-comment-delimiter">// </span><span class="org-comment">Scale object (increase or decrease object size)</span>
 <span class="org-comment-delimiter">// </span><span class="org-comment">model = model * T_scale</span>
 <span class="org-comment-delimiter">// </span><span class="org-comment">model = T_translate * T_scale</span>
 model =  <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-1">(</span> model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>_scale, _scale, _scale<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>;

 <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate from a given angle around Z axis at current object X, Y  postion</span>
 <span class="org-comment-delimiter">// </span><span class="org-comment">model = model * T_rotation</span>
 <span class="org-comment-delimiter">// </span><span class="org-comment">model =  (T_translate * T_scale) * T_rot</span>
 model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-1">(</span> model, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>_angle<span class="org-rainbow-delimiters-depth-2">)</span>,  axis_Z<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
The final value of the model matrix, is product between the following
affine transforms:
</p>

<div class="org-src-container">
<pre class="src src-text">model  =  Identity * T_translate * T_scale * T_rotation
model  =  T_translate * T_scale * T_rotation
</pre>
</div>
</div>
</div>

<div id="outline-container-org5823891" class="outline-4">
<h4 id="org5823891"><span class="section-number-4">1.10.2</span> Testing in CERN's Root REPL</h4>
<div class="outline-text-4" id="text-1-10-2">
<p>
<b>Download Library Source</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">$ mkdir -p /tmp/temp &amp;&amp; <span class="org-builtin">cd</span> /temp

<span class="org-comment-delimiter"># </span><span class="org-comment">Download source code archive</span>
$ &gt;&gt; curl -o <span class="org-keyword">glm.zip</span> -L https://github.com/g-truc/glm/archive/master.zip

<span class="org-comment-delimiter"># </span><span class="org-comment">Extract code</span>
$ &gt;&gt; unzip  glm.zip

<span class="org-comment-delimiter"># </span><span class="org-comment">Enter the in the extracted directory</span>
$ &gt;&gt; cd glm-master/

<span class="org-comment-delimiter"># </span><span class="org-comment">List directory content</span>
$ &gt;&gt; ls
cmake/  CMakeLists.txt  copying.txt  doc/  glm/  manual.md  readme.md  test/  util/
</pre>
</div>

<p>
<b>Load the library in CERN's ROOT repl</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp"> $ &gt;&gt; ~/Applications/root/bin/root
ERROR in <span class="org-constant">cling</span>::<span class="org-constant">CIFactory</span>::createCI<span class="org-rainbow-delimiters-depth-1">()</span>: cannot extract standard library <span class="org-type">include</span> <span class="org-variable-name">paths</span><span class="org-negation-char">!</span>
<span class="org-function-name">Invoking</span>:
  LC_ALL=C ccache  -O2 -DNDEBUG -xc++ -E -v /dev/null 2&gt;&amp;1 | sed -n -e <span class="org-warning">'</span>/^.include/,$<span class="org-rainbow-delimiters-depth-1">{</span><span class="org-warning">'</span> -e <span class="org-warning">'</span>/^ \/.*++/p<span class="org-warning">'</span> -e <span class="org-string">'}'</span>
Results was:
With exit code 0
   ------------------------------------------------------------------
  | Welcome to ROOT 6.22/02                        https:<span class="org-comment-delimiter">//</span><span class="org-comment">root.cern |</span>
  | <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">c</span><span class="org-rainbow-delimiters-depth-2">)</span> 1995-2020, The <span class="org-type">ROOT</span> <span class="org-variable-name">Team</span>; <span class="org-constant">conception</span>: R. Brun, F. Rademakers |
  | Built <span class="org-keyword">for</span> linuxx8664gcc on Aug 17 2020, 12:46:52                 |
  | From tags/v6-22-02@v6-22-02                                      |
  | Try <span class="org-warning">'</span>.help<span class="org-warning">'</span>, <span class="org-warning">'</span>.demo<span class="org-warning">'</span>, <span class="org-warning">'</span>.license<span class="org-warning">'</span>, <span class="org-warning">'</span>.credits<span class="org-warning">'</span>, <span class="org-warning">'</span>.quit<span class="org-string">'/'</span>.q<span class="org-warning">'</span>       |
   ------------------------------------------------------------------

root <span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span>

root <span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span> .I .

root <span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span> .I .
root <span class="org-rainbow-delimiters-depth-2">[</span>1<span class="org-rainbow-delimiters-depth-2">]</span> #<span class="org-type">include</span> <span class="org-rainbow-delimiters-depth-2">&lt;</span>glm/glm.hpp<span class="org-rainbow-delimiters-depth-2">&gt;</span>
root <span class="org-rainbow-delimiters-depth-2">[</span>2<span class="org-rainbow-delimiters-depth-2">]</span> #<span class="org-type">include</span> <span class="org-rainbow-delimiters-depth-2">&lt;</span>glm/gtc/matrix_transform.hpp<span class="org-rainbow-delimiters-depth-2">&gt;</span>
root <span class="org-rainbow-delimiters-depth-2">[</span>3<span class="org-rainbow-delimiters-depth-2">]</span> #<span class="org-type">include</span> <span class="org-rainbow-delimiters-depth-2">&lt;</span>glm/gtc/type_ptr.hpp<span class="org-rainbow-delimiters-depth-2">&gt;</span>
root <span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span> #<span class="org-type">include</span> <span class="org-rainbow-delimiters-depth-2">&lt;</span>glm/gtx/string_cast.hpp<span class="org-rainbow-delimiters-depth-2">&gt;</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Note: GLM matrices are stored in Column-major order</span>
<span class="org-type">void</span> show_matrix<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">label</span>, <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">m</span><span class="org-rainbow-delimiters-depth-2">){</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"\n [MATRIX] "</span> &lt;&lt; label &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::fixed &lt;&lt; <span class="org-constant">std</span>::setprecision<span class="org-rainbow-delimiters-depth-3">(</span>3<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0; i &lt; 4; i++<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">{</span>
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">size_t</span> <span class="org-variable-name">j</span> = 0; j &lt; 4; j++<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">{</span>
            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-constant">std</span>::setw<span class="org-rainbow-delimiters-depth-5">(</span>8<span class="org-rainbow-delimiters-depth-5">)</span> &lt;&lt; m<span class="org-rainbow-delimiters-depth-5">[</span>j<span class="org-rainbow-delimiters-depth-5">][</span>i<span class="org-rainbow-delimiters-depth-5">]</span>;
        <span class="org-rainbow-delimiters-depth-4">}</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-rainbow-delimiters-depth-3">}</span>
<span class="org-rainbow-delimiters-depth-2">}</span>
</pre>
</div>


<p>
Construct a matrix from column vectors:
</p>

\begin{equation}
   \text{colum}_0 = \begin{bmatrix}  25   \\ 40 \\   7 \\ 0    \end{bmatrix} \quad
   \text{colum}_1 = \begin{bmatrix}   8   \\ 9  \\  10 \\ 0    \end{bmatrix} \quad
   \text{colum}_2 = \begin{bmatrix}  -5   \\ 6  \\   9 \\ 0    \end{bmatrix} \quad
   \text{colum}_3 = \begin{bmatrix} 100   \\ 50 \\  20 \\ 1    \end{bmatrix}
\end{equation}


\begin{equation}
   M = \begin{bmatrix} \text{colum}_0  &\text{colum}_1 & \text{colum}_2 & \text{colum}_3 \end{bmatrix}
\end{equation}

\begin{equation}
   M = \begin{bmatrix}
            25  &  8  & -5  &  100 \\
            40  &  9  &  6  &   50 \\
             7  & 10  &  9  &   20 \\
             0  &  0  &  0  &    1 \\
       \end{bmatrix}
\end{equation}


<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">auto</span> <span class="org-variable-name">col0</span> = <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-1">(</span>25, 40, 7, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">col1</span> = <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-1">(</span>8, 9, 10, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">col2</span> = <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-1">(</span>-5, 6, 9, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">col3</span> = <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-1">(</span>100, 50, 20, 1<span class="org-rainbow-delimiters-depth-1">)</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>9<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> M = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-1">(</span>col0, col1, col2, col3<span class="org-rainbow-delimiters-depth-1">)</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>24<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"M"</span>, M<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> M =
  25.000   8.000  -5.000 100.000
  40.000   9.000   6.000  50.000
   7.000  10.000   9.000  20.000
   0.000   0.000   0.000   1.000
</pre>
</div>

<p>
This matrix could also be constructed in the following mode:
</p>

<div class="org-src-container">
<pre class="src src-cpp"> <span class="org-keyword">auto</span> <span class="org-variable-name">MM</span> = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-1">(</span>25, 40, 7, 0  ,8, 9, 10, 0  ,-5, 6, 9, 0 ,100, 50, 20, 1<span class="org-rainbow-delimiters-depth-1">)</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>27<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"MM"</span>, MM<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> MM =
  25.000   8.000  -5.000 100.000
  40.000   9.000   6.000  50.000
   7.000  10.000   9.000  20.000
   0.000   0.000   0.000   1.000

<span class="org-comment-delimiter">// </span><span class="org-comment">Note: It shows the matrix columns, not the matix rows.</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>39<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>M<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"mat4x4((25.000000, 40.000000, 7.000000, 0.000000), (8.000000, 9.000000, 10.000000, 0.000000), (-5.000000, 6.000000, 9.000000, 0.000000), (100.000000, 50.000000, 20.000000, 1.000000))"</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>40<span class="org-rainbow-delimiters-depth-1">]</span>

</pre>
</div>

<p>
Extract columns from matrix MM:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_access.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">auto</span> <span class="org-variable-name">col0</span> = <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-1">(</span>MM, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">col1</span> = <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-1">(</span>MM, 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">col2</span> = <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-1">(</span>MM, 2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">col3</span> = <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-1">(</span>MM, 3<span class="org-rainbow-delimiters-depth-1">)</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>58<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>col0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(25.000000, 40.000000, 7.000000, 0.000000)"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>60<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>col1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(8.000000, 9.000000, 10.000000, 0.000000)"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>62<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>col2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(-5.000000, 6.000000, 9.000000, 0.000000)"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>64<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>col3<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(100.000000, 50.000000, 20.000000, 1.000000)"</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Get elements from column 0 (col0)</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>65<span class="org-rainbow-delimiters-depth-1">]</span> col0<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 25.0000f

root <span class="org-rainbow-delimiters-depth-1">[</span>66<span class="org-rainbow-delimiters-depth-1">]</span> col0<span class="org-rainbow-delimiters-depth-1">[</span>1<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 40.0000f

root <span class="org-rainbow-delimiters-depth-1">[</span>67<span class="org-rainbow-delimiters-depth-1">]</span> col0<span class="org-rainbow-delimiters-depth-1">[</span>2<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 7.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>68<span class="org-rainbow-delimiters-depth-1">]</span> col0<span class="org-rainbow-delimiters-depth-1">[</span>3<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.00000f
</pre>
</div>

<p>
Extract rows from matrix MM:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">auto</span> <span class="org-variable-name">row0</span> = <span class="org-constant">glm</span>::row<span class="org-rainbow-delimiters-depth-1">(</span>MM, 0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">row1</span> = <span class="org-constant">glm</span>::row<span class="org-rainbow-delimiters-depth-1">(</span>MM, 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">row2</span> = <span class="org-constant">glm</span>::row<span class="org-rainbow-delimiters-depth-1">(</span>MM, 2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">row3</span> = <span class="org-constant">glm</span>::row<span class="org-rainbow-delimiters-depth-1">(</span>MM, 3<span class="org-rainbow-delimiters-depth-1">)</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>73<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>row0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(25.000000, 8.000000, -5.000000, 100.000000)"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>74<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>row1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(40.000000, 9.000000, 6.000000, 50.000000)"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>75<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>row2<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(7.000000, 10.000000, 9.000000, 20.000000)"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>76<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>row3<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(0.000000, 0.000000, 0.000000, 1.000000)"</span>
</pre>
</div>

<p>
Modify matrix columns:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>77<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"MM"</span>, MM<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> MM =
  25.000   8.000  -5.000 100.000
  40.000   9.000   6.000  50.000
   7.000  10.000   9.000  20.000
   0.000   0.000   0.000   1.000

root <span class="org-rainbow-delimiters-depth-1">[</span>80<span class="org-rainbow-delimiters-depth-1">]</span> MM<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">]</span> = <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-1">(</span>-90.f, 50.0f, 32.5f, 26.0f<span class="org-rainbow-delimiters-depth-1">)</span>


root <span class="org-rainbow-delimiters-depth-1">[</span>81<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"MM"</span>, MM<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> MM =
 -90.000   8.000  -5.000 100.000
  50.000   9.000   6.000  50.000
  32.500  10.000   9.000  20.000
  26.000   0.000   0.000   1.000
</pre>
</div>


<p>
Obtain transpose matrix:
</p>

<div class="org-src-container">
<pre class="src src-cpp"> root <span class="org-rainbow-delimiters-depth-1">[</span>82<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> tmat = <span class="org-constant">glm</span>::transpose<span class="org-rainbow-delimiters-depth-1">(</span>MM<span class="org-rainbow-delimiters-depth-1">)</span>
 <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f7b71f0c20c


 root <span class="org-rainbow-delimiters-depth-1">[</span>83<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"tmat"</span>, tmat<span class="org-rainbow-delimiters-depth-1">)</span>

  <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> tmat =
  -90.000  50.000  32.500  26.000
    8.000   9.000  10.000   0.000
   -5.000   6.000   9.000   0.000
  100.000  50.000  20.000   1.000

<span class="org-comment-delimiter">// </span><span class="org-comment">----- Access first column elements (column 0) ----//</span>
<span class="org-comment-delimiter">//  </span><span class="org-comment">=&gt;&gt; The matrix is column-major order (Fortran-like data layout),</span>
<span class="org-comment-delimiter">//      </span><span class="org-comment">not C or C++ data-layout, which is row-major order</span>
<span class="org-comment-delimiter">//</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Tmat[j column-number][i row-number]</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">----- Column 0 elements ----------//</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>84<span class="org-rainbow-delimiters-depth-1">]</span> tmat<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">][</span>0<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> -90.0000f

root <span class="org-rainbow-delimiters-depth-1">[</span>85<span class="org-rainbow-delimiters-depth-1">]</span> tmat<span class="org-rainbow-delimiters-depth-1">[</span>1<span class="org-rainbow-delimiters-depth-1">][</span>0<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 50.0000f

root <span class="org-rainbow-delimiters-depth-1">[</span>86<span class="org-rainbow-delimiters-depth-1">]</span> tmat<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">][</span>0<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> -90.0000f

root <span class="org-rainbow-delimiters-depth-1">[</span>87<span class="org-rainbow-delimiters-depth-1">]</span> tmat<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">][</span>1<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 8.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>88<span class="org-rainbow-delimiters-depth-1">]</span> tmat<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">][</span>2<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> -5.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>89<span class="org-rainbow-delimiters-depth-1">]</span> tmat<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">][</span>3<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 100.000f
</pre>
</div>

<p>
Get pointer to first element:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>90<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-type">float</span>* ptr = <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-1">(</span>tmat<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> *<span class="org-rainbow-delimiters-depth-1">)</span> 0x7f7b71f0c20c

root <span class="org-rainbow-delimiters-depth-1">[</span>91<span class="org-rainbow-delimiters-depth-1">]</span> ptr<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> -90.0000f

root <span class="org-rainbow-delimiters-depth-1">[</span>92<span class="org-rainbow-delimiters-depth-1">]</span> ptr<span class="org-rainbow-delimiters-depth-1">[</span>1<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 8.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>93<span class="org-rainbow-delimiters-depth-1">]</span> ptr<span class="org-rainbow-delimiters-depth-1">[</span>15<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 1.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>94<span class="org-rainbow-delimiters-depth-1">]</span> ptr<span class="org-rainbow-delimiters-depth-1">[</span>10<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 9.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>95<span class="org-rainbow-delimiters-depth-1">]</span> *<span class="org-rainbow-delimiters-depth-1">(</span>ptr + 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 8.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>96<span class="org-rainbow-delimiters-depth-1">]</span> *<span class="org-rainbow-delimiters-depth-1">(</span>ptr + 10<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 9.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>97<span class="org-rainbow-delimiters-depth-1">]</span> *<span class="org-rainbow-delimiters-depth-1">(</span>ptr + 15<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 1.00000f
</pre>
</div>

<p>
Null 4x4 matrix:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>53<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> zero_4x4 = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c20e0

root <span class="org-rainbow-delimiters-depth-1">[</span>54<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"zero_4x4"</span>, zero_4x4<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> zero_4x4 =
   0.000   0.000   0.000   0.000
   0.000   0.000   0.000   0.000
   0.000   0.000   0.000   0.000
   0.000   0.000   0.000   0.000
</pre>
</div>

<p>
Identity matrix:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>55<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> id_4x4 = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-1">(</span>1.0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c2120
root <span class="org-rainbow-delimiters-depth-1">[</span>56<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>56<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"id_4x4"</span>, id_4x4<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> id_4x4 =
   1.000   0.000   0.000   0.000
   0.000   1.000   0.000   0.000
   0.000   0.000   1.000   0.000
   0.000   0.000   0.000   1.000
</pre>
</div>

<p>
Matrix translation coordinate transform:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>58<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> t1 = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-1">(</span>id_4x4, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>2.0, 10.0, 30.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c2160

root <span class="org-rainbow-delimiters-depth-1">[</span>59<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"t1"</span>, t1<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> t1 =
   1.000   0.000   0.000   2.000
   0.000   1.000   0.000  10.000
   0.000   0.000   1.000  30.000
   0.000   0.000   0.000   1.000


root <span class="org-rainbow-delimiters-depth-1">[</span>62<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> t2 = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-1">(</span>t1, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>-10, 100.0, 200.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c21a0

root <span class="org-rainbow-delimiters-depth-1">[</span>63<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"t2"</span>, t2<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> t2 =
   1.000   0.000   0.000  -8.000
   0.000   1.000   0.000 110.000
   0.000   0.000   1.000 230.000
   0.000   0.000   0.000   1.000
</pre>
</div>

<p>
Rotation around Z axis of 90 degrees:
</p>

<ul class="org-ul">
<li>glm::mat4 glm::rotate(glm::mat4 const&amp; matrix, float angle_radians, glm::vec3 const&amp; axis)</li>
<li>Rotate around a given axis. The angle is given in radians.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>65<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">const</span> <span class="org-keyword">auto</span> axis_z = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>0.0f, 0.0f, 1.0f<span class="org-rainbow-delimiters-depth-1">)</span>;
root <span class="org-rainbow-delimiters-depth-1">[</span>66<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">const</span> <span class="org-keyword">auto</span> axis_y = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>0.0f, 1.0f, 0.0f<span class="org-rainbow-delimiters-depth-1">)</span>;
root <span class="org-rainbow-delimiters-depth-1">[</span>67<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">const</span> <span class="org-keyword">auto</span> axis_x = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">(</span>1.0f, 0.0f, 0.0f<span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-comment-delimiter">/*          </span><span class="org-comment">| cos(t)  -sin(t)   0   0  |</span>
<span class="org-comment"> *          | sin(t)   cos(t)   0   0  |</span>
<span class="org-comment"> *  Rz(t) = |  0        0       1   0  |</span>
<span class="org-comment"> *          |  0        0       0   1  |</span>
<span class="org-comment"> *</span>
<span class="org-comment"> *</span>
<span class="org-comment"> *  t_rotZ = Rz(90) x id_4x4 = Rz(90)</span>
<span class="org-comment"> */</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>71<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> t_rotZ = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-1">(</span>id_4x4, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>90.0f<span class="org-rainbow-delimiters-depth-2">)</span>, axis_z<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c2204

root <span class="org-rainbow-delimiters-depth-1">[</span>72<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"t_rotZ"</span>, t_rotZ<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> t_rotZ =
  -0.000  -1.000   0.000   0.000
   1.000  -0.000   0.000   0.000
   0.000   0.000   1.000   0.000
   0.000   0.000   0.000   1.000
root <span class="org-rainbow-delimiters-depth-1">[</span>73<span class="org-rainbow-delimiters-depth-1">]</span>

 root <span class="org-rainbow-delimiters-depth-1">[</span>96<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>t_rotZ<span class="org-rainbow-delimiters-depth-1">)</span>
 <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"mat4x4((-0.000000, 1.000000, 0.000000, 0.000000), ... "</span>
 root <span class="org-rainbow-delimiters-depth-1">[</span>97<span class="org-rainbow-delimiters-depth-1">]</span>
</pre>
</div>

<p>
Scaling transformation:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>75<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> s1 = <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-1">(</span>id_4x4, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>2.0, 2.0, 2.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c2244

root <span class="org-rainbow-delimiters-depth-1">[</span>76<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"s1"</span>, s1<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> s1 =
   2.000   0.000   0.000   0.000
   0.000   2.000   0.000   0.000
   0.000   0.000   2.000   0.000
   0.000   0.000   0.000   1.000

root <span class="org-rainbow-delimiters-depth-1">[</span>78<span class="org-rainbow-delimiters-depth-1">]</span> s1 = <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-1">(</span>s1, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>5.0, 5.0, 5.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c2244

root <span class="org-rainbow-delimiters-depth-1">[</span>79<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"s1"</span>, s1<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> s1 =
  10.000   0.000   0.000   0.000
   0.000  10.000   0.000   0.000
   0.000   0.000  10.000   0.000
   0.000   0.000   0.000   1.000
root <span class="org-rainbow-delimiters-depth-1">[</span>80<span class="org-rainbow-delimiters-depth-1">]</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Apply transform to vector:</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>82<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> res = s1 * <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-1">(</span>2.0, 5.0, 10.0, 1.0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">vec</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c2284

root <span class="org-rainbow-delimiters-depth-1">[</span>91<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>res<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(20.000000, 50.000000, 100.000000, 1.000000)"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>92<span class="org-rainbow-delimiters-depth-1">]</span> res<span class="org-rainbow-delimiters-depth-1">[</span>0<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 20.0000f

root <span class="org-rainbow-delimiters-depth-1">[</span>93<span class="org-rainbow-delimiters-depth-1">]</span> res<span class="org-rainbow-delimiters-depth-1">[</span>1<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 50.0000f

root <span class="org-rainbow-delimiters-depth-1">[</span>94<span class="org-rainbow-delimiters-depth-1">]</span> res<span class="org-rainbow-delimiters-depth-1">[</span>2<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 100.000f

root <span class="org-rainbow-delimiters-depth-1">[</span>95<span class="org-rainbow-delimiters-depth-1">]</span> res<span class="org-rainbow-delimiters-depth-1">[</span>3<span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 1.00000f
</pre>
</div>

<p>
Scaling transformation:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>97<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> s = <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-1">(</span>id_4x4, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>4.0, 5.0, 6.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c22a4

root <span class="org-rainbow-delimiters-depth-1">[</span>98<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"s"</span>, s<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> s =
   4.000   0.000   0.000   0.000
   0.000   5.000   0.000   0.000
   0.000   0.000   6.000   0.000
   0.000   0.000   0.000   1.000
root <span class="org-rainbow-delimiters-depth-1">[</span>99<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>99<span class="org-rainbow-delimiters-depth-1">]</span> s = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-1">(</span>s, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>4, -5, 9<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c22a4


root <span class="org-rainbow-delimiters-depth-1">[</span>100<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"s"</span>, s<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> s =
   4.000   0.000   0.000  16.000
   0.000   5.000   0.000 -25.000
   0.000   0.000   6.000  54.000
   0.000   0.000   0.000   1.000
root <span class="org-rainbow-delimiters-depth-1">[</span>101<span class="org-rainbow-delimiters-depth-1">]</span>


root <span class="org-rainbow-delimiters-depth-1">[</span>105<span class="org-rainbow-delimiters-depth-1">]</span> s = <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-1">(</span>s, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>5.0, 2.0, 3.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c22a4


root <span class="org-rainbow-delimiters-depth-1">[</span>106<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"s"</span>, s<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> s =
  25.000   0.000   0.000  20.000
   0.000   4.000   0.000 -10.000
   0.000   0.000   9.000  27.000
   0.000   0.000   0.000   1.000
</pre>
</div>

<p>
Inverse matrix:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>111<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"s"</span>, s<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> s =
  25.000   0.000   0.000  20.000
   0.000   4.000   0.000 -10.000
   0.000   0.000   9.000  27.000
   0.000   0.000   0.000   1.000

root <span class="org-rainbow-delimiters-depth-1">[</span>112<span class="org-rainbow-delimiters-depth-1">]</span> inv_s = <span class="org-constant">glm</span>::inverse<span class="org-rainbow-delimiters-depth-1">(</span>s<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">mat</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>4, 4, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7f904e6c2324

root <span class="org-rainbow-delimiters-depth-1">[</span>113<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"inv_s"</span>, inv_s<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> inv_s =
   0.040  -0.000   0.000  -0.800
  -0.000   0.250  -0.000   2.500
   0.000  -0.000   0.111  -3.000
  -0.000   0.000  -0.000   1.000
root <span class="org-rainbow-delimiters-depth-1">[</span>114<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>114<span class="org-rainbow-delimiters-depth-1">]</span>

</pre>
</div>


<p>
<b>GLM Quaternions</b>
</p>

<p>
Create an identity quaternion, which represents no rotation.
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>26<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> q = <span class="org-constant">glm</span>::quat<span class="org-rainbow-delimiters-depth-1">(</span>1.0, 0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">qua</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e6020

root <span class="org-rainbow-delimiters-depth-1">[</span>27<span class="org-rainbow-delimiters-depth-1">]</span> q.x
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.00000f
root <span class="org-rainbow-delimiters-depth-1">[</span>28<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>28<span class="org-rainbow-delimiters-depth-1">]</span> q.y
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.00000f
root <span class="org-rainbow-delimiters-depth-1">[</span>29<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>29<span class="org-rainbow-delimiters-depth-1">]</span> q.z
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.00000f
root <span class="org-rainbow-delimiters-depth-1">[</span>30<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>30<span class="org-rainbow-delimiters-depth-1">]</span> q.w
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 1.00000f
root <span class="org-rainbow-delimiters-depth-1">[</span>31<span class="org-rainbow-delimiters-depth-1">]</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>31<span class="org-rainbow-delimiters-depth-1">]</span>
</pre>
</div>

<p>
Create a quaternion that represents a rotation of 90 degrees around Z
axis:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>39<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> qrot_z = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>90.0f<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">{</span>0.0f, 0.0f, 1.0f<span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">qua</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e6050

root <span class="org-rainbow-delimiters-depth-1">[</span>40<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>qrot_z<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"quat(0.707107, {0.000000, 0.000000, 0.707107})"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>42<span class="org-rainbow-delimiters-depth-1">]</span> qrot_z.w
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.707107f

root <span class="org-rainbow-delimiters-depth-1">[</span>43<span class="org-rainbow-delimiters-depth-1">]</span> qrot_z.x
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>44<span class="org-rainbow-delimiters-depth-1">]</span> qrot_z.y
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.00000f

root <span class="org-rainbow-delimiters-depth-1">[</span>45<span class="org-rainbow-delimiters-depth-1">]</span> qrot_z.z
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.707107f
</pre>
</div>

<p>
Get quaternion angle:
</p>

<div class="org-src-container">
<pre class="src src-cpp">
<span class="org-comment-delimiter">// </span><span class="org-comment">Angle in radians.</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>61<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::angle<span class="org-rainbow-delimiters-depth-1">(</span>qrot_z<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 1.57080f

<span class="org-comment-delimiter">// </span><span class="org-comment">Angle in degrees</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>62<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::angle<span class="org-rainbow-delimiters-depth-1">(</span>qrot_z<span class="org-rainbow-delimiters-depth-1">)</span> * 180.0 / M_PI
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 90.000003
</pre>
</div>

<p>
Get quaternion rotation axis vector:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>63<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> axis = <span class="org-constant">glm</span>::axis<span class="org-rainbow-delimiters-depth-1">(</span>qrot_z<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">vec</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>3, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e6150

root <span class="org-rainbow-delimiters-depth-1">[</span>64<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>axis<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec3(0.000000, 0.000000, 1.000000)"</span>
</pre>
</div>

<p>
Determine quaternion conjugate:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Conjugate</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>68<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> res = <span class="org-constant">glm</span>::conjugate<span class="org-rainbow-delimiters-depth-1">(</span>qrot_z<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">qua</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e616c

root <span class="org-rainbow-delimiters-depth-1">[</span>69<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>res<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"quat(0.707107, {-0.000000, -0.000000, -0.707107})"</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>71<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span> qrot_z * res <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"quat(1.000000, {0.000000, 0.000000, 0.000000})"</span>
</pre>
</div>

<p>
Determine quaternion inverse:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>72<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-constant">glm</span>::inverse<span class="org-rainbow-delimiters-depth-2">(</span>qrot_z<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"quat(0.707107, {-0.000000, -0.000000, -0.707107})"</span>
</pre>
</div>

<p>
Computer quaternion norm (aka magnitude):
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>74<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::length<span class="org-rainbow-delimiters-depth-1">(</span>qrot_z<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 1.00000f
</pre>
</div>


<p>
Turn the previous quaternion in to a rotation matrix:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>47<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> TrotZ1 = <span class="org-constant">glm</span>::mat4_cast<span class="org-rainbow-delimiters-depth-1">(</span>qrot_z<span class="org-rainbow-delimiters-depth-1">)</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>48<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"TrotZ1"</span>, TrotZ1<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> TrotZ1 =
   0.000  -1.000   0.000   0.000
   1.000   0.000   0.000   0.000
   0.000   0.000   1.000   0.000
   0.000   0.000   0.000   1.000

<span class="org-comment-delimiter">// </span><span class="org-comment">------------ Confirm result ------------//</span>
<span class="org-comment-delimiter">//</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>51<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> TrotZ2 = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>90.0f<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">(</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>52<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"TrotZ2"</span>, TrotZ2<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> TrotZ2 =
  -0.000  -1.000   0.000   0.000
   1.000  -0.000   0.000   0.000
   0.000   0.000   1.000   0.000
   0.000   0.000   0.000   1.000

</pre>
</div>

<p>
Rotate a vector with the quaternion <span class="underline">qrot_z</span>:
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>57<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> v = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-1">{</span>1.0f, 0.0f, 0.0f<span class="org-rainbow-delimiters-depth-1">}</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">vec</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>3, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e6138

<span class="org-comment-delimiter">// </span><span class="org-comment">Rotating a vector just requires multiplication.</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>59<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> rotated_v = qrot_z * v
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">vec</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>3, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e6144

root <span class="org-rainbow-delimiters-depth-1">[</span>60<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span>rotated_v<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec3(0.000000, 1.000000, 0.000000)"</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Rotate the same vector with a rotation matrix.</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>79<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span> TrotZ2 * <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-2">(</span>1.0, 0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec4(-0.000000, 1.000000, 0.000000, 0.000000)"</span>
</pre>
</div>

<p>
New rotation around Y axis about 60 degrees.
</p>

<div class="org-src-container">
<pre class="src src-cpp">root <span class="org-rainbow-delimiters-depth-1">[</span>80<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> q = qrot_z
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">qua</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e617c

<span class="org-comment-delimiter">// </span><span class="org-comment">---------- Before rotation ------------</span>
<span class="org-comment-delimiter">//</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>81<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span> q <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"quat(0.707107, {0.000000, 0.000000, 0.707107})"</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- After rotation ----------------//</span>
<span class="org-comment-delimiter">//</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>84<span class="org-rainbow-delimiters-depth-1">]</span> q = q * <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>60.0f<span class="org-rainbow-delimiters-depth-2">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-2">{</span>0.0, 0.1, 0.0<span class="org-rainbow-delimiters-depth-2">}</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">qua</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span>, <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">qualifier</span><span class="org-rainbow-delimiters-depth-3">)</span>0U<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e617c

root <span class="org-rainbow-delimiters-depth-1">[</span>85<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span> q <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"quat(0.612372, {-0.035355, 0.035355, 0.612372})"</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- Get Rotation Matrix -----------//</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>86<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> m = <span class="org-constant">glm</span>::mat4_cast<span class="org-rainbow-delimiters-depth-1">(</span>q<span class="org-rainbow-delimiters-depth-1">)</span>

root <span class="org-rainbow-delimiters-depth-1">[</span>88<span class="org-rainbow-delimiters-depth-1">]</span> show_matrix<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"m"</span>, m<span class="org-rainbow-delimiters-depth-1">)</span>

 <span class="org-rainbow-delimiters-depth-1">[</span>MATRIX<span class="org-rainbow-delimiters-depth-1">]</span> m =
   0.248  -0.752   0.000   0.000
   0.747   0.248   0.087   0.000
  -0.087   0.000   0.995   0.000
   0.000   0.000   0.000   1.000

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- Get total rotation angle and axis ---------//</span>
<span class="org-comment-delimiter">//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Get new rotation axis</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>89<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-keyword">auto</span> axis = <span class="org-constant">glm</span>::axis<span class="org-rainbow-delimiters-depth-1">(</span>q<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">glm</span>::<span class="org-type">vec</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>3, <span class="org-type">float</span>, <span class="org-constant">glm</span>::<span class="org-constant">qualifier</span>::packed_highp<span class="org-rainbow-delimiters-depth-2">&gt;</span> &amp;<span class="org-rainbow-delimiters-depth-1">)</span> @0x7fc8b47e61cc

root <span class="org-rainbow-delimiters-depth-1">[</span>90<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-1">(</span> axis <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-string">"vec3(-0.044721, 0.044721, 0.774597)"</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Get rotation angle around new axis in radians</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>91<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::angle<span class="org-rainbow-delimiters-depth-1">(</span>q<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-1">)</span> 1.82348f

<span class="org-comment-delimiter">// </span><span class="org-comment">Get rotation angle around new axis in degrees</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>92<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::angle<span class="org-rainbow-delimiters-depth-1">(</span>q<span class="org-rainbow-delimiters-depth-1">)</span> * 180.0 / M_PI
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 104.47752


<span class="org-comment-delimiter">//</span><span class="org-comment">--------- Get Yaw, Pitch and Roll angles --------------------//</span>
<span class="org-comment-delimiter">//</span>
root <span class="org-rainbow-delimiters-depth-1">[</span>94<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::yaw<span class="org-rainbow-delimiters-depth-1">(</span>q<span class="org-rainbow-delimiters-depth-1">)</span> * 180.0 / M_PI
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 4.9681836

root <span class="org-rainbow-delimiters-depth-1">[</span>95<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::pitch<span class="org-rainbow-delimiters-depth-1">(</span>q<span class="org-rainbow-delimiters-depth-1">)</span> * 180.0 / M_PI
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 0.0000000

root <span class="org-rainbow-delimiters-depth-1">[</span>96<span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-constant">glm</span>::roll<span class="org-rainbow-delimiters-depth-1">(</span>q<span class="org-rainbow-delimiters-depth-1">)</span> * 180.0 / M_PI
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-1">)</span> 90.000003

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org0ec74bf" class="outline-3">
<h3 id="org0ec74bf"><span class="section-number-3">1.11</span> [DRAFT] Debugging Computer Graphics Code</h3>
<div class="outline-text-3" id="text-1-11">
<p>
Outline of techniques for debugging computer graphics code:
</p>

<ul class="org-ul">
<li>Use <span class="underline">right-hand rule</span> for finding rotation direction around some rotation axis.
<ul class="org-ul">
<li>See: <a href="https://en.wikipedia.org/wiki/Right-hand_rule">right-hand-rule</a></li>
</ul></li>

<li>Use <span class="underline">right-hand rule</span> for finding the result vector of a vector-product operation.</li>

<li>Print/display transform matrices.</li>

<li>Use assertions for validating code assumptions during runtime and
abort the process execution if the assertion predicate does not
hold.</li>

<li>Use print statements for tracing the code execution flow.</li>

<li>Draw X, Y, Z axis lines for visual debugging.</li>

<li>Check shader compilation error message and error code.</li>

<li>Check OpenGL error codes for every OpenGL subroutine calls.</li>

<li>Simulate and prototype linear algebra parts in a
numerically-oriented or scientific programming language such
Matlab, Octave or Julia.</li>

<li>Use a <span class="underline">debugger</span>, such as Windows Debugger, GDB, LLDB - LVM
Debugger, in the case of runtime crash due to failed assertions,
std::abort() calls, uncaught exceptions, Unix signals or
segmentation faults.</li>

<li>Use 3D standard test models for testing the 3D scene rendering. 
<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/List_of_common_3D_test_models">List of common 3D test models</a></li>
</ul></li>
</ul>

<p>
<b>Assertions</b>
</p>

<p>
The subroutine glGetUniformLocation() returns -1 as error code when it
fails to find a shader's uniform variable location named
'u_projection'.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable location for projection matrix</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">See shader code: "uniform mat4 projection;"</span>
<span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-1">(</span>prog, <span class="org-string">"u_projection"</span><span class="org-rainbow-delimiters-depth-1">)</span>;
assert<span class="org-rainbow-delimiters-depth-1">(</span> u_proj &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find u_projection uniform variable"</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
Assertions should be used for non-recoverable errors, checking
pre-conditions, post-conditons and invariant. Since assertions are
eliminated on non-debug builds, this assertion should be replaced by a
proper error checking. However, in this case, assertion are useful
for a prototyping code and during development time as a scaffolding
for a future error handling.
</p>


<p>
<b>Checking OpenGL error code</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor"> #define</span> <span class="org-function-name">GL_CHECK</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">funcall</span><span class="org-rainbow-delimiters-depth-1">)</span>\
     <span class="org-keyword">do</span> <span class="org-rainbow-delimiters-depth-1">{</span> \
         <span class="org-rainbow-delimiters-depth-2">(</span>funcall<span class="org-rainbow-delimiters-depth-2">)</span>; \
         <span class="org-type">GLint</span> <span class="org-variable-name">error</span> = glGetError<span class="org-rainbow-delimiters-depth-2">()</span>;  \
         <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>error == GL_NO_ERROR<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">break</span>; <span class="org-rainbow-delimiters-depth-2">}</span> \
         <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [OPENGL ERROR] Error code = %d ; line = %d ; call = '%s'  \n"</span> \
                       , error, __LINE__, #funcall <span class="org-rainbow-delimiters-depth-2">)</span>; \
         abort<span class="org-rainbow-delimiters-depth-2">()</span>; \
     <span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-1">(</span>0<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- Usage ---------------//</span>

   GL_CHECK<span class="org-rainbow-delimiters-depth-1">(</span> glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>model<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
   GL_CHECK<span class="org-rainbow-delimiters-depth-1">(</span> glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
   GL_CHECK<span class="org-rainbow-delimiters-depth-1">(</span> glDrawArrays<span class="org-rainbow-delimiters-depth-2">(</span>draw_type, 0, n_vertices<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>;

</pre>
</div>
</div>
</div>

<div id="outline-container-org168fd64" class="outline-3">
<h3 id="org168fd64"><span class="section-number-3">1.12</span> Minimal C++ GLFW project</h3>
<div class="outline-text-3" id="text-1-12">
<p>
The following code draws a square and a triangle using the OpenGL
retained mode API. Before the rendering takes place, data must be
upload to the VBO (Vertex Buffer Object), allocated on the GPU-side,
via <span class="underline">glBufferData()</span> call that sends the data to the previous bound VBO
through <span class="underline">glBindBuffer()</span> call. Then, on the rendering loop and on every
frame, the buffer data layout must described with
<span class="underline">glVertexAttribPointer()</span> before drawing via call to <span class="underline">glDrawArrays()</span>
subroutine, which draw vertices from the current bound buffer.
</p>

<p>
Subroutines that modifies global state may cause unintended behavior,
so it is a good practice to unset the affected global state when the
current global state is no longer needed. For instance, if the current
VBO no longer needs to be bound, this global state can be disabled by
calling <i>glBindBuffer(GL_ARRAY_BUFFER, 0)</i>.
</p>


<p>
OpenGL subroutines used:
</p>

<ul class="org-ul">
<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glGenBuffers.xhtml">glGenBuffers()</a> =&gt; Instantiate a buffer object.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">void</span> <span class="org-function-name">glGenBuffers</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLsizei</span> <span class="org-variable-name">n</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">buffers</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<ul class="org-ul">
<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glBindBuffer.xhtml">glBindBuffer()</a> =&gt; Bind some buffer object, a.k.a enable, only one
buffer can be bound at a time. (The VBO is a global state).</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">void</span> <span class="org-function-name">glBindBuffer</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLenum</span> <span class="org-variable-name">target</span>,<span class="org-type">nt</span> <span class="org-variable-name">buffer</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<ul class="org-ul">
<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glBufferData.xhtml">glBufferData()</a>  =&gt;&gt; Send data to current bound buffer object that
was bound via glBindBuffer() call.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">void</span> <span class="org-function-name">glBufferData</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLenum</span>      <span class="org-variable-name">target</span>,
                   <span class="org-type">GLsizeiptr</span>  <span class="org-variable-name">size</span>,
                   <span class="org-keyword">const</span> <span class="org-type">void</span>* <span class="org-variable-name">data</span>,
                   <span class="org-type">GLenum</span>      <span class="org-variable-name">usage</span>
                   <span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<ul class="org-ul">
<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glEnableVertexAttribArray.xhtml">glEnableVertexAttribArray()</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">void</span> <span class="org-function-name">glEnableVertexAttribArray</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">index</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<ul class="org-ul">
<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glVertexAttribPointer.xhtml">glVertexAttribPointer()</a>
<ul class="org-ul">
<li>Describes the data layout of current bound buffer.</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">void</span> <span class="org-function-name">glVertexAttribPointer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>      <span class="org-variable-name">index</span>,
                            <span class="org-type">GLint</span>       <span class="org-variable-name">size</span>,
                            <span class="org-type">GLenum</span>      <span class="org-variable-name">type</span>,
                            <span class="org-type">GLboolean</span>   <span class="org-variable-name">normalized</span>,
                            <span class="org-type">GLsizei</span>     <span class="org-variable-name">stride</span>,
                            <span class="org-keyword">const</span> <span class="org-type">void</span>* <span class="org-variable-name">pointer</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<ul class="org-ul">
<li><a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glDrawArrays.xhtml">glDrawArrays()</a> =&gt; Render OpenGL primitives from current bound
buffer object's data. Those primitives are: lines, triangles or
quads and so on.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">void</span> <span class="org-function-name">glDrawArrays</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLenum</span> <span class="org-variable-name">mode</span>, <span class="org-type">GLint</span> <span class="org-variable-name">first</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">count</span><span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>


<p>
<b>Screenshot</b>
</p>


<div class="figure">
<p><a href="images/opengl-draw2d-raw.png"><img src="images/opengl-draw2d-raw.png" alt="opengl-draw2d-raw.png" /></a>
</p>
</div>

<p>
<b>Source Code</b>
</p>

<ul class="org-ul">
<li>This CMakeLists.txt building script saves the user from manually
downloading, building, installing and configuring OpenGL Glew and
GLFW companion libraries. This file automatically downloads the
GLFW library, that provides window system abstraction and OpenGL
context; and a pre-compiled GLEW library (Windows only) that
provides platform-agnostic OpenGL function pointer loading.</li>

<li>The CMakeLists.txt (version 2) contains a macro for defining
OpenGL applications without the boilerplate needed for linking
against OpenGL companion libraries and statically linking against
MINGW runtimme libraries.</li>
</ul>

<p>
File: <span class="underline">CMakeLists.txt</span> (Version 1)
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(OpenGL_Draw2D_VBO)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download pre-compiled GLEW when building under Windows NT OS (x64)</span>
<span class="org-keyword">IF</span>(WIN32)
   <span class="org-function-name">FetchContent_Declare</span>(
      glew-release 
      URL  https://ufpr.dl.sourceforge.net/project/glew/glew/2.1.0/glew-2.1.0-win32.zip
      <span class="org-comment"># No longer valid URL </span>
      <span class="org-comment">## URL     https://megalink.dl.sourceforge.net/project/glew/glew/2.1.0/glew-2.1.0-win32.zip</span>
   )
   <span class="org-function-name">FetchContent_MakeAvailable</span>(glew-release)
   <span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/include  ${<span class="org-variable-name">glm_SOURCE_DIR</span>} )        
   <span class="org-function-name">link_directories</span>(  ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64 )

   <span class="org-function-name">set</span>( GLEW_LIB_PATH1 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32.lib )
   <span class="org-function-name">set</span>( GLEW_LIB_PATH2 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32s.lib )
<span class="org-keyword">ENDIF</span>()

   <span class="org-comment"># ======= T A R G E T S ============================#</span>
   <span class="org-comment">#                                                   #</span>


       <span class="org-function-name">add_executable</span>( draw2d-raw  draw2d-raw.cpp )
<span class="org-function-name">target_link_libraries</span>( draw2d-raw  glfw
                                   OpenGL::GL
                                   ${<span class="org-variable-name">GLEW_LIB_PATH1</span>} ${<span class="org-variable-name">GLEW_LIB_PATH2</span>}  )

<span class="org-comment"># For MINGW (GCC Ported to Windows)                              </span>
<span class="org-keyword">IF</span>(MINGW)
   <span class="org-comment"># Statically link against MINGW dependencies</span>
   <span class="org-comment"># for making easier to deploy on other machines. </span>
   <span class="org-function-name">target_link_options</span>( draw2d-raw PRIVATE                                 
                            -static-libgcc
                            -static-libstdc++

                            -Wl,-Bstatic,--whole-archive -lwinpthread
                              -Wl,--no-whole-archive                                 
                            )
<span class="org-keyword">ENDIF</span>()       


<span class="org-comment"># Copy GLEW DLL shared library to same directory as the executable.                              </span>
<span class="org-keyword">IF</span>(WIN32)                                
   <span class="org-function-name">add_custom_command</span>(TARGET draw2d-raw POST_BUILD 
                  COMMAND ${<span class="org-variable-name">CMAKE_COMMAND</span>} -E copy_if_different
                  <span class="org-string">"${</span><span class="org-variable-name">glew-release_SOURCE_DIR</span><span class="org-string">}/bin/Release/x64/glew32.dll"</span>              
                  $&lt;TARGET_FILE_DIR:draw2d-raw&gt;)
<span class="org-keyword">ENDIF</span>()  
</pre>
</div>

<p>
File: <span class="underline">CMakeLists.txt</span> (Version 2) - This version provides a macro for automating the definition of OpenGL projects with <span class="underline">ADD_OPENGL</span> command.
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(OpenGL_Draw2D_VBO)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download pre-compiled GLEW when building under Windows NT OS (x64)</span>
<span class="org-keyword">IF</span>(WIN32)
   <span class="org-function-name">FetchContent_Declare</span>(
      glew-release 
      URL  https://ufpr.dl.sourceforge.net/project/glew/glew/2.1.0/glew-2.1.0-win32.zip   
      <span class="org-comment"># https://github.com/nigels-com/glew/archive/glew-2.2.0.zip</span>
   )
   <span class="org-function-name">FetchContent_MakeAvailable</span>(glew-release)
   <span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/include  ${<span class="org-variable-name">glm_SOURCE_DIR</span>} )        
   <span class="org-function-name">link_directories</span>(  ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64 )

   <span class="org-function-name">set</span>( GLEW_LIB_PATH1 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32.lib )
   <span class="org-function-name">set</span>( GLEW_LIB_PATH2 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32s.lib )
<span class="org-keyword">ENDIF</span>()


<span class="org-keyword">MACRO</span>(ADD_OPENGL_APP target sources)
   <span class="org-function-name">add_executable</span>( ${<span class="org-variable-name">target</span>} ${<span class="org-variable-name">sources</span>} )
   <span class="org-function-name">message</span>([TRACE] <span class="org-string">" Add OpenGL executable = ${</span><span class="org-variable-name">target</span><span class="org-string">} "</span>)

   <span class="org-function-name">target_link_libraries</span>( ${<span class="org-variable-name">target</span>} glfw
                                    OpenGL::GL
                                    ${<span class="org-variable-name">GLEW_LIB_PATH1</span>}
                                    ${<span class="org-variable-name">GLEW_LIB_PATH2</span>} )

    <span class="org-keyword">IF</span>(MINGW)
        <span class="org-comment"># Statically link against MINGW dependencies</span>
        <span class="org-comment"># for making easier to deploy on other machines. </span>
        <span class="org-function-name">target_link_options</span>( ${<span class="org-variable-name">target</span>} PRIVATE                                 
                                 -static-libgcc
                                 -static-libstdc++
                                 -Wl,-Bstatic,--whole-archive -lwinpthread
                                   -Wl,--no-whole-archive                                    
                                 )
     <span class="org-keyword">ENDIF</span>()       


     <span class="org-comment"># Copy GLEW DLL shared library to same directory as the executable.                 </span>
     <span class="org-keyword">IF</span>(WIN32)                           
        <span class="org-function-name">add_custom_command</span>(TARGET ${<span class="org-variable-name">target</span>} POST_BUILD 
                       COMMAND ${<span class="org-variable-name">CMAKE_COMMAND</span>} -E copy_if_different
                       <span class="org-string">"${</span><span class="org-variable-name">glew-release_SOURCE_DIR</span><span class="org-string">}/bin/Release/x64/glew32.dll"</span>              
                       $&lt;TARGET_FILE_DIR:${<span class="org-variable-name">target</span>}&gt;)
     <span class="org-keyword">ENDIF</span>()                                       
<span class="org-keyword">ENDMACRO</span>()     

     <span class="org-comment"># ======= T A R G E T S ============================#</span>
     <span class="org-comment">#                                                   #</span>

<span class="org-function-name">ADD_OPENGL_APP</span>( draw2-raw draw2d-raw.cpp )
</pre>
</div>

<p>
File: <span class="underline">CMakeLists.txt</span> (Version 3) - last resort if the SourceForge link
no longer works. In this case, it is assumed that Glew library was
download manually from SourceForge via the URL <a href="https://sourceforge.net/projects/glew/files/glew/2.1.0/glew-2.1.0.zip/download">(glew-2.1.0 - download)</a>.
Then the ZIP  <span class="underline">glew-2.1.0-win32.zip</span> is saved in the project root
directory and extracted to a directory named ./glew-2.1.0/
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-comment"># Used when Glew library is download manually </span>
<span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(OpenGL_Draw2D_VBO)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download pre-compiled GLEW when building under Windows NT OS (x64)</span>
<span class="org-keyword">IF</span>(WIN32)
   <span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">CMAKE_CURRENT_LIST_DIR</span>}/glew-2.1.0/include  ${<span class="org-variable-name">glm_SOURCE_DIR</span>} )        
   <span class="org-function-name">link_directories</span>(  ${<span class="org-variable-name">CMAKE_CURRENT_LIST_DIR</span>}/glew-2.1.0/lib/Release/x64 )

   <span class="org-function-name">set</span>( GLEW_LIB_PATH1  ${<span class="org-variable-name">CMAKE_CURRENT_LIST_DIR</span>}/glew-2.1.0/lib/Release/x64/glew32.lib )
   <span class="org-function-name">set</span>( GLEW_LIB_PATH2  ${<span class="org-variable-name">CMAKE_CURRENT_LIST_DIR</span>}/glew-2.1.0/lib/Release/x64/glew32s.lib )
<span class="org-keyword">ENDIF</span>()

   <span class="org-comment"># ======= T A R G E T S ============================#</span>
   <span class="org-comment">#                                                   #</span>

       <span class="org-function-name">add_executable</span>( draw2d-raw  draw2d-raw.cpp )
<span class="org-function-name">target_link_libraries</span>( draw2d-raw  glfw
                                   OpenGL::GL
                                   ${<span class="org-variable-name">GLEW_LIB_PATH1</span>} ${<span class="org-variable-name">GLEW_LIB_PATH2</span>}  )

<span class="org-comment"># For MINGW (GCC Ported to Windows)                              </span>
<span class="org-keyword">IF</span>(MINGW)
   <span class="org-comment"># Statically link against MINGW dependencies</span>
   <span class="org-comment"># for making easier to deploy on other machines. </span>
   <span class="org-function-name">target_link_options</span>( draw2d-raw PRIVATE                                 
                            -static-libgcc
                            -static-libstdc++

                            -Wl,-Bstatic,--whole-archive -lwinpthread
                              -Wl,--no-whole-archive                                 
                            )
<span class="org-keyword">ENDIF</span>()       


<span class="org-comment"># Copy GLEW DLL shared library to same directory as the executable.                              </span>
<span class="org-keyword">IF</span>(WIN32)                                
   <span class="org-function-name">add_custom_command</span>(TARGET draw2d-raw POST_BUILD 
                  COMMAND ${<span class="org-variable-name">CMAKE_COMMAND</span>} -E copy_if_different
                  <span class="org-string">"${</span><span class="org-variable-name">CMAKE_CURRENT_LIST_DIR</span><span class="org-string">}/glew-2.1.0/bin/Release/x64/glew32.dll"</span>              
                  $&lt;TARGET_FILE_DIR:draw2d-raw&gt;)
<span class="org-keyword">ENDIF</span>()   
</pre>
</div>

<p>
Downloading glew manually with curl for usage with the previous CMakeLists.txt file: 
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ curl -L -o <span class="org-keyword">glew32.zip</span>  https://ufpr.dl.sourceforge.net/project/glew/glew/2.1.0/glew-2.1.0-win32.zip

 <span class="org-comment-delimiter"># </span><span class="org-comment">File hash (file signature) - unique identifier for the file  </span>
 $ md5sum glew32.zip 
 32a72e6b43367db8dbea6010cd095355  glew32.zip

 <span class="org-comment-delimiter"># </span><span class="org-comment">File hash (file signature) - unique identifier for the file  </span>
 $ sha256sum glew32.zip 
 80cfc88fd295426b49001a9dc521da793f8547ac10aebfc8bdc91ddc06c5566c  glew32.zip

 <span class="org-comment-delimiter"># </span><span class="org-comment">File hash (file signature) - unique identifier for the file  </span>
 $ sha1sum glew32.zip 
 f505a67ad884b75648639a9b01bf0245bfcfa731  glew32.zip

$ unzip -l glew32.zip 
 Archive:  glew32.zip
   Length      Date    Time    Name
 ---------  ---------- -----   ----
         0  2017-07-31 08:46   glew-2.1.0/
         0  2017-07-31 08:41   glew-2.1.0/bin/
         0  2017-07-31 08:42   glew-2.1.0/bin/Release/
         0  2017-07-31 08:42   glew-2.1.0/bin/Release/Win32/
    389632  2017-07-31 08:42   glew-2.1.0/bin/Release/Win32/glew32.dll
    482304  2017-07-31 08:42   glew-2.1.0/bin/Release/Win32/glewinfo.exe
    294912  2017-07-31 08:42   glew-2.1.0/bin/Release/Win32/visualinfo.exe
         0  2017-07-31 08:42   glew-2.1.0/bin/Release/x64/
    422912  2017-07-31 08:42   glew-2.1.0/bin/Release/x64/glew32.dll
    539648  2017-07-31 08:42   glew-2.1.0/bin/Release/x64/glewinfo.exe
    338432  2017-07-31 08:42   glew-2.1.0/bin/Release/x64/visualinfo.exe
    ... ... ... ... ... ... ... ... ... ... ... ... ... ... .. 
    ... ... ... ... ... ... ... ... ... ... ... ... ... ... .. 

         0  2017-07-31 08:42   glew-2.1.0/lib/Release/
         0  2017-07-31 08:46   glew-2.1.0/lib/Release/Win32/
    712098  2017-07-31 08:42   glew-2.1.0/lib/Release/Win32/glew32.lib
   2443636  2017-07-31 08:42   glew-2.1.0/lib/Release/Win32/glew32s.lib
         0  2017-07-31 08:46   glew-2.1.0/lib/Release/x64/
    701288  2017-07-31 08:42   glew-2.1.0/lib/Release/x64/glew32.lib
   2584968  2017-07-31 08:42   glew-2.1.0/lib/Release/x64/glew32s.lib
      3870  2017-07-31 08:46   glew-2.1.0/LICENSE.txt
 ---------                     -------
  10662952                     47 files

 $ unzip -x glew32.zip 
 Archive:  glew32.zip
    creating: glew-2.1.0/
    creating: glew-2.1.0/bin/
    creating: glew-2.1.0/bin/Release/
    creating: glew-2.1.0/bin/Release/Win32/
   inflating: glew-2.1.0/bin/Release/Win32/glew32.dll  
   inflating: glew-2.1.0/bin/Release/Win32/glewinfo.exe 
  ... ... ... ... ... ... ... ... ... ... ... ... ... ...  
  ... ... ... ... ... ... ... ... ... ... ... ... ... ...  
    inflating: glew-2.1.0/lib/Release/Win32/glew32.lib  
   inflating: glew-2.1.0/lib/Release/Win32/glew32s.lib  
    creating: glew-2.1.0/lib/Release/x64/
   inflating: glew-2.1.0/lib/Release/x64/glew32.lib  
   inflating: glew-2.1.0/lib/Release/x64/glew32s.lib  
   inflating: glew-2.1.0/LICENSE.txt  

</pre>
</div>

<p>
File: <span class="underline">xmake.lua</span>  
</p>

<ul class="org-ul">
<li>Compilation script for <a href="https://xmake.io/">Xmake</a> building system, that uses <a href="https://en.wikipedia.org/wiki/Lua_(programming_language)">Lua</a> as
embedded scripting language and as a DSL - Domain-Specific
Language. The disadvantage of this building system are: poor IDE
support and the lack of ability for downloading sources directly
like CMake's <span class="underline">FetchContent_Declare</span> statement. Another issue is
that new packages can only be added by sending pull requests to
<a href="https://github.com/xmake-io/xmake-repo/tree/master/packages">Xmake packages repository</a>.</li>
<li>XMake packages used in this sample project: 
<ul class="org-ul">
<li><a href="https://github.com/xmake-io/xmake-repo/blob/master/packages/g/glfw/xmake.lua">glfw</a>, <a href="https://github.com/xmake-io/xmake-repo/blob/master/packages/g/glew/xmake.lua">glew</a>, <a href="https://github.com/xmake-io/xmake-repo/blob/master/packages/g/glm/xmake.lua">glm</a></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-lua">add_rules(<span class="org-string">"mode.debug"</span>, <span class="org-string">"mode.release"</span>)

add_requires(<span class="org-string">"glm"</span>, <span class="org-string">"glew"</span>, <span class="org-string">"glfw"</span>)

target(<span class="org-string">"draw2d"</span>)
  set_kind(<span class="org-string">"binary"</span>)
  add_files(<span class="org-string">"./draw2d-raw.cpp"</span>)
  add_packages(<span class="org-string">"glew"</span>, <span class="org-string">"glfw"</span>, <span class="org-string">"glm"</span>)
</pre>
</div>


<p>
File: <span class="underline">draw2d-raw.cpp</span>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>


<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>_WIN32<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">windows.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glew.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glut.h&gt;</span>


<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>;
    <span class="org-type">GLfloat</span> <span class="org-variable-name">y</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Initialize GLFW </span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>


    <span class="org-comment-delimiter">/* </span><span class="org-comment">Create a windowed mode window and its OpenGL context */</span>
    window = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"2D Drawing raw VBO buffers"</span>, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>window<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glfwTerminate<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-keyword">return</span> -1;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Make the window's context current */</span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glClearColor(0.0f, 0.5f, 0.6f, 1.0f);</span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.0f, 0.0, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">--- GLEW should always be initialized after an OpenGL context.</span>
<span class="org-preprocessor">    #if</span> _WIN32
    glewExperimental = GL_TRUE;
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span>glewInit<span class="org-rainbow-delimiters-depth-3">()</span> != GLEW_OK<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"GLEW::Error : failed to initialize GLEW"</span>&lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [TRACE] Glew Initialized Ok. \n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">    #endif</span>


    <span class="org-type">Vertex2D</span> <span class="org-variable-name">triangle_points</span><span class="org-rainbow-delimiters-depth-2">[</span>3<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
        Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span>-0.25,   -0.25<span class="org-rainbow-delimiters-depth-3">}</span>
      , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> 0.00,   0.25<span class="org-rainbow-delimiters-depth-3">}</span>
      , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> 0.25,  -0.25<span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">Vertex2D</span> <span class="org-variable-name">square_points</span><span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-rainbow-delimiters-depth-3">{</span> -0.3,  -0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> -0.3,   0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>  0.3,   0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>  0.3,  -0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">================== Triangle Buffer ====================//</span>
    <span class="org-comment-delimiter">//</span>

    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_triangle_</span> = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Create an OpenGL VBO buffer</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; void glGenBuffers (GLsizei n, GLuint *buffers);</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>  1                <span class="org-comment-delimiter">// </span><span class="org-comment">Number of buffers that will be instantiated</span>
                 , &amp;vbo_triangle_   <span class="org-comment-delimiter">// </span><span class="org-comment">Address of first element or address of array</span>
                                    <span class="org-comment-delimiter">// </span><span class="org-comment">that results will be written to.</span>
                 <span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> vbo_triangle_ != 0 <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set this buffer as the current buffer - Only one buffer can be bound at a time.</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; void glBindBuffer (GLenum target, GLuint buffer)</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo_triangle_<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>triangle_points<span class="org-rainbow-delimiters-depth-3">)</span>, triangle_points, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind current buffer in order to avoid unintended behaviors</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">as the subroutine glBindBuffer() modifies has a global state.</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">================ Square / Vertex Buffer Object 2 ==================//</span>
    <span class="org-comment-delimiter">//</span>

    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_square_</span> = 0;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Instiate buffer - gets a handle or token for</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">a buffer allocated on GPU-side.</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo_square_<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check for error</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span> vbo_square_ != 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Bind Current buffer (Affects global state)</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo_square_<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to the GPU</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>square_points<span class="org-rainbow-delimiters-depth-3">)</span>, square_points, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind buffer</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">shader_attr</span> = 0;

    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">------------ Draw triangle --------------//</span>
            <span class="org-comment-delimiter">//</span>
            glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, vbo_triangle_<span class="org-rainbow-delimiters-depth-3">)</span>;
            glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Describe buffer data layout (binary layout)</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; glVertexAttribPointer ( GLuint index, GLint size, GLenum type</span>
            <span class="org-comment-delimiter">//                           </span><span class="org-comment">, GLboolean normalized, GLsizei stride, const void *pointer);</span>
            <span class="org-comment-delimiter">//</span>
            glVertexAttribPointer<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr <span class="org-comment-delimiter">// </span><span class="org-comment">GLint  index         =&gt; Shader attribute location, 0 for now</span>
                                , 2           <span class="org-comment-delimiter">// </span><span class="org-comment">GLint  size          =&gt; 2 components (X, Y) of type GLfloat</span>
                                , GL_FLOAT    <span class="org-comment-delimiter">// </span><span class="org-comment">GLemum type          =&gt; Type of each component</span>
                                , GL_FALSE    <span class="org-comment-delimiter">// </span><span class="org-comment">GLboolean normalized</span>
                                , 0           <span class="org-comment-delimiter">// </span><span class="org-comment">GLsizei stride</span>
                                , <span class="org-constant">nullptr</span>     <span class="org-comment-delimiter">// </span><span class="org-comment">const void* pointer</span>
                                <span class="org-rainbow-delimiters-depth-3">)</span>;
            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw arrays using the content of buffer</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">Plot 1 triangle (each triangle has 3 vertices)</span>
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_TRIANGLES, 0, 3<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Disable global state</span>
            glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>0<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">//</span><span class="org-comment">------------ Draw Square -------------------------//</span>
            <span class="org-comment-delimiter">//</span>

<span class="org-preprocessor">            #if</span> 1
            glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, vbo_square_<span class="org-rainbow-delimiters-depth-3">)</span>;
            glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr<span class="org-rainbow-delimiters-depth-3">)</span>;
            glVertexAttribPointer<span class="org-rainbow-delimiters-depth-3">(</span>0, 2, GL_FLOAT, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            <span class="org-comment-delimiter">// </span><span class="org-comment">Plot 4 vertices</span>
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_LINE_LOOP, 0, 4<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Disable global state</span>
            glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr<span class="org-rainbow-delimiters-depth-3">)</span>;
<span class="org-preprocessor">            #endif</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
        glfwPollEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Q'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
             <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] User typed Q =&gt;&gt; Shutdown program. Ok. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
             <span class="org-keyword">break</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>

<p>
<b>Building on Linux</b> 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build_linux -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build_linux --target 

<span class="org-comment-delimiter"># </span><span class="org-comment">Run </span>
$ _build_linux/draw2d-raw 
</pre>
</div>

<p>
<b>Building with dockercross tool (cross compilation for Windows)</b>
</p>

<ul class="org-ul">
<li>See: Cross compiling toolchains in Docker images
<ul class="org-ul">
<li>=&gt;&gt; <a href="https://github.com/dockcross/dockcross">https://github.com/dockcross/dockcross</a></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ docker run -it --rm -v $<span class="org-variable-name">PWD</span>:/cwd -w /cwd --entrypoint=bash dockcross/windows-static-x64

$ cmake -H. -B_build_cross -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build_cross --target

</pre>
</div>

<p>
Building without entering docker shell: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ docker run -it --rm -v $<span class="org-variable-name">PWD</span>:/cwd -w /cwd --entrypoint=bash dockcross/windows-static-x64 cmake -H. -B_build_cross -DCMAKE_BUILD_TYPE=Debug
$ docker run -it --rm -v $<span class="org-variable-name">PWD</span>:/cwd -w /cwd --entrypoint=bash dockcross/windows-static-x64 cmake --build _build_cross --target
</pre>
</div>

<p>
List build directory:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ls _build_cross
CMakeCache.txt CMakeFiles  Makefile  _deps  cmake_install.cmake  draw2d-raw.exe  glew32.dll
</pre>
</div>

<p>
Run executable with <b>wine</b> on Linux: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ wine _build_cross/draw2d-raw.exe 
</pre>
</div>

<p>
<b>Building on Windows with MINGW (GCC ported to Windows)</b> 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build_mingw -G <span class="org-string">"MinGW Makefiles"</span> -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build_mingw --target
</pre>
</div>

<p>
Run executable: 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">On Window</span>
$ _build_mingw\draw2d-raw.exe 

<span class="org-comment-delimiter"># </span><span class="org-comment">on Linux via wine </span>
$ wine _build_mingw\draw2d-raw.exe  
</pre>
</div>

<p>
<b>Building with Xmake building system</b>
</p>

<p>
Display Xmake version: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake --version | grep -i <span class="org-string">"cross-platform"</span> 2&gt; /dev/null
xmake v2.6.9+202208081520, A cross-platform build utility based on Lua
</pre>
</div>

<p>
Enter XMake - Lua interactive REPL (Read-Eval-Print-Loop):
</p>

<div class="org-src-container">
<pre class="src src-lua">$ xmake lua 
xmake&gt; 

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Get host operating system</span>
xmake&gt; <span class="org-builtin">os</span>.host()
&lt; <span class="org-string">"linux"</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Get host architecture</span>
xmake&gt; <span class="org-builtin">os</span>.arch()
&lt; <span class="org-string">"x86_64"</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Open Root Linux's directory</span>
xmake&gt; <span class="org-builtin">os</span>.execv(<span class="org-string">"xdg-open /"</span>)
&lt; 1: 0
&lt; 2: <span class="org-constant">nil</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Check whether file exists</span>
xmake&gt; <span class="org-builtin">os</span>.exists(<span class="org-string">"./draw2d-raw.cpp"</span>)
&lt; <span class="org-constant">true</span>
xmake&gt; <span class="org-builtin">os</span>.exists(<span class="org-string">"./draw2d-raw.cpp.back"</span>)
&lt; <span class="org-constant">false</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Get current directory</span>
xmake&gt; <span class="org-builtin">os</span>.curdir()
&lt; <span class="org-string">"/home/user/opengl1"</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Get project directory</span>
xmake&gt; <span class="org-builtin">os</span>.projectdir()
&lt; <span class="org-string">"/home/user/opengl1"</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Get scripting directory </span>
xmake&gt; <span class="org-builtin">os</span>.scriptdir()
&lt; <span class="org-string">"/home/user/.local/share/xmake/plugins/lua"</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Download file from http server</span>
xmake&gt; http = import(<span class="org-string">"net.http"</span>)
xmake&gt; http.download(<span class="org-string">"https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip"</span>, <span class="org-string">"glfw-source.zip"</span>)
xmake&gt; <span class="org-builtin">os</span>.exists(<span class="org-string">"glfw-source.zip"</span>)
&lt; <span class="org-constant">true</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Extract archive </span>
xmake&gt; r = import(<span class="org-string">"utils.archive"</span>)
xmake&gt; r.extract(<span class="org-string">"./glfw-source.zip"</span>, <span class="org-string">"/tmp/glfw-src"</span>)


<span class="org-comment-delimiter">-- </span><span class="org-comment">Check current platform (All return false in the REPL)</span>
xmake&gt; is_plat(<span class="org-string">"windows"</span>)
&lt; <span class="org-constant">false</span>
xmake&gt; is_plat(<span class="org-string">"linux"</span>)
&lt; <span class="org-constant">false</span>
xmake&gt; is_plat(<span class="org-string">"unix"</span>)
&lt; <span class="org-constant">false</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Check whether the current mode is Debug or Release (All fail in the REPL)</span>
xmake&gt; is_mode(<span class="org-string">"debug"</span>)
&lt; <span class="org-constant">false</span>
xmake&gt; is_mode(<span class="org-string">"release"</span>)
&lt; <span class="org-constant">false</span>

xmake&gt; <span class="org-comment-delimiter">-- </span><span class="org-comment">Join paths </span>
xmake&gt; p = path.join( <span class="org-builtin">os</span>.projectdir(), <span class="org-string">"build"</span>, <span class="org-string">"path1"</span>, <span class="org-string">"path2"</span>, <span class="org-string">"app.exe"</span>)
xmake&gt; p
&lt; <span class="org-string">"/home/user/opengl1/build/path1/path2/app.exe"</span>

</pre>
</div>


<p>
List repositories: 
</p>

<ul class="org-ul">
<li>$ xrepo list-repo</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ xrepo list-repo
global repositories:
    build-artifacts https://gitlab.com/xmake-mirror/build-artifacts.git main 
    xmake-repo https://gitlab.com/tboox/xmake-repo.git master 
    builtin-repo /home/user/.local/share/xmake/repository 

3 repositories were found!
</pre>
</div>


<p>
Search Xmake packages: 
</p>

<ul class="org-ul">
<li>$ xrepo search &lt;PACKAGE&gt;</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ xrepo search boost
The package names:
    boost: 
      -&gt; boost-1.79.0: Collection of portable C++ source libraries. (<span class="org-keyword">in</span> xmake-repo)

$ xrepo search glut
The package names:
    glut: 
      -&gt; freeglut-3.2.2: A free-software/open-source alternative to the OpenGL Utility Toolkit (GLUT) library. (<span class="org-keyword">in</span> xmake-repo)
      -&gt; glut: OpenGL utility toolkit (<span class="org-keyword">in</span> xmake-repo)

</pre>
</div>

<p>
Install package: 
</p>

<ul class="org-ul">
<li>$ xrepo install &lt;PACKAGE&gt;</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"> $ xrepo install boost

<span class="org-function-name">note</span>: install or modify (m) these packages (pass -y to skip confirm)?
<span class="org-keyword">in</span> xmake-repo:
  -&gt; bzip2 1.0.8 [from:boost]
  -&gt; boost 1.79.0 
please input: y (y/n/m)
y
  =&gt; download https://sourceware.org/pub/bzip2/bzip2-1.0.8.tar.gz .. ok
</pre>
</div>


<p>
List package information: 
</p>

<ul class="org-ul">
<li>$ xrepo info &lt;PACKAGE&gt;</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"> $ &gt;&gt; xrepo info glm
The package info of project:
    require(glm): 
      -&gt; description: OpenGL Mathematics (GLM)
      -&gt; version: 0.9.9+8
      -&gt; urls:
         -&gt; https://github.com/g-truc/glm/archive/0.9.9.8.tar.gz
            -&gt; 7d508ab72cb5d43227a3711420f06ff99b0a0cb63ee2f93631b162bfe1fe9592
         -&gt; https://github.com/g-truc/glm.git
            -&gt; 0.9.9+8
      -&gt; repo: xmake-repo https://gitlab.com/tboox/xmake-repo.git master
      -&gt; cachedir: /home/user/.xmake/cache/packages/2208/g/glm/0.9.9+8
      -&gt; installdir: /home/user/.xmake/packages/g/glm/0.9.9+8/65b1ad153bda4a43b0454eba7969327f
      -&gt; searchdirs: 
      -&gt; searchnames: 0.9.9.8.tar.gz, glm.git, glm-0.9.9+8.tar.gz, glm-0.9.9+8
      -&gt; fetchinfo: 0.9.9+8
          -&gt; sysincludedirs: /home/user/.xmake/packages/g/glm/0.9.9+8/65b1ad153bda4a43b0454eba7969327f/include
          -&gt; version: 0.9.9+8
      -&gt; platforms: all
      -&gt; requires:
         -&gt; plat: linux
         -&gt; arch: x86_64
         -&gt; configs:
            -&gt; debug: false
            -&gt; pic: true
            -&gt; shared: false
      -&gt; configs:
      -&gt; configs (<span class="org-builtin">builtin</span>):
         -&gt; debug: Enable debug symbols. (default: false)
         -&gt; shared: Build shared library. (default: false)
         -&gt; pic: Enable the position independent code. (default: true)
         -&gt; lto: Enable the link-time build optimization. (<span class="org-builtin">type</span>: boolean)
         -&gt; vs_runtime: Set vs compiler runtime.
            -&gt; values: {<span class="org-string">"MT"</span>,<span class="org-string">"MTd"</span>,<span class="org-string">"MD"</span>,<span class="org-string">"MDd"</span>}
         -&gt; toolchains: Set package toolchains only for cross-compilation.
         -&gt; cflags: Set the C compiler flags.
         -&gt; cxflags: Set the C/C++ compiler flags.
         -&gt; cxxflags: Set the C++ compiler flags.
         -&gt; asflags: Set the assembler flags.
      -&gt; references:
         -&gt; 220814: /dev/shm/.xmake1000/220814/xrepo/working
         -&gt; 220813: /home/user/opengl1
</pre>
</div>


<p>
List project information:
</p>

<ul class="org-ul">
<li>$ xmake show</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ xmake show

The information of xmake:
    version: 2.6.9+202208081520
    host: linux/x86_64
    programdir: /home/user/.local/share/xmake
    programfile: /home/user/.local/bin/xmake
    globaldir: /home/user/.xmake
    tmpdir: /dev/shm/.xmake1000/220808
    workingdir: /home/user/opengl1
    packagedir: /home/user/.xmake/packages
    packagedir(cache): /home/user/.xmake/cache/packages/2208

The information of project: 
    plat: linux
    arch: x86_64
    mode: release
    buildir: build
    configdir: /home/user/opengl1/.xmake/linux/x86_64
    projectdir: /home/user/opengl1
    projectfile: /home/user/opengl1/xmake.lua
</pre>
</div>

<p>
Configure building for Linux: 
</p>

<ul class="org-ul">
<li>$ xmake f -p linux</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"> $ &gt;&gt; xmake f -p linux
checking for <span class="org-variable-name">architecture </span>... <span class="org-compilation-warning">x86_64</span>
</pre>
</div>


<p>
Building: 
</p>

<ul class="org-ul">
<li>$ xmake build</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"> $ &gt;&gt; xmake build -v
[ 25%]: ccache compiling.release draw2d-raw.cpp
/usr/bin/gcc -c -m64 -fvisibility=hidden -fvisibility-inlines-hidden -O3 -DGLEW_NO_GLU -D_GLFW_X11 -DGLFW_INCLUDE_NONE <span class="org-sh-escaped-newline">\</span>
               -isystem /home/user/.xmake/packages/g/glew/2.2.0/2ac0c6940a2140f7b6506fcd8240f406/include <span class="org-sh-escaped-newline">\</span>
               -isystem /home/user/.xmake/packages/g/glfw/3.3.8/aa037e96cc854680a09e144c4b5c8fe0/include <span class="org-sh-escaped-newline">\</span>
               -isystem /usr/include/X11/dri -isystem /home/user/.xmake/packages/g/glm/0.9.9+8/65b1ad153bda4a43b0454eba7969327f/include <span class="org-sh-escaped-newline">\</span>
               -DNDEBUG -o <span class="org-keyword">build/.objs/draw2d/linux/x86_64/release/draw2d-raw.cpp.o</span> draw2d-raw.cpp

[ 50%]: linking.release draw2d
/usr/bin/g++ -o <span class="org-keyword">build/linux/x86_64/release/draw2d</span> build/.objs/draw2d/linux/x86_64/release/draw2d-raw.cpp.o -m64 <span class="org-sh-escaped-newline">\</span>
               -L/home/user/.xmake/packages/g/glew/2.2.0/2ac0c6940a2140f7b6506fcd8240f406/lib <span class="org-sh-escaped-newline">\</span>
               -L/home/user/.xmake/packages/g/glfw/3.3.8/aa037e96cc854680a09e144c4b5c8fe0/lib <span class="org-sh-escaped-newline">\</span>
                -L/usr/lib/x86_64-linux-gnu -s <span class="org-sh-escaped-newline">\</span>
                -lglew -lglfw3 -lOpenGL -lXrandr -lXinerama -lXcursor -lXrender -lX11 -lXi -lXfixes <span class="org-sh-escaped-newline">\</span>
                -lXext -lxcb -lssl -lcrypto -lffi -lz -lXau -lXdmcp -lGL -ldl -lpthread
[100%]: build ok!
</pre>
</div>


<p>
Inspecting compilation output:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ tree build
build
&#9492;&#9472;&#9472; linux
    &#9492;&#9472;&#9472; x86_64
        &#9492;&#9472;&#9472; release
            &#9492;&#9472;&#9472; draw2d

3 directories, 1 file
</pre>
</div>

<p>
Running the default xmake target: 
</p>

<ul class="org-ul">
<li>$ xmake run</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ xmake run
</pre>
</div>

<p>
Running a specific xmake target:
</p>

<ul class="org-ul">
<li>$ xmake run draw2d</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ xmake run draw2d
</pre>
</div>

<p>
Generate file containing compilation commands: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake project -k compile_commands
create ok!

$ cat compile_commands.json 
[
{
  <span class="org-string">"directory"</span>: <span class="org-string">"/home/user/opengl1"</span>,
  <span class="org-string">"arguments"</span>: [<span class="org-string">"/usr/bin/gcc"</span>, <span class="org-string">"-c"</span>, <span class="org-string">"-m64"</span>, <span class="org-string">"-fvisibility=hidden"</span>, <span class="org-string">"-fvisibility-inlines-hidden"</span>, <span class="org-string">"-O3"</span>, <span class="org-string">"-DGLEW_NO_GLU"</span>, <span class="org-string">"-D_GLFW_X11"</span>, <span class="org-string">"-DGLFW_INCLUDE_NONE"</span>, <span class="org-string">"-I"</span>, <span class="org-string">"/home/user/.xmake/packages/g/glew/2.2.0/2ac0c6940a2140f7b6506fcd8240f406/include"</span>, <span class="org-string">"-I"</span>, <span class="org-string">"/home/user/.xmake/packages/g/glfw/3.3.8/aa037e96cc854680a09e144c4b5c8fe0/include"</span>, <span class="org-string">"-I"</span>, <span class="org-string">"/usr/include/X11/dri"</span>, <span class="org-string">"-I"</span>, <span class="org-string">"/home/user/.xmake/packages/g/glm/0.9.9+8/65b1ad153bda4a43b0454eba7969327f/include"</span>, <span class="org-string">"-DNDEBUG"</span>, <span class="org-string">"-o"</span>, <span class="org-string">"build/.objs/draw2d/linux/x86_64/release/draw2d-raw.cpp.o"</span>, <span class="org-string">"draw2d-raw.cpp"</span>],
  <span class="org-string">"file"</span>: <span class="org-string">"draw2d-raw.cpp"</span>
}]
</pre>
</div>

<p>
Generate a CMake project file (note - this file must not be under version control): 
</p>

<ul class="org-ul">
<li>$ xmake project -k cmake</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ xmake project -k cmake
create ok!
</pre>
</div>

<p>
CMake file generated by Xmake (CMakeLists.txt): 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">this is the build file for project </span>
<span class="org-comment-delimiter"># </span><span class="org-comment">it is autogenerated by the xmake build system.</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">do not edit by hand.</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">project</span>
<span class="org-function-name">cmake_minimum_required</span>(VERSION 3.15.0)
<span class="org-function-name">cmake_policy</span>(SET CMP0091 NEW)
<span class="org-function-name">project</span>(draw2d LANGUAGES CXX C)

<span class="org-comment-delimiter"># </span><span class="org-comment">target</span>
<span class="org-function-name">add_executable</span>(draw2d <span class="org-string">""</span>)
<span class="org-function-name">set_target_properties</span>(draw2d PROPERTIES OUTPUT_NAME <span class="org-string">"draw2d"</span>)
<span class="org-function-name">set_target_properties</span>(draw2d PROPERTIES RUNTIME_OUTPUT_DIRECTORY <span class="org-string">"${CMAKE_SOURCE_DIR}/build/linux/x86_64/release"</span>)
<span class="org-function-name">target_include_directories</span>(draw2d PRIVATE
    /home/user/.xmake/packages/g/glew/2.2.0/2ac0c6940a2140f7b6506fcd8240f406/include
    /usr/include/X11/dri
    /home/user/.xmake/packages/g/glfw/3.3.6/703496809fe34548a9dbcf268bfa4db5/include
    /home/user/.xmake/packages/g/glm/0.9.9+8/65b1ad153bda4a43b0454eba7969327f/include
)
<span class="org-function-name">target_compile_definitions</span>(draw2d PRIVATE
    GLEW_NO_GLU
    _GLFW_X11
    GLFW_INCLUDE_NONE
)
<span class="org-function-name">target_compile_options</span>(draw2d PRIVATE
    $&lt;$&lt;COMPILE_LANGUAGE:C&gt;:-m64&gt;
    $&lt;$&lt;COMPILE_LANGUAGE:CXX&gt;:-m64&gt;
    $&lt;$&lt;COMPILE_LANGUAGE:C&gt;:-DNDEBUG&gt;
    $&lt;$&lt;COMPILE_LANGUAGE:CXX&gt;:-DNDEBUG&gt;
)
<span class="org-keyword">if</span>(MSVC)
    target_compile_options(draw2d PRIVATE $&lt;$&lt;CONFIG:Release&gt;:-Ox -fp:fast&gt;)
<span class="org-keyword">else</span>()
    target_compile_options(draw2d PRIVATE -O3)
<span class="org-function-name">endif</span>()
<span class="org-keyword">if</span>(MSVC)
<span class="org-keyword">else</span>()
    target_compile_options(draw2d PRIVATE -fvisibility=hidden)
<span class="org-function-name">endif</span>()
<span class="org-keyword">if</span>(MSVC)
    set_property(TARGET draw2d PROPERTY
        MSVC_RUNTIME_LIBRARY <span class="org-string">"MultiThreaded$&lt;$&lt;CONFIG:Debug&gt;:Debug&gt;"</span>)
<span class="org-function-name">endif</span>()
<span class="org-function-name">target_link_libraries</span>(draw2d PRIVATE
    glew
    X11
    xcb
    ssl
    crypto
    ffi
    z
    Xau
    Xdmcp
    glfw3
    OpenGL
    Xrandr
    Xinerama
    Xcursor
    Xrender
    Xi
    Xfixes
    Xext
    GL
    dl
    pthread
)
<span class="org-function-name">target_link_directories</span>(draw2d PRIVATE
    /home/user/.xmake/packages/g/glew/2.2.0/2ac0c6940a2140f7b6506fcd8240f406/lib
    /usr/lib/x86_64-linux-gnu
    /home/user/.xmake/packages/g/glfw/3.3.6/703496809fe34548a9dbcf268bfa4db5/lib
)
<span class="org-function-name">target_link_options</span>(draw2d PRIVATE
    -m64
)
<span class="org-function-name">target_sources</span>(draw2d PRIVATE
    draw2d-raw.cpp
)

</pre>
</div>

<p>
Now it is possible to edit the project with any IDE or smart editor
that supports CMake, including <span class="underline">Visual Studio Code - Vscode</span> or <span class="underline">CLion</span>:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Edit project with vscode using the CMakeLists.txt as project file</span>
$ vscode .  
</pre>
</div>


<p>
<b>Building with Xmake building system on Windows</b> 
</p>

<p>
Configure XMake for using MinGW (GCC Ported to Windows)
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake f -p mingw 
</pre>
</div>

<p>
Show project information:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake show

The information of xmake:
    version: 2.7.1+master.1acf248c0
    host: windows/x64
    programdir: C:\Program Files\xmake
    programfile: C:\Program Files\xmake\xmake.exe
    globaldir: C:\Users\ghostuser\AppData\Local<span class="org-string">\.</span>xmake
    tmpdir: C:\Users\ghostuser\AppData\Local\Temp<span class="org-string">\.</span>xmake\220902
    workingdir: D:\opengl
    packagedir: C:\Users\ghostuser\AppData\Local<span class="org-string">\.</span>xmake\packages
    packagedir(cache): C:\Users\ghostuser\AppData\Local<span class="org-string">\.</span>xmake\cache\packages\2209

The information of project:
    plat: mingw
    arch: x86_64
    mode: release
    buildir: build
    configdir: D:\opengl<span class="org-string">\.</span>xmake\windows\x64
    projectdir: D:\opengl
    projectfile: D:\opengl\xmake.lua
</pre>
</div>

<p>
Build the application showing all compilation and linking commands:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake build -v

[ 25%]: cache compiling.release draw2d-raw.cpp
<span class="org-string">"C:\\Program Files\\mingw-w64\\x86_64-8.1.0-posix-seh-rt_v6-rev0\\mingw64\\bin\\x86_64-w64-mingw32-g++"</span> -c <span class="org-sh-escaped-newline">\</span>
    -m64 -fvisibility=hidden -fvisibility-inlines-hidden -O3 -DGLEW_NO_GLU -DGLEW_STATIC -DGLFW_INCLUDE_NONE <span class="org-sh-escaped-newline">\</span>
    -isystem C:\Users\ghostuser\AppData\Local<span class="org-string">\.</span>xmake\packages\g\glew\2.2.0\f1937cf4c620461cac69417973f0b9e2\include <span class="org-sh-escaped-newline">\</span>
    -isystem C:\Users\ghostuser\AppData\Local<span class="org-string">\.</span>xmake\packages\g\glfw\3.3.8\580b60fd05d941e2abb98f9baa25683e\include <span class="org-sh-escaped-newline">\</span>
    -isystem C:\Users\ghostuser\AppData\Local<span class="org-string">\.</span>xmake\packages\g\glm\0.9.9+8\53c948164ca94a25beb29600f690b730\include -DNDEBUG <span class="org-sh-escaped-newline">\</span>
    -o <span class="org-keyword">build\.objs\draw2d\mingw\x86_64\release\draw2d-raw.cpp.obj</span> draw2d-raw.cpp

[ 50%]: linking.release draw2d.exe
<span class="org-string">"C:\\Program Files\\mingw-w64\\x86_64-8.1.0-posix-seh-rt_v6-rev0\\mingw64\\bin\\x86_64-w64-mingw32-g++"</span> <span class="org-sh-escaped-newline">\</span>
    -o <span class="org-keyword">build\mingw\x86_64\release\draw2d.exe</span> build<span class="org-string">\.</span>objs\draw2d\mingw\x86_64\release\draw2d-raw.cpp.obj -m64 <span class="org-sh-escaped-newline">\</span>
    -LC:\Users\ghostuser\AppData\Local<span class="org-string">\.</span>xmake\packages\g\glew\2.2.0\f1937cf4c620461cac69417973f0b9e2\lib <span class="org-sh-escaped-newline">\</span>
    -LC:\Users\ghostuser\AppData\Local<span class="org-string">\.</span>xmake\packages\g\glfw\3.3.8\580b60fd05d941e2abb98f9baa25683e\lib <span class="org-sh-escaped-newline">\</span>
    -s -lglew32s -lglfw3 -lopengl32 -lgdi32
[100%]: build ok!
</pre>
</div>

<p>
Run the executable:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake run 
</pre>
</div>

<p>
Generate CMakeLists.txt:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake project -k cmake 
</pre>
</div>

<p>
Build the project using the CMakeListst.txt file:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build -G <span class="org-string">"MinGW Makefiles"</span> -DCMAKE_BUILD_TYPE=Debug

$ cmake --build _build --target all
[ 50%] Building CXX object CMakeFiles/draw2d.dir/draw2d-raw.cpp.obj
[100%] Linking CXX executable ..\build\mingw\x86_64\release\draw2d.exe
[100%] Built target draw2d
</pre>
</div>


<p>
File: <span class="underline">CMakeLists.txt</span> - generated by XMake 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-comment"># this is the build file for project </span>
<span class="org-comment"># it is autogenerated by the xmake build system.</span>
<span class="org-comment"># do not edit by hand.</span>

<span class="org-comment"># project</span>
<span class="org-function-name">cmake_minimum_required</span>(VERSION 3.15.0)
<span class="org-function-name">cmake_policy</span>(SET CMP0091 NEW)
<span class="org-function-name">project</span>(draw2d LANGUAGES CXX C)

<span class="org-comment"># target</span>
<span class="org-function-name">add_executable</span>(draw2d <span class="org-string">""</span>)
<span class="org-function-name">set_target_properties</span>(draw2d PROPERTIES OUTPUT_NAME <span class="org-string">"draw2d"</span>)
<span class="org-function-name">set_target_properties</span>(draw2d PROPERTIES RUNTIME_OUTPUT_DIRECTORY <span class="org-string">"${</span><span class="org-variable-name">CMAKE_SOURCE_DIR</span><span class="org-string">}/build/mingw/x86_64/release"</span>)
<span class="org-function-name">target_include_directories</span>(draw2d PRIVATE
    C:/Users/ghostuser/AppData/Local/.xmake/packages/g/glew/2.2.0/f1937cf4c620461cac69417973f0b9e2/include
    C:/Users/ghostuser/AppData/Local/.xmake/packages/g/glfw/3.3.8/580b60fd05d941e2abb98f9baa25683e/include
    C:/Users/ghostuser/AppData/Local/.xmake/packages/g/glm/0.9.9+8/53c948164ca94a25beb29600f690b730/include
)
<span class="org-function-name">target_compile_definitions</span>(draw2d PRIVATE
    GLEW_NO_GLU
    GLEW_STATIC
    GLFW_INCLUDE_NONE
)
<span class="org-function-name">target_compile_options</span>(draw2d PRIVATE
    $&lt;$&lt;COMPILE_LANGUAGE:C&gt;:-m64&gt;
    $&lt;$&lt;COMPILE_LANGUAGE:CXX&gt;:-m64&gt;
    $&lt;$&lt;COMPILE_LANGUAGE:C&gt;:-DNDEBUG&gt;
    $&lt;$&lt;COMPILE_LANGUAGE:CXX&gt;:-DNDEBUG&gt;
)
<span class="org-keyword">if</span>(MSVC)
    <span class="org-function-name">target_compile_options</span>(draw2d PRIVATE $&lt;$&lt;CONFIG:Release&gt;:-Ox -fp:fast&gt;)
<span class="org-keyword">else</span>()
    <span class="org-function-name">target_compile_options</span>(draw2d PRIVATE -O3)
<span class="org-keyword">endif</span>()
<span class="org-keyword">if</span>(MSVC)
<span class="org-keyword">else</span>()
    <span class="org-function-name">target_compile_options</span>(draw2d PRIVATE -fvisibility=hidden)
<span class="org-keyword">endif</span>()
<span class="org-keyword">if</span>(MSVC)
    <span class="org-function-name">set_property</span>(TARGET draw2d PROPERTY
        MSVC_RUNTIME_LIBRARY <span class="org-string">"MultiThreaded$&lt;$&lt;CONFIG:Debug&gt;:Debug&gt;"</span>)
<span class="org-keyword">endif</span>()
<span class="org-function-name">target_link_libraries</span>(draw2d PRIVATE
    glew32s
    glfw3
    opengl32
    opengl32
    gdi32
)
<span class="org-function-name">target_link_directories</span>(draw2d PRIVATE
    C:/Users/ghostuser/AppData/Local/.xmake/packages/g/glew/2.2.0/f1937cf4c620461cac69417973f0b9e2/lib
    C:/Users/ghostuser/AppData/Local/.xmake/packages/g/glfw/3.3.8/580b60fd05d941e2abb98f9baa25683e/lib
)
<span class="org-function-name">target_link_options</span>(draw2d PRIVATE
    -m64
)
<span class="org-function-name">target_sources</span>(draw2d PRIVATE
    draw2d-raw.cpp
)

</pre>
</div>
</div>
</div>

<div id="outline-container-org59ad1d8" class="outline-3">
<h3 id="org59ad1d8"><span class="section-number-3">1.13</span> Minimal Dlang (D) GLFW and XMake project</h3>
<div class="outline-text-3" id="text-1-13">
<p>
This section provides a minimal OpenGL-GLFW project in <a href="https://dlang.org/">Dlang (D)</a>
programming language with <a href="https://xmake.io/">XMake</a> building system, that uses Lua as an
embedded scripting language and as a DSL (Domain Specific Language) for
describing a projects in multiple programming languages including C,
C++, DLang, Fortran, Rust, Zim, Nim and so on. 
</p>

<p>
The Lua scripting file, xmake.lua describes the project compilation
process that uses multiple programming languages, such as D (DLang)
and C programming language, used by Glew and GLFw libraries.
</p>

<p>
<b>Project Files</b>
</p>

<p>
File: <span class="underline">xmake.lua</span>
</p>

<div class="org-src-container">
<pre class="src src-lua">add_rules(<span class="org-string">"mode.debug"</span>, <span class="org-string">"mode.release"</span>)

add_requires(<span class="org-string">"glew"</span>, <span class="org-string">"glfw"</span>)

target(<span class="org-string">"draw-dlang"</span>)
  set_kind(<span class="org-string">"binary"</span>)
  add_files(<span class="org-string">"draw_dlang.d"</span>)
  add_packages(<span class="org-string">"glew"</span>, <span class="org-string">"glfw"</span>)
  <span class="org-comment-delimiter">-- </span><span class="org-comment">Customize action $ xmake run draw-dlang </span>
  on_run(<span class="org-keyword">function</span> (target)
    <span class="org-builtin">print</span>(<span class="org-string">" [XMAKE HOOK] Running a DLang - D plus OpenGL application."</span>)
     <span class="org-comment-delimiter">-- </span><span class="org-comment">print(" [TARGET] target = ", target)</span>
    <span class="org-builtin">print</span>(<span class="org-string">" [XMAKE HOOK] Running file = "</span>, target:targetfile())
    <span class="org-builtin">print</span>(<span class="org-string">" [XMAKE HOOK] Target directory = "</span>, target:targetdir())
     <span class="org-comment-delimiter">-- </span><span class="org-comment">Run executable (target file) generated by compilation.</span>
    <span class="org-builtin">os</span>.run(target:targetfile())
 <span class="org-keyword">end</span>)

<span class="org-comment-delimiter">-- </span><span class="org-comment">Pseudo target for running a script </span>
target(<span class="org-string">"script"</span>)
  on_run(<span class="org-keyword">function</span>()
    <span class="org-builtin">print</span>(<span class="org-string">" [XMAKE-SCRIPT] Running a script in this target."</span>) 
  <span class="org-keyword">end</span>)
</pre>
</div>

<p>
File: <span class="underline">draw_dlang.d</span> 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">import</span> <span class="org-variable-name">core</span>.stdc.stdio;
<span class="org-type">import</span> <span class="org-variable-name">std</span>.range: empty;
<span class="org-type">import</span> <span class="org-variable-name">str</span> = std.string;
<span class="org-type">import</span> <span class="org-variable-name">std</span>.stdio: writeln;

<span class="org-keyword">const</span>     <span class="org-type">GLFW_RELEASE</span>    = 0;
<span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">GLFW_PRESS</span>      = 1;
<span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">GL_ARRAY_BUFFER</span> = 0x8892;
<span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">GL_LINE_LOOP</span>    = 0x0002;
<span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">GL_TRIANGLES</span>    = 0x0004;
<span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">GL_FLOAT</span>        = 0x1406;
<span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">GL_STATIC_DRAW</span>  = 0x88E4;
<span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">GL_FALSE</span>        = 0;
<span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">GL_TRUE</span>         = 1;

<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>;
    <span class="org-type">GLfloat</span> <span class="org-variable-name">y</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    writeln<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"GLFW with DLang - D Programming language"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Create a windowed mode window and its OpenGL context */</span>
    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"2D Drawing with Dlang, OpenGL and GLFW"</span>, null, null<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>window<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glfwTerminate<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-keyword">return</span> -1;
    <span class="org-rainbow-delimiters-depth-2">}</span>

     <span class="org-comment-delimiter">/* </span><span class="org-comment">Make the window's context current */</span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glClearColor(0.0f, 0.5f, 0.6f, 1.0f);</span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.0f, 0.0, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    Vertex2D<span class="org-rainbow-delimiters-depth-2">[</span>3<span class="org-rainbow-delimiters-depth-2">]</span> triangle_points = <span class="org-rainbow-delimiters-depth-2">[</span>
        <span class="org-constant">Vertex2D</span><span class="org-rainbow-delimiters-depth-3">(</span>-0.25,   -0.25<span class="org-rainbow-delimiters-depth-3">)</span>
      , <span class="org-constant">Vertex2D</span><span class="org-rainbow-delimiters-depth-3">(</span> 0.00,   0.25<span class="org-rainbow-delimiters-depth-3">)</span>
      , <span class="org-constant">Vertex2D</span><span class="org-rainbow-delimiters-depth-3">(</span> 0.25,  -0.25<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-2">]</span>;


    Vertex2D<span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span> square_points = <span class="org-rainbow-delimiters-depth-2">[</span>
        <span class="org-rainbow-delimiters-depth-3">{</span> -0.3,  -0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> -0.3,   0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>  0.3,   0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>  0.3,  -0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">]</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">Create an OpenGL VBO buffer and send vertices to GPU</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; void glGenBuffers (GLsizei n, GLuint *buffers);</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_triangle_</span> = 0;
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo_triangle_ <span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo_triangle_<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, triangle_points.<span class="org-keyword">sizeof</span>, &amp;triangle_points, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_square_</span> = 0;
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo_square_<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> vbo_square_ != 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo_square_<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glBufferData(GL_ARRAY_BUFFER, sizeof(square_points), square_points, GL_STATIC_DRAW);</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, square_points.<span class="org-keyword">sizeof</span>, &amp;square_points, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">shader_attr</span> = 0;

    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>

        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;

        glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">---------- Draw Triangle -----------------//</span>
        <span class="org-comment-delimiter">//</span><span class="org-comment">===========================================//</span>
        glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, vbo_triangle_<span class="org-rainbow-delimiters-depth-3">)</span>;
        glVertexAttribPointer<span class="org-rainbow-delimiters-depth-3">(</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">GLint  index =&gt; Shader attribute location, 0 for now</span>
            shader_attr 
            <span class="org-comment-delimiter">// </span><span class="org-comment">GLint  size  =&gt; 2 components (X, Y) of type GLfloat</span>
          , 2           
            <span class="org-comment-delimiter">// </span><span class="org-comment">GLemum type  =&gt; Type of each component</span>
          , GL_FLOAT    
            <span class="org-comment-delimiter">// </span><span class="org-comment">GLboolean normalized</span>
          , GL_FALSE    
            <span class="org-comment-delimiter">// </span><span class="org-comment">GLsizei stride</span>
          , 0           
            <span class="org-comment-delimiter">// </span><span class="org-comment">const void* pointer</span>
          , null       
          <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Plot 1 triangle (each triangle has 3 vertices)</span>
        glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_TRIANGLES, 0, 3<span class="org-rainbow-delimiters-depth-3">)</span>;


        <span class="org-comment-delimiter">// </span><span class="org-comment">----------- Draw Square ------------------// </span>
        <span class="org-comment-delimiter">//</span><span class="org-comment">===========================================//</span>
        glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, vbo_square_<span class="org-rainbow-delimiters-depth-3">)</span>;
        glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr<span class="org-rainbow-delimiters-depth-3">)</span>;
        glVertexAttribPointer<span class="org-rainbow-delimiters-depth-3">(</span>0, 2, GL_FLOAT, GL_FALSE, 0, null<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Plot 4 vertices</span>
        glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_LINE_LOOP, 0, 4<span class="org-rainbow-delimiters-depth-3">)</span>;


        glfwPollEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Q'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            printf<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"Shutdown program Ok. \n"</span><span class="org-rainbow-delimiters-depth-4">)</span>;
             <span class="org-keyword">break</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

    <span class="org-rainbow-delimiters-depth-2">}</span>


    printf<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" [TRACE] Application started Ok. \n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

   <span class="org-comment-delimiter">// </span><span class="org-comment">------------------ D E F I N I T I O N S   -------------------------//</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Opaque types </span>
<span class="org-type">alias</span> <span class="org-variable-name">GLFWwindow</span> = <span class="org-type">void</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLFWmonitor</span> = <span class="org-type">void</span>;


<span class="org-type">alias</span> <span class="org-variable-name">GLenum</span>     = uint;
<span class="org-type">alias</span> <span class="org-variable-name">GLboolean</span>  = <span class="org-type">char</span>; 
<span class="org-type">alias</span> <span class="org-variable-name">GLbitfield</span> = uint;  
<span class="org-type">alias</span> <span class="org-variable-name">GLvoid</span>     = <span class="org-type">void</span>; 
<span class="org-type">alias</span> <span class="org-variable-name">GLbyte</span>     = <span class="org-type">char</span>; 
<span class="org-type">alias</span> <span class="org-variable-name">GLshort</span>    = <span class="org-type">short</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLint</span>      = <span class="org-type">int</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLubyte</span>    = <span class="org-type">char</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLushort</span>   = ushort;
<span class="org-type">alias</span> <span class="org-variable-name">GLuint</span>     = uint;
<span class="org-type">alias</span> <span class="org-variable-name">GLsizei</span>    = <span class="org-type">int</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLfloat</span>    = <span class="org-type">float</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLclampf</span>   = <span class="org-type">float</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLdouble</span>   = <span class="org-type">double</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLclampd</span>   = <span class="org-type">double</span>;

<span class="org-type">alias</span> <span class="org-variable-name">khronos_ssize_t</span>  = <span class="org-type">long</span>;
<span class="org-type">alias</span> <span class="org-variable-name">khronos_intptr_t</span> = <span class="org-type">long</span>;
<span class="org-type">alias</span> <span class="org-variable-name">GLsizeiptr</span>       = khronos_ssize_t;
<span class="org-type">alias</span> <span class="org-variable-name">GLintptr</span>         = khronos_intptr_t;

<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">int</span>   <span class="org-function-name">glfwInit</span><span class="org-rainbow-delimiters-depth-1">()</span>; 
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span>  <span class="org-function-name">glfwTerminate</span><span class="org-rainbow-delimiters-depth-1">()</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span>  <span class="org-function-name">glfwMakeContextCurrent</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">int</span>   <span class="org-function-name">glfwWindowShouldClose</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">int</span>   <span class="org-function-name">glfwGetKey</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>, <span class="org-type">int</span> <span class="org-variable-name">key</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span>  <span class="org-function-name">glfwPollEvents</span><span class="org-rainbow-delimiters-depth-1">()</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span>  <span class="org-function-name">glfwSwapBuffers</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span>  <span class="org-function-name">glClear</span><span class="org-rainbow-delimiters-depth-1">(</span>GLbitfield<span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">GLFWwindow</span>* <span class="org-function-name">glfwCreateWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span>
                            , <span class="org-type">GLFWmonitor</span>* <span class="org-variable-name">monitor</span>, <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">share</span><span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">----- OpenGL APIs ---------------------- //</span>
<span class="org-comment-delimiter">//</span>
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span> <span class="org-function-name">glBindBuffer</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLenum</span> <span class="org-variable-name">target</span>, <span class="org-type">GLuint</span> <span class="org-variable-name">buffer</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span> <span class="org-function-name">glClearColor</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLclampf</span> <span class="org-variable-name">red</span>, <span class="org-type">GLclampf</span> <span class="org-variable-name">green</span>, <span class="org-type">GLclampf</span> <span class="org-variable-name">blue</span>, <span class="org-type">GLclampf</span> <span class="org-variable-name">alpha</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span> <span class="org-function-name">glGenBuffers</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLsizei</span> <span class="org-variable-name">n</span>, <span class="org-type">GLuint</span> *<span class="org-variable-name">buffers</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span> <span class="org-function-name">glEnableVertexAttribArray</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">index</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span> <span class="org-function-name">glDrawArrays</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLenum</span> <span class="org-variable-name">mode</span>, <span class="org-type">GLint</span> <span class="org-variable-name">first</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">count</span> <span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span> <span class="org-function-name">glBufferData</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLenum</span> <span class="org-variable-name">target</span>, <span class="org-type">GLsizeiptr</span> <span class="org-variable-name">size</span>
                            , <span class="org-keyword">const</span> <span class="org-type">void</span> *<span class="org-variable-name">data</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">usage</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">extern</span><span class="org-rainbow-delimiters-depth-1">(</span>C<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-type">void</span> <span class="org-function-name">glVertexAttribPointer</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">index</span>, <span class="org-type">GLint</span> <span class="org-variable-name">size</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span>
                                    , <span class="org-type">GLboolean</span> <span class="org-variable-name">normalized</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">stride</span>
                                    , <span class="org-keyword">const</span> <span class="org-type">void</span> *<span class="org-variable-name">pointer</span><span class="org-rainbow-delimiters-depth-1">)</span>;

</pre>
</div>


<p>
<b>Building with XMake</b> 
</p>

<p>
Build only the target <span class="underline">draw-dlang</span>: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake build -v draw-dlang  

checking for <span class="org-variable-name">dmd </span>... <span class="org-compilation-warning">/home/user/dlang/dmd-2.100.0/linux/bin64/dmd</span>
checking for <span class="org-variable-name">the dlang compiler (dc) </span>... <span class="org-compilation-warning">dmd</span>
checking for <span class="org-variable-name">/home/user/dlang/dmd-2.100.0/linux/bin64/dmd </span>... <span class="org-compilation-warning">ok</span>
checking for <span class="org-variable-name">flags (-O -release -inline -boundscheck=off) </span>... <span class="org-compilation-warning">ok</span>
[ 25%]: compiling.release draw_dlang.d
/home/user/dlang/dmd-2.100.0/linux/bin64/dmd -c -m64 -O -release -inline -boundscheck=off <span class="org-sh-escaped-newline">\</span>
          -I/home/user/.xmake/packages/g/glew/2.2.0/2ac0c6940a2140f7b6506fcd8240f406/include <span class="org-sh-escaped-newline">\</span>
          -I/home/user/.xmake/packages/g/glfw/3.3.8/aa037e96cc854680a09e144c4b5c8fe0/include <span class="org-sh-escaped-newline">\</span>
          -I/usr/include/X11/dri -ofbuild/.objs/draw-dlang/linux/x86_64/release/draw_dlang.d.o draw_dlang.d
checking for <span class="org-variable-name">dmd </span>... <span class="org-compilation-warning">/home/user/dlang/dmd-2.100.0/linux/bin64/dmd</span>
checking for <span class="org-variable-name">the dlang linker (dcld) </span>... <span class="org-compilation-warning">dmd</span>

[ 50%]: linking.release draw-dlang
/home/user/dlang/dmd-2.100.0/linux/bin64/dmd -m64 <span class="org-sh-escaped-newline">\</span>
          -L-L/home/user/.xmake/packages/g/glew/2.2.0/2ac0c6940a2140f7b6506fcd8240f406/lib <span class="org-sh-escaped-newline">\</span>
          -L-L/home/user/.xmake/packages/g/glfw/3.3.8/aa037e96cc854680a09e144c4b5c8fe0/lib <span class="org-sh-escaped-newline">\</span>
          -L-L/usr/lib/x86_64-linux-gnu -L-s -L-lglew -L-lglfw3 -L-lOpenGL -L-lXrandr -L-lXinerama -L-lXcursor <span class="org-sh-escaped-newline">\</span>
          -L-lXrender -L-lX11 -L-lXi -L-lXfixes -L-lXext -L-lxcb -L-lssl -L-lcrypto -L-lffi <span class="org-sh-escaped-newline">\</span>
          -L-lz -L-lXau -L-lXdmcp -L-lGL -L-ldl -L-lpthread <span class="org-sh-escaped-newline">\</span>
          -ofbuild/linux/x86_64/release/draw-dlang <span class="org-sh-escaped-newline">\</span>
          build/.objs/draw-dlang/linux/x86_64/release/draw_dlang.d.o
[100%]: build ok!
</pre>
</div>

<p>
Run the scripting target: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake run script
 [XMAKE-SCRIPT] Running a script<span class="org-keyword"> in</span> this target.
</pre>
</div>

<p>
Run the target <span class="underline">draw-dlang</span>:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake run draw-dlang
 [XMAKE HOOK] Running a DLang - D plus OpenGL application.
 [XMAKE HOOK] Running file =  build/linux/x86_64/release/draw-dlang
 [XMAKE HOOK] Target directory =  build/linux/x86_64/release
</pre>
</div>

<p>
Screenshot: 
</p>


<div class="figure">
<p><a href="images/opengl-draw2d-dlang1.png"><img src="images/opengl-draw2d-dlang1.png" alt="opengl-draw2d-dlang1.png" /></a>
</p>
</div>
</div>
</div>

<div id="outline-container-org6d6a1a2" class="outline-3">
<h3 id="org6d6a1a2"><span class="section-number-3">1.14</span> Minimal SDL project</h3>
<div class="outline-text-3" id="text-1-14">
<p>
The next code uses the SLD (Simple Direct Media Layer) library instead
of GLFW for window system abstraction. The advantage of SDL over GLFW
is that, SDL supports more platforms and is able to deal with audio
and image loading, which are essential features for rich multimedia
applications. This CMake script automatically downloads SDL and
defines a macro for making it easier to create OpenGL apps with
SDL statically linked.  
</p>

<p>
SDL Web Sites: 
</p>

<ul class="org-ul">
<li><a href="https://www.libsdl.org/">https://www.libsdl.org/</a></li>

<li><a href="https://github.com/libsdl-org/SDL">https://github.com/libsdl-org/SDL</a> (Repository)</li>

<li><a href="https://github.com/libSDL2pp/libSDL2pp">https://github.com/libSDL2pp/libSDL2pp</a> (C++ Wrapper)</li>
</ul>


<p>
<b>Project Files</b> 
</p>

<p>
File: <span class="underline">CMakeLists.txt</span> 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(OPENGL_SDL_project)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)
<span class="org-comment"># Download GLM (OpenGL math library for matrix and vectors transformation)</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glm  
  URL  https://github.com/g-truc/glm/archive/0.9.8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glm)
<span class="org-function-name">include_directories</span>(${<span class="org-variable-name">glm_SOURCE_DIR</span>} )

<span class="org-comment"># Donwload library SLD - Simple Direct Media Layer </span>
<span class="org-function-name">FetchContent_Declare</span>(
  sdl  
  URL    https://github.com/libsdl-org/SDL/archive/refs/tags/release-2.0.14.zip 
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(sdl)
<span class="org-comment"># find_package( SDL REQUIRED )</span>

<span class="org-function-name">file</span>(MAKE_DIRECTORY  ${<span class="org-variable-name">sdl_SOURCE_DIR</span>}/headers/SDL2)
<span class="org-function-name">file</span>(COPY  ${<span class="org-variable-name">sdl_SOURCE_DIR</span>}/include/ 
           DESTINATION ${<span class="org-variable-name">sdl_SOURCE_DIR</span>}/headers/SDL2 
           FILES_MATCHING PATTERN <span class="org-string">"*.h"</span>
           )

               <span class="org-function-name">add_library</span>( sdl-include  INTERFACE )
<span class="org-function-name">target_include_directories</span>( sdl-include  INTERFACE ${<span class="org-variable-name">sdl_SOURCE_DIR</span>}/headers )
<span class="org-comment"># Option for making this target IDE-friendly</span>
<span class="org-keyword">IF</span>(false)
<span class="org-function-name">target_sources</span>( sdl-include INTERFACE  
                              ${<span class="org-variable-name">sdl_SOURCE_DIR</span>}/headers/SDL2/SDL.h   
                              ${<span class="org-variable-name">sdl_SOURCE_DIR</span>}/headers/SDL2/SDL_opengl.h  
                           )

<span class="org-keyword">ENDIF</span>()

<span class="org-comment"># Download pre-compiled GLEW when building under Windows NT OS (x64)</span>
<span class="org-keyword">IF</span>(WIN32)
   <span class="org-function-name">FetchContent_Declare</span>(
      glew-release 
      URL   https://ufpr.dl.sourceforge.net/project/glew/glew/2.1.0/glew-2.1.0-win32.zip 
      <span class="org-comment"># https://github.com/nigels-com/glew/archive/glew-2.2.0.zip</span>
   )
   <span class="org-function-name">FetchContent_MakeAvailable</span>(glew-release)
   <span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/include  ${<span class="org-variable-name">glm_SOURCE_DIR</span>} )        
   <span class="org-function-name">link_directories</span>(  ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64 )

   <span class="org-function-name">set</span>( GLEW_LIB_PATH1 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32.lib )
   <span class="org-function-name">set</span>( GLEW_LIB_PATH2 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32s.lib )
<span class="org-keyword">ENDIF</span>()

<span class="org-keyword">MACRO</span>(ADD_OPENGL_APP target sources)
   <span class="org-function-name">add_executable</span>( ${<span class="org-variable-name">target</span>} ${<span class="org-variable-name">sources</span>} )
   <span class="org-function-name">message</span>([TRACE] <span class="org-string">" Add OpenGL executable = ${</span><span class="org-variable-name">target</span><span class="org-string">} "</span>)

   <span class="org-function-name">target_link_libraries</span>( ${<span class="org-variable-name">target</span>} OpenGL::GL SDL2-static sdl-include 
                                    ${<span class="org-variable-name">GLEW_LIB_PATH1</span>}
                                    ${<span class="org-variable-name">GLEW_LIB_PATH2</span>} )

    <span class="org-keyword">IF</span>(MINGW)
        <span class="org-comment"># Statically link against MINGW dependencies</span>
        <span class="org-comment"># for making easier to deploy on other machines. </span>
        <span class="org-function-name">target_link_options</span>( ${<span class="org-variable-name">target</span>} PRIVATE                                 
                                 -static-libgcc
                                 -static-libstdc++
                                 -Wl,-Bstatic,--whole-archive -lwinpthread
                                   -Wl,--no-whole-archive                                    
                                 )
     <span class="org-keyword">ENDIF</span>()       


     <span class="org-comment"># Copy GLEW DLL shared library to same directory as the executable.                 </span>
     <span class="org-keyword">IF</span>(WIN32)                           
        <span class="org-function-name">add_custom_command</span>(TARGET ${<span class="org-variable-name">target</span>} POST_BUILD 
                       COMMAND ${<span class="org-variable-name">CMAKE_COMMAND</span>} -E copy_if_different
                       <span class="org-string">"${</span><span class="org-variable-name">glew-release_SOURCE_DIR</span><span class="org-string">}/bin/Release/x64/glew32.dll"</span>              
                       $&lt;TARGET_FILE_DIR:${<span class="org-variable-name">target</span>}&gt;)
     <span class="org-keyword">ENDIF</span>()                                       
<span class="org-keyword">ENDMACRO</span>()     


      <span class="org-comment">#========== Targets Configurations ================#</span>

<span class="org-function-name">ADD_OPENGL_APP</span>( opengl-sdl opengl-sdl.cpp )

</pre>
</div>


<p>
File: <span class="underline">xmake.lua</span>  (See: <a href="https://github.com/xmake-io/xmake-repo/blob/master/packages/l/libsdl/xmake.lua">libsdl</a> package)
</p>

<div class="org-src-container">
<pre class="src src-lua">add_rules(<span class="org-string">"mode.debug"</span>, <span class="org-string">"mode.release"</span>)

add_requires(<span class="org-string">"glm"</span>, <span class="org-string">"glew"</span>, <span class="org-string">"libsdl 2.0.14"</span>)

target(<span class="org-string">"draw2d"</span>)
  set_kind(<span class="org-string">"binary"</span>)
  add_files(<span class="org-string">"./opengl-sdl.cpp"</span>)
  add_packages(<span class="org-string">"glm"</span>, <span class="org-string">"glew"</span>, <span class="org-string">"libsdl"</span>)
</pre>
</div>


<p>
File: <span class="underline">opengl-sdl.cpp</span> 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>_WIN32<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">windows.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glew.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>

<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

<span class="org-preprocessor">#define</span> <span class="org-variable-name">SDL_MAIN_HANDLED</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">SDL2/SDL.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">SDL2/SDL_opengl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- OpenGL Math Library ------------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for 2D vertex coordinates</span>
<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-1">{</span>  <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for RGB colors</span>
<span class="org-keyword">struct</span> <span class="org-type">ColorRGB</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">COLOR_R</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 0.0, 0.0  <span class="org-rainbow-delimiters-depth-1">}</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Red</span>
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">COLOR_G</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 1.0, 0.0  <span class="org-rainbow-delimiters-depth-1">}</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Green</span>
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">COLOR_B</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 0.0, 1.0  <span class="org-rainbow-delimiters-depth-1">}</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Blue</span>

<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>
                , <span class="org-type">void</span>* <span class="org-variable-name">pBufffer</span>, <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span>, <span class="org-type">GLint</span> <span class="org-variable-name">size</span>
                , <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">shader_vertex</span>; 
<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">shader_fragment</span>;

<span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">matrix_identity</span> = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-1">(</span>1.0<span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span> 
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" [TRACE] OpenGL SDL started Ok. "</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">int</span> <span class="org-variable-name">window_x</span> = 100, <span class="org-variable-name">window_y</span> = 100, <span class="org-variable-name">window_w</span> = 500, <span class="org-variable-name">window_h</span> = 400;
    <span class="org-type">SDL_Window</span>* <span class="org-variable-name">window</span> = SDL_CreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>  
                                <span class="org-string">"OpenGL with SLD library"</span>
                               , window_x, window_y  <span class="org-comment-delimiter">// </span><span class="org-comment">Window position </span>
                               , window_w, window_h  <span class="org-comment-delimiter">// </span><span class="org-comment">Window width and height </span>
                               , SDL_WINDOW_OPENGL   <span class="org-comment-delimiter">// </span><span class="org-comment">Bitwise-OR flags  </span>
                               <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">SDL_GLContext</span> <span class="org-variable-name">ctx</span> = SDL_GL_CreateContext<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">--- Initialize GLEW library after OpenGL context --------- //</span>
<span class="org-preprocessor">    #if</span> _WIN32
    glewExperimental = GL_TRUE;
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span>glewInit<span class="org-rainbow-delimiters-depth-3">()</span> != GLEW_OK<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"GLEW::Error : failed to initialize GLEW"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [TRACE] Glew Initialized Ok. \n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">    #endif</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== C O M P I L E  - S H A D E R ================== // </span>

    <span class="org-type">GLuint</span> <span class="org-variable-name">prog</span> = glCreateProgram<span class="org-rainbow-delimiters-depth-2">()</span>;
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, shader_vertex,   GL_VERTEX_SHADER   <span class="org-rainbow-delimiters-depth-2">)</span> ;
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, shader_fragment, GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUseProgram<span class="org-rainbow-delimiters-depth-2">(</span>prog<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable location for projection matrix</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">See shader code: "uniform mat4 projection;"</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_projection"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_proj &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable  location for model matrix.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_model</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_model &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader attribute location - the function glGetAttribLocation</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">returns (-1) on error.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_position &gt;= 0 &amp;&amp; <span class="org-string">"Failed to get attribute location"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [TRACE] Attribute location attr_position = %d \n"</span>
                , attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader index of color attribute variable.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_color &gt;= 0<span class="org-rainbow-delimiters-depth-2">)</span>;

    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_proj,  1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">======== U P L O A D - T O - G P U ==============================// </span>

    <span class="org-keyword">constexpr</span> <span class="org-type">size_t</span> <span class="org-variable-name">NUM_VERTICES</span> = 3;

    <span class="org-type">float</span> <span class="org-variable-name">a</span> = 0.25;

    <span class="org-type">Vertex2D</span> <span class="org-variable-name">vertices</span><span class="org-rainbow-delimiters-depth-2">[</span>NUM_VERTICES<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
      <span class="org-rainbow-delimiters-depth-3">{</span>  0.0  ,   a * sqrt<span class="org-rainbow-delimiters-depth-4">(</span>3.0f<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 0  </span>
    , <span class="org-rainbow-delimiters-depth-3">{</span> -2 * a,  -2 * a          <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 1  </span>
    , <span class="org-rainbow-delimiters-depth-3">{</span>  2 * a,  -2 * a          <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 2  </span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">ColorRGB</span> <span class="org-variable-name">colors</span><span class="org-rainbow-delimiters-depth-2">[</span>NUM_VERTICES<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-rainbow-delimiters-depth-3">{</span>0.4, 0.2, 0.67<span class="org-rainbow-delimiters-depth-3">}</span> 
        , <span class="org-rainbow-delimiters-depth-3">{</span>0.8, 0.6, 0.30<span class="org-rainbow-delimiters-depth-3">}</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span>0.2, 0.6, 0.10<span class="org-rainbow-delimiters-depth-3">}</span>  
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Always initialize with zero (0), otherwise, the values</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">of those variables will be undefined. (Undefine Behavior)</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_triangle</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_vertices</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_colors</span>   = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Send vertices to GPU VBO (vbo_vertices)</span>
    send_buffer<span class="org-rainbow-delimiters-depth-2">(</span>  &amp;vao_triangle    <span class="org-comment-delimiter">// </span><span class="org-comment">Ponter to VAO [OUTPUT]</span>
                , &amp;vbo_vertices    <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer VBO   [OUTPUT]</span>
                , <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>vertices<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Size of buffer sent to GPU (VBO memory)</span>
                , vertices         <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to buffer</span>
                , attr_position    <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location</span>
                , 2                <span class="org-comment-delimiter">// </span><span class="org-comment">Each vertex has 2 coordinates (X, Y)</span>
                , GL_FLOAT         <span class="org-comment-delimiter">// </span><span class="org-comment">Each vertex coordinate has type GLfloat (float)</span>
                <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Send colors to GPU VBO (vbo_colors)</span>
    send_buffer<span class="org-rainbow-delimiters-depth-2">(</span>  &amp;vao_triangle   <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer Vertex Array object</span>
                , &amp;vbo_colors     <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer Vertex buffer object handle (aka token)</span>
                , <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>colors<span class="org-rainbow-delimiters-depth-3">)</span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Buffer size</span>
                , colors          <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to buffer (addrress of first buffer element)</span>
                , attr_color      <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location</span>
                , 3               <span class="org-comment-delimiter">// </span><span class="org-comment">Each color has 3 coordinates (R, G, B)</span>
                , GL_FLOAT        <span class="org-comment-delimiter">// </span><span class="org-comment">Each color coordiante has type GLfloat</span>
                <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">model</span>; 

    <span class="org-comment-delimiter">// </span><span class="org-comment">======== R E N D E R I N G - L O O P ============================//</span>

    <span class="org-type">bool</span> <span class="org-variable-name">is_running</span> = <span class="org-constant">true</span>; 

    <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-2">(</span> is_running <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">SDL_Event</span> <span class="org-variable-name">event</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] Waiting SDL event \n"); </span>

        <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-3">(</span> SDL_PollEvent<span class="org-rainbow-delimiters-depth-4">(</span>&amp;event<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] Polling event \n");</span>

            <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-4">(</span> event.type == SDL_QUIT <span class="org-rainbow-delimiters-depth-4">){</span> is_running == <span class="org-constant">false</span>; <span class="org-rainbow-delimiters-depth-4">}</span>

            <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-4">(</span> event.type == SDL_WINDOWEVENT 
                &amp;&amp; event.window.event == SDL_WINDOWEVENT_CLOSE <span class="org-rainbow-delimiters-depth-4">)</span>
            <span class="org-rainbow-delimiters-depth-4">{</span>  is_running = <span class="org-constant">false</span>; 
               SDL_Quit<span class="org-rainbow-delimiters-depth-5">()</span>; 
            <span class="org-rainbow-delimiters-depth-4">}</span>
        <span class="org-rainbow-delimiters-depth-3">}</span>

        glViewport<span class="org-rainbow-delimiters-depth-3">(</span>0, 0, window_w, window_h<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL Background color (black for avoiding eye strain)</span>
        glClearColor<span class="org-rainbow-delimiters-depth-3">(</span>0.0f, 0.0f, 0.0f, 1.0f<span class="org-rainbow-delimiters-depth-3">)</span>;
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">=== BEGIN REDERING ========// </span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">------ Draw triangle 1 ------ //  </span>
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_triangle<span class="org-rainbow-delimiters-depth-3">)</span>;
            model = matrix_identity;
            model = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-3">(</span>model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-4">(</span>0.35, 0.22, 0.0<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>model<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_TRIANGLES, 0, 3<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">------ Draw triangle 2 ------ //</span>
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_triangle<span class="org-rainbow-delimiters-depth-3">)</span>;
            model = matrix_identity;
            model = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-3">(</span>model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-4">(</span>-0.5, -0.4, 0.0<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            model = <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-3">(</span>model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-4">(</span>0.5, 0.5, 0.5 <span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-3">(</span>model, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-4">(</span>25.0f<span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-4">(</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>model<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_TRIANGLES, 0, 3<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">=== END RENDERING ==========// </span>

        SDL_GL_SwapWindow<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" [TRACE] Shutdown gracefully. "</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span> 

<span class="org-comment-delimiter">// </span><span class="org-comment">----- I M P L E M E N T A T I O N S --------------// </span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== I M P L E M E N T A T I O N S ==========//</span>

<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_id</span> = glCreateShader<span class="org-rainbow-delimiters-depth-2">(</span> type <span class="org-rainbow-delimiters-depth-2">)</span>;
    glShaderSource<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, 1, &amp;code, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glCompileShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">is_compiled</span> = GL_FALSE;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check shader compilation result</span>
    glGetShaderiv<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, GL_COMPILE_STATUS, &amp;is_compiled<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">If there is any shader compilation result,</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">print the error message.</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> is_compiled == GL_FALSE<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">GLint</span> <span class="org-variable-name">length</span>;
        glGetShaderiv<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, GL_INFO_LOG_LENGTH, &amp;length<span class="org-rainbow-delimiters-depth-3">)</span>;
        assert<span class="org-rainbow-delimiters-depth-3">(</span> length &gt; 0 <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">out</span><span class="org-rainbow-delimiters-depth-3">(</span>length + 1, 0x00<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">GLint</span> <span class="org-variable-name">chars_written</span>;
        glGetShaderInfoLog<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, length, &amp;chars_written, <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">char</span>*<span class="org-rainbow-delimiters-depth-4">)</span> out.data<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SHADER ERROR] = "</span> &lt;&lt; out &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Abort the exection of current process.</span>
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    glAttachShader<span class="org-rainbow-delimiters-depth-2">(</span>m_program, shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDeleteShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glLinkProgram<span class="org-rainbow-delimiters-depth-2">(</span>m_program<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">link_status</span> = GL_FALSE;
    glGetProgramiv<span class="org-rainbow-delimiters-depth-2">(</span>m_program, GL_LINK_STATUS, &amp;link_status<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> link_status != GL_FALSE <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUseProgram(m_program);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload buffer from main memory to GPU VBO</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; Parameters VAO, VBO are allocated by the caller.</span>
<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>
                , <span class="org-type">void</span>* <span class="org-variable-name">pBufffer</span>, <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span>, <span class="org-type">GLint</span> <span class="org-variable-name">size</span>
                , <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVao != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVbo != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = *pVbo;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>vao == 0<span class="org-rainbow-delimiters-depth-2">){</span> glGenVertexArrays<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, sizeBuffer, pBufffer, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr, size, type, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute</span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">----- S H A D E R S ------------------------------// </span>

<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">shader_vertex</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330 core</span>

<span class="org-string">    layout ( location = 2)  in vec2 position;</span>
<span class="org-string">    layout ( location = 1 ) in vec3 color;</span>

<span class="org-string">    out vec3 out_color;</span>
<span class="org-string">    uniform mat4 u_model;</span>
<span class="org-string">    uniform mat4 u_projection;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">       gl_Position = u_projection * u_model * vec4(position, 0, 1.0);</span>
<span class="org-string">       out_color = color;</span>
<span class="org-string">    }</span>

<span class="org-string"> )</span><span class="org-default">"</span>;


<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">shader_fragment</span> = R<span class="org-default">"</span><span class="org-string">( </span>
<span class="org-string">    #version 330</span>

<span class="org-string">    // This color comes from Vertex shader</span>
<span class="org-string">    in vec3 out_color;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // Set vertex colors</span>
<span class="org-string">        gl_FragColor = vec4(out_color, 1.0);</span>
<span class="org-string">    }</span>

<span class="org-string">)</span><span class="org-default">"</span>;
</pre>
</div>


<p>
<b>Building</b> 
</p>

<p>
Building on Linux. 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmkae -H. -B_build_linux -DCMAKE_BUILD_TYPE=Debug
$ cmkae --build _build_linux --target 
</pre>
</div>

<p>
Building for Windows NT (cross-compilation) from Linux.
</p>

<div class="org-src-container">
<pre class="src src-sh">$ docker run -it --rm -v $<span class="org-variable-name">PWD</span>:/cwd -w /cwd --entrypoint=bash dockcross/windows-static-x64
$ cmake -H. -B_build_windows -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build_windows --target 

$ ls 
CMakeCache.txt  Makefile                 _deps                glew32.dll
CMakeFiles      SDL2ConfigVersion.cmake  cmake_install.cmake  opengl-sdl.exe
</pre>
</div>

<p>
Run with wine: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ wine _build_windows/opengl-sdl.exe 
</pre>
</div>

<p>
Building with Xmake: 
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ xmake -P .
[100%]: build ok!
</pre>
</div>

<p>
Running the application: (default target)
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake run -P .
[TRACE] OpenGL SDL started Ok. 
[TRACE] Attribute location attr_position = 2 
[TRACE] Shutdown gracefully. 
</pre>
</div>

<p>
Generate a CMake file and edit with VSCode or CLion: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake project -k cmake  -P . 
create ok!

<span class="org-comment-delimiter"># </span><span class="org-comment">Edit the project with VSCode </span>
$ vscode . 
</pre>
</div>
</div>
</div>

<div id="outline-container-org35908ee" class="outline-3">
<h3 id="org35908ee"><span class="section-number-3">1.15</span> Minimal Qt5 OpenGL project</h3>
<div class="outline-text-3" id="text-1-15">
<p>
Qt Framework is a better fit for non-games cross-platform OpenGL
graphical applications like 3D drawing akin to Blender, CAD
(Computer-Aided Design), scientific visualization and charts than
GLFW, SDL or SFML as those window abstraction libraries lack widgets,
such as buttons, menus, text entry and so on which are necessary for
rich and complex interaction. Other significant advantage of Qt over
the aforementioned libraries is that the Qt framework already has
everything that is needed for developing OpenGL applications,
including, OpenGL loading, 4x4 matrix, quaternion, OpenGL
widget and scene graph.
</p>

<p>
Documentation: 
</p>

<ul class="org-ul">
<li><a href="https://doc.qt.io/qt-5/qopenglwindow.html">QOpenGLWindow class</a></li>

<li><a href="https://doc.qt.io/qt-5/qopenglwidget.html">QOPenGLWidget class</a></li>

<li><a href="https://doc.qt.io/qt-5/qopenglshaderprogram.html">QOpenGLShaderProgram</a></li>

<li><a href="https://doc.qt.io/qt-5/qvector3d.html">QVector3D class</a></li>

<li><a href="https://doc.qt.io/qt-5/qvector4d.html">QVector4D class</a></li>

<li><a href="https://doc.qt.io/qt-5/qquaternion.html">QQuaternion class</a></li>

<li><a href="https://doc.qt.io/qt-5/qmatrix4x4.html">QMatrix4x4 class</a></li>

<li><a href="https://doc.qt.io/qt-5/qt3d-index.html">Qt3D Core Module</a></li>
</ul>

<p>
Examples: 
</p>

<ul class="org-ul">
<li><a href="https://doc.qt.io/qt-5/qtopengl-cube-example.html">https://doc.qt.io/qt-5/qtopengl-cube-example.html</a></li>

<li><a href="https://doc.qt.io/qt-5/qtopengl-2dpainting-example.html">https://doc.qt.io/qt-5/qtopengl-2dpainting-example.html</a></li>

<li><a href="https://doc.qt.io/qt-5/qtgui-openglwindow-example.html">https://doc.qt.io/qt-5/qtgui-openglwindow-example.html</a></li>
</ul>

<p>
<b>Screenshot</b> 
</p>

<p>
In this sample application, the vertex data is uploaded only once to
the GPU via VBO (Vertex Buffer Object) and used for drawing two
triangles, which the positions are set via affine trasnform
objects. The program has tree buttons that controls the second
triangle by performing the following set of operations: scale
increasing; scale decreasing and rotation.
</p>


<div class="figure">
<p><a href="images/opengl-qt3d-minimal.png"><img src="images/opengl-qt3d-minimal.png" alt="opengl-qt3d-minimal.png" /></a>
</p>
<p><span class="figure-number">Figure 7: </span>Minimal Qt 3D OpenGL application.</p>
</div>

<p>
<b>Project Files</b> 
</p>

<p>
File: <span class="underline">CMakeLists.txt</span> 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.9)
<span class="org-function-name">project</span>(Qt5_Widget_OpenGL)

<span class="org-comment">#====== Global Configurations ==================#</span>

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)
<span class="org-function-name">set</span>(CMAKE_INCLUDE_CURRENT_DIR ON)
<span class="org-function-name">set</span>(CMAKE_AUTOUIC ON)
<span class="org-function-name">set</span>(CMAKE_AUTOMOC ON)
<span class="org-function-name">set</span>(CMAKE_AUTORCC ON)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)

<span class="org-function-name">find_package</span>(Qt5 COMPONENTS Core Widgets REQUIRED)

<span class="org-comment">#=============== Target Configurations ============#</span>
<span class="org-function-name">SET</span>(QT5_LINK_LIBRARIES Qt5::Core Qt5::Gui Qt5::Widgets)

       <span class="org-function-name">add_executable</span>( qt-opengl qt-opengl.cpp )
<span class="org-function-name">target_link_libraries</span>( qt-opengl  Qt5::Core Qt5::Gui Qt5::Widgets )

</pre>
</div>

<p>
File: <span class="underline">meson.build</span> (Note: poor IDE support) - For <a href="https://mesonbuild.com/">Meson</a> Building System
</p>
<ul class="org-ul">
<li>Docs: <a href="https://mesonbuild.com/Tutorial.html">meson-tutorial</a> <a href="https://mesonbuild.com/Qt5-module.html">qt5-meson</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-python">project(<span class="org-string">'qt-opengl-meson'</span>, <span class="org-string">'cpp'</span>)

<span class="org-variable-name">qt5</span>      = <span class="org-keyword">import</span>(<span class="org-string">'qt5'</span>)
<span class="org-variable-name">qt5_deps</span> = dependency(<span class="org-string">'qt5'</span>, modules: [<span class="org-string">'Core'</span>, <span class="org-string">'Gui'</span>, <span class="org-string">'Widgets'</span>] )

executable( <span class="org-string">'qt-opengl'</span>             <span class="org-comment-delimiter"># </span><span class="org-comment">Executable name without extension </span>
          , <span class="org-string">'qt-opengl.cpp'</span>         <span class="org-comment-delimiter"># </span><span class="org-comment">Source files</span>
          , dependencies: qt5_deps  <span class="org-comment-delimiter"># </span><span class="org-comment">Depencies </span>
          ) 
</pre>
</div>

<p>
File: <span class="underline">xmake.lua</span> - For <a href="https://xmake.io/#/">XMake</a> building system 
</p>

<div class="org-src-container">
<pre class="src src-lua">add_rules(<span class="org-string">"mode.debug"</span>, <span class="org-string">"mode.release"</span>)

target(<span class="org-string">"qt-opengl"</span>)
    add_rules(<span class="org-string">"qt.widgetapp"</span>)
    set_languages(<span class="org-string">"c99"</span>, <span class="org-string">"c++1z"</span>)
    add_files(<span class="org-string">"qt-opengl.cpp"</span>)
</pre>
</div>


<p>
File: <span class="underline">qt-opengl.cpp</span> 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">QtWidgets</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">QApplication</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">QOpenGLWindow</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">QOpenGLContext</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">QOpenGLBuffer</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">QOpenGLShaderProgram</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>


<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">shader_vertex</span>;
<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">shader_fragment</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for 2D vertex coordinates</span>
<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-1">{</span>  <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for RGB colors</span>
<span class="org-keyword">struct</span> <span class="org-type">ColorRGB</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">Mesh</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">QOpenGLBuffer</span>*            <span class="org-variable-name">vbo_vertex</span>  = <span class="org-constant">nullptr</span>;
    <span class="org-type">QOpenGLBuffer</span>*            <span class="org-variable-name">vbo_color</span>   = <span class="org-constant">nullptr</span>;
    <span class="org-type">QOpenGLVertexArrayObject</span>* <span class="org-variable-name">vao</span>         = <span class="org-constant">nullptr</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">Transform</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">QVector3D</span>   <span class="org-variable-name">position</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.0,  0.0,  0.0,   <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-type">QVector3D</span>   <span class="org-variable-name">scale</span>    = <span class="org-rainbow-delimiters-depth-2">{</span>1.0f, 1.0f, 1.0f   <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-type">QQuaternion</span> <span class="org-variable-name">rotation</span> = <span class="org-rainbow-delimiters-depth-2">{</span>1.0, 0.0, 0.0, 0.0 <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Cached affine trasnform for speeding up computation</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">by tranding off time for space.</span>
    <span class="org-type">QMatrix4x4</span> <span class="org-variable-name">trasnform</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">When this flag is true, the transform is computed again.</span>
    <span class="org-type">bool</span> <span class="org-variable-name">is_changed</span> = <span class="org-constant">false</span>;

    <span class="org-type">Transform</span>&amp; <span class="org-function-name">setPosition</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-type">float</span> <span class="org-variable-name">y</span>, <span class="org-type">float</span> <span class="org-variable-name">z</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        position = <span class="org-rainbow-delimiters-depth-3">{</span>x, y, z<span class="org-rainbow-delimiters-depth-3">}</span>;
        is_changed = <span class="org-constant">true</span>;
        <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">Transform</span>&amp; <span class="org-function-name">displace</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">dx</span>, <span class="org-type">float</span> <span class="org-variable-name">dy</span>, <span class="org-type">float</span> <span class="org-variable-name">dz</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        position = <span class="org-rainbow-delimiters-depth-3">{</span> position.x<span class="org-rainbow-delimiters-depth-4">()</span> + dx, position.y<span class="org-rainbow-delimiters-depth-4">()</span> + dy, position.z<span class="org-rainbow-delimiters-depth-4">()</span> + dz <span class="org-rainbow-delimiters-depth-3">}</span>;
        is_changed = <span class="org-constant">true</span>;
        <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">Transform</span>&amp;  <span class="org-function-name">setRotationZ</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        rotation = <span class="org-constant">QQuaternion</span>::fromAxisAndAngle<span class="org-rainbow-delimiters-depth-3">(</span> QVector3D<span class="org-rainbow-delimiters-depth-4">{</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-4">}</span>, angle <span class="org-rainbow-delimiters-depth-3">)</span>;
        is_changed = <span class="org-constant">true</span>;
        <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">Transform</span>&amp; <span class="org-function-name">rotateZ</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        rotation = rotation * <span class="org-constant">QQuaternion</span>::fromAxisAndAngle<span class="org-rainbow-delimiters-depth-3">(</span> QVector3D<span class="org-rainbow-delimiters-depth-4">{</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-4">}</span>, angle <span class="org-rainbow-delimiters-depth-3">)</span>;
        is_changed = <span class="org-constant">true</span>;
        <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">Transform</span>&amp; <span class="org-function-name">setScale</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">f</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        scale = <span class="org-rainbow-delimiters-depth-3">{</span>f, f, f<span class="org-rainbow-delimiters-depth-3">}</span>;
        is_changed = <span class="org-constant">true</span>;
        <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">Transform</span>&amp; <span class="org-function-name">addScale</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">f</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        scale = <span class="org-rainbow-delimiters-depth-3">{</span> scale.x<span class="org-rainbow-delimiters-depth-4">()</span> + f, scale.y<span class="org-rainbow-delimiters-depth-4">()</span> + f, scale.z<span class="org-rainbow-delimiters-depth-4">()</span> + f <span class="org-rainbow-delimiters-depth-3">}</span>;
        is_changed = <span class="org-constant">true</span>;
        <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">QMatrix4x4</span> <span class="org-function-name">value</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> is_changed <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span>stderr, <span class="org-string">" [TRACE] Affine transform recalculated. Ok. \n"</span><span class="org-rainbow-delimiters-depth-4">)</span>;
            trasnform.setToIdentity<span class="org-rainbow-delimiters-depth-4">()</span>;
            trasnform.translate<span class="org-rainbow-delimiters-depth-4">(</span> position <span class="org-rainbow-delimiters-depth-4">)</span>;
            trasnform.scale<span class="org-rainbow-delimiters-depth-4">(</span>scale<span class="org-rainbow-delimiters-depth-4">)</span>;
            trasnform.rotate<span class="org-rainbow-delimiters-depth-4">(</span>rotation<span class="org-rainbow-delimiters-depth-4">)</span>;
            is_changed = <span class="org-constant">false</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">return</span> trasnform;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">class</span> <span class="org-type">OpenGLCanvas</span>: <span class="org-keyword">public</span> <span class="org-type">QOpenGLWidget</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-function-name">public</span>:
     <span class="org-keyword">using</span> <span class="org-type">DrawCallback</span> = <span class="org-constant">std</span>::<span class="org-type">function</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">QOpenGLExtraFunctions</span>* <span class="org-variable-name">ctx</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>;
<span class="org-function-name">private</span>:
    <span class="org-type">QOpenGLShaderProgram</span>* <span class="org-variable-name">m_prog</span>    = <span class="org-constant">nullptr</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location</span>
    <span class="org-type">int</span> <span class="org-variable-name">attr_position</span> = 0;
    <span class="org-type">int</span> <span class="org-variable-name">attr_color</span>    = 0;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Shader uniform locations</span>
    <span class="org-type">int</span> <span class="org-variable-name">u_model</span> = 0;
    <span class="org-type">int</span> <span class="org-variable-name">u_proj</span>  = 0;

    <span class="org-type">DrawCallback</span> <span class="org-variable-name">m_callback</span> = <span class="org-rainbow-delimiters-depth-2">[](</span><span class="org-type">QOpenGLExtraFunctions</span>* <span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-type">DrawCallback</span> <span class="org-variable-name">m_init</span>     = <span class="org-rainbow-delimiters-depth-2">[](</span><span class="org-type">QOpenGLExtraFunctions</span>* <span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-rainbow-delimiters-depth-2">}</span>;
<span class="org-function-name">public</span>:

    <span class="org-function-name">OpenGLCanvas</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">DrawCallback</span> <span class="org-variable-name">init</span><span class="org-rainbow-delimiters-depth-2">)</span>:  <span class="org-function-name">m_init</span><span class="org-rainbow-delimiters-depth-2">(</span>init<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">initializeGL</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">override</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">ctx</span> = <span class="org-constant">QOpenGLContext</span>::currentContext<span class="org-rainbow-delimiters-depth-3">()</span>-&gt;extraFunctions<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [TRACE] Initialized Ok. \n"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

        m_prog = <span class="org-keyword">new</span> <span class="org-type">QOpenGLShaderProgram</span>;
        m_prog-&gt;addShaderFromSourceCode<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">QOpenGLShader</span>::Vertex,   shader_vertex<span class="org-rainbow-delimiters-depth-3">)</span>;
        m_prog-&gt;addShaderFromSourceCode<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">QOpenGLShader</span>::Fragment, shader_fragment<span class="org-rainbow-delimiters-depth-3">)</span>;
        m_prog-&gt;link<span class="org-rainbow-delimiters-depth-3">()</span>;
        m_prog-&gt;bind<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Attribute location</span>
        attr_position = m_prog-&gt;attributeLocation<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        Q_ASSERT<span class="org-rainbow-delimiters-depth-3">(</span> attr_position != -1 <span class="org-rainbow-delimiters-depth-3">)</span>;
        attr_color = m_prog-&gt;attributeLocation<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        Q_ASSERT<span class="org-rainbow-delimiters-depth-3">(</span> attr_color != -1    <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Uniform variables</span>
        u_model = m_prog-&gt;uniformLocation<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        Q_ASSERT<span class="org-rainbow-delimiters-depth-3">(</span> u_model != -1 <span class="org-rainbow-delimiters-depth-3">)</span>;
        u_proj  = m_prog-&gt;uniformLocation<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"u_proj"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        Q_ASSERT<span class="org-rainbow-delimiters-depth-3">(</span> u_proj != -1 <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Initialize shader uniform variables</span>
        <span class="org-type">QMatrix4x4</span> <span class="org-variable-name">m</span>;
        m.setToIdentity<span class="org-rainbow-delimiters-depth-3">()</span>;
        m_prog-&gt;setUniformValue<span class="org-rainbow-delimiters-depth-3">(</span>u_model, m<span class="org-rainbow-delimiters-depth-3">)</span>;
        m_prog-&gt;setUniformValue<span class="org-rainbow-delimiters-depth-3">(</span>u_proj,  m<span class="org-rainbow-delimiters-depth-3">)</span>;

        m_init<span class="org-rainbow-delimiters-depth-3">(</span>ctx<span class="org-rainbow-delimiters-depth-3">)</span>;
   <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">setDrawCallback</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">DrawCallback</span> <span class="org-variable-name">callback</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        m_callback = callback;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Override QOpenGLWidget::paintGL()</span>
    <span class="org-type">void</span> <span class="org-function-name">paintGL</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">override</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [TRACE] Painting window Ok. \n"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-type">QOpenGLExtraFunctions</span>* <span class="org-variable-name">ctx</span> = <span class="org-constant">QOpenGLContext</span>::currentContext<span class="org-rainbow-delimiters-depth-3">()</span>-&gt;extraFunctions<span class="org-rainbow-delimiters-depth-3">()</span>;
        ctx-&gt;glClearColor<span class="org-rainbow-delimiters-depth-3">(</span>0.0, 0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-3">)</span>;
        ctx-&gt;glClear<span class="org-rainbow-delimiters-depth-3">(</span> GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT <span class="org-rainbow-delimiters-depth-3">)</span>;

        m_callback<span class="org-rainbow-delimiters-depth-3">(</span>ctx<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Override QOpenGLWidget::resizeGL()</span>
    <span class="org-type">void</span> <span class="org-function-name">resizeGL</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">w</span>, <span class="org-type">int</span> <span class="org-variable-name">h</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-keyword">override</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [TRACE] Window resized. \n"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Forward call to superclass</span>
        <span class="org-keyword">this</span>-&gt;<span class="org-constant">QOpenGLWidget</span>::resizeGL<span class="org-rainbow-delimiters-depth-3">(</span>w, h<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set model matrix of current object</span>
    <span class="org-type">void</span> <span class="org-function-name">setModel</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">QMatrix4x4</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">m</span><span class="org-rainbow-delimiters-depth-2">){</span> m_prog-&gt;setUniformValue<span class="org-rainbow-delimiters-depth-3">(</span>u_model, m<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload vertices to GPU</span>
    <span class="org-type">Mesh</span> <span class="org-function-name">upload</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">num_vertices</span>, <span class="org-type">Vertex2D</span>* <span class="org-variable-name">vertices</span>, <span class="org-type">ColorRGB</span>* <span class="org-variable-name">colors</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">ctx</span> = <span class="org-constant">QOpenGLContext</span>::currentContext<span class="org-rainbow-delimiters-depth-3">()</span>-&gt;extraFunctions<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">auto</span> <span class="org-variable-name">vao</span> = <span class="org-keyword">new</span> <span class="org-type">QOpenGLVertexArrayObject</span>;
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> vao-&gt;create<span class="org-rainbow-delimiters-depth-4">()</span> <span class="org-rainbow-delimiters-depth-3">){</span> vao-&gt;bind<span class="org-rainbow-delimiters-depth-4">()</span>; <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Send vertices positions to GPU</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">vbo_vertex</span> = <span class="org-keyword">new</span> <span class="org-type">QOpenGLBuffer</span>;
        vbo_vertex-&gt;create<span class="org-rainbow-delimiters-depth-3">()</span>;
        vbo_vertex-&gt;bind<span class="org-rainbow-delimiters-depth-3">()</span>;
        vbo_vertex-&gt;allocate<span class="org-rainbow-delimiters-depth-3">(</span> vertices , <span class="org-type">num_vertices</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-4">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        ctx-&gt;glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>attr_position<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout, how the data will be interpreted.</span>
        ctx-&gt;glVertexAttribPointer<span class="org-rainbow-delimiters-depth-3">(</span> attr_position, 2, GL_FLOAT, GL_FALSE, 0, <span class="org-constant">nullptr</span> <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Send vertices colors to GPU</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">vbo_color</span> = <span class="org-keyword">new</span> <span class="org-type">QOpenGLBuffer</span>;
        vbo_color-&gt;create<span class="org-rainbow-delimiters-depth-3">()</span>;
        vbo_color-&gt;bind<span class="org-rainbow-delimiters-depth-3">()</span>;
        vbo_color-&gt;allocate<span class="org-rainbow-delimiters-depth-3">(</span> colors, <span class="org-type">num_vertices</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-4">(</span>ColorRGB<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        ctx-&gt;glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>attr_color<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Set color data layout</span>
        ctx-&gt;glVertexAttribPointer<span class="org-rainbow-delimiters-depth-3">(</span> attr_color, 3, GL_FLOAT, GL_FALSE, 0, <span class="org-constant">nullptr</span> <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-type">Mesh</span> <span class="org-variable-name">mesh</span>;
        mesh.vbo_vertex = vbo_vertex;
        mesh.vbo_color  = vbo_color;
        mesh.vao = vao;
        <span class="org-keyword">return</span> mesh;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [INFO] Starting Application"</span> &lt;&lt; <span class="org-constant">std</span>::endl;

    <span class="org-type">QApplication</span> <span class="org-variable-name">app</span><span class="org-rainbow-delimiters-depth-2">(</span>argc, argv<span class="org-rainbow-delimiters-depth-2">)</span>;
    app.setApplicationName<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Qt OpenGL Cavans"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">constexpr</span> <span class="org-type">size_t</span> <span class="org-variable-name">NUM_VERTICES</span> = 3;

    <span class="org-keyword">const</span> <span class="org-type">float</span> <span class="org-variable-name">a</span> = 0.5f ;

    <span class="org-type">Vertex2D</span> <span class="org-variable-name">vertices</span><span class="org-rainbow-delimiters-depth-2">[</span>NUM_VERTICES<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-rainbow-delimiters-depth-3">{</span>  0.0,  a * sqrtf<span class="org-rainbow-delimiters-depth-4">(</span>3.0f<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 0</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span>   -a,  0.0             <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 1</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span>    a,  0.0             <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 2</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">ColorRGB</span> <span class="org-variable-name">colors</span><span class="org-rainbow-delimiters-depth-2">[</span>NUM_VERTICES<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-rainbow-delimiters-depth-3">{</span>0.4, 0.5, 0.67<span class="org-rainbow-delimiters-depth-3">}</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span>0.8, 0.6, 0.30<span class="org-rainbow-delimiters-depth-3">}</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span>0.2, 0.7, 0.10<span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;


    <span class="org-type">QWidget</span> <span class="org-variable-name">window</span>;
    window.resize<span class="org-rainbow-delimiters-depth-2">(</span>500, 400<span class="org-rainbow-delimiters-depth-2">)</span>;
    window.setWindowTitle<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Qt OpenGL Window is awesome!"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">hbox</span> = <span class="org-keyword">new</span> <span class="org-type">QVBoxLayout</span><span class="org-rainbow-delimiters-depth-2">(</span>&amp;window<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">form</span> = <span class="org-keyword">new</span> <span class="org-type">QHBoxLayout</span><span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">btn_add_scale</span> = <span class="org-keyword">new</span> <span class="org-type">QPushButton</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Increase scale"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">btn_dec_scale</span> = <span class="org-keyword">new</span> <span class="org-type">QPushButton</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Decrease scale"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">btn_rotate</span> = <span class="org-keyword">new</span> <span class="org-type">QPushButton</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Rotate"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    form-&gt;addWidget<span class="org-rainbow-delimiters-depth-2">(</span>btn_add_scale<span class="org-rainbow-delimiters-depth-2">)</span>;
    form-&gt;addWidget<span class="org-rainbow-delimiters-depth-2">(</span>btn_dec_scale<span class="org-rainbow-delimiters-depth-2">)</span>;
    form-&gt;addWidget<span class="org-rainbow-delimiters-depth-2">(</span>btn_rotate<span class="org-rainbow-delimiters-depth-2">)</span>;
    hbox-&gt;addLayout<span class="org-rainbow-delimiters-depth-2">(</span>form<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_triangle</span>;

    <span class="org-type">Transform</span> <span class="org-variable-name">trf_triangle1</span>;
    trf_triangle1.setPosition<span class="org-rainbow-delimiters-depth-2">(</span>0.36f, 0.50f, 0.0f<span class="org-rainbow-delimiters-depth-2">)</span>
                 .rotateZ<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>
                 .setScale<span class="org-rainbow-delimiters-depth-2">(</span>0.50<span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-type">Transform</span> <span class="org-variable-name">trf_triangle2</span>;
    trf_triangle2.setPosition<span class="org-rainbow-delimiters-depth-2">(</span>-0.24, -0.25, 0.0<span class="org-rainbow-delimiters-depth-2">)</span>
                 .setScale<span class="org-rainbow-delimiters-depth-2">(</span>0.80<span class="org-rainbow-delimiters-depth-2">)</span>
                 .rotateZ<span class="org-rainbow-delimiters-depth-2">(</span>35.0<span class="org-rainbow-delimiters-depth-2">)</span>;

    qDebug<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">" Trasnform 1 = "</span> &lt;&lt; trf_triangle1.value<span class="org-rainbow-delimiters-depth-2">()</span>;
    qDebug<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">" Transform 2 = "</span> &lt;&lt; trf_triangle2.value<span class="org-rainbow-delimiters-depth-2">()</span>;

    <span class="org-type">OpenGLCanvas</span>* <span class="org-variable-name">canvas</span> = <span class="org-keyword">new</span> <span class="org-type">OpenGLCanvas</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[</span>&amp;<span class="org-rainbow-delimiters-depth-3">](</span><span class="org-type">QOpenGLExtraFunctions</span>* <span class="org-variable-name">ctx</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">{</span>
        mesh_triangle = canvas-&gt;upload<span class="org-rainbow-delimiters-depth-4">(</span>NUM_VERTICES, vertices, colors<span class="org-rainbow-delimiters-depth-4">)</span>;
    <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    canvas-&gt;setSizePolicy<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">QSizePolicy</span>::Expanding, <span class="org-constant">QSizePolicy</span>::Expanding<span class="org-rainbow-delimiters-depth-2">)</span>;
    hbox-&gt;addWidget<span class="org-rainbow-delimiters-depth-2">(</span>canvas<span class="org-rainbow-delimiters-depth-2">)</span>;

    canvas-&gt;setDrawCallback<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[</span>&amp;<span class="org-rainbow-delimiters-depth-3">](</span><span class="org-type">QOpenGLExtraFunctions</span>* <span class="org-variable-name">ctx</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle 1</span>
        mesh_triangle.vao-&gt;bind<span class="org-rainbow-delimiters-depth-4">()</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">canvas-&gt;setModel(model_triangle1);</span>
        canvas-&gt;setModel<span class="org-rainbow-delimiters-depth-4">(</span> trf_triangle1.value<span class="org-rainbow-delimiters-depth-5">()</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        ctx-&gt;glDrawArrays<span class="org-rainbow-delimiters-depth-4">(</span>GL_TRIANGLES, 0, NUM_VERTICES<span class="org-rainbow-delimiters-depth-4">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle 2</span>
        mesh_triangle.vao-&gt;bind<span class="org-rainbow-delimiters-depth-4">()</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">canvas-&gt;setModel(model_triangle2);</span>
        canvas-&gt;setModel<span class="org-rainbow-delimiters-depth-4">(</span> trf_triangle2.value<span class="org-rainbow-delimiters-depth-5">()</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        ctx-&gt;glDrawArrays<span class="org-rainbow-delimiters-depth-4">(</span>GL_TRIANGLES, 0, NUM_VERTICES<span class="org-rainbow-delimiters-depth-4">)</span>;
    <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    window.show<span class="org-rainbow-delimiters-depth-2">()</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">----------- Set events ----------------------//</span>

    <span class="org-constant">QObject</span>::connect<span class="org-rainbow-delimiters-depth-2">(</span>btn_add_scale, &amp;<span class="org-constant">QPushButton</span>::clicked,
             <span class="org-rainbow-delimiters-depth-3">[</span>&amp;<span class="org-rainbow-delimiters-depth-3">]{</span>
                   <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span>stderr, <span class="org-string">" [TRACE] Button to increase scale clicked. Ok. \n"</span><span class="org-rainbow-delimiters-depth-4">)</span>; 
                   trf_triangle2.addScale<span class="org-rainbow-delimiters-depth-4">(</span>+0.10<span class="org-rainbow-delimiters-depth-4">)</span>;
                   canvas-&gt;repaint<span class="org-rainbow-delimiters-depth-4">()</span>;
             <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">QObject</span>::connect<span class="org-rainbow-delimiters-depth-2">(</span>btn_dec_scale, &amp;<span class="org-constant">QPushButton</span>::clicked,
                     <span class="org-rainbow-delimiters-depth-3">[</span>&amp;<span class="org-rainbow-delimiters-depth-3">]{</span>
                        <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span>stderr, <span class="org-string">" [TRACE] Button to decrease scale clicked. Ok. \n"</span><span class="org-rainbow-delimiters-depth-4">)</span>; 
                        trf_triangle2.addScale<span class="org-rainbow-delimiters-depth-4">(</span>-0.10<span class="org-rainbow-delimiters-depth-4">)</span>;
                        canvas-&gt;repaint<span class="org-rainbow-delimiters-depth-4">()</span>;
                     <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">QObject</span>::connect<span class="org-rainbow-delimiters-depth-2">(</span>btn_rotate, &amp;<span class="org-constant">QPushButton</span>::clicked,
                     <span class="org-rainbow-delimiters-depth-3">[</span>&amp;<span class="org-rainbow-delimiters-depth-3">]{</span>
                         <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span>stderr, <span class="org-string">" [TRACE] Button to rotate triangle clicked. Ok. \n"</span><span class="org-rainbow-delimiters-depth-4">)</span>;
                         trf_triangle2.rotateZ<span class="org-rainbow-delimiters-depth-4">(</span>10.5<span class="org-rainbow-delimiters-depth-4">)</span>;
                         canvas-&gt;repaint<span class="org-rainbow-delimiters-depth-4">()</span>;
                     <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">return</span> app.exec<span class="org-rainbow-delimiters-depth-2">()</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">===== S H A D E R - P R O G R A M S ==========//</span>


<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">shader_vertex</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330 core</span>

<span class="org-string">    layout ( location = 2)  in vec2 position;</span>
<span class="org-string">    layout ( location = 1 ) in vec3 color;</span>

<span class="org-string">    out vec3 out_color;</span>
<span class="org-string">    uniform mat4 u_model;</span>
<span class="org-string">    uniform mat4 u_proj;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">       gl_Position = u_proj * u_model * vec4(position, 0, 1.0);</span>
<span class="org-string">       out_color = color;</span>
<span class="org-string">    }</span>

<span class="org-string"> )</span><span class="org-default">"</span>;


<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">shader_fragment</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330</span>

<span class="org-string">    // This color comes from Vertex shader</span>
<span class="org-string">    in vec3 out_color;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // Set vertex colors</span>
<span class="org-string">        gl_FragColor = vec4(out_color, 1.0);</span>
<span class="org-string">    }</span>

<span class="org-string">)</span><span class="org-default">"</span>;

</pre>
</div>

<p>
<b>Building with CMake</b> 
</p>

<div class="org-src-container">
<pre class="src src-sh"> <span class="org-comment-delimiter"># </span><span class="org-comment">Build application </span>
 $ cmake -H. -B_build -DCMAKE_BUILD_TYPE=Debug
 $ cmake --build _build --target all

 <span class="org-comment-delimiter"># </span><span class="org-comment">List build tree directory </span>
 $ &gt;&gt; ls _build/
CMakeCache.txt  cmake_install.cmake  qt-opengl*
CMakeFiles/     Makefile             qt-opengl_autogen/

<span class="org-comment-delimiter"># </span><span class="org-comment">Run application </span>
$ &gt;&gt; _build/qt-opengl 
</pre>
</div>

<p>
<b>Building with Meson</b> 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Build application </span>
$ meson setup _build_meson <span class="org-comment-delimiter"># </span><span class="org-comment">Name of build directory is arbitrary</span>
$ meson compile -C _build_meson 

<span class="org-comment-delimiter"># </span><span class="org-comment">List build directory </span>
$ &gt;&gt; ls _build_meson/
build.ninja            meson-info/  meson-private/  qt-opengl.p/
compile_commands.json  meson-logs/  qt-opengl* 

<span class="org-comment-delimiter"># </span><span class="org-comment">Run application </span>
$ &gt;&gt; ./_build_meson/qt-opengl
</pre>
</div>

<p>
<b>Building with XMake</b>
</p>

<p>
Build project with <a href="https://xmake.io/#/">Xmake</a> lua-based building system showing all
compilation and linking process.
</p>

<div class="org-src-container">
<pre class="src src-sh">$  xmake build -v
</pre>
</div>

<p>
Run application (default target):
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake run 
</pre>
</div>

<p>
Run application specifying the target:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ xmake run qt-opengl 
</pre>
</div>

<p>
Generate an CMakeLists.txt for making IDEs and smart text editors
including, CLion, QtCreator and Visual Studio Code happy. 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ &gt;&gt; xmake project -k cmake
create ok!

<span class="org-comment-delimiter"># </span><span class="org-comment">Edit project with Visual Studio Code </span>
$ code . 

<span class="org-comment-delimiter"># </span><span class="org-comment">Edit project with CLion </span>
=&gt;&gt; Open the project directory with CLion 

<span class="org-comment-delimiter"># </span><span class="org-comment">Edit project with QtCreator </span>
=&gt;&gt; Open the project directory with Qt creator 
$ qt-creator . 

<span class="org-comment-delimiter"># </span><span class="org-comment">Build project with CMakeLists.txt </span>
$ cmake -H. -B_build -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build --target 
</pre>
</div>
</div>
</div>

<div id="outline-container-org9381847" class="outline-3">
<h3 id="org9381847"><span class="section-number-3">1.16</span> Minimal WebGL-OpenGL project</h3>
<div class="outline-text-3" id="text-1-16">
<p>
WebGL is a web standard supported by most modern web browsers for a
low-level 3D graphics API accelerated by GPU based on OpenGL ES. By
using WebGL as in this next code, it is possible to play with OpenGL
3D computer graphics without the hassle of dealing with C or C++
compilation and building systems since WebGL API is already available
in any web browser and the API is exposed as JavaScript API, that
resembles OpenGL C API.
</p>

<ul class="org-ul">
<li>Live example available at: <a href="https://jsfiddle.net/prxbmqof/">https://jsfiddle.net/prxbmqof/</a></li>
</ul>


<div class="figure">
<p><a href="images/opengl-webgl-basic.png"><img src="images/opengl-webgl-basic.png" alt="opengl-webgl-basic.png" /></a>
</p>
</div>

<p>
<b>Complete Html Code</b> 
</p>

<div class="org-src-container">
<pre class="src src-html"><span class="org-string">&lt;!DOCTYPE html&gt;</span>
&lt;<span class="org-function-name">html</span>&gt; 
   &lt;<span class="org-function-name">head</span>&gt; 
       &lt;<span class="org-function-name">title</span>&gt;<span class="org-underline"><span class="org-bold"> Web Page Title </span></span>&lt;/<span class="org-function-name">title</span>&gt;
       &lt;<span class="org-function-name">script</span> <span class="org-variable-name">src</span>=<span class="org-string">"https://somehost.com/jequey.js"</span>&gt;&lt;/<span class="org-function-name">script</span>&gt;

   &lt;/<span class="org-function-name">head</span>&gt;

   &lt;<span class="org-function-name">body</span>&gt;
       &lt;<span class="org-function-name">h1</span>&gt;<span class="org-underline"><span class="org-bold">WebGL Experiment 1 - Draw a triangle</span></span>&lt;/<span class="org-function-name">h1</span>&gt;
       &lt;<span class="org-function-name">canvas</span> <span class="org-variable-name">id</span>=<span class="org-string">"glCanvas"</span> <span class="org-variable-name">width</span>=<span class="org-string">"480"</span> <span class="org-variable-name">height</span>=<span class="org-string">"480"</span>&gt;
   &lt;/<span class="org-function-name">body</span>&gt;
  &lt;<span class="org-function-name">script</span>&gt;
    // Source: https://webglfundamentals.org/webgl/lessons/webgl-fundamentals.html
    function createShader(gl, type, source) 

      ... ... ... ... ... ... ... ... ... ... .. 
      ... ... ... ... ... ... ... ... ... ... ... 

    // Draw Square 
    console.log(" [TRACE] Draw sqaure in WebGL");
    gl.bindBuffer( gl.ARRAY_BUFFER, vbo_square );
    gl.vertexAttribPointer(attr_position, 2, gl.FLOAT, false, 0, 0);
    gl.drawArrays(gl.LINE_LOOP, 0, 4);

    console.log(" [TRACE] Loaded Ok.");
  &lt;/<span class="org-function-name">script</span>&gt;

&lt;/<span class="org-function-name">html</span>&gt; 
</pre>
</div>

<p>
JavaScript part: 
</p>

<div class="org-src-container">
<pre class="src src-js"><span class="org-comment-delimiter">// </span><span class="org-comment">Source: https://webglfundamentals.org/webgl/lessons/webgl-fundamentals.html</span>
<span class="org-keyword">function</span> <span class="org-function-name">createShader</span>(<span class="org-variable-name">gl</span>, <span class="org-variable-name">type</span>, <span class="org-variable-name">source</span>) 
{
  <span class="org-keyword">var</span> <span class="org-variable-name">shader</span> = gl.createShader(type);
  gl.shaderSource(shader, source);
  gl.compileShader(shader);
  <span class="org-keyword">var</span> <span class="org-variable-name">success</span> = gl.getShaderParameter(shader, gl.COMPILE_STATUS);
  <span class="org-keyword">if</span> (success) {
    <span class="org-keyword">return</span> shader;
  }

  console.log(gl.getShaderInfoLog(shader));
  gl.deleteShader(shader);
}

<span class="org-comment-delimiter">// </span><span class="org-comment">Source:  https://webglfundamentals.org/webgl/lessons/webgl-fundamentals.html</span>
<span class="org-keyword">function</span> <span class="org-function-name">createProgram</span>(<span class="org-variable-name">gl</span>, <span class="org-variable-name">vertexShader</span>, <span class="org-variable-name">fragmentShader</span>) 
{
  <span class="org-keyword">var</span> <span class="org-variable-name">program</span> = gl.createProgram();
  gl.attachShader(program, vertexShader);
  gl.attachShader(program, fragmentShader);
  gl.linkProgram(program);
  <span class="org-keyword">var</span> <span class="org-variable-name">success</span> = gl.getProgramParameter(program, gl.LINK_STATUS);
  <span class="org-keyword">if</span> (success) {
    <span class="org-keyword">return</span> program;
  }

  console.log(gl.getProgramInfoLog(program));
  gl.deleteProgram(program);
}


<span class="org-keyword">function</span> <span class="org-function-name">resizeCanvasToDisplaySize</span>(<span class="org-variable-name">canvas</span>, <span class="org-variable-name">multiplier</span>) 
{
    multiplier = multiplier || 1;
    <span class="org-keyword">const</span> <span class="org-variable-name">width</span>  = canvas.clientWidth  * multiplier | 0;
    <span class="org-keyword">const</span> <span class="org-variable-name">height</span> = canvas.clientHeight * multiplier | 0;
    <span class="org-keyword">if</span> (canvas.width !== width ||  canvas.height !== height) {
      canvas.width  = width;
      canvas.height = height;
      <span class="org-keyword">return</span> <span class="org-constant">true</span>;
    }
    <span class="org-keyword">return</span> <span class="org-constant">false</span>;
  }


<span class="org-keyword">const</span> <span class="org-variable-name">canvas</span> = document.querySelector(<span class="org-string">"#glCanvas"</span>);
<span class="org-keyword">const</span> <span class="org-variable-name">gl</span> = canvas.getContext(<span class="org-string">"webgl"</span>);

<span class="org-keyword">if</span>(  gl == <span class="org-constant">null</span> ){
  alert(<span class="org-string">" [ABORT] Unable to initialized WebGL"</span>);
}

<span class="org-comment-delimiter">// </span><span class="org-comment">Vertex Shader code =&gt; Performs vertex coordinate transforms in the GPU </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Defines the a 3D scene or 2D scene (by ignoring the Z axis).</span>
<span class="org-keyword">let</span> <span class="org-variable-name">code_shader_vertex</span> = <span class="org-string">`</span>
<span class="org-string">  attribute vec2 position;</span>

<span class="org-string">  void main(){</span>
<span class="org-string">     // Coordinates: X, Y, Z = 0, W = 1 =&gt; Ignores the Z axis (2D Scene)</span>
<span class="org-string">     gl_Position = vec4(position, 0, 1.0);</span>

<span class="org-string">  }</span>
<span class="org-string">`</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Fragment shader code =&gt; Sets color, lights and illumination </span>
<span class="org-keyword">let</span> <span class="org-variable-name">code_shader_fragment</span> = <span class="org-string">`</span>
<span class="org-string">  void main(){</span>
<span class="org-string">    // Color always green </span>
<span class="org-string">    // Color in (R, G, B, W) =&gt; (Red, Green, Blue, W)</span>
<span class="org-string">    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);</span>
<span class="org-string">  }</span>
<span class="org-string">`</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Vertices of (x, y) coordinates </span>
<span class="org-keyword">let</span> <span class="org-variable-name">vertices_triangle</span> = [
    -0.25, -0.25
  ,  0.00,  0.25
  ,  0.25, -0.25
];

<span class="org-keyword">let</span> <span class="org-variable-name">vertices_square</span> = [
    -0.3, -0.3
  , -0.3,  0.3
  ,  0.3,  0.3
  ,  0.3, -0.3

];


<span class="org-keyword">let</span> <span class="org-variable-name">shader_vert</span> = createShader(gl, gl.VERTEX_SHADER, code_shader_vertex);
<span class="org-keyword">let</span> <span class="org-variable-name">shader_frag</span> = createShader(gl, gl.FRAGMENT_SHADER, code_shader_fragment);
<span class="org-keyword">let</span> <span class="org-variable-name">prog</span> = createProgram(gl, shader_vert, shader_frag);

<span class="org-keyword">let</span> <span class="org-variable-name">attr_position</span> = gl.getAttribLocation(prog, <span class="org-string">"position"</span>);
console.log(<span class="org-string">" [TRACE] attr_position = "</span>, attr_position);

<span class="org-comment-delimiter">// </span><span class="org-comment">resizeCanvasToDisplaySize(gl.canvas);</span>
gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);

<span class="org-comment-delimiter">// </span><span class="org-comment">Screen background color is black =&gt; clearColor(Red intensity from 0 to 1, Green , Blue , Alpha)</span>
gl.clearColor(0.0, 0.0, 0.0, 1.0);
gl.clear(gl.COLOR_BUFFER_BIT);
gl.useProgram(prog);

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- Upload triangle to GPU --------------------//</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">GLuint vbo_triangle_ = 0;</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">glGenBuffers(1 , &amp;vbo_triangle_); </span>
<span class="org-keyword">let</span> <span class="org-variable-name">vbo_triangle</span> = gl.createBuffer();
<span class="org-comment-delimiter">// </span><span class="org-comment">Set this buffer as current buffer (global state)</span>
gl.bindBuffer( gl.ARRAY_BUFFER, vbo_triangle );
<span class="org-comment-delimiter">// </span><span class="org-comment">Upload vertices to  GPU </span>
gl.bufferData(gl.ARRAY_BUFFER, <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(vertices_triangle), gl.STATIC_DRAW);

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- Upload squares to GPU ----------------------//</span>
<span class="org-keyword">let</span> <span class="org-variable-name">vbo_square</span> = gl.createBuffer();
gl.bindBuffer( gl.ARRAY_BUFFER, vbo_square );
gl.bufferData(gl.ARRAY_BUFFER, <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(vertices_square), gl.STATIC_DRAW);

<span class="org-comment-delimiter">// </span><span class="org-comment">------ Drawing ----------------------------------------//</span>
gl.enableVertexAttribArray(attr_position);

<span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle </span>
console.log(<span class="org-string">" [TRACE] Draw triangle in WebGL"</span>);
gl.bindBuffer( gl.ARRAY_BUFFER, vbo_triangle );
gl.vertexAttribPointer(attr_position, 2, gl.FLOAT, <span class="org-constant">false</span>, 0, 0);
gl.drawArrays(gl.TRIANGLES, 0, 3);

<span class="org-comment-delimiter">// </span><span class="org-comment">Draw Square </span>
console.log(<span class="org-string">" [TRACE] Draw sqaure in WebGL"</span>);
gl.bindBuffer( gl.ARRAY_BUFFER, vbo_square );
gl.vertexAttribPointer(attr_position, 2, gl.FLOAT, <span class="org-constant">false</span>, 0, 0);
gl.drawArrays(gl.LINE_LOOP, 0, 4);

console.log(<span class="org-string">" [TRACE] Loaded Ok."</span>);
</pre>
</div>
</div>
</div>

<div id="outline-container-org831be5e" class="outline-3">
<h3 id="org831be5e"><span class="section-number-3">1.17</span> Loading OpenGL without Glew</h3>
<div class="outline-text-3" id="text-1-17">
<p>
The next code loads OpenGL function pointers without Glew (OpenGL
extension wrangler) for streamlining the building process. Glew is a
library for loading OpenGL function pointers and OpenGL extensions in
a platform-agnostic way. Despite the usefulness of this library, its
source code is hard to integrate to building systems as the Glew
building systems as Glew library needs Perl and other dependencies for
code generation.
</p>

<p>
Relevant documentation: 
</p>

<ul class="org-ul">
<li><a href="https://www.khronos.org/opengl/wiki/Load_OpenGL_Functions">Khronos Group - Load OpenGL Functions</a>
<ul class="org-ul">
<li>Brief: "Loading OpenGL Functions is an important task for
initializing OpenGL after creating an OpenGL context. You are
strongly advised to use an OpenGL Loading Library instead of a
manual process. However, if you want to know how it works
manually, read on."</li>
</ul></li>

<li><a href="https://stackoverflow.com/questions/47445643/why-are-opengl-functions-loaded-at-runtime-instead-of-dynamically-linked">Why are OpenGL functions loaded at runtime &#x2026;?</a></li>

<li><a href="https://stackoverflow.com/questions/27873784/when-do-i-need-to-use-an-opengl-function-loader">When do I need to use an OpenGL function loader?</a></li>

<li><a href="https://docs.microsoft.com/en-us/windows/win32/api/wingdi/nf-wingdi-wglgetprocaddress">MSDN - wglGetProcAddress</a> (WGL - Windows NT)
<ul class="org-ul">
<li>Brief: "The wglGetProcAddress function returns the address of an OpenGL
extension function for use with the current OpenGL rendering
context."</li>
</ul></li>

<li><a href="https://docs.microsoft.com/en-us/windows/win32/api/wingdi/nf-wingdi-wglgetcurrentcontext">MSDN - wglGetCurrentContext</a> (WGL - Windows NT)
<ul class="org-ul">
<li>Brief: "The wglGetCurrentContext function obtains a handle to the
current OpenGL rendering context of the calling thread."</li>
</ul></li>

<li><a href="https://stackoverflow.com/questions/21769427/wglgetprocaddress-returns-null">wglGetProcAddress returns NULL</a></li>
</ul>


<p>
<b>Screenshot</b> 
</p>


<div class="figure">
<p><a href="images/opengl-load-function-ptr.png"><img src="images/opengl-load-function-ptr.png" alt="opengl-load-function-ptr.png" /></a>
</p>
</div>

<p>
<b>Files</b> 
</p>

<p>
File: <span class="underline">CMakeListst.txt</span> 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(OpenGL_Load_FPTR)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-keyword">MACRO</span>(ADD_OPENGL_APP target sources)
   <span class="org-function-name">add_executable</span>( ${<span class="org-variable-name">target</span>} ${<span class="org-variable-name">sources</span>} )
   <span class="org-function-name">message</span>([TRACE] <span class="org-string">" Add OpenGL executable = ${</span><span class="org-variable-name">target</span><span class="org-string">} "</span>)

   <span class="org-function-name">target_link_libraries</span>( ${<span class="org-variable-name">target</span>} glfw OpenGL::GL)

    <span class="org-keyword">IF</span>(MINGW)
        <span class="org-comment"># Statically link against MINGW dependencies</span>
        <span class="org-comment"># for making easier to deploy on other machines. </span>
        <span class="org-function-name">target_link_options</span>( ${<span class="org-variable-name">target</span>} PRIVATE                                 
                                 -static-libgcc
                                 -static-libstdc++
                                 -Wl,-Bstatic,--whole-archive -lwinpthread
                                   -Wl,--no-whole-archive                                    
                                 )
     <span class="org-keyword">ENDIF</span>()       

<span class="org-keyword">ENDMACRO</span>()     

     <span class="org-comment"># ======= T A R G E T S ============================#</span>
     <span class="org-comment">#                                                   #</span>

<span class="org-function-name">ADD_OPENGL_APP</span>( load-opengl-fptr  load-opengl-fptr.cpp )
</pre>
</div>

<p>
File: <span class="underline">load-openg-fptr.cpp</span> 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">----- Manual Loading of OpenGL function pointers -------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>


<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>_WIN32<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">windows.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>__linux__<span class="org-rainbow-delimiters-depth-1">)</span> || <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>__bsd__<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">    #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glx.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>  <span class="org-comment-delimiter">// </span><span class="org-comment">For glXGetProcAddress() and glXGetProcAddressARB()</span>
<span class="org-preprocessor">    #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glxext.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>


<span class="org-comment-delimiter">//</span><span class="org-comment">======== B O I L E R P L A T E - F O R - L O A D I N G - O P E N G L ==========//</span>
<span class="org-comment-delimiter">//</span>

<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_ARRAY_BUFFER</span>  0x8892
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_STATIC_DRAW</span>   0x88E4

<span class="org-comment-delimiter">// </span><span class="org-comment">Generic void function pointer which can be casted to any other function pointer.</span>
<span class="org-keyword">using</span> <span class="org-type">FptrVoid</span> = <span class="org-type">void</span>*;

<span class="org-comment-delimiter">/** </span><span class="org-comment">@brief Load OpenGL function pointer at runtime</span>
<span class="org-comment">  * See:</span>
<span class="org-comment">  *    -</span>
<span class="org-comment">  *    - https://stackoverflow.com/questions/21769427/wglgetprocaddress-returns-null</span>
<span class="org-comment">  */</span>
<span class="org-type">FptrVoid</span> <span class="org-function-name">load_gl_function</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">name</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">FptrVoid</span> <span class="org-variable-name">fp</span> = <span class="org-constant">nullptr</span>;
    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [TRACE] Loading pointer to OpenGL subroutine = %s \n"</span>, name<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-preprocessor">    #if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-2">(</span>_WIN32<span class="org-rainbow-delimiters-depth-2">)</span>
        assert<span class="org-rainbow-delimiters-depth-2">(</span> wglGetCurrentContext<span class="org-rainbow-delimiters-depth-3">()</span> != <span class="org-constant">nullptr</span> &amp;&amp; <span class="org-string">"Current thread lacks a OpenGL rendering context."</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

        fp = <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-2">)</span> wglGetProcAddress<span class="org-rainbow-delimiters-depth-2">(</span>name<span class="org-rainbow-delimiters-depth-2">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">assert( fp != nullptr );</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> fp == 0
            || <span class="org-rainbow-delimiters-depth-3">(</span>fp == <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-4">)</span>0x1<span class="org-rainbow-delimiters-depth-3">)</span> || <span class="org-rainbow-delimiters-depth-3">(</span>fp == <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-4">)</span>0x2<span class="org-rainbow-delimiters-depth-3">)</span> || <span class="org-rainbow-delimiters-depth-3">(</span>fp == <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-4">)</span>0x3<span class="org-rainbow-delimiters-depth-3">)</span>
            || <span class="org-rainbow-delimiters-depth-3">(</span>fp == <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-4">)</span>-1<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
          <span class="org-rainbow-delimiters-depth-2">{</span>
            <span class="org-type">HMODULE</span> <span class="org-variable-name">module</span> = LoadLibraryA<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"opengl32.dll"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            fp = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">void</span> *<span class="org-rainbow-delimiters-depth-3">)</span> GetProcAddress<span class="org-rainbow-delimiters-depth-3">(</span>module, name<span class="org-rainbow-delimiters-depth-3">)</span>;
          <span class="org-rainbow-delimiters-depth-2">}</span>

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> fp == <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">{</span>
            <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [ERROR] OpenGL function = '%s' not found on Windows "</span>, name <span class="org-rainbow-delimiters-depth-3">)</span>;
            <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-preprocessor">    #elif</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-2">(</span>__linux__<span class="org-rainbow-delimiters-depth-2">)</span> || <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-2">(</span>__bsd__<span class="org-rainbow-delimiters-depth-2">)</span>
        fp = <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">FptrVoid</span><span class="org-rainbow-delimiters-depth-2">)</span> glXGetProcAddressARB<span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">const</span> <span class="org-type">unsigned</span> <span class="org-type">char</span>*<span class="org-rainbow-delimiters-depth-3">)</span> name<span class="org-rainbow-delimiters-depth-2">)</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> fp == <span class="org-constant">nullptr</span> <span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">{</span>
            <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [ERROR] OpenGL function not found on Linux or BSD "</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-preprocessor">    #endif</span>
    <span class="org-keyword">return</span> fp;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">int</span>    <span class="org-type">GLenum</span>;
<span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">char</span>   <span class="org-type">GLboolean</span>;
<span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">int</span>    <span class="org-type">GLbitfield</span>;
<span class="org-keyword">typedef</span> <span class="org-type">void</span>        <span class="org-type">GLvoid</span>;
<span class="org-keyword">typedef</span> <span class="org-type">signed</span> <span class="org-type">char</span> <span class="org-type">GLbyte</span>;     <span class="org-comment-delimiter">/* </span><span class="org-comment">1-byte signed */</span>
<span class="org-keyword">typedef</span> <span class="org-type">short</span>       <span class="org-type">GLshort</span>;    <span class="org-comment-delimiter">/* </span><span class="org-comment">2-byte signed */</span>
<span class="org-keyword">typedef</span> <span class="org-type">int</span>     <span class="org-type">GLint</span>;      <span class="org-comment-delimiter">/* </span><span class="org-comment">4-byte signed */</span>
<span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">char</span>   <span class="org-type">GLubyte</span>;    <span class="org-comment-delimiter">/* </span><span class="org-comment">1-byte unsigned */</span>
<span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">short</span>  <span class="org-type">GLushort</span>;   <span class="org-comment-delimiter">/* </span><span class="org-comment">2-byte unsigned */</span>
<span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">int</span>    <span class="org-type">GLuint</span>;     <span class="org-comment-delimiter">/* </span><span class="org-comment">4-byte unsigned */</span>
<span class="org-keyword">typedef</span> <span class="org-type">int</span>     <span class="org-type">GLsizei</span>;    <span class="org-comment-delimiter">/* </span><span class="org-comment">4-byte signed */</span>
<span class="org-keyword">typedef</span> <span class="org-type">float</span>       <span class="org-type">GLfloat</span>;    <span class="org-comment-delimiter">/* </span><span class="org-comment">single precision float */</span>
<span class="org-keyword">typedef</span> <span class="org-type">float</span>       <span class="org-type">GLclampf</span>;   <span class="org-comment-delimiter">/* </span><span class="org-comment">single precision float in [0,1] */</span>
<span class="org-keyword">typedef</span> <span class="org-type">double</span>  <span class="org-type">GLdouble</span>;   <span class="org-comment-delimiter">/* </span><span class="org-comment">double precision float */</span>
<span class="org-keyword">typedef</span> <span class="org-type">double</span>  <span class="org-type">GLclampd</span>;   <span class="org-comment-delimiter">/* </span><span class="org-comment">double precision float in [0,1] */</span>

<span class="org-preprocessor">#ifdef</span> _WIN64
    <span class="org-keyword">typedef</span> <span class="org-type">signed</span>   <span class="org-type">long</span> <span class="org-type">long</span> <span class="org-type">int</span> <span class="org-type">khronos_intptr_t</span>;
    <span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">long</span> <span class="org-type">long</span> <span class="org-type">int</span> <span class="org-type">khronos_uintptr_t</span>;
    <span class="org-keyword">typedef</span> <span class="org-type">signed</span>   <span class="org-type">long</span> <span class="org-type">long</span> <span class="org-type">int</span> <span class="org-type">khronos_ssize_t</span>;
    <span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">long</span> <span class="org-type">long</span> <span class="org-type">int</span> <span class="org-type">khronos_usize_t</span>;
<span class="org-preprocessor">#else</span>
    <span class="org-keyword">typedef</span> <span class="org-type">signed</span>   <span class="org-type">long</span>  <span class="org-type">int</span>     <span class="org-type">khronos_intptr_t</span>;
    <span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">long</span>  <span class="org-type">int</span>     <span class="org-type">khronos_uintptr_t</span>;
    <span class="org-keyword">typedef</span> <span class="org-type">signed</span>   <span class="org-type">long</span>  <span class="org-type">int</span>     <span class="org-type">khronos_ssize_t</span>;
    <span class="org-keyword">typedef</span> <span class="org-type">unsigned</span> <span class="org-type">long</span>  <span class="org-type">int</span>     <span class="org-type">khronos_usize_t</span>;
<span class="org-preprocessor">#endif</span>


<span class="org-keyword">typedef</span> <span class="org-type">khronos_ssize_t</span> <span class="org-type">GLsizeiptr</span>;
<span class="org-keyword">typedef</span> <span class="org-type">khronos_intptr_t</span> <span class="org-type">GLintptr</span>;

<span class="org-keyword">using</span> <span class="org-type">glClear_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">unsigned</span> <span class="org-type">int</span> <span class="org-variable-name">mask</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">glClearColor_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">float</span> <span class="org-variable-name">red</span>, <span class="org-type">float</span> <span class="org-variable-name">green</span>, <span class="org-type">float</span> <span class="org-variable-name">blue</span>, <span class="org-type">float</span> <span class="org-variable-name">alpha</span> <span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">glBindBuffer_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLenum</span> <span class="org-variable-name">target</span>, <span class="org-type">GLuint</span> <span class="org-variable-name">buffer</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">glGenBuffers_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLsizei</span> <span class="org-variable-name">n</span>, GLuint * buffers<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">glBufferData_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLenum</span> <span class="org-variable-name">target</span>, <span class="org-type">GLsizeiptr</span> <span class="org-variable-name">size</span>, <span class="org-keyword">const</span> <span class="org-type">void</span> *<span class="org-variable-name">data</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">usage</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">glEnableVertexAttribArray_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">index</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">glDisableVertexAttribArray_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">index</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">glVertexAttribPointer_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">index</span>, <span class="org-type">GLint</span> <span class="org-variable-name">size</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span>, <span class="org-type">GLboolean</span> <span class="org-variable-name">normalized</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">stride</span>, <span class="org-keyword">const</span> <span class="org-type">void</span> *<span class="org-variable-name">pointer</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">using</span> <span class="org-type">glDrawArrays_t</span> = <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-1">(</span>*<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLenum</span> <span class="org-variable-name">mode</span>, <span class="org-type">GLint</span> <span class="org-variable-name">first</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">count</span> <span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">struct</span> <span class="org-type">OpenGL</span> <span class="org-rainbow-delimiters-depth-1">{</span>

    <span class="org-function-name">OpenGL</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;glClear = <span class="org-keyword">reinterpret_cast</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">glClear_t</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span> load_gl_function<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"glClear"</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">It should be used reinterpret_cast&lt;&gt;, but C-style cast is used for breviety.</span>
        <span class="org-keyword">this</span>-&gt;glClearColor = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">glClearColor_t</span><span class="org-rainbow-delimiters-depth-3">)</span> load_gl_function<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"glClearColor"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;glBindBuffer = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">glBindBuffer_t</span><span class="org-rainbow-delimiters-depth-3">)</span> load_gl_function<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"glBindBuffer"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;glGenBuffers = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">glGenBuffers_t</span><span class="org-rainbow-delimiters-depth-3">)</span> load_gl_function<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"glGenBuffers"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;glBufferData = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">glBufferData_t</span><span class="org-rainbow-delimiters-depth-3">)</span> load_gl_function<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"glBufferData"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;glEnableVertexAttribArray   = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">glEnableVertexAttribArray_t</span><span class="org-rainbow-delimiters-depth-3">)</span> load_gl_function<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"glEnableVertexAttribArray"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;glDisableVertexAttribArray  = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">glDisableVertexAttribArray_t</span><span class="org-rainbow-delimiters-depth-3">)</span> load_gl_function<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"glDisableVertexAttribArray"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;glVertexAttribPointer       = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">glVertexAttribPointer_t</span><span class="org-rainbow-delimiters-depth-3">)</span> load_gl_function<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"glVertexAttribPointer"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;glDrawArrays                = <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">glDrawArrays_t</span><span class="org-rainbow-delimiters-depth-3">)</span> load_gl_function<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"glDrawArrays"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">glClear_t</span>               <span class="org-variable-name">glClear</span>;
    <span class="org-type">glClearColor_t</span>                <span class="org-variable-name">glClearColor</span>;
    <span class="org-type">glBindBuffer_t</span>              <span class="org-variable-name">glBindBuffer</span>;
    <span class="org-type">glGenBuffers_t</span>              <span class="org-variable-name">glGenBuffers</span>;
    <span class="org-type">glBufferData_t</span>                  <span class="org-variable-name">glBufferData</span>;
    <span class="org-type">glEnableVertexAttribArray_t</span>   <span class="org-variable-name">glEnableVertexAttribArray</span>;
    <span class="org-type">glDisableVertexAttribArray_t</span>  <span class="org-variable-name">glDisableVertexAttribArray</span>;
    <span class="org-type">glVertexAttribPointer_t</span>         <span class="org-variable-name">glVertexAttribPointer</span>;
    <span class="org-type">glDrawArrays_t</span>                <span class="org-variable-name">glDrawArrays</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">====== S T A R T - O F - A P P L I C A T I O N - C O D E ============//</span>
<span class="org-comment-delimiter">//</span>

<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>;
    <span class="org-type">GLfloat</span> <span class="org-variable-name">y</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>


    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Initialize GLFW </span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [TRACE] GLFW initialized Ok. \n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">/* </span><span class="org-comment">Create a windowed mode window and its OpenGL context */</span>
    window = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"Load OpenGL functiion pointers"</span>, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>window<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glfwTerminate<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-keyword">return</span> -1;
    <span class="org-rainbow-delimiters-depth-2">}</span> 

    <span class="org-comment-delimiter">// </span><span class="org-comment">----- Before defining current OpenGL context ----//</span>
        glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">----- After defining current OpenGL context -----//</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">GL object Must only be instantiated after an OpenGL context (Window) is obtained</span>
    <span class="org-type">OpenGL</span> <span class="org-variable-name">gl</span>;

    gl.glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.5f, 0.6f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Vertex2D</span> <span class="org-variable-name">triangle_points</span><span class="org-rainbow-delimiters-depth-2">[</span>3<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
        Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span>-0.25,   -0.25<span class="org-rainbow-delimiters-depth-3">}</span>
      , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> 0.00,   0.25<span class="org-rainbow-delimiters-depth-3">}</span>
      , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> 0.25,  -0.25<span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">Vertex2D</span> <span class="org-variable-name">square_points</span><span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-rainbow-delimiters-depth-3">{</span> -0.3,  -0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> -0.3,   0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>  0.3,   0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>  0.3,  -0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">================== Triangle Buffer ====================//</span>
    <span class="org-comment-delimiter">//</span>

    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_triangle_</span> = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Create an OpenGL VBO buffer</span>
    gl.glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo_triangle_ <span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> vbo_triangle_ != 0 <span class="org-rainbow-delimiters-depth-2">)</span>;
    gl.glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo_triangle_<span class="org-rainbow-delimiters-depth-2">)</span>;
    gl.glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>triangle_points<span class="org-rainbow-delimiters-depth-3">)</span>, triangle_points, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;
    gl.glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">================ Square / Vertex Buffer Object 2 ==================//</span>
    <span class="org-comment-delimiter">//</span>

    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_square_</span> = 0;
    gl.glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo_square_<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check for error</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span> vbo_square_ != 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    gl.glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo_square_<span class="org-rainbow-delimiters-depth-2">)</span>;
    gl.glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>square_points<span class="org-rainbow-delimiters-depth-3">)</span>, square_points, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;
    gl.glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">shader_attr</span> = 0;

    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
            gl.glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">------------ Draw triangle --------------//</span>
            <span class="org-comment-delimiter">//</span>
            gl.glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, vbo_triangle_<span class="org-rainbow-delimiters-depth-3">)</span>;
            gl.glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr<span class="org-rainbow-delimiters-depth-3">)</span>;

            gl.glVertexAttribPointer<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr, 2, GL_FLOAT, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_TRIANGLES, 0, 3<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Disable global state</span>
            gl.glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-3">)</span>;
            gl.glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>0<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">//</span><span class="org-comment">------------ Draw Square -------------------------//</span>
            <span class="org-comment-delimiter">//</span>

<span class="org-preprocessor">            #if</span> 1
            gl.glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, vbo_square_<span class="org-rainbow-delimiters-depth-3">)</span>;
            gl.glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr<span class="org-rainbow-delimiters-depth-3">)</span>;
            gl.glVertexAttribPointer<span class="org-rainbow-delimiters-depth-3">(</span>0, 2, GL_FLOAT, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            <span class="org-comment-delimiter">// </span><span class="org-comment">Plot 4 vertices</span>
            gl.glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_LINE_LOOP, 0, 4<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Disable global state</span>
            gl.glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-3">)</span>;
            gl.glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-3">(</span>shader_attr<span class="org-rainbow-delimiters-depth-3">)</span>;
<span class="org-preprocessor">            #endif</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
        glfwPollEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Q'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
             <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] User typed Q =&gt;&gt; Shutdown program. Ok. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
             <span class="org-keyword">break</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>

<p>
<b>Building</b> 
</p>

<p>
Building on Linux: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build_linux -DCMAKE_BUILD_TYPE=Debug 
$ cmake --build _build_linux --target
</pre>
</div>

<p>
Building for Windows with Dockercross tool: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ docker run -it --rm -v $<span class="org-variable-name">PWD</span>:/cwd -w /cwd --entrypoint=bash dockcross/windows-static-x64
$ cmake -H. -B_build_cross -DCMAKE_BUILD_TYPE=Debug 
$ cmake --build _build_cross --target

$ wine _build_cross/load-opengl-fptr.exe 
 [TRACE] GLFW initialized Ok. 
 [TRACE] Loading pointer to OpenGL subroutine = glClear 
 [TRACE] Loading pointer to OpenGL subroutine = glClearColor 
 [TRACE] Loading pointer to OpenGL subroutine = glBindBuffer 
 [TRACE] Loading pointer to OpenGL subroutine = glGenBuffers 
 [TRACE] Loading pointer to OpenGL subroutine = glBufferData 
 [TRACE] Loading pointer to OpenGL subroutine = glEnableVertexAttribArray 
 [TRACE] Loading pointer to OpenGL subroutine = glDisableVertexAttribArray 
 [TRACE] Loading pointer to OpenGL subroutine = glVertexAttribPointer 
 [TRACE] Loading pointer to OpenGL subroutine = glDrawArrays 
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb98f4d6" class="outline-3">
<h3 id="orgb98f4d6"><span class="section-number-3">1.18</span> 2D - using VAO</h3>
<div class="outline-text-3" id="text-1-18">
<p>
A VAO (Vertex Array Object) is an object that stores all the
information necessary to render a VBO (Vertex Buffer Object). For
instance, a VAO allows rendering the data, by performing the following
set of operations only once: 1 - binding the VAO; 2 - binding the
buffer via glBindBuffer() call; 3 - enabling the vertex attribute via
glEnableVertexAttribArray(); 4 - setting the data layout by calling
glVertexAttribPointer() subroutine. Without a VAO, all those
subroutines would need to be called on every frame rendering.
</p>

<p>
Algorithm for VAO usage:
</p>

<ul class="org-ul">
<li>Setup</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location</span>
<span class="org-type">GLint</span> <span class="org-variable-name">shader_attr</span> = 1;

<span class="org-comment-delimiter">// </span><span class="org-comment">-------------- Setup VAO --------------------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-type">GLuint</span> <span class="org-variable-name">vao</span>;
glGenVertexArrays<span class="org-rainbow-delimiters-depth-1">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-1">)</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Instantiate VAO</span>

<span class="org-type">GLuint</span> <span class="org-variable-name">vbo</span>;
glGenBuffers<span class="org-rainbow-delimiters-depth-1">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Bind VBO (Recorded by VAO)</span>
glBindBuffer<span class="org-rainbow-delimiters-depth-1">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to GPU</span>
glBufferData<span class="org-rainbow-delimiters-depth-1">(</span>GL_ARRAY_BUFFER, buffer_size, buffer, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-1">)</span>;

glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-1">(</span>shader_attr<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Set buffer data layout (Recorded by VAO)</span>
glVertexAttribPointer<span class="org-rainbow-delimiters-depth-1">(</span>shader_attr, size, type, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">------- Disable Global state ---------//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO</span>
glBindVertexArray<span class="org-rainbow-delimiters-depth-1">(</span>0<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO</span>
glBindBuffer<span class="org-rainbow-delimiters-depth-1">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute</span>
glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-1">(</span>shader_attr<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<ul class="org-ul">
<li>Rendering loop</li>
</ul>

<div class="org-src-container">
<pre class="src src-cpp">     ... ...         ... ...         ... ...
     ... ...         ... ...         ... ...

<span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
<span class="org-comment-delimiter">//                                             </span><span class="org-comment">//</span>
<span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    glClear<span class="org-rainbow-delimiters-depth-2">(</span>GL_COLOR_BUFFER_BIT<span class="org-rainbow-delimiters-depth-2">)</span>;
     ... ...         ... ...         ... ...
     ... ...         ... ...         ... ...

     glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;
     glDrawArrays<span class="org-rainbow-delimiters-depth-2">(</span>GL_LINE_LOOP, 0, NUMBER_OF_VERTICES<span class="org-rainbow-delimiters-depth-2">)</span>;

     glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao1<span class="org-rainbow-delimiters-depth-2">)</span>;
     glDrawArrays<span class="org-rainbow-delimiters-depth-2">(</span>GL_LINE_TRIANGLES, 0, NUMBER_OF_VERTICES_1<span class="org-rainbow-delimiters-depth-2">)</span>;

     glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao2<span class="org-rainbow-delimiters-depth-2">)</span>;
     glDrawArrays<span class="org-rainbow-delimiters-depth-2">(</span>GL_LINES, 0, NUMBER_OF_VERTICES_2<span class="org-rainbow-delimiters-depth-2">)</span>;

     ... ...         ... ...         ... ...
     ... ...         ... ...         ... ...

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
    glfwSwapBuffers<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
    glfwPollEvents<span class="org-rainbow-delimiters-depth-2">()</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>


<p>
<b>Further Reading</b>
</p>

<ul class="org-ul">
<li><a href="https://www.khronos.org/opengl/wiki/Tutorial2:_VAOs,_VBOs,_Vertex_and_Fragment_Shaders_(C_/_SDL)">Tutorial2: VAOs, VBOs, Vertex and Fragment Shaders (C / SDL) - OpenGL Wiki</a></li>

<li><a href="https://android-developers.googleblog.com/2015/10/game-performance-vertex-array-objects.html">Android Developers Blog: Game Performance: Vertex Array Objects</a></li>

<li><a href="https://android-developers.googleblog.com/2015/03/today-we-want-to-share-some-best.html">Android Developers Blog: Game Performance: Layout Qualifiers</a></li>

<li><a href="https://stackoverflow.com/questions/28270954/process-of-setting-up-a-vao-in-opengl">c++ - Process of setting up a VAO in OpenGL - Stack Overflow</a></li>

<li><a href="https://stackoverflow.com/questions/8923174/opengl-vao-best-practices">OpenGL VAO best practices - Stack Overflow</a></li>

<li><a href="https://computergraphics.stackexchange.com/questions/5895/what-is-an-opengl-vao-in-a-nutshell">vertex buffer object - What is an OpenGL VAO in a nutshell?</a>  -
Computer Graphics Stack Exchange</li>

<li><a href="https://gamedev.stackexchange.com/questions/92832/in-opengl-whats-quicker-lots-of-smaller-vaos-or-one-large-one-updated-each-fr">performance - In OpenGL what's quicker</a> - , lots of smaller VAOs,
or one large one updated each frame? - Game Development Stack
Exchange.</li>

<li><a href="https://stackoverflow.com/questions/18485381/opengl-how-many-vaos">OpenGL How Many VAOs - Stack Overflow</a></li>
</ul>


<p>
<b>Screenshot</b>
</p>


<div class="figure">
<p><a href="images/opengl-draw2-vao.png"><img src="images/opengl-draw2-vao.png" alt="opengl-draw2-vao.png" /></a>
</p>
<p><span class="figure-number">Figure 10: </span>2D OpenGL draw using VAO - Vertex Array Object</p>
</div>

<p>
<b>Sample Code</b>
</p>

<p>
File: CMakeLists.txt
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(draw2d)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

       <span class="org-function-name">add_executable</span>( draw2d-vao  draw2d-vao.cpp )
<span class="org-function-name">target_link_libraries</span>( draw2d-vao  glfw OpenGL::GL GLU)
</pre>
</div>

<p>
File: <span class="underline">draw2d-vao.cpp</span>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Draw curve mapping buffer to the GPU.</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glew.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glut.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>


<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>;
    <span class="org-type">GLfloat</span> <span class="org-variable-name">y</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload buffer from main memory to GPU VBO</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; Parameters VAO, VBO are allocated by the caller.</span>
<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span>   <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VAO (Vertex Array Object) - allocated by caller</span>
                  , <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VBO (Vertex Buffer Object) - allocated by caller</span>
                  , <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Total buffer size in bytes</span>
                  , <span class="org-type">void</span>*   <span class="org-variable-name">pBufffer</span>    <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to buffer</span>
                  , <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location</span>
                  , <span class="org-type">GLint</span>   <span class="org-variable-name">size</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Number of coordinates of a given vertex</span>
                  , <span class="org-type">GLenum</span>  <span class="org-variable-name">type</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each element coordinate</span>
                  <span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-type">void</span>* <span class="org-function-name">map_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>         <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VAO - allocated by calling code.</span>
                , <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>         <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VBO - allocated by calling code.</span>
                , <span class="org-type">GLsizei</span> <span class="org-variable-name">data_size</span>    <span class="org-comment-delimiter">// </span><span class="org-comment">Total size in bytes that is allocated to buffer</span>
                , <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Shadder attribute location id (0 - zero) is there is no shader.</span>
                , <span class="org-type">GLint</span>   <span class="org-variable-name">size</span>         <span class="org-comment-delimiter">// </span><span class="org-comment">Number of component of each vertex</span>
                , <span class="org-type">GLenum</span>  <span class="org-variable-name">type</span>         <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each vertex element</span>
                <span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>;

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Initialize the library */</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-keyword">return</span> -1;

    glutInit<span class="org-rainbow-delimiters-depth-2">(</span>&amp;argc, argv<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Create a windowed mode window and its OpenGL context */</span>
    window = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"2D Drawing using VAO"</span>, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>window<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glfwTerminate<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-keyword">return</span> -1;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Make the window's context current */</span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glClearColor(0.0f, 0.5f, 0.6f, 1.0f);</span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.0f, 0.0, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location (default 0)</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_attr</span> = 0;


    <span class="org-comment-delimiter">// </span><span class="org-comment">================ Square / Vertex Buffer Object 2 ==================//</span>
    <span class="org-comment-delimiter">//</span>

    <span class="org-type">Vertex2D</span> <span class="org-variable-name">square_points</span><span class="org-rainbow-delimiters-depth-2">[</span>4<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-rainbow-delimiters-depth-3">{</span> -0.3,  -0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> -0.3,   0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>  0.3,   0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>  0.3,  -0.3 <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_square</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_square</span> = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload square_points buffer data to GPU</span>
    send_buffer<span class="org-rainbow-delimiters-depth-2">(</span> &amp;vao_square, &amp;vbo_square, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>square_points<span class="org-rainbow-delimiters-depth-3">)</span>
                , square_points, shader_attr, 2, GL_FLOAT <span class="org-rainbow-delimiters-depth-2">)</span>;

    assert<span class="org-rainbow-delimiters-depth-2">(</span> vao_square != 0 <span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> vbo_square != 0 <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span> stderr, <span class="org-string">" [TRACE] vao_square = %d, vbo_square = %d \n"</span>
                 , vao_square, vbo_square<span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">============== Circle / Vertex Buffer Object 3 ==================//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_circle</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_circle</span> = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Number of vertices to used to render the circle.</span>
    <span class="org-keyword">constexpr</span> <span class="org-type">size_t</span> <span class="org-variable-name">N_CIRCLE</span> = 100;
    <span class="org-keyword">constexpr</span> <span class="org-type">float</span>  <span class="org-variable-name">PI</span>       = 3.1415927;
    <span class="org-keyword">const</span>     <span class="org-type">float</span>  <span class="org-variable-name">radius</span>   = 0.75;

    <span class="org-comment-delimiter">// </span><span class="org-comment">C-style cast should not be used here</span>
    <span class="org-type">Vertex2D</span>* <span class="org-variable-name">pCursor</span> = <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">Vertex2D</span>*<span class="org-rainbow-delimiters-depth-2">)</span> map_buffer<span class="org-rainbow-delimiters-depth-2">(</span> &amp;vao_circle, &amp;vbo_circle, <span class="org-type">N_CIRCLE</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-3">)</span>
                                              , shader_attr, 2, GL_FLOAT <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">float</span> <span class="org-variable-name">angle</span> = 0.0;
    <span class="org-keyword">const</span> <span class="org-type">float</span> <span class="org-variable-name">step</span> = 2 * PI / N_CIRCLE;

    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">n</span> = 0; n &lt; N_CIRCLE; n++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        pCursor<span class="org-rainbow-delimiters-depth-3">[</span>n<span class="org-rainbow-delimiters-depth-3">]</span>.x = radius * cosf<span class="org-rainbow-delimiters-depth-3">(</span> angle <span class="org-rainbow-delimiters-depth-3">)</span>;
        pCursor<span class="org-rainbow-delimiters-depth-3">[</span>n<span class="org-rainbow-delimiters-depth-3">]</span>.y = radius * sinf<span class="org-rainbow-delimiters-depth-3">(</span> angle <span class="org-rainbow-delimiters-depth-3">)</span>;
        angle = angle + step;
    <span class="org-rainbow-delimiters-depth-2">}</span>


    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//                                             </span><span class="org-comment">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

            <span class="org-comment-delimiter">//</span><span class="org-comment">------------ Draw Square -------------------------//</span>
            <span class="org-comment-delimiter">//</span>
             glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_square<span class="org-rainbow-delimiters-depth-3">)</span>;
            <span class="org-comment-delimiter">// </span><span class="org-comment">Plot 4 vertices</span>
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_LINE_LOOP, 0, 4<span class="org-rainbow-delimiters-depth-3">)</span>;
            <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind vao (restore global state to default value)</span>
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>0<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">//</span><span class="org-comment">------------ Draw Circle -------------------------//</span>
            <span class="org-comment-delimiter">//</span>
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_circle<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_LINE_LOOP, 0, N_CIRCLE<span class="org-rainbow-delimiters-depth-3">)</span>;
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>0<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
        glfwPollEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Q'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
             <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] User typed Q =&gt;&gt; Shutdown program. Ok. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
             <span class="org-keyword">break</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">---------- Dispose Buffer Objects ---------//</span>
    glDeleteBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo_square<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDeleteBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo_circle<span class="org-rainbow-delimiters-depth-2">)</span>;

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">---------- I M P L E M E N T A T I O N S ------------------//</span>
<span class="org-comment-delimiter">//                                                            </span><span class="org-comment">//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload buffer from main memory to GPU VBO</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; Parameters VAO, VBO are allocated by the caller.</span>
<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span>   <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VAO (Vertex Array Object) - allocated by caller</span>
                  , <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VBO (Vertex Buffer Object) - allocated by caller</span>
                  , <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Total buffer size in bytes</span>
                  , <span class="org-type">void</span>*   <span class="org-variable-name">pBufffer</span>    <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to buffer</span>
                  , <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location id</span>
                  , <span class="org-type">GLint</span>   <span class="org-variable-name">size</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Number of coordinates of a given vertex</span>
                  , <span class="org-type">GLenum</span>  <span class="org-variable-name">type</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each element coordinate</span>
                  <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVao != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVbo != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = *pVbo;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    glGenVertexArrays<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, sizeBuffer, pBufffer, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;

    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr, size, type, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute</span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span>* <span class="org-function-name">map_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>         <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VAO - allocated by calling code.</span>
                , <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>         <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VBO - allocated by calling code.</span>
                , <span class="org-type">GLsizei</span> <span class="org-variable-name">data_size</span>    <span class="org-comment-delimiter">// </span><span class="org-comment">Total size in bytes that is allocated to buffer</span>
                , <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Shadder attribute location id (0 - zero) is there is no shader.</span>
                , <span class="org-type">GLint</span>   <span class="org-variable-name">size</span>         <span class="org-comment-delimiter">// </span><span class="org-comment">Number of component of each vertex</span>
                , <span class="org-type">GLenum</span>  <span class="org-variable-name">type</span>         <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each vertex element</span>
                <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = *pVbo;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    glGenVertexArrays<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">/** </span><span class="org-comment">See: https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glMapBuffer.xhtml</span>
<span class="org-comment">     *  Khronos Group: "glMapBuffer and glMapNamedBuffer map the entire data store of</span>
<span class="org-comment">     *  a specified buffer object into the client's address space. The data can then be directly</span>
<span class="org-comment">     *  read and/or written relative to the returned pointer,</span>
<span class="org-comment">     *  depending on the specified access policy."</span>
<span class="org-comment">     */</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, data_size, <span class="org-constant">nullptr</span>, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">void</span>* <span class="org-variable-name">pbuffer</span> = glMapBuffer<span class="org-rainbow-delimiters-depth-2">(</span> GL_ARRAY_BUFFER, GL_WRITE_ONLY <span class="org-rainbow-delimiters-depth-2">)</span>;

    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr, size, type, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute</span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------- Return --------------------------------------//</span>
    <span class="org-keyword">return</span> pbuffer;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org45cee49" class="outline-3">
<h3 id="org45cee49"><span class="section-number-3">1.19</span> 2D - using shaders</h3>
<div class="outline-text-3" id="text-1-19">
<p>
OpenGL retained mode (programmable pipeline) uses shaders, which are
programs that uses GLSL (OpenGL shading language) programming
language, runs on the GPU (Graphics Processing Unit). A vertex shader
performs vertex coordinate transformations on all vertices and colors
received from VBO - Vertex Buffer Objects. The fragment shader runs
after the vertex shader and deals with vertice texture and color
computations.
</p>

<p>
A vertex shader has the following features:
</p>

<ul class="org-ul">
<li>Data types:
<ul class="org-ul">
<li>float =&gt; Float IEEE754 32 bits floating point scalar.</li>
<li>vec2 =&gt; Vector of 2 coordinates</li>
<li>vec3 =&gt; Vector of 3 coordinates</li>
<li>vec4 =&gt; Vector of 4 coordinates</li>
<li>mat2 =&gt; 2x2 matrix</li>
<li>mat4 =&gt; 4x4 homogeneous coordinate matrix</li>
<li>mat3 =&gt; 3x3 matrix</li>
</ul></li>

<li><span class="underline">uniform variables</span> =&gt; Shader variables declared with <span class="underline">uniform</span> storage
qualifier. They allow passing data, such as transformation
matrices, vectors or scalar values, from the C++-side to the shader
program. Uniform variables can be used for passing the model matrix,
camera matrix and projection matrix to the shader.
<ul class="org-ul">
<li>Declaration example: 'uniform mat4 u_model;'</li>
</ul></li>

<li><span class="underline">attribute variables</span> =&gt; Used for passing vertices or color
coordinates from VBOs (Vertex Buffer Objects). Those variables are
only accessible in the shader.
<ul class="org-ul">
<li>Declaration example: 'layout ( location = 2)  in vec2 position;'</li>
</ul></li>

<li><span class="underline">Output</span> =&gt; Shader programs uses pre-defined global variables for
output, for instance, <span class="underline">gl_Position</span>, which sets the current vertex
position in clip-space (NDC - Normalized Device Coordinates).</li>
</ul>



<p>
<b>Documentation</b>
</p>

<ul class="org-ul">
<li><a href="https://www.khronos.org/opengl/wiki/Core_Language_(GLSL)">Core Language (GLSL) - OpenGL Wiki</a> / Khronos Group.
<ul class="org-ul">
<li>Syntax of GLSL (OpenGL shading language)</li>
</ul></li>

<li><a href="https://www.khronos.org/opengl/wiki/Data_Type_(GLSL)">Data Type (GLSL) - OpenGL Wiki</a> / Khronos Group</li>

<li><a href="https://en.wikipedia.org/wiki/OpenGL_Shading_Language">OpenGL Shading Language - Wikipedia</a></li>

<li><a href="https://www.khronos.org/opengl/wiki/Shader">Shader - OpenGL Wiki</a> / Khronos Group</li>

<li><a href="https://www.khronos.org/opengl/wiki/Vertex_Shader">Vertex Shader - OpenGL Wiki</a> / Khronos Group</li>

<li><a href="https://www.khronos.org/opengl/wiki/Fragment_Shader">Fragment Shader - OpenGL Wiki</a> / Khronos Group</li>

<li><a href="https://www.khronos.org/opengl/wiki/Uniform_(GLSL)">Uniform (GLSL) - OpenGL Wiki</a> / Khronos Group
<ul class="org-ul">
<li>Discusses shader uniform variables.</li>
</ul></li>

<li><a href="https://www.khronos.org/opengl/wiki/Layout_Qualifier_(GLSL)">Layout Qualifier (GLSL) - OpenGL Wiki</a> / Khronos Group
<ul class="org-ul">
<li>Shader attribute index (attribute location)</li>
</ul></li>

<li><a href="https://www.khronos.org/opengl/wiki/Geometry_Shader">Geometry Shader - OpenGL Wiki</a> / Khronos Group.</li>

<li><a href="https://www.khronos.org/opengl/wiki/Shader_Compilation">Shader Compilation - OpenGL Wiki</a> / Khronos Group.</li>

<li><a href="https://www.khronos.org/opengl/wiki/Vertex_Rendering">Vertex Rendering - OpenGL Wiki</a></li>

<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Data">Data in WebGL - Web APIs | MDN</a> / Mozilla
<ul class="org-ul">
<li>Explanation of shader's attribute variables and shader's uniform
variables.</li>
</ul></li>
</ul>

<p>
<b>Source Code</b>
</p>

<p>
Summary:
</p>

<ul class="org-ul">
<li>This sample application, draws many 4 triangles from a 2 VBO
(Vertex Buffer Object) and a single VAO (Vertex Array Object). The
application uses a vertex shader for performing coordinate
transformation for every triangle and drawing them at different
position with different rotation angles around Z axis. The triangle
'triangleD' follows the mouse position while the triangle
'triangleB' rotates acoording to the mouse position.</li>

<li>The vertex shader has two attributes variables ('position' and
'color') and two uniform variables u_model, that contains the model
matrix from every rendered object, and u_projection, which contains
the projection matrix.</li>
</ul>

<p>
Screenshot:
</p>


<div class="figure">
<p><a href="images/opengl-draw2d-shader.png"><img src="images/opengl-draw2d-shader.png" alt="opengl-draw2d-shader.png" /></a>
</p>
</div>


<p>
<span class="underline">Vertex Shader</span> - Source Code (Extraced from <span class="underline">draw2d-shader.cpp</span>)
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330 core

<span class="org-comment-delimiter">// </span><span class="org-comment">Supplied by GPU - attribute location (id = 2)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">contains a (X, Y) vertex</span>
layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 2<span class="org-rainbow-delimiters-depth-1">)</span>  in <span class="org-type">vec2</span> <span class="org-variable-name">position</span>;
layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 1 <span class="org-rainbow-delimiters-depth-1">)</span> in <span class="org-type">vec3</span> <span class="org-variable-name">color</span>;     <span class="org-comment-delimiter">// </span><span class="org-comment">Contains (Red, Green, Blue) components</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Output to fragment shader</span>
out <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Model matrix =&gt; projection coordinates from the local space (model space)</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">to view space .</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Transform 4x4 matrix - supplied by the C++ side.</span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_model</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Projection matrix =&gt; projections camera-space coordinates</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">to clip-space coordinates. (-1.0 to 1.0) range.</span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_projection</span>;

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">gl_Position =&gt; Global output variable that holds the</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">the current vertex position. It is a vector of</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">components (X, Y, Z = 0, W = ignored)</span>
    gl_Position = u_projection * u_model * vec4<span class="org-rainbow-delimiters-depth-2">(</span>position, 0, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Forward to fragment shader</span>
    out_color = color;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<span class="underline">Fragment Shader</span> -  Source Code (Extracted from <span class="underline">draw2d-shader.cpp</span>)
</p>


<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330

<span class="org-comment-delimiter">// </span><span class="org-comment">This color comes from Vertex shader</span>
in <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set vertex colors</span>
    gl_FragColor = vec4<span class="org-rainbow-delimiters-depth-2">(</span>out_color, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
File: <span class="underline">CMakeLists.txt</span>
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(GLFW_project)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download GLM (OpenGL math library for matrix and vectors transformation)</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glm
  URL  https://github.com/g-truc/glm/archive/0.9.8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glm)

<span class="org-function-name">message</span>( [DEBUG] <span class="org-string">" glm_SOURCE_DIR = ${</span><span class="org-variable-name">glm_SOURCE_DIR</span><span class="org-string">} "</span>)
<span class="org-function-name">include_directories</span>(${<span class="org-variable-name">glm_SOURCE_DIR</span>})

  <span class="org-comment"># ======= TARGETS ===========================#</span>

       <span class="org-function-name">add_executable</span>( draw2d-shader  draw2d-shader.cpp   )
<span class="org-function-name">target_link_libraries</span>( draw2d-shader  glfw OpenGL::GL GLU )
</pre>
</div>

<p>
File: <span class="underline">draw2d-shader.cpp</span>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Draw many colored triangles from a single VBO (Vertex Buffer Object)</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glew.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- OpenGL Math Librar ------------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Compile some  shader</span>
<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Send data from memory to GPU VBO memory</span>
<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span>   <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VAO (Vertex Array Object) - allocated by caller</span>
                  , <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VBO (Vertex Buffer Object) - allocated by caller</span>
                  , <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Total buffer size in bytes</span>
                  , <span class="org-type">void</span>*   <span class="org-variable-name">pBufffer</span>    <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to buffer</span>
                  , <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location id</span>
                  , <span class="org-type">GLint</span>   <span class="org-variable-name">size</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Number of coordinates of a given vertex</span>
                  , <span class="org-type">GLenum</span>  <span class="org-variable-name">type</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each element coordinate</span>
                  <span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">------------ Basic Data Structures -----------//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for 2D vertex coordinates</span>
<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-1">{</span>  <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for RGB colors</span>
<span class="org-keyword">struct</span> <span class="org-type">ColorRGB</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">COLOR_R</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 0.0, 0.0  <span class="org-rainbow-delimiters-depth-1">}</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Red</span>
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">COLOR_G</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 1.0, 0.0  <span class="org-rainbow-delimiters-depth-1">}</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Green</span>
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">COLOR_B</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 0.0, 1.0  <span class="org-rainbow-delimiters-depth-1">}</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Blue</span>


<span class="org-keyword">class</span> <span class="org-type">Model_Triangle</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Object position in World Coordinates</span>
    <span class="org-type">float</span> <span class="org-variable-name">_x</span> = 0.0, <span class="org-variable-name">_y</span> = 0.0;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Scale</span>
    <span class="org-type">float</span> <span class="org-variable-name">_scale</span> = 1.0;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotation angle around z axis</span>
    <span class="org-type">float</span> <span class="org-variable-name">_angle</span> = 0.0;

<span class="org-function-name">public</span>:
    <span class="org-function-name">Model_Triangle</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">scale</span> = 1.0<span class="org-rainbow-delimiters-depth-2">){</span>   <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>          <span class="org-rainbow-delimiters-depth-2">{</span> _angle = angle; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">translate</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">x</span> , <span class="org-type">float</span> <span class="org-variable-name">y</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span> _x = x; _y = y; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">scale</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">scale</span><span class="org-rainbow-delimiters-depth-2">)</span>           <span class="org-rainbow-delimiters-depth-2">{</span> _scale = scale; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">zoom</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">factor</span><span class="org-rainbow-delimiters-depth-2">)</span>           <span class="org-rainbow-delimiters-depth-2">{</span>  _scale = factor + _scale; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Render/draw this object</span>
    <span class="org-type">void</span> <span class="org-function-name">render</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">vao</span>, <span class="org-type">GLint</span>  <span class="org-variable-name">u_model</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Reset model matrix to indentiy matrix</span>
        <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">_model</span><span class="org-rainbow-delimiters-depth-3">(</span>1.0<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Scale object (increase or decrease object size)</span>
        _model =  <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-3">(</span> _model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-4">(</span>_scale, _scale, _scale<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Move to (X, Y) position</span>
        _model = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-3">(</span> _model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-4">(</span>_x, _y, 0.0<span class="org-rainbow-delimiters-depth-4">)</span>  <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate from a given angle around Z axis at current object X, Y  postion</span>
        _model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-3">(</span> _model, <span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">_angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-4">(</span>0, 0, 1<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Set shader uniform variable.</span>
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">Shader uniform variable location</span>
            u_model
            <span class="org-comment-delimiter">// </span><span class="org-comment">Number of matrices that will be set</span>
            , 1
            <span class="org-comment-delimiter">// </span><span class="org-comment">GL_FALSE =&gt; Matrix is in column-major order (Fortran matrix layout)</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">GL_TRUE  =&gt; Matrix is in row-major order (C, C++ array, matrix layout)</span>
            , GL_FALSE
            <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to first element transform matrix (homogeneous coordinate)</span>
            , <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">_model</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-3">)</span>;
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Draw 3 vertices</span>
        glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_TRIANGLES, 0, 3<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Disable global state</span>
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>0<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">Global variable [WARNING] - Vulnerable to global "initialization fiasco"</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">undefined behavior.</span>
<span class="org-keyword">auto</span> <span class="org-variable-name">Cursor_Callback</span> = <span class="org-constant">std</span>::function<span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>, <span class="org-type">double</span> <span class="org-variable-name">xpos</span>, <span class="org-type">double</span> <span class="org-variable-name">ypos</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">&gt;()</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Initialize the library */</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL Core Profile</span>
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MAJOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MINOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE<span class="org-rainbow-delimiters-depth-2">)</span>;

    glfwSetErrorCallback<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">error</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">description</span><span class="org-rainbow-delimiters-depth-3">)</span>
                         <span class="org-rainbow-delimiters-depth-3">{</span>
                            <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [GLFW ERROR] "</span> &lt;&lt; error
                                      &lt;&lt; <span class="org-string">": "</span> &lt;&lt; description
                                      &lt;&lt; <span class="org-constant">std</span>::endl;
                         <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"2D Drawing with Shader"</span>, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>window<span class="org-rainbow-delimiters-depth-2">){</span> glfwTerminate<span class="org-rainbow-delimiters-depth-3">()</span>; <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL context</span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.5f, 0.6f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Mouse move callback</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: It is only possible to pass non-capturing lambda to this callback.</span>
    glfwSetCursorPosCallback<span class="org-rainbow-delimiters-depth-2">(</span> window
                            , <span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>, <span class="org-type">double</span> <span class="org-variable-name">xpos</span>, <span class="org-type">double</span> <span class="org-variable-name">ypos</span><span class="org-rainbow-delimiters-depth-3">)</span>
                              <span class="org-rainbow-delimiters-depth-3">{</span>
                                  <span class="org-comment-delimiter">// </span><span class="org-comment">Forward call to global variable std::function&lt;&gt;</span>
                                  <span class="org-comment-delimiter">// </span><span class="org-comment">(Function object)</span>
                                  Cursor_Callback<span class="org-rainbow-delimiters-depth-4">(</span>window, xpos, ypos<span class="org-rainbow-delimiters-depth-4">)</span>;
                              <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== S H A D E R - C O M P I L A T I O N ====//</span>
    <span class="org-comment-delimiter">//                                                </span><span class="org-comment">//</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The shader source code is at the end of file.</span>
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span>;
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span>;

    <span class="org-type">GLuint</span> <span class="org-variable-name">prog</span> = glCreateProgram<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Compile shader code</span>
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_vertex_shader, GL_VERTEX_SHADER  <span class="org-rainbow-delimiters-depth-2">)</span> ;
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_frag_shader,   GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Bind current shader (enable it). Only one shader of the same type can</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">be bound at a time. For instance, only a single vertex shader can</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">be enabled at a time</span>
    glUseProgram<span class="org-rainbow-delimiters-depth-2">(</span>prog<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable location for projection matrix</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">See shader code: "uniform mat4 projection;"</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_projection"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_proj &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable  location for model matrix.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_model</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_model &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader attribute location - the function glGetAttribLocation - returns (-1) on error.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_position &gt;= 0 &amp;&amp; <span class="org-string">"Failed to get attribute location"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [TRACE] Attribute location attr_position = %d \n"</span>
                , attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader index of color attribute variable.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_color &gt;= 0<span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">====== U P L O A D - TO - G P U =========================//</span>
    <span class="org-comment-delimiter">//                                                          </span><span class="org-comment">//</span>

    <span class="org-keyword">constexpr</span> <span class="org-type">size_t</span> <span class="org-variable-name">NUM_VERTICES</span> = 3;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Array of triangle vertex coordinates (X, Y)</span>
    <span class="org-type">Vertex2D</span> <span class="org-variable-name">vertices</span><span class="org-rainbow-delimiters-depth-2">[</span>NUM_VERTICES<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
      <span class="org-rainbow-delimiters-depth-3">{</span>  0.0,   0.2<span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 0  (x =  0.0 ; y =  0.5)</span>
    , <span class="org-rainbow-delimiters-depth-3">{</span> -0.2,  -0.2<span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 1  (x = -0.5 ; y = -0.5)</span>
    , <span class="org-rainbow-delimiters-depth-3">{</span>  0.2,  -0.2<span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex 2  (x =  0.5 ; y = -0.5)</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">ColorRGB</span> <span class="org-variable-name">colors</span><span class="org-rainbow-delimiters-depth-2">[</span>NUM_VERTICES<span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-rainbow-delimiters-depth-2">{</span>
          COLOR_R   <span class="org-comment-delimiter">// </span><span class="org-comment">Color of vertex 0</span>
        , COLOR_B   <span class="org-comment-delimiter">// </span><span class="org-comment">Color of vertex 1</span>
        , COLOR_G   <span class="org-comment-delimiter">// </span><span class="org-comment">Color of vertex 2</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Always initialize with zero (0), otherwise, the values</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">of those variables will be undefined. (Undefine Behavior)</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_triangle</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_vertices</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_colors</span>   = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Send vertices to GPU VBO (vbo_vertices)</span>
    send_buffer<span class="org-rainbow-delimiters-depth-2">(</span>  &amp;vao_triangle    <span class="org-comment-delimiter">// </span><span class="org-comment">Ponter to VAO [OUTPUT]</span>
                , &amp;vbo_vertices    <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer VBO   [OUTPUT]</span>
                , <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>vertices<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Size of buffer sent to GPU (VBO memory)</span>
                , vertices         <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to buffer</span>
                , attr_position    <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location</span>
                , 2                <span class="org-comment-delimiter">// </span><span class="org-comment">Each vertex has 2 coordinates (X, Y)</span>
                , GL_FLOAT         <span class="org-comment-delimiter">// </span><span class="org-comment">Each vertex coordinate has type GLfloat (float)</span>
                <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Send colors to GPU VBO (vbo_colors)</span>
    send_buffer<span class="org-rainbow-delimiters-depth-2">(</span>  &amp;vao_triangle   <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer Vertex Array object</span>
                , &amp;vbo_colors     <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer Vertex buffer object handle (aka token)</span>
                , <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>colors<span class="org-rainbow-delimiters-depth-3">)</span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Buffer size</span>
                , colors          <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to buffer (addrress of first buffer element)</span>
                , attr_color      <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location</span>
                , 3               <span class="org-comment-delimiter">// </span><span class="org-comment">Each color has 3 coordinates (R, G, B)</span>
                , GL_FLOAT        <span class="org-comment-delimiter">// </span><span class="org-comment">Each color coordiante has type GLfloat</span>
                <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">============== Set Shader Uniform Variables =============//</span>
    <span class="org-comment-delimiter">//                                                          </span><span class="org-comment">//</span>

    <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-variable-name">height</span>;
    glfwGetWindowSize<span class="org-rainbow-delimiters-depth-2">(</span>window, &amp;width, &amp;height<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Window aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span> = <span class="org-keyword">static_cast</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>width<span class="org-rainbow-delimiters-depth-2">)</span> / height;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Identity matrix</span>
    <span class="org-keyword">const</span> <span class="org-keyword">auto</span> identity = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Projection matrix - orthogonal projection for compensating</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">the aspect ratio.</span>
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">Tproj</span> = <span class="org-constant">glm</span>::ortho<span class="org-rainbow-delimiters-depth-2">(</span>-aspect, aspect, -1.0f, 1.0f, -1.0f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set projection matrix uniform variable</span>
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_proj, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>Tproj<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set model matrix uniform variable</span>
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>identity<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Instatiate objects that will be rendered</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">triangleA</span> = Model_Triangle<span class="org-rainbow-delimiters-depth-2">{}</span>;
    triangleA.scale<span class="org-rainbow-delimiters-depth-2">(</span>0.50<span class="org-rainbow-delimiters-depth-2">)</span>;
    triangleA.rotate<span class="org-rainbow-delimiters-depth-2">(</span>122<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">triangleB</span> = Model_Triangle<span class="org-rainbow-delimiters-depth-2">{}</span>;
    triangleB.translate<span class="org-rainbow-delimiters-depth-2">(</span>-0.20, 0.30<span class="org-rainbow-delimiters-depth-2">)</span>;
    triangleB.rotate<span class="org-rainbow-delimiters-depth-2">(</span>50<span class="org-rainbow-delimiters-depth-2">)</span>;
    triangleB.scale<span class="org-rainbow-delimiters-depth-2">(</span>1.8<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">triangleC</span> = Model_Triangle<span class="org-rainbow-delimiters-depth-2">{}</span>;
    triangleC.translate<span class="org-rainbow-delimiters-depth-2">(</span>0.20, 0.20<span class="org-rainbow-delimiters-depth-2">)</span>;
    triangleC.rotate<span class="org-rainbow-delimiters-depth-2">(</span>35<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Follows mouse coordinate</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">triangleD</span> = Model_Triangle<span class="org-rainbow-delimiters-depth-2">{}</span>;
    triangleD.translate<span class="org-rainbow-delimiters-depth-2">(</span>-0.60, -0.50<span class="org-rainbow-delimiters-depth-2">)</span>;
    triangleD.scale<span class="org-rainbow-delimiters-depth-2">(</span>1.50<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">triangleD.scale(1.2);</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">triangleD.rotate(40);</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">--------- Set mouse callback ----------//</span>

    <span class="org-keyword">constexpr</span> <span class="org-type">float</span> <span class="org-variable-name">PI</span> = 3.1415926536f;
    <span class="org-keyword">constexpr</span> <span class="org-type">float</span> <span class="org-variable-name">FACTOR_RAD_TO_DEG</span> = 180.0 / PI;

    Cursor_Callback = <span class="org-rainbow-delimiters-depth-2">[</span>&amp;<span class="org-rainbow-delimiters-depth-2">](</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>, <span class="org-type">double</span> <span class="org-variable-name">xpos</span>, <span class="org-type">double</span> <span class="org-variable-name">ypos</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Mouse normalized coordinate</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; see: https://stackoverflow.com/questions/23870750/</span>
        <span class="org-type">float</span> <span class="org-variable-name">xMouse</span> = -1.0f + 2.0f * xpos / width;
        <span class="org-type">float</span> <span class="org-variable-name">yMouse</span> =  1.0f - 2.0f * ypos / height;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Angle in degrees between X axis vector(1, 0, 0) and poit (xMouse, yMouse, 0) position.</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Note: atan2f() returns angle in radians.</span>
        <span class="org-type">float</span> <span class="org-variable-name">angle</span> = atan2f<span class="org-rainbow-delimiters-depth-3">(</span>yMouse, xMouse<span class="org-rainbow-delimiters-depth-3">)</span> * FACTOR_RAD_TO_DEG ;
        fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [TRACE] Angle = %f \n"</span>, angle<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Triangle D follows mouse position</span>
        triangleD.translate<span class="org-rainbow-delimiters-depth-3">(</span>xMouse, yMouse<span class="org-rainbow-delimiters-depth-3">)</span>;
        triangleD.rotate<span class="org-rainbow-delimiters-depth-3">(</span>angle<span class="org-rainbow-delimiters-depth-3">)</span>;

        triangleB.rotate<span class="org-rainbow-delimiters-depth-3">(</span>angle<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Show mouse position</span>
         <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [MOUSE] x = %f ; y = %f \n", xMouse, yMouse);</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//                                             </span><span class="org-comment">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

            triangleA.render<span class="org-rainbow-delimiters-depth-3">(</span>vao_triangle, u_model<span class="org-rainbow-delimiters-depth-3">)</span>;
            triangleB.render<span class="org-rainbow-delimiters-depth-3">(</span>vao_triangle, u_model<span class="org-rainbow-delimiters-depth-3">)</span>;
            triangleC.render<span class="org-rainbow-delimiters-depth-3">(</span>vao_triangle, u_model<span class="org-rainbow-delimiters-depth-3">)</span>;
            triangleD.render<span class="org-rainbow-delimiters-depth-3">(</span>vao_triangle, u_model<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">//</span><span class="org-comment">std::fprintf(stderr, " [TRACE] Redraw screen \n");</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
        glfwPollEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Q'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
             <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] User typed Q =&gt;&gt; Shutdown program. Ok. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
             <span class="org-keyword">break</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Increase scale by 10%</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'A'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> triangleD.zoom<span class="org-rainbow-delimiters-depth-4">(</span>+0.10<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Decrease scale by 10%</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'B'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> triangleD.zoom<span class="org-rainbow-delimiters-depth-4">(</span>-0.10<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>


    <span class="org-rainbow-delimiters-depth-2">}</span>

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;

<span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">--- End of main() -----//</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Minimal vertex shader =&gt;&gt; Runs on the GPU and processes each vertex.</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330 core</span>

<span class="org-string">    // Supplied by GPU - attribute location (id = 2)</span>
<span class="org-string">    // contains a (X, Y) vertex</span>
<span class="org-string">    layout ( location = 2)  in vec2 position;</span>
<span class="org-string">    layout ( location = 1 ) in vec3 color;     // Contains (Red, Green, Blue) components</span>

<span class="org-string">    // Output to fragment shader</span>
<span class="org-string">    out vec3 out_color;</span>

<span class="org-string">    // Model matrix =&gt; projection coordinates from the local space (model space)</span>
<span class="org-string">    // to view space .</span>
<span class="org-string">    // Transform 4x4 matrix - supplied by the C++ side.</span>
<span class="org-string">    uniform mat4 u_model;</span>

<span class="org-string">    // Projection matrix =&gt; projections camera-space coordinates</span>
<span class="org-string">    // to clip-space coordinates. (-1.0 to 1.0) range.</span>
<span class="org-string">    uniform mat4 u_projection;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // gl_Position =&gt; Global output variable that holds the</span>
<span class="org-string">        // the current vertex position. It is a vector of</span>
<span class="org-string">        // components (X, Y, Z = 0, W = ignored)</span>
<span class="org-string">        gl_Position = u_projection * u_model * vec4(position, 0, 1.0);</span>

<span class="org-string">        // Forward to fragment shader</span>
<span class="org-string">        out_color = color;</span>
<span class="org-string">    }</span>

<span class="org-string">)</span><span class="org-default">"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Fragment shader source code</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330</span>

<span class="org-string">    // This color comes from Vertex shader</span>
<span class="org-string">    in vec3 out_color;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // Set vertex colors</span>
<span class="org-string">        gl_FragColor = vec4(out_color, 1.0);</span>

<span class="org-string">    }</span>
<span class="org-string">)</span><span class="org-default">"</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== I M P L E M E N T A T I O N S ==========//</span>

<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_id</span> = glCreateShader<span class="org-rainbow-delimiters-depth-2">(</span> type <span class="org-rainbow-delimiters-depth-2">)</span>;
    glShaderSource<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, 1, &amp;code, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glCompileShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">is_compiled</span> = GL_FALSE;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check shader compilation result</span>
    glGetShaderiv<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, GL_COMPILE_STATUS, &amp;is_compiled<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">If there is any shader compilation result,</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">print the error message.</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> is_compiled == GL_FALSE<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">GLint</span> <span class="org-variable-name">length</span>;
        glGetShaderiv<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, GL_INFO_LOG_LENGTH, &amp;length<span class="org-rainbow-delimiters-depth-3">)</span>;
        assert<span class="org-rainbow-delimiters-depth-3">(</span> length &gt; 0 <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">out</span><span class="org-rainbow-delimiters-depth-3">(</span>length + 1, 0x00<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">GLint</span> <span class="org-variable-name">chars_written</span>;
        glGetShaderInfoLog<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, length, &amp;chars_written, out.data<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SHADER ERROR] = "</span> &lt;&lt; out &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Abort the exection of current process.</span>
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    glAttachShader<span class="org-rainbow-delimiters-depth-2">(</span>m_program, shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDeleteShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glLinkProgram<span class="org-rainbow-delimiters-depth-2">(</span>m_program<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">link_status</span> = GL_FALSE;
    glGetProgramiv<span class="org-rainbow-delimiters-depth-2">(</span>m_program, GL_LINK_STATUS, &amp;link_status<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> link_status != GL_FALSE <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUseProgram(m_program);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload buffer from main memory to GPU VBO</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; Parameters VAO, VBO are allocated by the caller.</span>
<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>
                , <span class="org-type">void</span>* <span class="org-variable-name">pBufffer</span>, <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span>, <span class="org-type">GLint</span> <span class="org-variable-name">size</span>
                , <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVao != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVbo != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = *pVbo;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>vao == 0<span class="org-rainbow-delimiters-depth-2">){</span> glGenVertexArrays<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, sizeBuffer, pBufffer, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;

    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr, size, type, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute</span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5bf4d70" class="outline-3">
<h3 id="org5bf4d70"><span class="section-number-3">1.20</span> 2D - Chart with orthographic projection</h3>
<div class="outline-text-3" id="text-1-20">
<p>
This sample applications draws a 2D chart by plotting two curves, the
functions f(x) and g(x). It is possible to adjust the range displayed
by the chart by setting xmin, xmax, ymin and ymax using the
console. By typing 'A' the chart is displayed adjusting the xmax or
ymax for preserving the aspect ratio. By typing 'B' the chart does not
preserve the aspect ratio and shows the full range xmin to xmax on the
X axis, and ymin to ymax on the Y axis.
</p>

<ul class="org-ul">
<li>f(x) = 100.0 - x^2</li>
<li>g(x) = 50 * sin(x / (2 * PI)) + 10</li>
</ul>

<p>
The significant features on this sample code are:
</p>

<ul class="org-ul">
<li>Orthographic projection transform which allows drawing using
user-defined coordinates (world-space coordinates), instead of NDC
normalized-device coordinates with range -1.0 to 1.0 on each axis.</li>

<li>Sending interleaved vertex attributes, namely, positions and
colors, to GPU with a single call to glBufferData() and a single
VBO - Vertex Buffer Object.</li>

<li>Usage of threads for allowing the user controlling the displayed
range by typing in the console (command line).</li>
</ul>

<p>
<b>Projection matrix</b>
</p>

<p>
The orthogonal projection matrix is used for allowing user-defined
coordinates instead of normalized coordinates in the range -1.0 to
1.0 on for each axis. The orthogonal matrix without aspect-ratio
compensation is generated by using the following call to glm::ortho.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-function-name">glm</span>::mat4 proj = ortho<span class="org-rainbow-delimiters-depth-1">(</span>xmin, xmax, ymin, ymax, zNear = +1.0, zFar = -1.0<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
<b>Algorithm for avoiding chart distortion</b>
</p>

<p>
Consider the following rations \(u_x\) and \(u_y\):
</p>

\begin{eqnarray*}
   u_x &=& \frac{w}{\Delta_x} = \frac{ w }{ x_{max} - x_{min} } \\
   u_y &=& \frac{h}{\Delta_y} = \frac{ h }{ y_{max} - y_{min} } \\
\end{eqnarray*}

<p>
Where:
</p>

<ul class="org-ul">
<li>w - screen width in pixels.</li>

<li>h - screen height in pixels.</li>

<li>\(\Delta_x\) screen width in world-space coordinates.</li>

<li>\(\Delta_y\) screen height in world-space coordinates.</li>

<li>\(u_y\) - The ratio \(u_x\) represents how many pixels (real screen lenght)
each user-defined unit on world-space coordinate systems
represents across the X axis.</li>

<li>\(u_x\) - The ratio \(u_y\), is similar to \(u_x\), but it is applicable
to Y axis.</li>
</ul>

<p>
For instance, if the screen has width of 500 pixels and height of 600
pixels and \(x_{min} = -50\),  \(x_{max} = +50\),  \(y_{min} = -200\),
\(y_{max} = +200\). The ratios \(u_x\) and \(u_y\) will be:
</p>

\begin{eqnarray*}
   \Delta_x &=& x_{max} - x_{min} = 100 \\
   \Delta_y &=& y_{max} - y_{min} = 400 \\

   u_x &=& \frac{500}{100} = 5   \quad \text{pixels per X axis units} \\
   u_y &=& \frac{600}{400} = 1.5 \quad \text{pixels per Y axis units} \\
\end{eqnarray*}

<p>
The result means that any curve, will appear distorted, for instance a
square with side of 10, will be shown on the screen with the width of
10 * ux = 50 pixels and the height of 10 * uy = 10 * 1.5 = 15
pixels. As a result, the square will appear as rectangle. To avoid any
distortion, the ratios \(u_x\) and \(u_y\) must be equal, which is
expressed as:
</p>

\begin{eqnarray*}
   u_x                         &=& u_y                         \\
  \frac{x_{max} - x_{min}}{w}  &=& \frac{y_{max} - y_{min}}{h} \\
\end{eqnarray*}

<p>
If the variables w, h, \(x_{min}\) and \(y_{min}\) are fixed. \(x_{max}\) or
\(y_{max}\) must be adjusted for making the ratios \(u_x\) and \(u_y\)
equal and avoiding any distortion.
</p>

<p>
If the adjusting is choosen for \(x_{max}\), then its new value will be:
</p>

\begin{equation}
   x_{max}' = x_{min} + \frac{w}{h}( y_{max} - y_{min} )
\end{equation}

<p>
If the adjusting is choosen for \(y_{max}\), then its adjusted value is:
</p>

\begin{equation}
   y_{max}' = y_{min} + \frac{h}{w}( x_{max} - x_{min} )
\end{equation}

<p>
By applying the adjusting for the previous case for \(x_{max}\), its
adjusted value becomes:
</p>

\begin{equation}
   x_{max}' = (-50) + \frac{500}{600}( 200 - (-200) ) \approx 283.333
\end{equation}

<p>
The ratios \(u_x\), \(u_y\) become:
</p>


\begin{eqnarray*}
   u_x' &=& \frac{ w }{ x_{max}' - x_{min} } = \frac{ 500 }{ 283.333 - (-50) } \approx 1.50  \\
   u_y' &=& \frac{ h }{ y_{max} - y_{min} }  = \frac{ 600 }{ 200 - (-200) }  = 1.50    \\
\end{eqnarray*}

<p>
As the ratios became equal, a square of side 10 will not appear
distorted as its width and lenght in pixels, became equal.
</p>

<p>
<b>Screenshots</b>
</p>



<div class="figure">
<p><a href="images/opengl-chart-2.png"><img src="images/opengl-chart-2.png" alt="opengl-chart-2.png" /></a>
</p>
</div>


<div class="figure">
<p><a href="images/opengl-chart-1.png"><img src="images/opengl-chart-1.png" alt="opengl-chart-1.png" /></a>
</p>
</div>


<p>
<b>Files and shaders code</b>
</p>

<p>
Vertex Shader:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330 core

layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 0<span class="org-rainbow-delimiters-depth-1">)</span> in <span class="org-type">vec2</span> <span class="org-variable-name">position</span>;
layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 1<span class="org-rainbow-delimiters-depth-1">)</span> in <span class="org-type">vec3</span> <span class="org-variable-name">color</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Forwarded to fragment shader</span>
out <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;

uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_model</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">Model matrix</span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_proj</span>;   <span class="org-comment-delimiter">// </span><span class="org-comment">Projection matrix</span>

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">vec4(position, 0.0, 1.0) means =&gt; vec4(x, y, z = 0.0, w =1.0)</span>
    gl_Position = u_proj * u_model * vec4<span class="org-rainbow-delimiters-depth-2">(</span>position, 0.0, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Forward to fragment shader</span>
    out_color = color;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Fragment Shader:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330

in <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set vertex colors</span>
    gl_FragColor =  vec4<span class="org-rainbow-delimiters-depth-2">(</span>out_color, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
File: <span class="underline">CMakeLists.txt</span>
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(Draw2D-Chart-GLFW)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download GLM (OpenGL math library for matrix and vectors transformation)</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glm
  URL  https://github.com/g-truc/glm/archive/0.9.8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glm)

<span class="org-function-name">message</span>( [DEBUG] <span class="org-string">" glm_SOURCE_DIR = ${</span><span class="org-variable-name">glm_SOURCE_DIR</span><span class="org-string">} "</span>)
<span class="org-function-name">include_directories</span>(${<span class="org-variable-name">glm_SOURCE_DIR</span>})

  <span class="org-comment"># ======= TARGETS ===========================#</span>

       <span class="org-function-name">add_executable</span>( draw2d-chart  draw2d-chart.cpp   )
<span class="org-function-name">target_link_libraries</span>( draw2d-chart  glfw OpenGL::GL GLU )
</pre>
</div>

<p>
File: <span class="underline">draw2d-chart.cpp</span>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">algorithm</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">thread</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glew.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glut.h&gt;</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- OpenGL Math Library ------------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_access.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">struct</span> <span class="org-type">Point2D</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">ColorRGB</span><span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">Point2D</span>  <span class="org-variable-name">position</span>;
    <span class="org-type">ColorRGB</span> <span class="org-variable-name">color</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_red</span>    = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 0.0, 0.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_green</span>  = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_blue</span>   = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 0.0, 1.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_white</span>  = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 1.0, 1.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_yellow</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">------------------------------------//</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Shader code at the end of file.</span>
<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>*  <span class="org-variable-name">code_vertex_shader</span>;
<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>*  <span class="org-variable-name">code_frag_shader</span>;

<span class="org-type">void</span>        <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">GLFWwindow</span>* <span class="org-function-name">make_glfwWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload vertices position and colors to GPU in a single call.</span>
<span class="org-type">void</span> <span class="org-function-name">send_vertices</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>
                  , <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span>
                  , <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span>
                  , <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">vertices</span> <span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">using resize_callback_t = void (*) (GLFWwindow* window, int width, int height);</span>
<span class="org-keyword">using</span> <span class="org-type">FuncResizeCallback</span> = <span class="org-constant">std</span>::<span class="org-type">function</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>, <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>;
<span class="org-type">FuncResizeCallback</span> <span class="org-variable-name">resize_callback</span>;


<span class="org-comment-delimiter">/*  </span><span class="org-comment">Ajust orthogonal projection matrix for keeping the aspect ratio.</span>
<span class="org-comment"> *  If the flag is false, the range (Xmin, Xmax), (Ymax, Ymin) is not adjusted.</span>
<span class="org-comment"> *******************************************************************/</span>
<span class="org-type">void</span> <span class="org-function-name">adjust_window_range</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>
                        , <span class="org-type">GLint</span> <span class="org-variable-name">uniform_projection_id</span>
                        , <span class="org-type">bool</span> <span class="org-variable-name">flag</span>
                        , <span class="org-type">float</span> <span class="org-variable-name">xmin</span>, <span class="org-type">float</span> <span class="org-variable-name">xmax</span>, <span class="org-type">float</span> <span class="org-variable-name">ymin</span>, <span class="org-type">float</span> <span class="org-variable-name">ymax</span><span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">typename</span> <span class="org-type">Function</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">auto</span> <span class="org-function-name">make_curve</span><span class="org-rainbow-delimiters-depth-1">(</span>  <span class="org-type">ColorRGB</span> <span class="org-variable-name">color</span>, <span class="org-type">float</span> <span class="org-variable-name">xmin</span>, <span class="org-type">float</span> <span class="org-variable-name">xmax</span>
                , <span class="org-type">size_t</span> <span class="org-variable-name">npoints</span>, <span class="org-type">Function</span>&amp;&amp; <span class="org-variable-name">fun</span><span class="org-rainbow-delimiters-depth-1">)</span> -&gt; <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">curve</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Reserve pre-allocated space in order to avoid multiple allocations</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">via vector.push_back(Item)</span>
    curve.reserve<span class="org-rainbow-delimiters-depth-2">(</span>npoints<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">float</span> <span class="org-variable-name">x</span> = xmin;
    <span class="org-type">float</span> <span class="org-variable-name">y</span> = 0.0;
    <span class="org-type">float</span> <span class="org-variable-name">dx</span> = <span class="org-rainbow-delimiters-depth-2">(</span>xmax - xmin<span class="org-rainbow-delimiters-depth-2">)</span> / npoints;

    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">n</span> = 0; n &lt; npoints; n++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        y = fun<span class="org-rainbow-delimiters-depth-3">(</span>x<span class="org-rainbow-delimiters-depth-3">)</span>;
        curve.push_back<span class="org-rainbow-delimiters-depth-3">(</span> Vertex2D<span class="org-rainbow-delimiters-depth-4">{</span> Point2D<span class="org-rainbow-delimiters-depth-5">{</span>x, y<span class="org-rainbow-delimiters-depth-5">}</span>, color <span class="org-rainbow-delimiters-depth-4">}</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] x = %f ; y = %f \n", x, y);</span>
        x = x + dx;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">return</span> curve;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Initialize GLFW</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span> = <span class="org-string">"2D Scientific Chart with Orthogonal projection."</span>;
    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = make_glfwWindow<span class="org-rainbow-delimiters-depth-2">(</span>600, 400, title<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">========== Shader settings ==================//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">prog</span> = glCreateProgram<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Compile shader code</span>
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_vertex_shader, GL_VERTEX_SHADER  <span class="org-rainbow-delimiters-depth-2">)</span> ;
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_frag_shader,   GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUseProgram<span class="org-rainbow-delimiters-depth-2">(</span>prog<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">------- Shader attribute locations -------//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span>    = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_color &gt;= 0 <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">--------- Shader Uniform Variables -------//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_proj"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_model</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The error checking for other uniforms are missing</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">for breviety purposes.</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_model &gt;= 0 <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Default values for uniform variables ----------//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-keyword">const</span> <span class="org-keyword">auto</span> matrix_identity = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_proj,  1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Forward callback to global variable.</span>
    glfwSetFramebufferSizeCallback<span class="org-rainbow-delimiters-depth-2">(</span>window, <span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>, <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span><span class="org-rainbow-delimiters-depth-3">){</span>
         resize_callback<span class="org-rainbow-delimiters-depth-4">(</span>window, width, height<span class="org-rainbow-delimiters-depth-4">)</span>;
    <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

     <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">model_rectangle</span> = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    model_rectangle = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span>model_rectangle, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>5.0, 4.0, 0.0<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">==== O R T H O G O N A L - P R O J E C T I O N =====//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-type">float</span> <span class="org-variable-name">xmin</span> = -20.0f, <span class="org-variable-name">xmax</span> = +10.0f;
    <span class="org-type">float</span> <span class="org-variable-name">ymin</span> = -5.0f, <span class="org-variable-name">ymax</span>  = +100.0f;
    <span class="org-type">float</span> <span class="org-variable-name">zNear</span> = +1.0, <span class="org-variable-name">zFar</span> = -1.0;

    <span class="org-type">bool</span> <span class="org-variable-name">aspect_ratio_flag</span> = <span class="org-constant">true</span>;
    adjust_window_range<span class="org-rainbow-delimiters-depth-2">(</span>window, u_proj, aspect_ratio_flag, xmin, xmax, ymin, ymax<span class="org-rainbow-delimiters-depth-2">)</span>;

    resize_callback = <span class="org-rainbow-delimiters-depth-2">[</span>&amp;<span class="org-rainbow-delimiters-depth-2">](</span><span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>, <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] Window resize to width = %d ; height = %d \n", width, height);</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Resize windo view port to the whole window</span>
        glViewport<span class="org-rainbow-delimiters-depth-3">(</span>0, 0, width, height<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">--- Console loop thread callback =&gt;&gt; Allows user to adjust chart range</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">using console.</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">console_thread</span> = <span class="org-constant">std</span>::thread<span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-rainbow-delimiters-depth-3">[</span>&amp;<span class="org-rainbow-delimiters-depth-3">]{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">glfwMakeContextCurrent(window);</span>
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-4">(</span>;;<span class="org-rainbow-delimiters-depth-4">){</span>
            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" Enter chart range (xmin, xmax, ymin, ymax): "</span>;
            <span class="org-constant">std</span>::cin &gt;&gt; xmin &gt;&gt; xmax &gt;&gt; ymin &gt;&gt; ymax;
            <span class="org-comment-delimiter">// </span><span class="org-comment">Send an empty envent to the render loop for redrawing the window.</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">It makes the subroutine glfwWaitEvents() return to calling code.</span>
            glfwPostEmptyEvent<span class="org-rainbow-delimiters-depth-5">()</span>;

        <span class="org-rainbow-delimiters-depth-4">}</span>
    <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    console_thread.detach<span class="org-rainbow-delimiters-depth-2">()</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">======= U P L O A D - T O - G P U ===========//</span>
    <span class="org-comment-delimiter">//</span>

<span class="org-preprocessor">#if</span> 1
    <span class="org-comment-delimiter">// </span><span class="org-comment">X, Y axis lines at point (0, 0)</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">chart_axis</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-rainbow-delimiters-depth-2">{</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">X axis Line - color green</span>
            <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span> -500.0, 0<span class="org-rainbow-delimiters-depth-4">}</span>, color_green <span class="org-rainbow-delimiters-depth-3">}</span>, <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span>500.0, 0<span class="org-rainbow-delimiters-depth-4">}</span>, color_green <span class="org-rainbow-delimiters-depth-3">}</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">Y axis Line  - color blue</span>
          , <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span>0, -500.0<span class="org-rainbow-delimiters-depth-4">}</span>, color_blue <span class="org-rainbow-delimiters-depth-3">}</span>,  <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span>0, 500.0<span class="org-rainbow-delimiters-depth-4">}</span>, color_blue <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_axis</span> = 0, <span class="org-variable-name">vbo_axis</span> = 0;
    send_vertices<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_axis, &amp;vbo_axis, attr_position, attr_color, chart_axis<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">#endif</span>

    <span class="org-keyword">auto</span> <span class="org-variable-name">curve</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-2">&gt;{}</span>;

    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_quadratic_curve</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_quadratic_curve</span> = 0;
    curve = make_curve<span class="org-rainbow-delimiters-depth-2">(</span> color_red, -20.0, 20.0, 500
                      , <span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">float</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-3">){</span> <span class="org-keyword">return</span> 100.0 - x * x;  <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">quadratic_curve_points</span> = curve.size<span class="org-rainbow-delimiters-depth-2">()</span>;
    send_vertices<span class="org-rainbow-delimiters-depth-2">(</span> &amp;vao_quadratic_curve, &amp;vbo_quadratic_curve
                 , attr_position, attr_color, curve <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Sine curve f(x) = 25 * sin(x / (2&#183;PI) ) + + 60.0;</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_sine_curve</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_sine_curve</span> = 0;
    <span class="org-keyword">constexpr</span> <span class="org-type">float</span> <span class="org-variable-name">PI_2</span> = 2.0 * 3.141592653589;
    curve = make_curve<span class="org-rainbow-delimiters-depth-2">(</span>  color_yellow, -50.0, 200.0, 500
                     , <span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">float</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-3">){</span> <span class="org-keyword">return</span> 25.0 * sin<span class="org-rainbow-delimiters-depth-4">(</span>x / PI_2<span class="org-rainbow-delimiters-depth-4">)</span> + 60.0;  <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">sine_curve_points</span> = curve.size<span class="org-rainbow-delimiters-depth-2">()</span>;
    send_vertices<span class="org-rainbow-delimiters-depth-2">(</span> &amp;vao_sine_curve, &amp;vbo_sine_curve
                 , attr_position, attr_color, curve <span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//                                             </span><span class="org-comment">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT  | GL_DEPTH_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">Adjust orthogonal projection and range of coordinates shown in the window.</span>
            adjust_window_range<span class="org-rainbow-delimiters-depth-3">(</span>window, u_proj, aspect_ratio_flag, xmin, xmax, ymin, ymax<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw lines for X and Y axis</span>
            <span class="org-comment-delimiter">//</span><span class="org-comment">-------------------------------//</span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_axis<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_LINES, 0, 4<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw curve quadratic curve f(x) = 100.0 - x^2</span>
            <span class="org-comment-delimiter">//</span><span class="org-comment">-------------------------------//</span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_quadratic_curve<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_POINTS, 0, quadratic_curve_points<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw sine curve f(x) = 50 * sin(x) + 10.0;</span>
            <span class="org-comment-delimiter">//</span><span class="org-comment">-------------------------------//</span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_sine_curve<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_LINE_STRIP, 0, sine_curve_points<span class="org-rainbow-delimiters-depth-3">)</span>;


         <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Swap front and back buffers</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Wait for events - blocks current thread until some event arrives.</span>
        glfwWaitEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== PROCESS EVENTS =============//</span>

          <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] Waiting events. \n");</span>

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'A'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span>  aspect_ratio_flag = <span class="org-constant">true</span>;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'B'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span>  aspect_ratio_flag = <span class="org-constant">false</span>; <span class="org-rainbow-delimiters-depth-3">}</span>

    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">--- End of render loop --- //</span>

    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- S H A D E R S --------------------------------//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Minimal vertex shader =&gt;&gt; Runs on the GPU and processes each vertex.</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330 core</span>

<span class="org-string">    layout ( location = 0) in vec2 position;</span>
<span class="org-string">    layout ( location = 1) in vec3 color;</span>

<span class="org-string">    // Forwarded to fragment shader</span>
<span class="org-string">    out vec3 out_color;</span>

<span class="org-string">    uniform mat4 u_model;  // Model matrix</span>
<span class="org-string">    uniform mat4 u_proj;   // Projection matrix</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // vec4(position, 0.0, 1.0) means =&gt; vec4(x, y, z = 0.0, w =1.0)</span>
<span class="org-string">        gl_Position = u_proj * u_model * vec4(position, 0.0, 1.0);</span>
<span class="org-string">        // Forward to fragment shader</span>
<span class="org-string">        out_color = color;</span>
<span class="org-string">    }</span>

<span class="org-string">)</span><span class="org-default">"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Fragment shader source code</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330</span>

<span class="org-string">    in vec3 out_color;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // Set vertex colors</span>
<span class="org-string">        gl_FragColor =  vec4(out_color, 1.0);</span>
<span class="org-string">    }</span>
<span class="org-string">)</span><span class="org-default">"</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">--------- I M P L E M E N T A T I O N S -----------------//</span>

<span class="org-type">GLFWwindow</span>*
<span class="org-function-name">make_glfwWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    glfwSetErrorCallback<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">error</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">description</span><span class="org-rainbow-delimiters-depth-3">)</span>
                         <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span> stderr, <span class="org-string">" [GLFW ERROR] Error = %d ; Description = %s \n"</span>
                                        , error, description<span class="org-rainbow-delimiters-depth-4">)</span>;
                         <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>width, height, title, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> window != <span class="org-constant">nullptr</span> &amp;&amp; <span class="org-string">"Failed  to create Window"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL context</span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Pain whole screen as black - dark screen colors are better</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">for avoding eye strain due long hours staring on monitor.</span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.0f, 0.0f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set - OpenGL Core Profile - version 3.3</span>
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MAJOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MINOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Make the window the topmost (Always on top)</span>
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_FLOATING, GLFW_TRUE<span class="org-rainbow-delimiters-depth-2">)</span>;

    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_COLOR_MATERIAL<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_DEPTH_TEST<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_BLEND<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">return</span> window;
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_id</span> = glCreateShader<span class="org-rainbow-delimiters-depth-2">(</span> type <span class="org-rainbow-delimiters-depth-2">)</span>;
    glShaderSource<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, 1, &amp;code, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glCompileShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">is_compiled</span> = GL_FALSE;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check shader compilation result</span>
    glGetShaderiv<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, GL_COMPILE_STATUS, &amp;is_compiled<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">If there is any shader compilation result,</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">print the error message.</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> is_compiled == GL_FALSE<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SHADER ERROR] =&gt;&gt; Abort execution. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Abort the exection of current process.</span>
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    glAttachShader<span class="org-rainbow-delimiters-depth-2">(</span>m_program, shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDeleteShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glLinkProgram<span class="org-rainbow-delimiters-depth-2">(</span>m_program<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">link_status</span> = GL_FALSE;
    glGetProgramiv<span class="org-rainbow-delimiters-depth-2">(</span>m_program, GL_LINK_STATUS, &amp;link_status<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> link_status != GL_FALSE <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUseProgram(m_program);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Upload vertices from main memory to GPU memory.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Vertices position and colors are uploaded in a single call.</span>
<span class="org-type">void</span> <span class="org-function-name">send_vertices</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>
                  , <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span>
                  , <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span>
                  , <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">vertices</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVao != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVbo != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = *pVbo;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>vao == 0<span class="org-rainbow-delimiters-depth-2">){</span> glGenVertexArrays<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vertices.size<span class="org-rainbow-delimiters-depth-3">()</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-3">)</span>
                , vertices.data<span class="org-rainbow-delimiters-depth-3">()</span>, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;

    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;

    static_assert<span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-3">)</span> == 5 * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-3">)</span>
                 ,<span class="org-string">"Vertex2D size assumption does not hold."</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    static_assert<span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Point2D<span class="org-rainbow-delimiters-depth-3">)</span> == offsetof<span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D, color<span class="org-rainbow-delimiters-depth-3">)</span>
                 , <span class="org-string">"Invalid offsetof() assumption"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt; Each vertex has 2 coordinates.</span>
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_position     <span class="org-comment-delimiter">// </span><span class="org-comment">Position vertex shader attribute</span>
                          , 2                <span class="org-comment-delimiter">// </span><span class="org-comment">Each position has 2 coordinates (X, Y)</span>
                          , GL_FLOAT         <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each coordinate</span>
                          , GL_FALSE
                          , <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Offset to next coordinates (5 floats in this case)</span>
                          , <span class="org-constant">nullptr</span>
                          <span class="org-rainbow-delimiters-depth-2">)</span>;

    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_color
                           <span class="org-comment-delimiter">// </span><span class="org-comment">Each color has 3 components R, G, B</span>
                          , 3
                           <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each color coordinate</span>
                          , GL_FLOAT
                          , GL_FALSE
                           <span class="org-comment-delimiter">// </span><span class="org-comment">Offset to next coordinates (next row)</span>
                          , <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-3">)</span>
                           <span class="org-comment-delimiter">// </span><span class="org-comment">Offset to color member variable in class Vertex2D</span>
                          , <span class="org-keyword">reinterpret_cast</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-3">&gt;(</span> offsetof<span class="org-rainbow-delimiters-depth-4">(</span>Vertex2D, color<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>
                          <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute</span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">adjust_window_range</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span>
                        , <span class="org-type">GLint</span> <span class="org-variable-name">uniform_projection_id</span>
                        , <span class="org-type">bool</span> <span class="org-variable-name">flag</span>
                        , <span class="org-type">float</span> <span class="org-variable-name">xmin</span>, <span class="org-type">float</span> <span class="org-variable-name">xmax</span>, <span class="org-type">float</span> <span class="org-variable-name">ymin</span>, <span class="org-type">float</span> <span class="org-variable-name">ymax</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">constexpr</span> <span class="org-type">float</span> <span class="org-variable-name">zFar</span>  = -1.0f;
    <span class="org-keyword">constexpr</span> <span class="org-type">float</span> <span class="org-variable-name">zNear</span> = +1.0f;

    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>flag == <span class="org-constant">false</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">proj_1</span> = <span class="org-constant">glm</span>::ortho<span class="org-rainbow-delimiters-depth-3">(</span>xmin, xmax, ymin, ymax, zNear, zFar<span class="org-rainbow-delimiters-depth-3">)</span>;
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>uniform_projection_id, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>proj_1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-variable-name">height</span>;
    glfwGetWindowSize<span class="org-rainbow-delimiters-depth-2">(</span>window, &amp;width, &amp;height<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">float</span> <span class="org-variable-name">k_aspect</span> = <span class="org-keyword">static_cast</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>width<span class="org-rainbow-delimiters-depth-2">)</span> / <span class="org-keyword">static_cast</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>height<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">float</span> <span class="org-variable-name">dx</span> = xmax - xmin;
    <span class="org-type">float</span> <span class="org-variable-name">dy</span> = ymax - ymin;

    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>dx &gt; dy<span class="org-rainbow-delimiters-depth-2">){</span>
        ymax =  ymin + <span class="org-rainbow-delimiters-depth-3">(</span>1.0f / k_aspect <span class="org-rainbow-delimiters-depth-3">)</span> * dx;
        <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] Adjust range =&gt; ymax = %f \n", ymax);</span>
    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">else</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        xmax = xmin + k_aspect * dy;
        <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] Adjust range =&gt; xmax = %f \n", ymax);</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>

    dx = xmax - xmin;
    dy = ymax - ymin;
    <span class="org-type">float</span> <span class="org-variable-name">ux</span> = width / dx;
    <span class="org-type">float</span> <span class="org-variable-name">uy</span> = height / dy;

    <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] ux = %f ; uy = %f \n", ux, uy);</span>

    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">proj_2</span> = <span class="org-constant">glm</span>::ortho<span class="org-rainbow-delimiters-depth-2">(</span>xmin, xmax, ymin, ymax, zNear, zFar<span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>uniform_projection_id, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>proj_2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org24d5a33" class="outline-3">
<h3 id="org24d5a33"><span class="section-number-3">1.21</span> 2D - IBO - Index Buffer Object</h3>
<div class="outline-text-3" id="text-1-21">
<p>
This code uses OpenGL IBO (Index Buffer Objects) for drawing triangles
and lines OpenGL primitives. The IBO is useful for drawing complex
objects without repeating vertices, which saves memory and bandwith
and increases performance. 
</p>

<p>
<b>Screenshot</b> 
</p>


<div class="figure">
<p><a href="images/opengl-ibo-triangles.png"><img src="images/opengl-ibo-triangles.png" alt="opengl-ibo-triangles.png" /></a> 
</p>
<p><span class="figure-number">Figure 14: </span>Triangles IBO - Index Buffer Object</p>
</div>


<p>
<b>Code Highlights</b> 
</p>

<p>
Vertices and colors data structures: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">struct</span> <span class="org-type">Point2D</span>  <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>;    <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">ColorRGB</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">Point2D</span>  <span class="org-variable-name">position</span>; <span class="org-type">ColorRGB</span> <span class="org-variable-name">color</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">using</span> <span class="org-type">VertexArray</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>;
<span class="org-keyword">using</span> <span class="org-type">IndexArray</span>  = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-1">&lt;</span>GLuint<span class="org-rainbow-delimiters-depth-1">&gt;</span>;
</pre>
</div>

<p>
The next blocks defines the triangles vertices and the connection
between those vertices. Each three indices in the 'triangles_indices'
variables represents a triangle. Without using IBO (Index Buffer
Object), there would be duplicated vertices, then the content of array
'vertices' would be [V0, V1, V2, V1, V3, V4, V3, V5, V6, V2, V7, V5], 
</p>


<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Triangle side </span>
<span class="org-type">float</span> <span class="org-variable-name">a</span> = 1.0 / 5.0; 
<span class="org-comment-delimiter">// </span><span class="org-comment">Triangle height </span>
<span class="org-type">float</span> <span class="org-variable-name">h</span> = sqrt<span class="org-rainbow-delimiters-depth-1">(</span>3.0<span class="org-rainbow-delimiters-depth-1">)</span> * a;

<span class="org-keyword">auto</span> <span class="org-variable-name">vertices</span> = VertexArray <span class="org-rainbow-delimiters-depth-1">{</span>
      Vertex2D<span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-3">{</span> 0,       0  <span class="org-rainbow-delimiters-depth-3">}</span>, color_green   <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V0 - vertex 0 </span>
    , Vertex2D<span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-3">{</span> 2 * a,   0  <span class="org-rainbow-delimiters-depth-3">}</span>, color_green   <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V1 </span>
    , Vertex2D<span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-3">{</span> a,       h  <span class="org-rainbow-delimiters-depth-3">}</span>, color_green   <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V2 </span>

    , Vertex2D<span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-3">{</span> 3 * a,   h  <span class="org-rainbow-delimiters-depth-3">}</span>, color_blue    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V3</span>
    , Vertex2D<span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-3">{</span> 4 * a,   0  <span class="org-rainbow-delimiters-depth-3">}</span>, color_blue    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V4</span>

    , Vertex2D<span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-3">{</span> 2 * a, 2 * h <span class="org-rainbow-delimiters-depth-3">}</span>, color_red    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V5</span>
    , Vertex2D<span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-3">{</span> 4 * a, 2 * h <span class="org-rainbow-delimiters-depth-3">}</span>, color_red    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V6</span>
    , Vertex2D<span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-3">{</span>     0, 2 * h <span class="org-rainbow-delimiters-depth-3">}</span>, color_yellow <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V7 - vertex 7 </span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Indices for GL_TRIANGLE drawing primitive. </span>
<span class="org-keyword">auto</span> <span class="org-variable-name">triangles_indices</span> = IndexArray <span class="org-rainbow-delimiters-depth-1">{</span>
      0, 1, 2  <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle with vertices V0, V1, V2 (Triangle A)</span>
    , 1, 3, 4  <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle with vertices V1, V3, V4 (Triangle B)</span>
    , 3, 5, 6  <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle with vertices V3, V5, V6 (Triangle C)</span>
    , 2, 7, 5  <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle with vertices V2, V7, V5 (Triangle D)</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
This index array defines the connections between vertices for
GL_LINES primitives, each 2 indices represents a line. 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Indices for GL_LINES drawing primitive </span>
 <span class="org-keyword">auto</span> <span class="org-variable-name">lines_indices</span> = IndexArray <span class="org-rainbow-delimiters-depth-1">{</span>
       0, 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Line connecting vertices V0 and V1 </span>
     , 0, 2 <span class="org-comment-delimiter">// </span><span class="org-comment">Line connecting vertices V0 and V2 </span>
     , 1, 2 <span class="org-comment-delimiter">// </span><span class="org-comment">Line connecting vertices V1 and V2 </span>

     , 2, 7 
     , 5, 7 
     , 2, 5 

     , 1, 3
     , 1, 4
     , 3, 4

     , 3, 5
     , 3, 6
     , 5, 6
 <span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
In the following code highlight, the vertices indices and data are
sent to the GPU using the subroutines send_vertices() and
send_indices(). These functions uses the following parameters: vao
(Vertex Array Object); vbo (Vertex Buffer Object) and ibo (Index
Buffer Objects), which are supposed to be allocated by calling
code. 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">------- Upload data for drawing traingle primitives --------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-type">GLuint</span> <span class="org-variable-name">vao_triangles</span> = 0, <span class="org-variable-name">vbo_triangles</span> = 0, <span class="org-variable-name">ibo_triangles</span> = 0;    

send_vertices<span class="org-rainbow-delimiters-depth-1">(</span> &amp;vao_triangles, &amp;vbo_triangles
             , attr_position, attr_color, vertices<span class="org-rainbow-delimiters-depth-1">)</span>;

send_indices<span class="org-rainbow-delimiters-depth-1">(</span>&amp;vao_triangles, &amp;ibo_triangles, triangles_indices<span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">-------- Upload data for drawing lines primitives ----------// </span>
<span class="org-comment-delimiter">//</span>
<span class="org-type">GLuint</span> <span class="org-variable-name">vao_lines</span> = 0, <span class="org-variable-name">vbo_lines</span> = 0, <span class="org-variable-name">ibo_lines</span> = 0;  
send_vertices<span class="org-rainbow-delimiters-depth-1">(</span> &amp;vao_lines, &amp;vbo_lines
             , attr_position, attr_color, vertices<span class="org-rainbow-delimiters-depth-1">)</span>;     
send_indices<span class="org-rainbow-delimiters-depth-1">(</span>&amp;vao_lines, &amp;ibo_lines, lines_indices<span class="org-rainbow-delimiters-depth-1">)</span>;
</pre>
</div>

<p>
At the rendering loop. The OpenGL glDrawElements() subroutine is used
,instead of glDrawArrays(), for drawing triangles and lines
primitives. This subroutine uses the vertices indices instead of using
the vertices ordering. For instance, if glDrawArrays() was used, each
three vertices from the current bound VBO would be used for drawing a
triangle.
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">---- Draw triangles primitives using IBO -------// </span>
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-1">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-variable-name">model_triangle_primtives</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>;
    glBindVertexArray<span class="org-rainbow-delimiters-depth-1">(</span>vao_triangles<span class="org-rainbow-delimiters-depth-1">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw OpenGL primitives between vertices designated by their</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">IBO - Index Buffer Object.         </span>
    glDrawElements<span class="org-rainbow-delimiters-depth-1">(</span>GL_TRIANGLES, triangles_indices.size<span class="org-rainbow-delimiters-depth-2">()</span> , GL_UNSIGNED_INT, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-1">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">----- Draw lines using IBO -----------------------//</span>
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-1">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-2">(</span>model_lines_primitives<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>;
    glBindVertexArray<span class="org-rainbow-delimiters-depth-1">(</span>vao_lines<span class="org-rainbow-delimiters-depth-1">)</span>;
    glDrawElements<span class="org-rainbow-delimiters-depth-1">(</span>GL_LINES, lines_indices.size<span class="org-rainbow-delimiters-depth-2">()</span> , GL_UNSIGNED_INT, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-1">)</span>;            

<span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

</pre>
</div>

<p>
<b>Files / Sources</b> 
</p>

<p>
File: <span class="underline">CMakeLists.txt</span>
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(Draw2D-Chart-GLFW)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download GLM (OpenGL math library for matrix and vectors transformation)</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glm
  URL  https://github.com/g-truc/glm/archive/0.9.8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glm)

<span class="org-function-name">message</span>( [DEBUG] <span class="org-string">" glm_SOURCE_DIR = ${</span><span class="org-variable-name">glm_SOURCE_DIR</span><span class="org-string">} "</span>)
<span class="org-function-name">include_directories</span>(${<span class="org-variable-name">glm_SOURCE_DIR</span>})

  <span class="org-comment"># ======= TARGETS ===========================#</span>

       <span class="org-function-name">add_executable</span>( draw2d-ibo-triangles  draw2d-ibo-triangles.cpp   )
<span class="org-function-name">target_link_libraries</span>( draw2d-ibo-triangles  glfw OpenGL::GL GLU )
</pre>
</div>

<p>
File: <span class="underline">draw2d-ibo-triangles.cpp</span> 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glew.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- OpenGL Math Library ------------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_access.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">struct</span> <span class="org-type">Point2D</span>  <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>;    <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">ColorRGB</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">Vertex2D</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">Point2D</span>  <span class="org-variable-name">position</span>; <span class="org-type">ColorRGB</span> <span class="org-variable-name">color</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>*  <span class="org-variable-name">code_vertex_shader</span>;
<span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>*  <span class="org-variable-name">code_frag_shader</span>;

<span class="org-type">void</span>        <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">GLFWwindow</span>* <span class="org-function-name">make_glfwWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Send vertices (position and color of each vertex to GPU memory)</span>
<span class="org-type">void</span> <span class="org-function-name">send_vertices</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>
                  , <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span>
                  , <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span> 
                  , <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">vertices</span> <span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Send vertices indices to GPU memory. </span>
<span class="org-type">void</span> <span class="org-function-name">send_indices</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbi</span>
                , <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">GLuint</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">indices</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_red</span>    = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 0.0, 0.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_green</span>  = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-1">}</span>;        
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_blue</span>   = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 0.0, 1.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_white</span>  = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 1.0, 1.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_yellow</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Create a windowed mode window and its OpenGL context */</span>
    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = make_glfwWindow<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"Draw 2D - IBO - Index Buffer Object"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">======= S H A D E R - C O M P I L A T I O N ==========// </span>
    <span class="org-comment-delimiter">// </span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">prog</span> = glCreateProgram<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Compile shader code </span>
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_vertex_shader, GL_VERTEX_SHADER  <span class="org-rainbow-delimiters-depth-2">)</span> ;    
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_frag_shader,   GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUseProgram<span class="org-rainbow-delimiters-depth-2">(</span>prog<span class="org-rainbow-delimiters-depth-2">)</span>;    
    <span class="org-comment-delimiter">// </span><span class="org-comment">------- Shader attribute locations -------//</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span>    = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_position &gt;= 0 <span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_color &gt;= 0 <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">--------- Shader Uniform Variables -------//</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_proj"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_model</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>u_proj &gt;= 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>u_model &gt;= 0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Default values for uniform variables ----------//</span>
    <span class="org-keyword">const</span> <span class="org-keyword">auto</span> matrix_identity = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_proj,  1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= U P L O A D - T O - G P U =====================//</span>
    <span class="org-comment-delimiter">//     </span>

    <span class="org-keyword">using</span> <span class="org-type">VertexArray</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>;
    <span class="org-keyword">using</span> <span class="org-type">IndexArray</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">GLuint</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Triangle side </span>
    <span class="org-type">float</span> <span class="org-variable-name">a</span> = 1.0 / 5.0; 
    <span class="org-comment-delimiter">// </span><span class="org-comment">Triangle height </span>
    <span class="org-type">float</span> <span class="org-variable-name">h</span> = sqrt<span class="org-rainbow-delimiters-depth-2">(</span>3.0<span class="org-rainbow-delimiters-depth-2">)</span> * a;

    <span class="org-keyword">auto</span> <span class="org-variable-name">vertices</span> = VertexArray <span class="org-rainbow-delimiters-depth-2">{</span>
          Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span> 0,       0  <span class="org-rainbow-delimiters-depth-4">}</span>, color_green   <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V0 - vertex 0 </span>
        , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span> 2 * a,   0  <span class="org-rainbow-delimiters-depth-4">}</span>, color_green   <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V1 </span>
        , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span> a,       h  <span class="org-rainbow-delimiters-depth-4">}</span>, color_green   <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V2 </span>

        , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span> 3 * a,   h  <span class="org-rainbow-delimiters-depth-4">}</span>, color_blue    <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V3</span>
        , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span> 4 * a,   0  <span class="org-rainbow-delimiters-depth-4">}</span>, color_blue    <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V4</span>

        , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span> 2 * a, 2 * h <span class="org-rainbow-delimiters-depth-4">}</span>, color_red    <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V5</span>
        , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span> 4 * a, 2 * h <span class="org-rainbow-delimiters-depth-4">}</span>, color_red    <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V6</span>
        , Vertex2D<span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-rainbow-delimiters-depth-4">{</span>     0, 2 * h <span class="org-rainbow-delimiters-depth-4">}</span>, color_yellow <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">V7 - vertex 7 </span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Indices for GL_TRIANGLE drawing primitive. </span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">triangles_indices</span> = IndexArray <span class="org-rainbow-delimiters-depth-2">{</span>
          0, 1, 2  <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle with vertices V0, V1, V2 (Triangle A)</span>
        , 1, 3, 4  <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle with vertices V1, V3, V4 (Triangle B)</span>
        , 3, 5, 6  <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle with vertices V3, V5, V6 (Triangle C)</span>
        , 2, 7, 5  <span class="org-comment-delimiter">// </span><span class="org-comment">Draw triangle with vertices V2, V7, V5 (Triangle D)</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Indices for GL_LINES drawing primitive </span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">lines_indices</span> = IndexArray <span class="org-rainbow-delimiters-depth-2">{</span>
          0, 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Line connecting vertices V0 and V1 </span>
        , 0, 2 <span class="org-comment-delimiter">// </span><span class="org-comment">Line connecting vertices V0 and V2 </span>
        , 1, 2 <span class="org-comment-delimiter">// </span><span class="org-comment">Line connecting vertices V1 and V2 </span>

        , 2, 7 
        , 5, 7 
        , 2, 5 

        , 1, 3
        , 1, 4
        , 3, 4

        , 3, 5
        , 3, 6
        , 5, 6
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------- Upload data for drawing traingle primitives --------//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_triangles</span> = 0, <span class="org-variable-name">vbo_triangles</span> = 0, <span class="org-variable-name">ibo_triangles</span> = 0;    

    send_vertices<span class="org-rainbow-delimiters-depth-2">(</span> &amp;vao_triangles, &amp;vbo_triangles
                 , attr_position, attr_color, vertices<span class="org-rainbow-delimiters-depth-2">)</span>;

    send_indices<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_triangles, &amp;ibo_triangles, triangles_indices<span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">-------- Upload data for drawing lines primitives ----------// </span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_lines</span> = 0, <span class="org-variable-name">vbo_lines</span> = 0, <span class="org-variable-name">ibo_lines</span> = 0;  
    send_vertices<span class="org-rainbow-delimiters-depth-2">(</span> &amp;vao_lines, &amp;vbo_lines
                 , attr_position, attr_color, vertices<span class="org-rainbow-delimiters-depth-2">)</span>;     
    send_indices<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_lines, &amp;ibo_lines, lines_indices<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">==== Model matrices for translating drawings =======//</span>
    <span class="org-comment-delimiter">//      </span>
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">model_triangle_primtives</span> = matrix_identity;
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">model_lines_primitives</span> = matrix_identity;   
    <span class="org-comment-delimiter">// </span><span class="org-comment">Translate triangles to point (x = -0.7, y = -0.8, z = 0.0)</span>
    model_triangle_primtives = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span>model_triangle_primtives, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>-0.7, -0.8, 0.0<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ===================//</span>
    <span class="org-comment-delimiter">//                                                    </span><span class="org-comment">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT  | GL_DEPTH_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">---- Draw triangles primitives using IBO -------// </span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>model_triangle_primtives<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_triangles<span class="org-rainbow-delimiters-depth-3">)</span>;
            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw OpenGL primitives between vertices designated by their</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">IBO - Index Buffer Object.         </span>
            glDrawElements<span class="org-rainbow-delimiters-depth-3">(</span>GL_TRIANGLES, triangles_indices.size<span class="org-rainbow-delimiters-depth-4">()</span> , GL_UNSIGNED_INT, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">----- Draw lines using IBO -----------------------//</span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>model_lines_primitives<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_lines<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawElements<span class="org-rainbow-delimiters-depth-3">(</span>GL_LINES, lines_indices.size<span class="org-rainbow-delimiters-depth-4">()</span> , GL_UNSIGNED_INT, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>;            

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        glfwPollEvents<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">---------- S H A D E R S - C O D E  ---------------------// </span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Minimal vertex shader =&gt;&gt; Runs on the GPU and processes each vertex.</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span> = R<span class="org-default">"</span><span class="org-string">(    </span>
<span class="org-string">    #version 330 core </span>

<span class="org-string">    layout ( location = 0) in vec2 position;</span>
<span class="org-string">    layout ( location = 1) in vec3 color;   </span>

<span class="org-string">    // Forwarded to fragment shader </span>
<span class="org-string">    out vec3 out_color;</span>

<span class="org-string">    uniform mat4 u_model;  // Model matrix </span>
<span class="org-string">    uniform mat4 u_proj;   // Projection matrix </span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // vec4(position, 0.0, 1.0) means =&gt; vec4(x, y, z = 0.0, w =1.0)</span>
<span class="org-string">        gl_Position = u_proj * u_model * vec4(position, 0.0, 1.0);</span>

<span class="org-string">        // Forward to fragment shader </span>
<span class="org-string">        out_color = color; </span>
<span class="org-string">    }</span>

<span class="org-string">)</span><span class="org-default">"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Fragment shader source code </span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330 </span>

<span class="org-string">    in vec3 out_color;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // Set vertex colors</span>
<span class="org-string">        gl_FragColor =  vec4(out_color, 1.0);</span>
<span class="org-string">    }</span>
<span class="org-string">)</span><span class="org-default">"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- I M P L E M E N T A T I O N S -----------------//</span>

<span class="org-type">GLFWwindow</span>* 
<span class="org-function-name">make_glfwWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    glfwSetErrorCallback<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">error</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">description</span><span class="org-rainbow-delimiters-depth-3">)</span>
                         <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span> stderr, <span class="org-string">" [GLFW ERROR] Error = %d ; Description = %s \n"</span>
                                        , error, description<span class="org-rainbow-delimiters-depth-4">)</span>;
                         <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>width, height, title, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> window != <span class="org-constant">nullptr</span> &amp;&amp; <span class="org-string">"Failed  to create Window"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL context </span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set window color </span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.5f, 3.0f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set - OpenGL Core Profile - version 3.3</span>
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MAJOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MINOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Make the window the topmost (Always on top)</span>
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_FLOATING, GLFW_TRUE<span class="org-rainbow-delimiters-depth-2">)</span>;

    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_COLOR_MATERIAL<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_DEPTH_TEST<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_BLEND<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">return</span> window;
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_id</span> = glCreateShader<span class="org-rainbow-delimiters-depth-2">(</span> type <span class="org-rainbow-delimiters-depth-2">)</span>;
    glShaderSource<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, 1, &amp;code, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glCompileShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">is_compiled</span> = GL_FALSE;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check shader compilation result </span>
    glGetShaderiv<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, GL_COMPILE_STATUS, &amp;is_compiled<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">If there is any shader compilation result, </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">print the error message.</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> is_compiled == GL_FALSE<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SHADER ERROR] =&gt;&gt; Abort execution. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Abort the exection of current process. </span>
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>          

    glAttachShader<span class="org-rainbow-delimiters-depth-2">(</span>m_program, shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;   
    glDeleteShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glLinkProgram<span class="org-rainbow-delimiters-depth-2">(</span>m_program<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">link_status</span> = GL_FALSE;
    glGetProgramiv<span class="org-rainbow-delimiters-depth-2">(</span>m_program, GL_LINK_STATUS, &amp;link_status<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> link_status != GL_FALSE <span class="org-rainbow-delimiters-depth-2">)</span>;   
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUseProgram(m_program);         </span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload vertices from main memory to GPU memory.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Vertices position and colors are uploaded in a single call.</span>
<span class="org-type">void</span> <span class="org-function-name">send_vertices</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>
                  , <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span>
                  , <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span> 
                  , <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex2D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">vertices</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVao != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVbo != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = *pVbo;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>vao == 0<span class="org-rainbow-delimiters-depth-2">){</span> glGenVertexArrays<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU </span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vertices.size<span class="org-rainbow-delimiters-depth-3">()</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-3">)</span>
                , vertices.data<span class="org-rainbow-delimiters-depth-3">()</span>, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;   

    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;    
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;    

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt; Each vertex has 2 coordinates. </span>
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_position, 2, GL_FLOAT, GL_FALSE, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-3">)</span>, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_color, 3, GL_FLOAT, GL_FALSE, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex2D<span class="org-rainbow-delimiters-depth-3">)</span>     
                           <span class="org-comment-delimiter">// </span><span class="org-comment">Offset to color member variable in class Vertex2D</span>
                          , <span class="org-keyword">reinterpret_cast</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-3">&gt;(</span> offsetof<span class="org-rainbow-delimiters-depth-4">(</span>Vertex2D, color<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>
                          <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO </span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO </span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute </span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">send_indices</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbi</span>, <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">GLuint</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">indices</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbi</span> = *pVbi;
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate index buffer object </span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbi<span class="org-rainbow-delimiters-depth-2">)</span>; 
    <span class="org-comment-delimiter">// </span><span class="org-comment">Bind this index buffer object - only one IBO can </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">be bound at a time. (It is a global state!!)</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span> GL_ELEMENT_ARRAY_BUFFER, vbi <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload indices to GPU - This VBI object is a handle </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">(token, akin to file descriptor) that refers </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">to the data sent to the GPU on the next line. </span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span> GL_ELEMENT_ARRAY_BUFFER, indices.size<span class="org-rainbow-delimiters-depth-3">()</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>GLuint<span class="org-rainbow-delimiters-depth-3">)</span>
                    , indices.data<span class="org-rainbow-delimiters-depth-3">()</span>, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;    
    <span class="org-comment-delimiter">// </span><span class="org-comment">----------- Unset global state -------------//</span>
    <span class="org-comment-delimiter">// </span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span> GL_ELEMENT_ARRAY_BUFFER, 0 <span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgccf505e" class="outline-3">
<h3 id="orgccf505e"><span class="section-number-3">1.22</span> 3D - Rotating cube/box</h3>
<div class="outline-text-3" id="text-1-22">
<p>
This sample application contains: two cubes; two grid planes for
visual reference; a coordinate axis for visual debugging and a camera
that always points to the origin. The camera has the following
controls: right arrow, rotates the camera's position in a
counterclockwise way around Y axis (red line); if left arrow is typed,
the camera position rotates in a clockwise way around Y axis (red
line). If up arrow is typed, the camera position moves in the positive
direction of Y axis. If down arrow is typed, the reverse
happens.
</p>

<p>
<b>Screenshots</b>
</p>


<div class="figure">
<p><a href="images/opengl-draw3d-rotating-cube1.png"><img src="images/opengl-draw3d-rotating-cube1.png" alt="opengl-draw3d-rotating-cube1.png" /></a>
</p>
</div>


<div class="figure">
<p><a href="images/opengl-draw3d-rotating-cube2.png"><img src="images/opengl-draw3d-rotating-cube2.png" alt="opengl-draw3d-rotating-cube2.png" /></a>
</p>
</div>

<p>
<b>Project Files</b>
</p>

<p>
Vertex Shader Code:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330 core

layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 0<span class="org-rainbow-delimiters-depth-1">)</span>  in <span class="org-type">vec3</span> <span class="org-variable-name">position</span>;
layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 1<span class="org-rainbow-delimiters-depth-1">)</span> in <span class="org-type">vec3</span> <span class="org-variable-name">color</span>;
out <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_model</span>;       <span class="org-comment-delimiter">// </span><span class="org-comment">Model matrix</span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_view</span>;        <span class="org-comment-delimiter">// </span><span class="org-comment">Camera's view matrix</span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_projection</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">Camera's projection matrix</span>

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    gl_Position = u_projection * u_view * u_model * vec4<span class="org-rainbow-delimiters-depth-2">(</span>position, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Forward to fragment shader</span>
    out_color = color; <span class="org-comment-delimiter">// </span><span class="org-comment">vec3(0.56, 0.6, 0.0);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Fragment Shader Code:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330

<span class="org-comment-delimiter">// </span><span class="org-comment">This color comes from Vertex shader</span>
in <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set vertex colors</span>
    gl_FragColor =  vec4<span class="org-rainbow-delimiters-depth-2">(</span>out_color, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">gl_FragColor = vec4(0.3, 0.6, 0.0, 1.0);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
File: CmakeLists.txt
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(GLFW_project)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download GLM (OpenGL math library for matrix and vectors transformation)</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glm
  URL  https://github.com/g-truc/glm/archive/0.9.8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glm)

<span class="org-comment"># Download pre-compiled GLEW when building under Windows NT OS (x64)</span>
<span class="org-keyword">IF</span>(WIN32)
   <span class="org-function-name">FetchContent_Declare</span>(
      glew-release 
      URL  https://ufpr.dl.sourceforge.net/project/glew/glew/2.1.0/glew-2.1.0-win32.zip
   )
   <span class="org-function-name">FetchContent_MakeAvailable</span>(glew-release)
   <span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/include  ${<span class="org-variable-name">glm_SOURCE_DIR</span>} )        
   <span class="org-function-name">link_directories</span>(  ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64 )

   <span class="org-function-name">set</span>( GLEW_LIB_PATH1 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32.lib )
   <span class="org-function-name">set</span>( GLEW_LIB_PATH2 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32s.lib )
<span class="org-keyword">ENDIF</span>()


<span class="org-function-name">message</span>( [DEBUG] <span class="org-string">" glm_SOURCE_DIR = ${</span><span class="org-variable-name">glm_SOURCE_DIR</span><span class="org-string">} "</span>)
<span class="org-function-name">include_directories</span>(${<span class="org-variable-name">glm_SOURCE_DIR</span>})

<span class="org-keyword">MACRO</span>(ADD_OPENGL_APP target sources)
   <span class="org-function-name">add_executable</span>( ${<span class="org-variable-name">target</span>} ${<span class="org-variable-name">sources</span>} )
   <span class="org-function-name">message</span>([TRACE] <span class="org-string">" Add OpenGL executable = ${</span><span class="org-variable-name">target</span><span class="org-string">} "</span>)

   <span class="org-function-name">target_link_libraries</span>( ${<span class="org-variable-name">target</span>} glfw
                                    OpenGL::GL
                                    ${<span class="org-variable-name">GLEW_LIB_PATH1</span>}
                                    ${<span class="org-variable-name">GLEW_LIB_PATH2</span>} )

    <span class="org-keyword">IF</span>(MINGW)
        <span class="org-comment"># Statically link against MINGW dependencies</span>
        <span class="org-comment"># for making easier to deploy on other machines. </span>
        <span class="org-function-name">target_link_options</span>( ${<span class="org-variable-name">target</span>} PRIVATE                                 
                                 -static-libgcc
                                 -static-libstdc++
                                 -Wl,-Bstatic,--whole-archive -lwinpthread
                                 -Wl,--no-whole-archive                                    
                                 )
     <span class="org-keyword">ENDIF</span>()       


     <span class="org-comment"># Copy GLEW DLL shared library to same directory as the executable.                 </span>
     <span class="org-keyword">IF</span>(WIN32)                           
        <span class="org-function-name">add_custom_command</span>(TARGET ${<span class="org-variable-name">target</span>} POST_BUILD 
                       COMMAND ${<span class="org-variable-name">CMAKE_COMMAND</span>} -E copy_if_different
                       <span class="org-string">"${</span><span class="org-variable-name">glew-release_SOURCE_DIR</span><span class="org-string">}/bin/Release/x64/glew32.dll"</span>              
                       $&lt;TARGET_FILE_DIR:${<span class="org-variable-name">target</span>}&gt;)
     <span class="org-keyword">ENDIF</span>()                                       
<span class="org-keyword">ENDMACRO</span>()     


  <span class="org-comment"># ======= TARGETS ===========================#</span>

  <span class="org-function-name">ADD_OPENGL_APP</span>( draw3d-cube draw3d-cube.cpp )
</pre>
</div>

<p>
File: draw3d-cube.cpp
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Draw many colored triangles from a single VBO (Vertex Buffer Object)</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>

<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>_WIN32<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">windows.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glew.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glew.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- OpenGL Math Librar ------------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#define GLUT_ENABLED</span>

<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>GLUT_ENABLED<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">    #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glut.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>

<span class="org-preprocessor">#define</span> <span class="org-function-name">GL_CHECK</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">funcall</span><span class="org-rainbow-delimiters-depth-1">)</span>\
    <span class="org-keyword">do</span> <span class="org-rainbow-delimiters-depth-1">{</span> \
        <span class="org-rainbow-delimiters-depth-2">(</span>funcall<span class="org-rainbow-delimiters-depth-2">)</span>; \
        <span class="org-type">GLint</span> <span class="org-variable-name">error</span> = glGetError<span class="org-rainbow-delimiters-depth-2">()</span>;  \
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>error == GL_NO_ERROR<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">break</span>; <span class="org-rainbow-delimiters-depth-2">}</span> \
        <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [OPENGL ERROR] Error code = %d ; line = %d ; call = '%s'  \n"</span> \
                      , error, __LINE__, #funcall <span class="org-rainbow-delimiters-depth-2">)</span>; \
        abort<span class="org-rainbow-delimiters-depth-2">()</span>; \
    <span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-1">(</span>0<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-type">GLFWwindow</span>* <span class="org-function-name">make_glfwWindowi</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Compile some  shader</span>
<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Send data from memory to GPU VBO memory</span>
<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span>   <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VAO (Vertex Array Object) - allocated by caller</span>
                  , <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to VBO (Vertex Buffer Object) - allocated by caller</span>
                  , <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>  <span class="org-comment-delimiter">// </span><span class="org-comment">Total buffer size in bytes</span>
                  , <span class="org-type">void</span>*   <span class="org-variable-name">pBufffer</span>    <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to buffer</span>
                  , <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute location id</span>
                  , <span class="org-type">GLint</span>   <span class="org-variable-name">size</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Number of coordinates of a given vertex</span>
                  , <span class="org-type">GLenum</span>  <span class="org-variable-name">type</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each element coordinate</span>
                  <span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">------------ Basic Data Structures -----------//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for 2D vertex coordinates</span>
<span class="org-keyword">struct</span> <span class="org-type">Vertex3D</span><span class="org-rainbow-delimiters-depth-1">{</span>  <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for RGB colors</span>
<span class="org-keyword">struct</span> <span class="org-type">ColorRGB</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">Geometry</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex3D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">vertices</span>;
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">ColorRGB</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">colors</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">RenderObject</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLuint</span>     <span class="org-variable-name">u_model</span>;     <span class="org-comment-delimiter">// </span><span class="org-comment">Shader uniform variable for model matrix</span>
    <span class="org-type">GLuint</span>     <span class="org-variable-name">vao</span>;         <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex Array object</span>
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span>  <span class="org-variable-name">model</span>;       <span class="org-comment-delimiter">// </span><span class="org-comment">Object model matrix</span>
    <span class="org-type">GLenum</span>     <span class="org-variable-name">draw_type</span>;   <span class="org-comment-delimiter">// </span><span class="org-comment">Draw type</span>
    <span class="org-type">GLint</span>      <span class="org-variable-name">n_vertices</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">Number of vertices</span>

    <span class="org-function-name">RenderObject</span><span class="org-rainbow-delimiters-depth-2">(){</span> model = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-3">(</span>1.0<span class="org-rainbow-delimiters-depth-3">)</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Explicit copy constructor</span>
    <span class="org-function-name">RenderObject</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-type">RenderObject</span>&amp;<span class="org-rainbow-delimiters-depth-2">)</span> = <span class="org-keyword">default</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Explicit copy assignment operator</span>
    <span class="org-type">RenderObject</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">=</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-type">RenderObject</span>&amp;<span class="org-rainbow-delimiters-depth-2">)</span> = <span class="org-keyword">default</span>;

    <span class="org-type">void</span> <span class="org-function-name">render</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">model</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>draw_type, 0, n_vertices<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-type">Geometry</span> <span class="org-function-name">make_grid_geometry</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">size_t</span> <span class="org-variable-name">n_grid</span>, <span class="org-type">float</span> <span class="org-variable-name">dx</span>, <span class="org-keyword">const</span> <span class="org-type">ColorRGB</span>&amp; <span class="org-variable-name">color</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">Geometry</span> <span class="org-function-name">make_cube_geometry</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">w</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_red</span>   = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_green</span> = <span class="org-rainbow-delimiters-depth-1">{</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_blue</span>  = <span class="org-rainbow-delimiters-depth-1">{</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_yelllow</span>    = <span class="org-rainbow-delimiters-depth-1">{</span> 0.80,  1.000, 0.100 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_gray</span>       = <span class="org-rainbow-delimiters-depth-1">{</span> 0.47,  0.390, 0.380 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_dark_green</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.027, 0.392, 0.050 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_dark_blue</span>  = <span class="org-rainbow-delimiters-depth-1">{</span> 0.109, 0.066, 0.411 <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Send vertices to GPU</span>
<span class="org-type">void</span> <span class="org-function-name">send_vertices</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>,  <span class="org-type">GLint</span> <span class="org-variable-name">shader_attr</span>
                ,   <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex3D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>&amp; <span class="org-variable-name">vertices</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    send_buffer<span class="org-rainbow-delimiters-depth-2">(</span>pVao, pVbo, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex3D<span class="org-rainbow-delimiters-depth-3">)</span> * vertices.size<span class="org-rainbow-delimiters-depth-3">()</span>, vertices.data<span class="org-rainbow-delimiters-depth-3">()</span>, shader_attr, 3, GL_FLOAT <span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Send color coordinates to GPU</span>
<span class="org-type">void</span> <span class="org-function-name">send_colors</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>,  <span class="org-type">GLint</span> <span class="org-variable-name">shader_attr</span>
                ,   <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">ColorRGB</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>&amp; <span class="org-variable-name">vertices</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    send_buffer<span class="org-rainbow-delimiters-depth-2">(</span>pVao, pVbo, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex3D<span class="org-rainbow-delimiters-depth-3">)</span> * vertices.size<span class="org-rainbow-delimiters-depth-3">()</span>, vertices.data<span class="org-rainbow-delimiters-depth-3">()</span>, shader_attr, 3, GL_FLOAT <span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-keyword">struct</span> <span class="org-type">Camera</span><span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current location of camera in world coordinates</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">cam_eye</span>  = <span class="org-rainbow-delimiters-depth-2">{</span> 2.0, 4.0, 5.0 <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Point to where the camera is looking at in world coordinates.</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">cam_targ</span> = <span class="org-rainbow-delimiters-depth-2">{</span> 0.0, 0.0, 0.0  <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current  camera up vector (orientation) - Y axis (default)</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">cam_up</span> = <span class="org-rainbow-delimiters-depth-2">{</span> 0.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Field of view</span>
    <span class="org-type">float</span> <span class="org-variable-name">fov_angle</span> = <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>60.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span>   = 1.0;
    <span class="org-type">float</span> <span class="org-variable-name">zFar</span>     = 20.0;
    <span class="org-type">float</span> <span class="org-variable-name">zNear</span>    = 0.1;

    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's view uniform variable - for setting view matrix</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">shader_uniform_view</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's projection uniform variable for setting projection matrix.</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">shader_uniform_proj</span>;

    <span class="org-function-name">Camera</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">uniform_view</span>, <span class="org-type">GLuint</span> <span class="org-variable-name">uniform_proj</span>, <span class="org-type">float</span> <span class="org-variable-name">aspect</span><span class="org-rainbow-delimiters-depth-2">)</span>:
        shader_uniform_view<span class="org-rainbow-delimiters-depth-2">(</span>uniform_view<span class="org-rainbow-delimiters-depth-2">)</span>
      , shader_uniform_proj<span class="org-rainbow-delimiters-depth-2">(</span>uniform_proj<span class="org-rainbow-delimiters-depth-2">)</span>
      , aspect<span class="org-rainbow-delimiters-depth-2">(</span>aspect<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>  update_view<span class="org-rainbow-delimiters-depth-3">()</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">update_view</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Create View matrix that maps from world-space coordinates to</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">camera-space coordinates</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tview</span> = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-3">(</span>cam_eye, cam_targ, cam_up<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">Create projection matrix coordinates that maps from</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">camera-space coordinates to NDC (Normalized Device Coordinates).</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tproj</span> = <span class="org-constant">glm</span>::perspective<span class="org-rainbow-delimiters-depth-3">(</span> fov_angle
                                     , aspect
                                     , zNear
                                     , zFar <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Set shader uniform variables.</span>
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_view, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tview</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_proj, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tproj</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate camera around Y axis</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_y</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">float</span> <span class="org-variable-name">a</span> = <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-3">(</span>angle<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">float</span> <span class="org-variable-name">C</span> = cosf<span class="org-rainbow-delimiters-depth-3">(</span>a<span class="org-rainbow-delimiters-depth-3">)</span>, <span class="org-variable-name">S</span> = sinf<span class="org-rainbow-delimiters-depth-3">(</span>a<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">float</span> <span class="org-variable-name">x</span> = <span class="org-keyword">this</span>-&gt;cam_eye.x;
        <span class="org-type">float</span> <span class="org-variable-name">y</span> = <span class="org-keyword">this</span>-&gt;cam_eye.y;
        <span class="org-type">float</span> <span class="org-variable-name">z</span> = <span class="org-keyword">this</span>-&gt;cam_eye.z;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Apply Y-axis rotation matrix directly to Y axis.</span>
        <span class="org-keyword">this</span>-&gt;cam_eye.x = x * C + z * S;
        <span class="org-keyword">this</span>-&gt;cam_eye.y = y;
        <span class="org-keyword">this</span>-&gt;cam_eye.z = -x * S + z * C;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Initialize the library */</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-preprocessor">    #if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-2">(</span>GLUT_ENABLED<span class="org-rainbow-delimiters-depth-2">)</span>
        glutInit<span class="org-rainbow-delimiters-depth-2">(</span>&amp;argc, argv<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">    #endif</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== S H A D E R - C O M P I L A T I O N ====//</span>
    <span class="org-comment-delimiter">//                                                </span><span class="org-comment">//</span>

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = make_glfwWindowi<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"Draw Cube 3D"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The shader source code is at the end of file.</span>
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span>;
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span>;

    <span class="org-type">GLuint</span> <span class="org-variable-name">prog</span> = glCreateProgram<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Compile shader code</span>
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_vertex_shader, GL_VERTEX_SHADER  <span class="org-rainbow-delimiters-depth-2">)</span> ;
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_frag_shader,   GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUseProgram<span class="org-rainbow-delimiters-depth-2">(</span>prog<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable location for projection matrix</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">See shader code: "uniform mat4 projection;"</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_projection"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_proj &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find u_projection uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_view</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_view"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_proj &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find u_view uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable  location for model matrix.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_model</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_model &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader attribute location - the function glGetAttribLocation - returns (-1) on error.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_position &gt;= 0 &amp;&amp; <span class="org-string">"Failed to get attribute location"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader attribute of color</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> attr_color &lt; 0<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [WARNING] Shader color attribute location not found. \n"</span><span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">====== U P L O A D - TO - G P U =========================//</span>
    <span class="org-comment-delimiter">//                                                          </span><span class="org-comment">//</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">----- Upload Cube vertices and colors ----------------//</span>
        <span class="org-type">Geometry</span> <span class="org-variable-name">cube_geometry</span> = make_cube_geometry<span class="org-rainbow-delimiters-depth-2">(</span>0.3<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_cube</span>     = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_vertices</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_colors</span>   = 0;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload geometry cube data to GPU</span>
    send_vertices<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_cube, &amp;vbo_vertices, attr_position, cube_geometry.vertices<span class="org-rainbow-delimiters-depth-2">)</span>;
    send_colors<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_cube, &amp;vbo_colors, attr_color, cube_geometry.colors<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [TRACE] vao_cube = %d \n"</span>, vao_cube <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------- Upload grid vertices and colors ------------------//</span>
    <span class="org-type">Geometry</span> <span class="org-variable-name">grid_geometry</span> = make_grid_geometry<span class="org-rainbow-delimiters-depth-2">(</span>20, 0.1f, ColorRGB<span class="org-rainbow-delimiters-depth-3">{</span>0.0f, 0.9f, 0.5f<span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_grid</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_grid_vertices</span> = 0;
    send_vertices<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_grid, &amp;vbo_grid_vertices, attr_position, grid_geometry.vertices<span class="org-rainbow-delimiters-depth-2">)</span>;
    send_colors<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_grid, &amp;vbo_grid_vertices, attr_color, grid_geometry.colors<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">----- X, Y, Z axis for visual debugging ----------------</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">X axis (GREEN) ; Y axis (RED); Z axis (BLUE)</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_axis</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_axis_vertices</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_axis_colors</span> = 0;
    <span class="org-type">float</span> <span class="org-variable-name">axis_len</span> = 5.0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Each two points represents a unconnected line (GL_LINES)</span>
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex3D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">axis_vertices</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Line for X axis - from (0.0, 0.0, 0.0) to (axis_len, 0.0, 0.0)</span>
          Vertex3D<span class="org-rainbow-delimiters-depth-3">{</span>0.0f, 0.0f, 0.0f<span class="org-rainbow-delimiters-depth-3">}</span>, Vertex3D<span class="org-rainbow-delimiters-depth-3">{</span>axis_len, 0.0f, 0.0f<span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Line for Y axis</span>
        , Vertex3D<span class="org-rainbow-delimiters-depth-3">{</span>0.0f, 0.0f, 0.0f<span class="org-rainbow-delimiters-depth-3">}</span>, Vertex3D<span class="org-rainbow-delimiters-depth-3">{</span>0.0f, axis_len, 0.0f<span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Line for Z axis</span>
        , Vertex3D<span class="org-rainbow-delimiters-depth-3">{</span>0.0f, 0.0f, 0.0f<span class="org-rainbow-delimiters-depth-3">}</span>, Vertex3D<span class="org-rainbow-delimiters-depth-3">{</span>0.0f, 0.0, axis_len<span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">axis_colors</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">ColorRGB</span><span class="org-rainbow-delimiters-depth-2">&gt;{</span>
          <span class="org-comment-delimiter">// </span><span class="org-comment">Color of X axis line</span>
          color_green, color_green
          <span class="org-comment-delimiter">// </span><span class="org-comment">Color of Y axis line</span>
         , color_red,  color_red
          <span class="org-comment-delimiter">// </span><span class="org-comment">Color of Z axis line</span>
         , color_blue, color_blue
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    send_vertices<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_axis, &amp;vbo_axis_vertices, attr_position, axis_vertices<span class="org-rainbow-delimiters-depth-2">)</span>;
    send_colors<span class="org-rainbow-delimiters-depth-2">(</span>&amp;vao_axis,   &amp;vbo_axis_colors,   attr_color,    axis_colors  <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">============== Set Shader Uniform Variables =============//</span>
    <span class="org-comment-delimiter">//                                                          </span><span class="org-comment">//</span>

    <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-variable-name">height</span>;
    glfwGetWindowSize<span class="org-rainbow-delimiters-depth-2">(</span>window, &amp;width, &amp;height<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Window aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span> = <span class="org-keyword">static_cast</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>width<span class="org-rainbow-delimiters-depth-2">)</span> / height;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Identity matrix</span>
    <span class="org-keyword">const</span> <span class="org-keyword">auto</span> identity = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">Set projection matrix uniform variable</span>
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_proj, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>identity<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">==== R E N D E R I N G - O B J E C T S ==========================//</span>
    <span class="org-comment-delimiter">//                                                                  </span><span class="org-comment">//</span>

    <span class="org-type">RenderObject</span> <span class="org-variable-name">cube1</span><span class="org-rainbow-delimiters-depth-2">{}</span>;
    cube1.vao        = vao_cube;
    cube1.u_model    = u_model;
    cube1.draw_type  = GL_QUADS;
    cube1.n_vertices = 24;
    <span class="org-comment-delimiter">// </span><span class="org-comment">cube1.model = glm::scale(cube1.model, glm::vec3(0.5, 0.5, 0.5));</span>
    cube1.model = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span>cube1.model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>0.2, 1.20, +0.4<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    cube1.model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-2">(</span>cube1.model, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-3">(</span>45.0f<span class="org-rainbow-delimiters-depth-3">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>1.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Call copy constructor (copy all data from cube1)</span>
    <span class="org-type">RenderObject</span> <span class="org-variable-name">cube2</span> = cube1;
    cube2.model = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    cube2.model = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span>cube2.model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>-1.20, 1.2, 0.4<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    cube2.model = <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-2">(</span>cube2.model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>1.5, 1.5, 1.5<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">cube2.model = glm::rotate(cube2.model, glm::radians(60.0f), glm::vec3(1.0, 0.0, 1.0));</span>


    <span class="org-comment-delimiter">// </span><span class="org-comment">Grid in the plane containing the axis X and Y</span>
    <span class="org-type">RenderObject</span> <span class="org-variable-name">grid_xy</span><span class="org-rainbow-delimiters-depth-2">{}</span>;
    grid_xy.vao        = vao_grid;
    grid_xy.u_model    = u_model;
    grid_xy.draw_type  = GL_LINES; <span class="org-comment-delimiter">// </span><span class="org-comment">Unconnected lines</span>
    grid_xy.n_vertices = grid_geometry.vertices.size<span class="org-rainbow-delimiters-depth-2">()</span>;
    grid_xy.model = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span>grid_xy.model, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>0.0, 1.5, -2.2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">//</span><span class="org-comment">grid_xy.model = glm::scale(grid_xy.model, glm::vec3(4.0, 4.0, 4.0));</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Grid in the plane which contains the axis X and Z</span>
    <span class="org-type">RenderObject</span> <span class="org-variable-name">grid_xz</span> = grid_xy;
    grid_xz.model = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    grid_xz.model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-2">(</span>grid_xz.model, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-3">(</span>-90.0f<span class="org-rainbow-delimiters-depth-3">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
     <span class="org-comment-delimiter">// </span><span class="org-comment">grid_xz.model = glm::scale(grid_xz.model, glm::vec3(4.0, 4.0, 4.0));</span>


    <span class="org-comment-delimiter">// </span><span class="org-comment">Axis which is positioned at the origin of WCS (World Coordinate System)</span>
    <span class="org-type">RenderObject</span> <span class="org-variable-name">axis_world</span>;
    axis_world.u_model   = u_model;
    axis_world.vao       = vao_axis;
    axis_world.draw_type = GL_LINES;
    axis_world.n_vertices = axis_vertices.size<span class="org-rainbow-delimiters-depth-2">()</span>;


    <span class="org-type">Camera</span> <span class="org-variable-name">camera</span><span class="org-rainbow-delimiters-depth-2">(</span>u_view, u_proj, width / height<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//                                             </span><span class="org-comment">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT  | GL_DEPTH_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">GL_CHECK( ::glutWireTeapot(0.50) );</span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">------ Draw Grid ----------</span>
            axis_world.render<span class="org-rainbow-delimiters-depth-3">()</span>;
            grid_xy.render<span class="org-rainbow-delimiters-depth-3">()</span>;
            grid_xz.render<span class="org-rainbow-delimiters-depth-3">()</span>;
            cube1.render<span class="org-rainbow-delimiters-depth-3">()</span>;
            cube2.render<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
        glfwWaitEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Q'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
             <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] User typed Q =&gt;&gt; Shutdown program. Ok. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
             <span class="org-keyword">break</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_RIGHT <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_y<span class="org-rainbow-delimiters-depth-4">(</span>+10.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_LEFT  <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_y<span class="org-rainbow-delimiters-depth-4">(</span>-10.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera up (positive Y axis)</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_UP  <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span>
            camera.cam_eye.y += 0.5;
            camera.update_view<span class="org-rainbow-delimiters-depth-4">()</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera down (negative Y axis)</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_DOWN  <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            camera.cam_eye.y -= 0.5;
            camera.update_view<span class="org-rainbow-delimiters-depth-4">()</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate cube 1 in counter counter clockwise way around Y axis</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'A'</span>  <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            cube1.model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-4">(</span> cube1.model, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-5">(</span>+10.0f<span class="org-rainbow-delimiters-depth-5">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-5">(</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate cube 1 in counter clockwise way around Y axis</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'S'</span>  <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            cube1.model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-4">(</span> cube1.model, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-5">(</span>-10.0f<span class="org-rainbow-delimiters-depth-5">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-5">(</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate cube 1 in counter counter clockwise way around X axis (positive rotation)</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Z'</span>  <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            cube1.model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-4">(</span> cube1.model, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-5">(</span>+10.0f<span class="org-rainbow-delimiters-depth-5">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-5">(</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate cube 1 in counter counter clockwise way around X axis (negative rotation)</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'X'</span>  <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            cube1.model = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-4">(</span> cube1.model, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-5">(</span>-10.0f<span class="org-rainbow-delimiters-depth-5">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-5">(</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>


    <span class="org-rainbow-delimiters-depth-2">}</span>

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;

<span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">--- End of main() -----//</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">---------- S H A D E R - P R O G R A M S  -------------------------//</span>
<span class="org-comment-delimiter">//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Minimal vertex shader =&gt;&gt; Runs on the GPU and processes each vertex.</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330 core</span>

<span class="org-string">    layout ( location = 0)  in vec3 position;</span>
<span class="org-string">    layout ( location = 1) in vec3 color;</span>
<span class="org-string">    out vec3 out_color;</span>
<span class="org-string">    uniform mat4 u_model;       // Model matrix</span>
<span class="org-string">    uniform mat4 u_view;        // Camera's view matrix</span>
<span class="org-string">    uniform mat4 u_projection;  // Camera's projection matrix</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        gl_Position = u_projection * u_view * u_model * vec4(position, 1.0);</span>

<span class="org-string">        // Forward to fragment shader</span>
<span class="org-string">        out_color = color; // vec3(0.56, 0.6, 0.0);</span>
<span class="org-string">    }</span>

<span class="org-string">)</span><span class="org-default">"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Fragment shader source code</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330</span>

<span class="org-string">    // This color comes from Vertex shader</span>
<span class="org-string">    in vec3 out_color;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // Set vertex colors</span>
<span class="org-string">        gl_FragColor =  vec4(out_color, 1.0);</span>
<span class="org-string">        // gl_FragColor = vec4(0.3, 0.6, 0.0, 1.0);</span>
<span class="org-string">    }</span>
<span class="org-string">)</span><span class="org-default">"</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">====== I M P L E M E N T A T I O N S ==========//</span>

<span class="org-type">GLFWwindow</span>*
<span class="org-function-name">make_glfwWindowi</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    glfwSetErrorCallback<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">error</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">description</span><span class="org-rainbow-delimiters-depth-3">)</span>
                         <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span> stderr, <span class="org-string">" [GLFW ERROR] Error = %d ; Description = %s \n"</span>
                                        , error, description<span class="org-rainbow-delimiters-depth-4">)</span>;
                         <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>width, height, title, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> window != <span class="org-constant">nullptr</span> &amp;&amp; <span class="org-string">"Failed  to create Window"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL context</span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Pain whole screen as black - dark screen colors are better</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">for avoding eye strain due long hours staring on monitor.</span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.0f, 0.0f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set - OpenGL Core Profile - version 3.3</span>
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glfwWindowHint<span class="org-rainbow-delimiters-depth-3">(</span>GLFW_CONTEXT_VERSION_MAJOR, 3<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glfwWindowHint<span class="org-rainbow-delimiters-depth-3">(</span>GLFW_CONTEXT_VERSION_MINOR, 3<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glfwWindowHint<span class="org-rainbow-delimiters-depth-3">(</span>GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glEnable<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_MATERIAL<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glEnable<span class="org-rainbow-delimiters-depth-3">(</span>GL_DEPTH_TEST<span class="org-rainbow-delimiters-depth-3">)</span>     <span class="org-rainbow-delimiters-depth-2">)</span>;
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glEnable<span class="org-rainbow-delimiters-depth-3">(</span>GL_BLEND<span class="org-rainbow-delimiters-depth-3">)</span>          <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">return</span> window;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_id</span> = glCreateShader<span class="org-rainbow-delimiters-depth-2">(</span> type <span class="org-rainbow-delimiters-depth-2">)</span>;
    glShaderSource<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, 1, &amp;code, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glCompileShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">is_compiled</span> = GL_FALSE;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check shader compilation result</span>
    glGetShaderiv<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, GL_COMPILE_STATUS, &amp;is_compiled<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">If there is any shader compilation result,</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">print the error message.</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> is_compiled == GL_FALSE<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">GLint</span> <span class="org-variable-name">length</span>;
        glGetShaderiv<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, GL_INFO_LOG_LENGTH, &amp;length<span class="org-rainbow-delimiters-depth-3">)</span>;
        assert<span class="org-rainbow-delimiters-depth-3">(</span> length &gt; 0 <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">out</span><span class="org-rainbow-delimiters-depth-3">(</span>length + 1, 0x00<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">GLint</span> <span class="org-variable-name">chars_written</span>;
        glGetShaderInfoLog<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, length, &amp;chars_written, out.data<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SHADER ERROR] = "</span> &lt;&lt; out &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Abort the exection of current process.</span>
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    glAttachShader<span class="org-rainbow-delimiters-depth-2">(</span>m_program, shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDeleteShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glLinkProgram<span class="org-rainbow-delimiters-depth-2">(</span>m_program<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">link_status</span> = GL_FALSE;
    glGetProgramiv<span class="org-rainbow-delimiters-depth-2">(</span>m_program, GL_LINK_STATUS, &amp;link_status<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> link_status != GL_FALSE <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUseProgram(m_program);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload buffer from main memory to GPU VBO</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; Parameters VAO, VBO are allocated by the caller.</span>
<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>
                , <span class="org-type">void</span>* <span class="org-variable-name">pBufffer</span>, <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span>, <span class="org-type">GLint</span> <span class="org-variable-name">size</span>
                , <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVao != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVbo != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = *pVbo;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>vao == 0<span class="org-rainbow-delimiters-depth-2">){</span> glGenVertexArrays<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, sizeBuffer, pBufffer, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr, size, type, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute</span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">Geometry</span>
<span class="org-function-name">make_grid_geometry</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">size_t</span> <span class="org-variable-name">n_grid</span>, <span class="org-type">float</span> <span class="org-variable-name">dx</span>, <span class="org-keyword">const</span> <span class="org-type">ColorRGB</span>&amp; <span class="org-variable-name">color</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex3D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">grid_vertices</span>;
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">ColorRGB</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">grid_colors</span> ;

    <span class="org-type">float</span> <span class="org-variable-name">dy</span> = dx;
    <span class="org-type">float</span> <span class="org-variable-name">grid_w</span>  = n_grid * dx;
    <span class="org-type">float</span> <span class="org-variable-name">grid_h</span>  = n_grid * dy;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw horizontal lines - parallel to X axis</span>
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">n</span> = 0; n &lt; 2 * n_grid; n++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Line Vertex A (BEGIN)</span>
        grid_vertices.push_back<span class="org-rainbow-delimiters-depth-3">(</span> Vertex3D<span class="org-rainbow-delimiters-depth-4">{</span> -grid_w, dy * n - grid_h, 0 <span class="org-rainbow-delimiters-depth-4">}</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Color of vertex A</span>
        grid_colors.push_back<span class="org-rainbow-delimiters-depth-3">(</span>color<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Line Vertex B (END)</span>
        grid_vertices.push_back<span class="org-rainbow-delimiters-depth-3">(</span> Vertex3D<span class="org-rainbow-delimiters-depth-4">{</span> +grid_w, dy * n - grid_h, 0  <span class="org-rainbow-delimiters-depth-4">}</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Color of vertex B</span>
        grid_colors.push_back<span class="org-rainbow-delimiters-depth-3">(</span>color<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

     <span class="org-comment-delimiter">// </span><span class="org-comment">Draw horizontal lines - parallel to Y axis</span>
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">n</span> = 0; n &lt; 2 * n_grid; n++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Line point A (BEGIN)</span>
        grid_vertices.push_back<span class="org-rainbow-delimiters-depth-3">(</span> Vertex3D<span class="org-rainbow-delimiters-depth-4">{</span> dx * n - grid_w, -grid_h, 0 <span class="org-rainbow-delimiters-depth-4">}</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Color of Vertex A</span>
        grid_colors.push_back<span class="org-rainbow-delimiters-depth-3">(</span>color<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Line pojnt B (END)</span>
        grid_vertices.push_back<span class="org-rainbow-delimiters-depth-3">(</span> Vertex3D<span class="org-rainbow-delimiters-depth-4">{</span> dx * n - grid_w, +grid_h, 0  <span class="org-rainbow-delimiters-depth-4">}</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Color of Vertex B</span>
        grid_colors.push_back<span class="org-rainbow-delimiters-depth-3">(</span>color<span class="org-rainbow-delimiters-depth-3">)</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-keyword">return</span> Geometry<span class="org-rainbow-delimiters-depth-2">{</span> grid_vertices, grid_colors <span class="org-rainbow-delimiters-depth-2">}</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">Geometry</span>
<span class="org-function-name">make_cube_geometry</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">w</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Array of cube vertex coordinates (X, Y)</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">vertices</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex3D</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Top face {y = w}</span>
        <span class="org-rainbow-delimiters-depth-3">{</span> w, w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w, w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w, w,  w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> w, w,  w<span class="org-rainbow-delimiters-depth-3">}</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Bottom face , {y = -w}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> w, -w,  w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w, -w,  w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w, -w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> w, -w, -w<span class="org-rainbow-delimiters-depth-3">}</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Front face  , {z = w}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> w,  w, w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w,  w, w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w, -w, w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> w, -w, w<span class="org-rainbow-delimiters-depth-3">}</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Back face , {z = -w}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> w, -w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w, -w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w,  w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span> w,  w, -w<span class="org-rainbow-delimiters-depth-3">}</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Left face , {x = -w}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w,  w,  w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w,  w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w, -w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>-w, -w,  w<span class="org-rainbow-delimiters-depth-3">}</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Right face , {x = w}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>w,  w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>w,  w,  w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>w, -w,  w<span class="org-rainbow-delimiters-depth-3">}</span>
      , <span class="org-rainbow-delimiters-depth-3">{</span>w, -w, -w<span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] Number of cube vertices = %zu \n", cube_vertices.size() );</span>

    <span class="org-keyword">auto</span> <span class="org-variable-name">colors</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">ColorRGB</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-rainbow-delimiters-depth-2">{</span>
           color_red
        ,  color_red
        ,  color_red
        ,  color_red

        , color_blue
        , color_blue
        , color_blue
        , color_blue

        , color_green
        , color_green
        , color_green
        , color_green

        , color_gray
        , color_gray
        , color_gray
        , color_gray

        , color_dark_green
        , color_dark_green
        , color_dark_green
        , color_dark_green

        , color_dark_blue
        , color_dark_blue
        , color_dark_blue
        , color_dark_blue
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-keyword">return</span> Geometry<span class="org-rainbow-delimiters-depth-2">{</span> vertices, colors <span class="org-rainbow-delimiters-depth-2">}</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<b>Building on Linux</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build_linux -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build_linux --target

$ ls _build_linux/
CMakeCache.txt  cmake_install.cmake  draw3d-cube*
CMakeFiles/     _deps/               Makefile
</pre>
</div>

<p>
Run the application:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ &gt;&gt; _build_linux/draw3d-cube
[TRACE] vao_cube = 1 
</pre>
</div>

<p>
<b>Cross-compiling for Windows and testing  with wine</b>
</p>

<p>
STEP 1: Cmake configuration step 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ docker run -it --rm --user=$(<span class="org-sh-quoted-exec">id</span> -u):$(<span class="org-sh-quoted-exec">id</span> -g)  <span class="org-sh-escaped-newline">\</span>
       --volume=$<span class="org-variable-name">PWD</span>:/cwd --workdir=/cwd  dockcross/windows-static-x64 <span class="org-sh-escaped-newline">\</span>
       cmake -H. -B_build_cross -DCMAKE_BUILD_TYPE=Debug
</pre>
</div>

<p>
STEP 2: Cmake building step 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ docker run -it --rm --user=(id -u):(id -g)  <span class="org-sh-escaped-newline">\</span>
    --volume=$<span class="org-variable-name">PWD</span>:/cwd --workdir=/cwd  dockcross/windows-static-x64 <span class="org-sh-escaped-newline">\</span>
    cmake --build _build_cross --target
</pre>
</div>

<p>
STEP 3: Check compiled files
</p>

<div class="org-src-container">
<pre class="src src-sh">$ &gt;&gt; ls _build_cross/
CMakeCache.txt  cmake_install.cmake  draw3d-cube.exe*  Makefile
CMakeFiles/     _deps/               glew32.dll*
</pre>
</div>

<p>
STEP 4: Run the application with Wine 
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ file _build_cross/draw3d-cube.exe 
<span class="org-function-name">_build_cross/draw3d-cube.exe</span>: PE32+ executable (console) x86-64, for MS Windows

 $ file _build_cross/glew32.dll 
<span class="org-function-name">_build_cross/glew32.dll</span>: PE32+ executable (DLL) (console) x86-64, for MS Windows

$ wine _build_cross/draw3d-cube.exe
</pre>
</div>
</div>
</div>

<div id="outline-container-orga67b7f0" class="outline-3">
<h3 id="orga67b7f0"><span class="section-number-3">1.23</span> 3D - WebGL 3D Scene with grid and cube</h3>
<div class="outline-text-3" id="text-1-23">
<p>
By using WebGL API, it is possible to learn and prototype computer
graphics without the complexity of dealing with building systems,
compilation, memory management and C or C++ programming. This code
takes advantage of the ubiquity and availability of JavaScript and
WebGL on every modern web browser for demonstrating the usage of
OpenGL and WebGL APIs for rendering a simple 3D scene containing a
camera, grid, cube and tetrahedron. The sample WebGL application uses
no external dependencies and implements everything from scratch which
makes it easier to reason about the code and about 3D programming
concepts.
</p>


<p>
Since the code is written in JavaScript and html, it is possible to
experiment and play with webGL APIs used in the code by opening the
next link.
</p>

<ul class="org-ul">
<li>Live example available at:  <a href="https://jsfiddle.net/kgqdocma/">https://jsfiddle.net/kgqdocma/</a></li>
</ul>

<p>
In the live example, there are the following controls:
</p>

<ul class="org-ul">
<li>'a' key =&gt; rotates the camera view upwards (forward vector)</li>
<li>'s' key =&gt; rotates the camera view downwards (forward)</li>
<li>arrow up =&gt; Moves the camera position (eye vector) in the
direction that camera is <span class="underline">looking at</span> (forward vector).</li>
<li>arrow down =&gt; Moves the camera position (eye vector) in the
opposite direction that the camera is looking at.</li>
<li>arrow right =&gt; Rotates the camera around its <span class="underline">up</span> vector (orientation).</li>
<li>arrow left =&gt; Rotates the camera in the opposite direction around its <span class="underline">up</span> vector (orientation).</li>
<li>'j' =&gt; Move the camera in the positive direction of Y axis</li>
<li>'k' =&gt; Move the camera in the negative direction of Y axis.</li>
<li>'q' =&gt; Rotates the cube.</li>
<li>'r' =&gt; Reset camera position (eye vector) and view (forward vector)</li>
</ul>

<p>
Notes:
</p>

<ul class="org-ul">
<li>The class Matrix4x4 that represents a mutable 4x4 matrix
column-major matrix is inspired by the c++ class <a href="https://doc.qt.io/qt-5/qmatrix4x4.html">QMatrix4x4</a> class from
Qt framework.</li>

<li>The Quaternion class was inspired by C++ class <a href="https://doc.qt.io/qt-5/qquaternion.html">QQuaternion</a>  from Qt framework.</li>

<li>The class Orientation was inspired by the C++ class <a href="https://web.archive.org/web/20210507012307/https://docs.unrealengine.com/en-US/API/Runtime/Core/Math/FTransform/index.html">FTransform</a>
from Unreal game engine. The idea was copied from public
information available in the documentation.</li>

<li><span class="underline">WebGL</span> and OpenGL ES only support matrices in <span class="underline">column-major</span> order memory
layout. Those APIs do not support matrices in <span class="underline">row-major order</span>.</li>

<li><span class="underline">WebGL</span>, which is based on <span class="underline">OpenGL ES</span> only supports the <span class="underline">retained</span>
<span class="underline">mode</span>. WebGL does not support <span class="underline">immediate mode</span>. Therefore there is no
equivalent in WebGL to the old and deprecated OpenGL retained mode
APIs, including glVertex3f(), glBegin(), glEnd(), glColor(),
glMaterial(), glRotate(), glTranslate(), glFrustum() and many
other deprecated OpenGL subroutines.</li>

<li>In modern OpenGL and specially in OpenGL ES and WebGL, it is only
possible to draw primitive forms such as lines, points and
triangles, any complex shape requires a good enough amount of
primitive shapes in order to look like smooth and realistic.</li>
</ul>



<p>
<b>Screenshots</b>
</p>



<div class="figure">
<p><a href="images/opengl-webgl-cube3d-1.png"><img src="images/opengl-webgl-cube3d-1.png" alt="opengl-webgl-cube3d-1.png" /></a>
</p>
</div>


<div class="figure">
<p><a href="images/opengl-webgl-cube3d-2.png"><img src="images/opengl-webgl-cube3d-2.png" alt="opengl-webgl-cube3d-2.png" /></a>   
</p>
</div>


<p>
<b>More about WebGL</b>
</p>

<ul class="org-ul">
<li><a href="https://blog.scottlogic.com/2019/11/27/drawing-area-polygons-with-webgl.html">Drawing Area Polygons with WebGL</a></li>

<li><a href="https://learnwebgl.brown37.net/">https://learnwebgl.brown37.net/</a></li>

<li><a href="https://webglfundamentals.org/">https://webglfundamentals.org/</a></li>

<li><a href="https://stackoverflow.com/questions/tagged/webgl">https://stackoverflow.com/questions/tagged/webgl</a></li>

<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API">WebGL: 2D and 3D graphics for the web</a> - Mozilla</li>

<li><a href="https://webgl-shaders.com/">https://webgl-shaders.com/</a></li>

<li><a href="https://web.dev/webgl-shaders/">https://web.dev/webgl-shaders/</a></li>

<li><a href="https://www.obfuscator.io/">JavaScript Obfuscator Tool</a></li>
</ul>


<p>
<b>Complete Html Code</b>  (File: webgl2.html)
</p>

<div class="org-src-container">
<pre class="src src-html"><span class="org-string">&lt;!DOCTYPE html&gt;</span>
&lt;<span class="org-function-name">html</span>&gt; 
   &lt;<span class="org-function-name">head</span>&gt; 
       &lt;<span class="org-function-name">title</span>&gt;<span class="org-underline"><span class="org-bold">WebGL 3D Scene</span></span>&lt;/<span class="org-function-name">title</span>&gt;
    &lt;/<span class="org-function-name">script</span>&gt;
   &lt;/<span class="org-function-name">head</span>&gt;

   &lt;<span class="org-function-name">body</span>&gt;
       &lt;<span class="org-function-name">h1</span>&gt;<span class="org-underline"><span class="org-bold">WebGL 3D Scene with Cube</span></span>&lt;/<span class="org-function-name">h1</span>&gt;
       OpenGL version:  &lt;<span class="org-function-name">label</span> <span class="org-variable-name">id</span>=<span class="org-string">"output1"</span>&gt;&lt;/<span class="org-function-name">label</span>&gt;          &lt;<span class="org-function-name">br</span>/&gt;
       Shading language version: &lt;<span class="org-function-name">label</span> <span class="org-variable-name">id</span>=<span class="org-string">"output2"</span>&gt;&lt;/<span class="org-function-name">label</span>&gt; &lt;<span class="org-function-name">br</span>/&gt; 
       Camera Position: &lt;<span class="org-function-name">label</span> <span class="org-variable-name">id</span>=<span class="org-string">"output-camera"</span>&gt;&lt;/<span class="org-function-name">label</span>&gt; &lt;<span class="org-function-name">br</span>/&gt;
       &lt;<span class="org-function-name">canvas</span> <span class="org-variable-name">id</span>=<span class="org-string">"glCanvas"</span> <span class="org-variable-name">width</span>=<span class="org-string">"600"</span> <span class="org-variable-name">height</span>=<span class="org-string">"480"</span>&gt;
   &lt;/<span class="org-function-name">body</span>&gt;
    &lt;<span class="org-function-name">script</span>&gt;
// eye = [3, 10, 20]; at = [50, 25, 10]; up = [0, 1, 0];

// RGB color constants (Red, Gree, Blue) (R, G, B) tuples
const COLOR_RED        = [1.0, 0.0, 0.0];
const COLOR_GREEN      = [0.0, 1.0, 0.0];
const COLOR_BLUE       = [0.0, 0.0, 1.0];
const COLOR_YELLLOW    = [ 0.80,  1.000, 0.100 ];
const COLOR_GRAY       = [ 0.47,  0.390, 0.380 ];
const COLOR_DARK_GREEN = [ 0.027, 0.392, 0.050 ];
const COLOR_DARK_BLUE  = [ 0.109, 0.066, 0.411 ];   

  ... ... ..... . ... .... ... ... ... ... 
  ... ... ..... . ... .... ... ... ... ... 

    &lt;/<span class="org-function-name">script</span>&gt;

  &lt;/<span class="org-function-name">html</span>&gt; 
</pre>
</div>

<p>
JavaScript part: 
</p>

<div class="org-src-container">
<pre class="src src-js"><span class="org-comment-delimiter">// </span><span class="org-comment">eye = [3, 10, 20]; at = [50, 25, 10]; up = [0, 1, 0];</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">RGB color constants (Red, Gree, Blue) (R, G, B) tuples</span>
<span class="org-keyword">const</span> <span class="org-variable-name">COLOR_RED</span>        = [1.0, 0.0, 0.0];
<span class="org-keyword">const</span> <span class="org-variable-name">COLOR_GREEN</span>      = [0.0, 1.0, 0.0];
<span class="org-keyword">const</span> <span class="org-variable-name">COLOR_BLUE</span>       = [0.0, 0.0, 1.0];
<span class="org-keyword">const</span> <span class="org-variable-name">COLOR_YELLLOW</span>    = [ 0.80,  1.000, 0.100 ];
<span class="org-keyword">const</span> <span class="org-variable-name">COLOR_GRAY</span>       = [ 0.47,  0.390, 0.380 ];
<span class="org-keyword">const</span> <span class="org-variable-name">COLOR_DARK_GREEN</span> = [ 0.027, 0.392, 0.050 ];
<span class="org-keyword">const</span> <span class="org-variable-name">COLOR_DARK_BLUE</span>  = [ 0.109, 0.066, 0.411 ];


<span class="org-comment-delimiter">// </span><span class="org-comment">Normalize a vector 3x1 column vector (3 rows and 1 column)  </span>
<span class="org-keyword">function</span> <span class="org-function-name">normalize</span>(<span class="org-variable-name">vector</span>)
{
  <span class="org-keyword">let</span> [<span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>] = vector;
  <span class="org-keyword">let</span> <span class="org-variable-name">norm</span> = Math.sqrt( x * x + y * y + z * z);
  <span class="org-keyword">return</span> [ x / norm, y / norm, z / norm ];
}

<span class="org-comment-delimiter">// </span><span class="org-comment">Computes the dot product (aka scalar) product between two vectors  </span>
<span class="org-keyword">function</span> <span class="org-function-name">dot</span>(<span class="org-variable-name">vectorA</span>, <span class="org-variable-name">vectorB</span>)
{
  <span class="org-keyword">let</span> [<span class="org-variable-name">xa</span>, <span class="org-variable-name">ya</span>, <span class="org-variable-name">za</span>] = vectorA;
  <span class="org-keyword">let</span> [<span class="org-variable-name">xb</span>, <span class="org-variable-name">yb</span>, <span class="org-variable-name">zb</span>] = vectorB;
  <span class="org-keyword">return</span> xa * xb  + ya * yb + za * zb;
}

<span class="org-comment-delimiter">// </span><span class="org-comment">Computs the cross product between two vectors </span>
<span class="org-keyword">function</span> <span class="org-function-name">cross</span>(<span class="org-variable-name">vectorA</span>, <span class="org-variable-name">vectorB</span>)
{
  <span class="org-keyword">let</span> [<span class="org-variable-name">xa</span>, <span class="org-variable-name">ya</span>, <span class="org-variable-name">za</span>] = vectorA;
  <span class="org-keyword">let</span> [<span class="org-variable-name">xb</span>, <span class="org-variable-name">yb</span>, <span class="org-variable-name">zb</span>] = vectorB;
  <span class="org-keyword">return</span> [ ya * zb - za * yb, za * xb - xa * zb, xa * yb - ya * xb ];
}

<span class="org-comment-delimiter">// </span><span class="org-comment">Difference between two vectors </span>
<span class="org-keyword">function</span> <span class="org-function-name">diff</span>(<span class="org-variable-name">vectorA</span>, <span class="org-variable-name">vectorB</span>)
{
  <span class="org-keyword">let</span> [<span class="org-variable-name">xa</span>, <span class="org-variable-name">ya</span>, <span class="org-variable-name">za</span>] = vectorA;
  <span class="org-keyword">let</span> [<span class="org-variable-name">xb</span>, <span class="org-variable-name">yb</span>, <span class="org-variable-name">zb</span>] = vectorB;
  <span class="org-keyword">return</span> [xa - xb, ya - yb, za - zb];
}

<span class="org-keyword">class</span> Quaternion
{
  constructor(w, x, y, z)
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">Default is the unit quaternion </span>
    <span class="org-constant">this</span>._quat = [w, x, y, z];
  }

  <span class="org-doc">/** @param {number} w</span>
<span class="org-doc">  /*  @param {number} x </span>
<span class="org-doc">  /*  @param {number} y </span>
<span class="org-doc">  /*  @param {number} z </span>
<span class="org-doc">   */</span> 
  <span class="org-keyword">static</span> create(w, x, y, z)
  {
    <span class="org-keyword">return</span> <span class="org-keyword">new</span> <span class="org-type">Quaternion</span>(w, x, y, z);
  }

  <span class="org-doc">/** Create unit quaternion  */</span>
  <span class="org-keyword">static</span> createUnit()
  {
    <span class="org-keyword">return</span> <span class="org-keyword">new</span> <span class="org-type">Quaternion</span>(1.0, 0.0, 0.0, 0.0);
  }

  <span class="org-doc">/** Create a imaginary quaternion */</span>
  <span class="org-keyword">static</span> createFromVector(x, y, z)
  {
    <span class="org-keyword">return</span> <span class="org-keyword">new</span> <span class="org-type">Quaternion</span>(0.0, x, y, z);
  }

  <span class="org-doc">/** Create quaternion represeting a rotation around some axis </span>
<span class="org-doc">   * @param {number}   angle - Rotation angle in degrees </span>
<span class="org-doc">   * @param {number[]} axis  - Rotation axis</span>
<span class="org-doc">   */</span>
  <span class="org-keyword">static</span> createFromAxisAngle(angle, axis)
  {
    <span class="org-keyword">let</span> [<span class="org-variable-name">nx</span>, <span class="org-variable-name">ny</span>, <span class="org-variable-name">nz</span>] = normalize(axis);
    <span class="org-comment-delimiter">// </span><span class="org-comment">Angle in radians </span>
    <span class="org-keyword">let</span> <span class="org-variable-name">t</span> = angle / 180.0 * Math.PI / 2;
    <span class="org-keyword">let</span> <span class="org-variable-name">C</span> = Math.cos(t);
    <span class="org-keyword">let</span> <span class="org-variable-name">S</span> = Math.sin(t);
    <span class="org-keyword">return</span> Quaternion.create(C, S * nx, S * ny, S * nz);
  }

  negate()
  {
    <span class="org-keyword">let</span> [<span class="org-variable-name">w</span>, <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>] = <span class="org-constant">this</span>._quat;
    <span class="org-keyword">return</span> <span class="org-keyword">new</span> <span class="org-type">Quaternion</span>(-w, -x, -y, -z);
  }

  conjugate()
  {
    <span class="org-keyword">let</span> [<span class="org-variable-name">w</span>, <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>] = <span class="org-constant">this</span>._quat;
    <span class="org-keyword">return</span> <span class="org-keyword">new</span> <span class="org-type">Quaternion</span>(w, -x, -y, -z);
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Note: It is assumed that the current quaternion is a unit quaternion </span>
  rotateVector(v)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">qa</span> = <span class="org-constant">this</span>;
    <span class="org-keyword">let</span> <span class="org-variable-name">qb</span> = Quaternion.createFromVector(...v);
    <span class="org-comment-delimiter">// </span><span class="org-comment">r1 = qa * qb </span>
    <span class="org-keyword">let</span> <span class="org-variable-name">r1</span> = qa.multiply(qb);
    <span class="org-keyword">let</span> <span class="org-variable-name">r2</span> = r1.multiply(qa.conjugate());
    <span class="org-comment-delimiter">// </span><span class="org-comment">r2 = qa * qb * qa.conjugage()</span>
    <span class="org-comment-delimiter">//</span><span class="org-comment">let b = q.multiply( qa.conjugate() );</span>
    <span class="org-keyword">return</span> r2.getVector();
  }

  <span class="org-doc">/** Get imaginary part of a quaternion */</span>
  getVector()
  {
    <span class="org-keyword">let</span> [<span class="org-variable-name">w</span>, <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>] = <span class="org-constant">this</span>._quat;
    <span class="org-keyword">return</span> [x, y, z];
  }

  <span class="org-doc">/** Turn the quaternion into a homogeneous rotation matrix */</span>
  toMatrix()
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">The quaternion is assumed to be a unit quaternion </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">otherwise the matrix result will be invalid</span>
    <span class="org-keyword">let</span> [<span class="org-variable-name">a</span>, <span class="org-variable-name">b</span>, <span class="org-variable-name">c</span>, <span class="org-variable-name">d</span>] = <span class="org-constant">this</span>._quat;
    <span class="org-keyword">let</span> <span class="org-variable-name">m</span> = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(16);
    m[0] = a * a - c * c - d * d;
    m[1] = 2 * (b * c + a * d);
    m[2] = 2 * (b * d - a * c);
    m[3] = 0.0;

    m[4] = 2 * (b * c - a * d);
    m[5] = a * a - b * b + c * c -  d * d;
    m[6] = 2 * (c * d + a * b);
    m[7] = 0.0;

    m[8] = 2 * (b * d + a * c);
    m[9] = 2 * (c * d - a * b);
    m[10] = a * a - b * b - c * c + d * d;
    m[11] = 0;

    m[12] = 0.0;
    m[13] = 0.0;
    m[14] = 0.0;
    m[15] = 1.0;

    <span class="org-keyword">return</span> m;
  }

  <span class="org-doc">/** Multiply a quaternion for another and returns a new quaternion </span>
<span class="org-doc">   * Note: JavaScript lacks operator overloading</span>
<span class="org-doc">   * Note: Quaternion multiplication is not commutative </span>
<span class="org-doc">   * @param {Quaternio} q</span>
<span class="org-doc">   **/</span>
  multiply( q )
  {
    <span class="org-keyword">let</span> [<span class="org-variable-name">w1</span>, <span class="org-variable-name">x1</span>, <span class="org-variable-name">y1</span>, <span class="org-variable-name">z1</span>] = <span class="org-constant">this</span>._quat;
    <span class="org-keyword">let</span> [<span class="org-variable-name">w2</span>, <span class="org-variable-name">x2</span>, <span class="org-variable-name">y2</span>, <span class="org-variable-name">z2</span>] = q._quat; 
    <span class="org-keyword">let</span> <span class="org-variable-name">result</span> = [
          w1 * w2 - x1 * x2 - y1 * y2 - z1 * z2 
        , x1 * w2 + w1 * x2 - z1 * y2 + y1 * z2
        , y1 * w2 + z1 * x2 + w1 * y2 - x1 * z2 
        , z1 * w2 - y1 * x2 + x1 * y2 + w1 * z2  
    ];
    <span class="org-keyword">return</span> <span class="org-keyword">new</span> <span class="org-type">Quaternion</span>(...result);
  }

}



<span class="org-keyword">class</span> Matrix4x4 
{

  constructor()
  {
      <span class="org-constant">this</span>.mat = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(16);
      <span class="org-constant">this</span>.mat[0] = 1.0;
      <span class="org-constant">this</span>.mat[5] = 1.0;
      <span class="org-constant">this</span>.mat[10] = 1.0;
      <span class="org-constant">this</span>.mat[15] = 1.0;
  }

  <span class="org-keyword">static</span> create()
  {
    <span class="org-keyword">return</span> <span class="org-keyword">new</span> <span class="org-type">Matrix4x4</span>();
  }

  at(i, j) 
  {
    <span class="org-keyword">return</span> <span class="org-constant">this</span>.mat.at(j + 4 * i);
  }

  setToIdentity() 
  {
      <span class="org-constant">this</span>.mat = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(16);
      <span class="org-constant">this</span>.mat[0] = 1.0;
      <span class="org-constant">this</span>.mat[5] = 1.0;
      <span class="org-constant">this</span>.mat[10] = 1.0;
      <span class="org-constant">this</span>.mat[15] = 1.0;
      <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">this.matrix = this.matrix * translateMatrix(x, y, z)</span>
  <span class="org-doc">/**</span>
<span class="org-doc">   *  @param {number} x </span>
<span class="org-doc">   *  @param {number} y </span>
<span class="org-doc">   *  @param {number} z </span>
<span class="org-doc">   */</span> 
  translate(x, y, z)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">matrix</span> = [   1, 0, 0, 0
                   , 0, 1, 0, 0 
                   , 0, 0, 1, 0 
                   , x, y, z, 1 
                  ];
    <span class="org-constant">this</span>.multiply(matrix);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  translateV(vector)
  {
    <span class="org-constant">this</span>.translate(vector[0], vector[1], vector[2]);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-doc">/**</span>
<span class="org-doc">   *  @param {number} sx </span>
<span class="org-doc">   *  @param {number} sy </span>
<span class="org-doc">   *  @param {number} sz </span>
<span class="org-doc">   */</span> 
  scaleV(sx, sy, sz)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">matrix</span> = [  sx,  0,  0, 0 
                   , 0, sy,  0, 0 
                   , 0,  0, sz, 0 
                   , 0,  0,  0, 1 
                  ];
    <span class="org-constant">this</span>.multiply(matrix);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-doc">/**</span>
<span class="org-doc">   *  @param {number} k</span>
<span class="org-doc">   */</span> 
  scale(k)  
  {
     <span class="org-keyword">let</span> <span class="org-variable-name">m</span> = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(16);
     m[0] = k; 
     m[5] = k; 
     m[10] = k; 
     m[15] = 1.0; 
    <span class="org-constant">this</span>.multiply(m);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Rotation around arbitrary axis (vector) designated by X, Y, Z</span>
  <span class="org-comment-delimiter">// </span><span class="org-comment">the angle is in radians </span>
  <span class="org-comment-delimiter">// </span><span class="org-comment">this.matrix = this.matrix * rotate(angle, x, y, z)</span>
  rotate(angle, x, y, z)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">r</span> = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(16);
    <span class="org-keyword">let</span> <span class="org-variable-name">t</span> = angle * Math.PI / 180.0;
    <span class="org-keyword">let</span> <span class="org-variable-name">C</span> = Math.cos(t);
    <span class="org-keyword">let</span> <span class="org-variable-name">S</span> = Math.sin(t);
    <span class="org-keyword">let</span> <span class="org-variable-name">K</span> = 1 - C ;
    r[0] = x*x + (1 - x*x)*C;
    r[4] = x*y*K - z*S;
    r[8] = x*z*K + y*S;
    r[12] = 0;
    r[1] = x*y*K + z*S;
    r[5] = y*y + (1 - y*y)*C
    r[9] = -x*S + y*z*K;
    r[13] = 0;
    r[2] = x*z*K - y*S;
    r[6] = x*S + y*z*K;
    r[10] = z*z + (1 - z*z)*C;
    r[14] = 0;
    r[3] = 0;
    r[7] = 0;
    r[11] = 0;
    r[15] = 1;
    <span class="org-constant">this</span>.multiply(r);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-doc">/** Rotate around Z axis </span>
<span class="org-doc">   * @param {number} angle - Rotation angle in degrees </span>
<span class="org-doc">   */</span>  
  rotateZ(angle)
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">let r = new Float32Array(16);</span>
    <span class="org-keyword">let</span> <span class="org-variable-name">r</span> = Array(16).fill(0.0);
    <span class="org-keyword">let</span> <span class="org-variable-name">t</span> = angle * Math.PI / 180.0;
    <span class="org-keyword">let</span> <span class="org-variable-name">C</span> = Math.cos(t);
    <span class="org-keyword">let</span> <span class="org-variable-name">S</span> = Math.sin(t);
    r[0] = C; r[4] = -S;
    r[1] = S; r[5] =  C;
    r[10] = 1; r[15] = 1;

    <span class="org-constant">this</span>.multiply(r);
    <span class="org-comment-delimiter">//</span><span class="org-comment">this.mat = r;</span>
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-doc">/** Rotate around some axis </span>
<span class="org-doc">   * @param  {number}    angle  - rotation angle in degrees</span>
<span class="org-doc">   * @param  {number[]}  axis   - rotation axis as an array of 3 numbers </span>
<span class="org-doc">   */</span> 
  rotateAxis(angle, axis)
  {
    <span class="org-keyword">let</span> [<span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>] = axis;
    <span class="org-constant">this</span>.rotate(angle, x, y, z);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-doc">/** Rotate current matrix by multiplying it by the quaternion rotation matrix </span>
<span class="org-doc">   *  this.matrix = this.matrix * quaternion.RotMatrix </span>
<span class="org-doc">   * @param {Quaternion} q </span>
<span class="org-doc">   **/</span>
  rotateQuaternion(q)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">rotmatrix</span> = q.toMatrix();
    <span class="org-constant">this</span>.multiply(rotmatrix);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  setLookAt(eye, at, up)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">Z</span> = normalize( diff(eye, at) );
    <span class="org-keyword">let</span> <span class="org-variable-name">X</span> = normalize( cross(up, Z) );
    <span class="org-keyword">let</span> <span class="org-variable-name">Y</span> = normalize( cross(Z, X) );
    <span class="org-keyword">let</span> <span class="org-variable-name">m</span> = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(16);
    m[0]  = X[0]; m[4]  = X[1]; m[8]  = X[2];  m[12]  = -dot(X, eye);
    m[1]  = Y[0]; m[5]  = Y[1]; m[9]  = Y[2];  m[13]  = -dot(Y, eye);
    m[2]  = Z[0]; m[6]  = Z[1]; m[10] = Z[2];  m[14] = -dot(Z, eye);
    m[3] = 0;     m[7] = 0;     m[11] = 0;     m[15] =  1; 
    <span class="org-constant">this</span>.mat = m;
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">FOV angle in degrees </span>
  setPerspective(FOV, aspect, zNear, zFar)
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">Angle in radians</span>
    <span class="org-keyword">let</span> <span class="org-variable-name">t</span> = Math.PI * FOV / 180.0; 
    <span class="org-keyword">let</span> <span class="org-variable-name">k</span> = Math.tan(t / 2);
    <span class="org-keyword">let</span> <span class="org-variable-name">m</span> = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(16);
    m[0] = 1 / ( aspect * k ); 
    m[5] = 1 / k;
    m[10] = (zNear + zFar) / (zNear - zFar);
    m[14] = 2 * zNear * zFar / (zNear - zFar);
    m[11] = -1; 
    <span class="org-constant">this</span>.mat = m; 
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">In place matrix multiplication </span>
  multiply( matrix )
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">a</span> = <span class="org-constant">this</span>.mat;
    <span class="org-keyword">let</span> <span class="org-variable-name">b</span> = matrix;
    <span class="org-keyword">let</span> <span class="org-variable-name">c</span> = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(16);

  <span class="org-comment-delimiter">// </span><span class="org-comment">Matrix multiplication algorithm of column-major matrices borrowed from </span>
  <span class="org-comment-delimiter">// </span><span class="org-comment">https://github.com/yycho0108/Abstraction/blob/master/gl-matrix.min.js</span>
   <span class="org-keyword">var</span> <span class="org-variable-name">d</span> = a[0], <span class="org-variable-name">e</span> = a[1], <span class="org-variable-name">g</span> = a[2], <span class="org-variable-name">f</span> = a[3], <span class="org-variable-name">h</span> = a[4], <span class="org-variable-name">i</span> = a[5], <span class="org-variable-name">j</span> = a[6], <span class="org-variable-name">k</span> = a[7]
          , l = a[8], o = a[9], m = a[10], n = a[11], p = a[12], r = a[13], s = a[14];

    a = a[15];
    <span class="org-keyword">var</span> <span class="org-variable-name">A</span> = b[0], <span class="org-variable-name">B</span> = b[1], <span class="org-variable-name">t</span> = b[2], <span class="org-variable-name">u</span> = b[3], <span class="org-variable-name">v</span> = b[4], <span class="org-variable-name">w</span> = b[5], <span class="org-variable-name">x</span> = b[6], <span class="org-variable-name">y</span> = b[7], <span class="org-variable-name">z</span> = b[8]
        , C = b[9], D = b[10], E = b[11], q = b[12], F = b[13], G = b[14];

    b = b[15];
    c[0] = A * d + B * h + t * l + u * p;
    c[1] = A * e + B * i + t * o + u * r;
    c[2] = A * g + B * j + t * m + u * s;
    c[3] = A * f + B * k + t * n + u * a;
    c[4] = v * d + w * h + x * l + y * p;
    c[5] = v * e + w * i + x * o + y * r;
    c[6] = v * g + w * j + x * m + y * s;
    c[7] = v * f + w * k + x * n + y * a;
    c[8] = z * d + C * h + D * l + E * p;
    c[9] = z * e + C * i + D * o + E * r;
    c[10] = z *
        g + C * j + D * m + E * s;
    c[11] = z * f + C * k + D * n + E * a;
    c[12] = q * d + F * h + G * l + b * p;
    c[13] = q * e + F * i + G * o + b * r;
    c[14] = q * g + F * j + G * m + b * s;
    c[15] = q * f + F * k + G * n + b * a;
    <span class="org-constant">this</span>.mat = c;
  }  

}


<span class="org-keyword">function</span> <span class="org-function-name">assertNotUndefined</span>(<span class="org-variable-name">variableName</span>, <span class="org-variable-name">variable</span>)
{
  <span class="org-keyword">if</span>( <span class="org-keyword">typeof</span> variable == <span class="org-string">"undefined"</span> )
  {
    alert(<span class="org-string">` [ASSERT ERROR] ${variableName} is undefined.`</span>);
  }
}


    <span class="org-comment-delimiter">// </span><span class="org-comment">Based on:  https://webglfundamentals.org/webgl/lessons/webgl-fundamentals.html</span>
<span class="org-keyword">function</span> <span class="org-function-name">compileShaderProgram</span>(<span class="org-variable-name">gl</span>, <span class="org-variable-name">vertexShaderCode</span>, <span class="org-variable-name">fragmentShaderCode</span>) 
{
    <span class="org-keyword">function</span> <span class="org-function-name">createShader</span>(<span class="org-variable-name">gl</span>, <span class="org-variable-name">type</span>, <span class="org-variable-name">source</span>) 
    {
      assertNotUndefined(<span class="org-string">"gl"</span>, gl);
      <span class="org-keyword">var</span> <span class="org-variable-name">shader</span> = gl.createShader(type);
      gl.shaderSource(shader, source);
      gl.compileShader(shader);
      <span class="org-keyword">var</span> <span class="org-variable-name">success</span> = gl.getShaderParameter(shader, gl.COMPILE_STATUS);
      <span class="org-keyword">if</span> (success) {
        <span class="org-keyword">return</span> shader;
      }

      console.log(<span class="org-string">" [SHADER ERROR] = \n"</span> + source);
      console.log(<span class="org-string">" [SHADER ERROR] "</span>  + gl.getShaderInfoLog(shader) );
      <span class="org-comment-delimiter">// </span><span class="org-comment">alert(" [SHADER ERORR]  " + gl.getShaderInfoLog(shader) );</span>
      gl.deleteShader(shader);
    }

    <span class="org-keyword">let</span> <span class="org-variable-name">vertexShader</span> = createShader(gl, gl.VERTEX_SHADER, vertexShaderCode);

    <span class="org-keyword">let</span> <span class="org-variable-name">fragmentShader</span> = createShader(gl, gl.FRAGMENT_SHADER, fragmentShaderCode);
    console.log(<span class="org-string">" [TRACE] Compiled fragmentShader Ok."</span>);

    <span class="org-keyword">var</span> <span class="org-variable-name">program</span> = gl.createProgram();
    assertNotUndefined(<span class="org-string">"program"</span>, program);
    gl.attachShader(program, vertexShader);
    console.log(<span class="org-string">" [TRACE] Attach vertex shader Ok"</span>);
    gl.attachShader(program, fragmentShader);
    console.log(<span class="org-string">" [TRACE] Attach fragment shader Ok"</span>);
    gl.linkProgram(program);
    <span class="org-keyword">var</span> <span class="org-variable-name">success</span> = gl.getProgramParameter(program, gl.LINK_STATUS);
    <span class="org-keyword">if</span> (success) {
      <span class="org-keyword">return</span> program;
    }

    console.error(gl.getProgramInfoLog(program));
    gl.deleteProgram(program);
}


<span class="org-keyword">function</span> <span class="org-function-name">resizeCanvasToDisplaySize</span>(<span class="org-variable-name">canvas</span>, <span class="org-variable-name">multiplier</span>) 
{
    multiplier = multiplier || 1;
    <span class="org-keyword">const</span> <span class="org-variable-name">width</span>  = canvas.clientWidth  * multiplier | 0;
    <span class="org-keyword">const</span> <span class="org-variable-name">height</span> = canvas.clientHeight * multiplier | 0;
    <span class="org-keyword">if</span> (canvas.width !== width ||  canvas.height !== height) {
      canvas.width  = width;
      canvas.height = height;
      <span class="org-keyword">return</span> <span class="org-constant">true</span>;
    }
    <span class="org-keyword">return</span> <span class="org-constant">false</span>;
}

<span class="org-comment-delimiter">// </span><span class="org-comment">Vertex Buffer Object abstraction </span>
<span class="org-keyword">class</span> Vbuffer 
{
  constructor(gl, attr_position, attr_color)
  {
    <span class="org-constant">this</span>._gl = gl;
    <span class="org-constant">this</span>._vbo = gl.createBuffer();   
    <span class="org-constant">this</span>._data = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(1);
    <span class="org-constant">this</span>._attr_position = attr_position;
    <span class="org-constant">this</span>._attr_color = attr_color;
    <span class="org-constant">this</span>._vertices = 0;
  }

  unbind()
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">gl</span> = <span class="org-constant">this</span>._gl;
    gl.bindBuffer(gl.ARRAY_BUFFER, <span class="org-constant">null</span>);
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Release the VBO from the GPU </span>
  free()
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">gl</span> = <span class="org-constant">this</span>._gl;
    gl.deleteBuffer(<span class="org-constant">this</span>._vbo);
  }

  setData(data, ncomps = 3, stride = 0, istride = 0 )
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">gl</span> = <span class="org-constant">this</span>._gl;
    <span class="org-constant">this</span>._ncomps = ncomps;
    <span class="org-constant">this</span>._stride = stride; 
    <span class="org-constant">this</span>._istide = 0;
    <span class="org-constant">this</span>._vertices = data.length;
    gl.bindBuffer( gl.ARRAY_BUFFER, <span class="org-constant">this</span>._vbo );
    <span class="org-constant">this</span>._data = <span class="org-keyword">new</span> <span class="org-type">Float32Array</span>(data);
    <span class="org-comment-delimiter">// </span><span class="org-comment">Send data to GPU</span>
    gl.bufferData(gl.ARRAY_BUFFER, <span class="org-constant">this</span>._data, gl.STATIC_DRAW);
  }

  drawTriangles()
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">gl</span> = <span class="org-constant">this</span>._gl;
    <span class="org-constant">this</span>.draw(gl.TRIANGLES);
  }

  drawLines()
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">gl</span> = <span class="org-constant">this</span>._gl;
    <span class="org-constant">this</span>.draw(gl.LINES);
  }

  drawLineLoop()
  {

    <span class="org-keyword">let</span> <span class="org-variable-name">gl</span> = <span class="org-constant">this</span>._gl;
    <span class="org-constant">this</span>.draw(gl.LINE_LOOP);
  }

  draw(drawType)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">gl</span> = <span class="org-constant">this</span>._gl;
    gl.bindBuffer( gl.ARRAY_BUFFER, <span class="org-constant">this</span>._vbo );

    <span class="org-comment-delimiter">// </span><span class="org-comment">Position data layout for each vertex </span>
    gl.vertexAttribPointer(  <span class="org-constant">this</span>._attr_position  <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute </span>
                           , 3                    <span class="org-comment-delimiter">// </span><span class="org-comment">Number of components, coordinates</span>
                           , gl.FLOAT             <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each componente</span>
                           , <span class="org-constant">false</span>                <span class="org-comment-delimiter">// </span><span class="org-comment">Normalized flag </span>
                           , 24                   <span class="org-comment-delimiter">// </span><span class="org-comment">Stride  = sizeof(Vertex) = sizeof(Position) + sizeof(Color) = </span>
                                                  <span class="org-comment-delimiter">// </span><span class="org-comment">Stride  = 3 * sizeof(Float in bytes) + 3 * sizeof(Float in bytes) </span>
                                                  <span class="org-comment-delimiter">// </span><span class="org-comment">Stride  = 3 * 4 + 3 * 4 = 24  </span>
                           , 0                    <span class="org-comment-delimiter">// </span><span class="org-comment">offset  </span>
                          );

    <span class="org-comment-delimiter">// </span><span class="org-comment">Color data layout for each vertex  </span>
    gl.vertexAttribPointer(  <span class="org-constant">this</span>._attr_color     <span class="org-comment-delimiter">// </span><span class="org-comment">Shader attribute </span>
                           , 3                    <span class="org-comment-delimiter">// </span><span class="org-comment">Number of components, coordinates</span>
                           , gl.FLOAT             <span class="org-comment-delimiter">// </span><span class="org-comment">Type of each componente</span>
                           , <span class="org-constant">false</span>                <span class="org-comment-delimiter">// </span><span class="org-comment">Normalized flag </span>
                           , 24                   <span class="org-comment-delimiter">// </span><span class="org-comment">Stride </span>
                           , 12                   <span class="org-comment-delimiter">// </span><span class="org-comment">offset - offset of color attribute = 3 * sizeof(float) =  3 * 4 = 12 </span>
                          );


    <span class="org-comment-delimiter">// </span><span class="org-comment">Each vertex has 6 coordinates - 3 coordinates for position and 3 coordinates for color</span>
    gl.drawArrays(drawType, 0, <span class="org-constant">this</span>._vertices / 6);

    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO and disable global state </span>
    gl.bindBuffer( gl.ARRAY_BUFFER, <span class="org-constant">null</span>);
  }
}

<span class="org-keyword">class</span> Camera
{
  constructor(gl, uniform_view, uniform_proj, uniform_eye)
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current location of camera in world coordinates</span>
    <span class="org-constant">this</span>.eye     = [  2.0, 4.0,  5.0 ];
    <span class="org-comment-delimiter">// </span><span class="org-comment">Direction to where camera is looking at.</span>
    <span class="org-constant">this</span>.forward = [ -1.0, 0.0, -1.0 ];
    <span class="org-comment-delimiter">// </span><span class="org-comment">UP vector - camera orientation (default Y axis)</span>
    <span class="org-constant">this</span>.up      = [  0.0, 1.0,  0.0 ];

    <span class="org-comment-delimiter">// </span><span class="org-comment">Field of view angle stated in degrees  </span>
    <span class="org-constant">this</span>.fov_angle = 60.0; 
    <span class="org-comment-delimiter">// </span><span class="org-comment">Aspect ratio  </span>
    <span class="org-constant">this</span>.aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Far </span>
    <span class="org-constant">this</span>.zFar = 100.0;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Near </span>
    <span class="org-constant">this</span>.zNear = 0.1;

    <span class="org-constant">this</span>.gl = gl;
    <span class="org-constant">this</span>.uniform_view = uniform_view;
    <span class="org-constant">this</span>.uniform_proj = uniform_proj;
    <span class="org-constant">this</span>.uniform_eye  = uniform_eye;

    <span class="org-constant">this</span>.updateView();

    console.log(<span class="org-string">" [TRACE] Crated Camera Ok."</span>);
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Reset camera to initial position</span>
  reset()
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current location of camera in world coordinates</span>
    <span class="org-constant">this</span>.eye     = [  2.0, 4.0,  5.0 ];
    <span class="org-comment-delimiter">// </span><span class="org-comment">Direction to where camera is looking at.</span>
    <span class="org-constant">this</span>.forward = [ -1.0, 0.0, -1.0 ];
    <span class="org-comment-delimiter">// </span><span class="org-comment">Direction to where camera is looking at.</span>
    <span class="org-constant">this</span>.up      = [  0.0, 1.0,  0.0 ];
    <span class="org-comment-delimiter">// </span><span class="org-comment">Field of view angle stated in radians. It is by default 60 degrees.</span>
    <span class="org-constant">this</span>.fov_angle = 60.0; <span class="org-comment-delimiter">//</span><span class="org-comment">* Math.PI / 180.0;</span>
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's Up vecto.</span>
  rotateYaw(angle)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">q</span> = Quaternion.createFromAxisAngle(angle, <span class="org-constant">this</span>.up);
    <span class="org-constant">this</span>.forward = q.rotateVector(<span class="org-constant">this</span>.forward);
    <span class="org-constant">this</span>.updateView();
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's pitch axis (X axis) elevate camera view.</span>
  rotatePitch(angle)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">axis</span> = cross(<span class="org-constant">this</span>.up, <span class="org-constant">this</span>.forward);
    <span class="org-keyword">let</span> <span class="org-variable-name">q</span> = Quaternion.createFromAxisAngle(angle, axis);
    <span class="org-constant">this</span>.forward = q.rotateVector(<span class="org-constant">this</span>.forward);
    <span class="org-constant">this</span>.updateView();
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera in Y axis </span>
  moveCameraUpDow(factor)
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">Increase of decrease Y component of Eye vector</span>
    <span class="org-constant">this</span>.eye[1] = <span class="org-constant">this</span>.eye[1] + factor;
    <span class="org-constant">this</span>.updateView();
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Make the vector forward parallel to the plane XZ</span>
  parallelXZ()
  {
    <span class="org-constant">this</span>.forward[1] = 0.0; 
    <span class="org-constant">this</span>.updateView();
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

     <span class="org-comment-delimiter">// </span><span class="org-comment">Move at forward vector direction (to where camera is looking at).</span>
  moveForward(factor)
  {
      <span class="org-comment-delimiter">// </span><span class="org-comment">this-&gt;eye = this-&gt;eye + factor * this-&gt;forward;</span>
      <span class="org-keyword">let</span> [<span class="org-variable-name">ex</span>, <span class="org-variable-name">ey</span>, <span class="org-variable-name">ez</span>] = <span class="org-constant">this</span>.eye; 
      <span class="org-keyword">let</span> [<span class="org-variable-name">fx</span>, <span class="org-variable-name">fy</span>, <span class="org-variable-name">fz</span>] = <span class="org-constant">this</span>.forward;
      <span class="org-constant">this</span>.eye = [ex + factor * fx, ey + factor * fz, ez + factor * fz];
      <span class="org-constant">this</span>.updateView();
      <span class="org-keyword">return</span> <span class="org-constant">this</span>
  }

  <span class="org-comment-delimiter">// </span><span class="org-comment">Set camera position in world coordinates </span>
  setPosition(position)
  {
    <span class="org-constant">this</span>.eye = position; 
    <span class="org-constant">this</span>.updateView();
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  setPositonXYZ(x, y, z)
  {
    <span class="org-constant">this</span>.setPosition([x, y, z]);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  lookAt(at)
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set position to where camera is looking at.</span>
    <span class="org-constant">this</span>.forward = diff(at, <span class="org-constant">this</span>.eye) ;
    <span class="org-constant">this</span>.updateView();
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  lookAtXYZ(x, y, z)
  {
    <span class="org-constant">this</span>.lookAt([x, y, z]);
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }


  updateView() 
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">Perspective/Projection matrix </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Tp = glm::perspective( fov_angle, aspect, zNear, zFar );</span>
    <span class="org-keyword">const</span> <span class="org-variable-name">Tp</span> = <span class="org-keyword">new</span> <span class="org-type">Matrix4x4</span>(); 
    Tp.setPerspective(<span class="org-constant">this</span>.fov_angle, <span class="org-constant">this</span>.aspect, <span class="org-constant">this</span>.zNear, <span class="org-constant">this</span>.zFar);
    <span class="org-comment-delimiter">// </span><span class="org-comment">console.log(" [TRACE] Tp = ", Tp);</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">View matrix </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">auto Tview = glm::lookAt(eye, cam_at, up);</span>
    <span class="org-keyword">const</span> <span class="org-variable-name">Tv</span> = <span class="org-keyword">new</span> <span class="org-type">Matrix4x4</span>();
    <span class="org-comment-delimiter">// </span><span class="org-comment">Location where camera is looking at in world coordinates </span>
    <span class="org-keyword">const</span> <span class="org-variable-name">at</span> = [ <span class="org-constant">this</span>.eye[0] + <span class="org-constant">this</span>.forward[0], <span class="org-constant">this</span>.eye[1] + <span class="org-constant">this</span>.forward[1], <span class="org-constant">this</span>.eye[2] + <span class="org-constant">this</span>.forward[2] ];
    Tv.setLookAt(<span class="org-constant">this</span>.eye, at, <span class="org-constant">this</span>.up);
    <span class="org-comment-delimiter">// </span><span class="org-comment">console.log(" [TRACE] Tv = ", Tv);</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">glUniformMatrix4fv(shader_uniform_view, 1, GL_FALSE, glm::value_ptr(Tview) );</span>
    <span class="org-constant">this</span>.gl.uniformMatrix4fv(<span class="org-constant">this</span>.uniform_view, <span class="org-constant">false</span>, Tv.mat);

    <span class="org-comment-delimiter">// </span><span class="org-comment">glUniformMatrix4fv(shader_uniform_proj, 1, GL_FALSE, glm::value_ptr(Tproj) );</span>
    <span class="org-constant">this</span>.gl.uniformMatrix4fv(<span class="org-constant">this</span>.uniform_proj, <span class="org-constant">false</span>, Tp.mat);

  }

  setIdentity()
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">m</span> = <span class="org-keyword">new</span> <span class="org-type">Matrix4x4</span>();
    <span class="org-constant">this</span>.gl.uniformMatrix4fv(<span class="org-constant">this</span>.uniform_view, <span class="org-constant">false</span>, m.mat);
    <span class="org-constant">this</span>.gl.uniformMatrix4fv(<span class="org-constant">this</span>.uniform_proj, <span class="org-constant">false</span>, m.mat);
  }

}


<span class="org-doc">/** Encapsulates the position, scale and  rotation of an object in the space */</span>
<span class="org-keyword">class</span> Orientation
{
  constructor()
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">Default scale 1.0 - original object size </span>
    <span class="org-constant">this</span>._scale     = 1.0; 
    <span class="org-comment-delimiter">// </span><span class="org-comment">Default position at origin </span>
    <span class="org-constant">this</span>._position  = [0.0, 0.0, 0.0];
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unit quaternion </span>
    <span class="org-constant">this</span>._rotation = Quaternion.create(1.0, 0.0, 0.0, 0.0);
    <span class="org-constant">this</span>._is_changed = <span class="org-constant">false</span>;
    <span class="org-constant">this</span>._model = Matrix4x4.create()
                          .translateV(<span class="org-constant">this</span>._position)
                          .scale(<span class="org-constant">this</span>._scale)
                          .rotateQuaternion(<span class="org-constant">this</span>._rotation)
  }

  reset()
  {
    <span class="org-constant">this</span>._scale     = 1.0; 
    <span class="org-constant">this</span>._position  = [0.0, 0.0, 0.0];
    <span class="org-constant">this</span>.__rotation = Quaternion.create(1.0, 0.0, 0.0);
    <span class="org-constant">this</span>._is_changed = <span class="org-constant">true</span>;
  }

  setPosition(x, y, z)
  {
    <span class="org-constant">this</span>._position = [x, y, z];
    <span class="org-constant">this</span>._is_changed = <span class="org-constant">true</span>;
  }

  translate(dx, dy, dz)
  {
      <span class="org-constant">this</span>._position[0] += dx;
      <span class="org-constant">this</span>._position[1] += dy;
      <span class="org-constant">this</span>._position[2] += dz;
      <span class="org-constant">this</span>._is_changed = <span class="org-constant">true</span>;
      <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  setScale(scale)
  {
      <span class="org-constant">this</span>.scale = scale;
      <span class="org-constant">this</span>.is_changed = <span class="org-constant">true</span>;
      <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  rotateZ(angle)
  {
    <span class="org-comment-delimiter">// </span><span class="org-comment">console.log(" [TRACE] Rotating angle = ", angle);</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">this.angle = this.angle + angle;</span>
    <span class="org-constant">this</span>.rotate(angle, [0.0, 0.0, 1.0]);
    <span class="org-constant">this</span>._is_changed = <span class="org-constant">true</span>;
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  rotate(angle, axis)
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">q</span> = Quaternion.createFromAxisAngle(angle, axis);
    <span class="org-constant">this</span>._rotation = <span class="org-constant">this</span>._rotation.multiply(q);
    <span class="org-constant">this</span>._is_changed = <span class="org-constant">true</span>;
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  getModel()
  {
    <span class="org-keyword">if</span>( <span class="org-constant">this</span>._is_changed )
    {
        <span class="org-constant">this</span>._is_changed = <span class="org-constant">false</span>;
        <span class="org-constant">this</span>._model.setToIdentity()
                  .translateV(<span class="org-constant">this</span>._position)
                  .scale(<span class="org-constant">this</span>._scale)
                  .rotateQuaternion(<span class="org-constant">this</span>._rotation);
    }
    <span class="org-keyword">return</span> <span class="org-constant">this</span>._model;
  }

}

<span class="org-keyword">class</span> Entity 
{
  constructor(gl, vbo, u_model, drawType)
  {
    <span class="org-constant">this</span>.gl = gl;
    <span class="org-constant">this</span>.vbo = vbo; 
    <span class="org-constant">this</span>.u_model = u_model;

    <span class="org-constant">this</span>.is_visible = <span class="org-constant">true</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw Triangles by default </span>
    <span class="org-constant">this</span>.drawType = drawType; 
    <span class="org-constant">this</span>.orientaton = <span class="org-keyword">new</span> <span class="org-type">Orientation</span>();
  }

  setDrawTriangles() { <span class="org-constant">this</span>.drawType = <span class="org-constant">this</span>.gl.TRIANGLES; <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  setDrawLines() { <span class="org-constant">this</span>.drawType = <span class="org-constant">this</span>.gl.LINES;         <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  setDrawLineLoop() { <span class="org-constant">this</span>.drawType = <span class="org-constant">this</span>.gl.LINE_LOOP;  <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  setVisible(flag) { <span class="org-constant">this</span>.is_visible = flag;              <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  toggleVisible() { <span class="org-constant">this</span>.is_visible = !<span class="org-constant">this</span>.is_visible;         <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  setPosition(x, y, z) { <span class="org-constant">this</span>.orientaton.setPosition(x, y, z);  <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  translate(dx, dy, dz){ <span class="org-constant">this</span>.orientaton.translate(dx, dy, dz); <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  setScale(k){ <span class="org-constant">this</span>.orientaton.setScale(k);                     <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  rotateZ(angle){ <span class="org-constant">this</span>.orientaton.rotateZ(angle);               <span class="org-keyword">return</span> <span class="org-constant">this</span>; }
  rotate(angle, axis){ <span class="org-constant">this</span>.orientaton.rotate(angle, axis);     <span class="org-keyword">return</span> <span class="org-constant">this</span>; }

  draw() 
  {
    <span class="org-keyword">let</span> <span class="org-variable-name">model</span> = <span class="org-constant">this</span>.orientaton.getModel();
    <span class="org-keyword">if</span>( <span class="org-constant">this</span>.is_visible )
    {
       <span class="org-constant">this</span>.gl.uniformMatrix4fv(u_model, <span class="org-constant">false</span>, model.mat); 
       <span class="org-constant">this</span>.vbo.draw(<span class="org-constant">this</span>.drawType);
    }
  }
}

<span class="org-keyword">class</span> EntityFactory 
{

  <span class="org-doc">/** @param {Vbuffer} - vbo */</span>
  constructor(gl, vbo, u_model)
  {
    <span class="org-constant">this</span>.gl = gl; 
    <span class="org-constant">this</span>.vbo = vbo;
    <span class="org-constant">this</span>.u_model = u_model;
    <span class="org-constant">this</span>.drawType = gl.TRIANGLES;
  }

  setDrawTriangles()
  {
    <span class="org-constant">this</span>.drawType = <span class="org-constant">this</span>.gl.TRIANGLES;
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  setDrawLines()
  {
    <span class="org-constant">this</span>.drawType = <span class="org-constant">this</span>.gl.LINES;
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  setDrawLineLoop()
  {
    <span class="org-constant">this</span>.drawType = <span class="org-constant">this</span>.gl.LINE_LOOP;
    <span class="org-keyword">return</span> <span class="org-constant">this</span>;
  }

  create()
  {
      <span class="org-keyword">return</span> <span class="org-keyword">new</span> <span class="org-type">Entity</span>(<span class="org-constant">this</span>.gl, <span class="org-constant">this</span>.vbo, <span class="org-constant">this</span>.u_model, <span class="org-constant">this</span>.drawType);
  }
}

    <span class="org-comment-delimiter">// </span><span class="org-comment">----- R E N D E R I N  G ------------------//</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Vertex Shader code =&gt; Performs vertex coordinate transforms in the GPU </span>
<span class="org-keyword">let</span> <span class="org-variable-name">code_shader_vert</span> =<span class="org-string">` </span>
<span class="org-string">  // precision mediump float;</span>

<span class="org-string">  // Note: keyword attribute is deprecated </span>
<span class="org-string">  attribute vec3 position;</span>
<span class="org-string">  attribute vec3 color; </span>

<span class="org-string">  varying vec3 out_color;</span>

<span class="org-string">  uniform vec3 u_eye;         // Cameras's position in space</span>
<span class="org-string">  uniform mat4 u_model;       // Model matrix </span>
<span class="org-string">  uniform mat4 u_view;        // Camera's view matrix    </span>
<span class="org-string">  uniform mat4 u_projection;  // Camera's projection matrix </span>

<span class="org-string">  void main(){</span>

<span class="org-string">    gl_Position = u_projection * u_view * u_model * vec4(position, 1.0);</span>

<span class="org-string">    // Forward to fragment shader </span>
<span class="org-string">    out_color = color; </span>

<span class="org-string">  }</span>
<span class="org-string">`</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Fragment shader code =&gt; Sets color, lights and illumination </span>
<span class="org-keyword">let</span> <span class="org-variable-name">code_shader_frag</span> = <span class="org-string">`</span>
<span class="org-string">   // precision mediump float;</span>

<span class="org-string">   // varying low vec3 out_color;</span>
<span class="org-string">   varying lowp vec3 out_color;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">      gl_FragColor = vec4(out_color, 1.0);</span>
<span class="org-string">      //gl_FragColor = vec4(0, 0, 1.0, 1.0);</span>
<span class="org-string">    }</span>
<span class="org-string">`</span>;

  <span class="org-comment-delimiter">// </span><span class="org-comment">----------- Rendering Starts Here -----------//</span>


<span class="org-keyword">const</span> <span class="org-variable-name">canvas</span> = document.querySelector(<span class="org-string">"#glCanvas"</span>);
<span class="org-keyword">const</span> <span class="org-variable-name">gl</span> = canvas.getContext(<span class="org-string">"webgl"</span>);

<span class="org-keyword">if</span>(  gl == <span class="org-constant">null</span> ){
  alert(<span class="org-string">" [ABORT] Unable to initialized WebGL"</span>);
}

console.log(<span class="org-string">" [DEBUG] OpenGL version = "</span> + gl.getParameter(gl.VERSION) );
console.log(<span class="org-string">" [DEBUG] Shading language version = "</span> + gl.getParameter(gl.SHADING_LANGUAGE_VERSION));

document.querySelector(<span class="org-string">"#output1"</span>).textContent = gl.getParameter(gl.VERSION);
document.querySelector(<span class="org-string">"#output2"</span>).textContent =  gl.getParameter(gl.SHADING_LANGUAGE_VERSION);

<span class="org-keyword">let</span> <span class="org-variable-name">prog</span> =  compileShaderProgram(gl, code_shader_vert, code_shader_frag);
gl.useProgram(prog);

<span class="org-comment-delimiter">// </span><span class="org-comment">Uniform variables </span>
<span class="org-keyword">let</span> <span class="org-variable-name">u_proj</span>       = gl.getUniformLocation( prog, <span class="org-string">"u_projection"</span>);
<span class="org-keyword">let</span> <span class="org-variable-name">u_view</span>       = gl.getUniformLocation( prog, <span class="org-string">"u_view"</span>);
<span class="org-keyword">let</span> <span class="org-variable-name">u_model</span>      = gl.getUniformLocation( prog, <span class="org-string">"u_model"</span>);
<span class="org-keyword">let</span> <span class="org-variable-name">u_camera_eye</span> = gl.getUniformLocation( prog, <span class="org-string">"u_eye"</span>);

<span class="org-comment-delimiter">// </span><span class="org-comment">Attribute Locations </span>
<span class="org-keyword">let</span> <span class="org-variable-name">attr_position</span> = gl.getAttribLocation(prog, <span class="org-string">"position"</span>);
<span class="org-keyword">let</span> <span class="org-variable-name">attr_color</span>    = gl.getAttribLocation(prog, <span class="org-string">"color"</span>);

<span class="org-keyword">let</span> <span class="org-variable-name">identity</span> = <span class="org-keyword">new</span> <span class="org-type">Matrix4x4</span>();

<span class="org-comment-delimiter">// </span><span class="org-comment">Initialize with identity matrix </span>
gl.uniformMatrix4fv(u_model, <span class="org-constant">false</span>, identity.mat); 
gl.uniformMatrix4fv(u_view,  <span class="org-constant">false</span>, identity.mat); 
gl.uniformMatrix4fv(u_proj,  <span class="org-constant">false</span>, identity.mat);


<span class="org-keyword">function</span> <span class="org-function-name">buildGridPlaneXY</span>(<span class="org-variable-name">gl</span>, <span class="org-variable-name">attr_position</span>, <span class="org-variable-name">attr_color</span>, <span class="org-variable-name">n</span> , <span class="org-variable-name">delta</span>)
{
    <span class="org-keyword">let</span> <span class="org-variable-name">vertices</span> = [];

    <span class="org-keyword">let</span> <span class="org-variable-name">xmax</span> = n * delta; 
    <span class="org-keyword">let</span> <span class="org-variable-name">ymax</span> = n * delta;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw lines in plane XY parallel to line X </span>
    <span class="org-keyword">for</span>(<span class="org-keyword">let</span> <span class="org-variable-name">i</span> = 0; i &lt; n; i++)
    {
      <span class="org-comment-delimiter">// </span><span class="org-comment">Position of first vertex </span>
      <span class="org-keyword">let</span> <span class="org-variable-name">position1</span> = [0.0, i * delta, 0.0 ];
      <span class="org-comment-delimiter">// </span><span class="org-comment">Positon of first line vertex   </span>
      vertices.push(...position1);    
      <span class="org-comment-delimiter">// </span><span class="org-comment">Color of second line vertex </span>
      vertices.push(...COLOR_BLUE);   

      <span class="org-comment-delimiter">// </span><span class="org-comment">Position of second vertex  </span>
      <span class="org-keyword">let</span> <span class="org-variable-name">position2</span> = [xmax, i * delta, 0.0];
      <span class="org-comment-delimiter">// </span><span class="org-comment">Positon of first line vertex   </span>
      vertices.push(...position2);    
      <span class="org-comment-delimiter">// </span><span class="org-comment">Color of second line vertex </span>
      vertices.push(...COLOR_BLUE);   
    }

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw lines in plane XY parallel to line Y</span>
    <span class="org-keyword">for</span>(<span class="org-keyword">let</span> <span class="org-variable-name">j</span> = 0; j &lt; n; j++)
    {
      <span class="org-comment-delimiter">// </span><span class="org-comment">Position of first vertex </span>
      <span class="org-keyword">let</span> <span class="org-variable-name">position1</span> = [j * delta, 0.0, 0.0 ];
      <span class="org-comment-delimiter">// </span><span class="org-comment">Positon of first line vertex   </span>
      vertices.push(...position1);    
      <span class="org-comment-delimiter">// </span><span class="org-comment">Color of second line vertex </span>
      vertices.push(...COLOR_GREEN);   

      <span class="org-comment-delimiter">// </span><span class="org-comment">Position of second vertex  </span>
      <span class="org-keyword">let</span> <span class="org-variable-name">position2</span> = [j * delta, ymax, 0.0];
      <span class="org-comment-delimiter">// </span><span class="org-comment">Positon of first line vertex   </span>
      vertices.push(...position2);    
      <span class="org-comment-delimiter">// </span><span class="org-comment">Color of second line vertex </span>
      vertices.push(...COLOR_GREEN);   
    }

    <span class="org-keyword">let</span> <span class="org-variable-name">buffer</span> = <span class="org-keyword">new</span> <span class="org-type">Vbuffer</span>(gl, attr_position, attr_color);
    buffer.setData(vertices);
    <span class="org-keyword">return</span> buffer;
}

<span class="org-keyword">function</span> <span class="org-function-name">buildTetrahedron</span>(<span class="org-variable-name">gl</span>, <span class="org-variable-name">attr_position</span>, <span class="org-variable-name">attr_color</span>, <span class="org-variable-name">size</span>)
{
  <span class="org-keyword">let</span> <span class="org-variable-name">k</span> = size;
  <span class="org-comment-delimiter">// </span><span class="org-comment">Position of Tetrahedron vertices </span>
  <span class="org-keyword">let</span> <span class="org-variable-name">a</span> = [0, 0, k];  <span class="org-comment-delimiter">// </span><span class="org-comment">Point in Z axis </span>
  <span class="org-keyword">let</span> <span class="org-variable-name">b</span> = [k, 0, 0];  <span class="org-comment-delimiter">// </span><span class="org-comment">Point in X axis </span>
  <span class="org-keyword">let</span> <span class="org-variable-name">c</span> = [0, k, 0];  <span class="org-comment-delimiter">// </span><span class="org-comment">Point in Y axis </span>
  <span class="org-keyword">let</span> <span class="org-variable-name">d</span> = [0, 0, 0];  <span class="org-comment-delimiter">// </span><span class="org-comment">Point in origin </span>

  <span class="org-keyword">let</span> <span class="org-variable-name">COLOR_Triangle1</span> = COLOR_BLUE;
  <span class="org-keyword">let</span> <span class="org-variable-name">COLOR_Triangle2</span> = COLOR_GREEN;
  <span class="org-keyword">let</span> <span class="org-variable-name">COLOR_Triangle3</span> = COLOR_RED;
  <span class="org-keyword">let</span> <span class="org-variable-name">COLOR_Triangle4</span> = COLOR_YELLLOW;

  <span class="org-keyword">let</span> <span class="org-variable-name">vertices</span> = [];

  <span class="org-comment-delimiter">// </span><span class="org-comment">triangle vertices of face 1</span>
  vertices.push(...a, ...COLOR_Triangle1);
  vertices.push(...b, ...COLOR_Triangle1);
  vertices.push(...c, ...COLOR_Triangle1);

  <span class="org-comment-delimiter">// </span><span class="org-comment">triangle vertices of face 2</span>
  vertices.push(...a, ...COLOR_Triangle2);
  vertices.push(...c, ...COLOR_Triangle2);
  vertices.push(...d, ...COLOR_Triangle2);

  <span class="org-comment-delimiter">// </span><span class="org-comment">triangle vertices of face 3</span>
  vertices.push(...a, ...COLOR_Triangle3);
  vertices.push(...b, ...COLOR_Triangle3);
  vertices.push(...d, ...COLOR_Triangle3);

  <span class="org-comment-delimiter">// </span><span class="org-comment">triangle vertices of face 4</span>
  vertices.push(...d, ...COLOR_Triangle4);
  vertices.push(...c, ...COLOR_Triangle4);
  vertices.push(...b, ...COLOR_Triangle4);

  <span class="org-comment-delimiter">// </span><span class="org-comment">console.log(" [TRACE] vertices = ", vertices);</span>

  <span class="org-keyword">let</span> <span class="org-variable-name">buffer</span> = <span class="org-keyword">new</span> <span class="org-type">Vbuffer</span>(gl, attr_position, attr_color);
  buffer.setData(vertices);
  <span class="org-keyword">return</span> buffer;
}

<span class="org-comment-delimiter">// </span><span class="org-comment">Note: OpenGL can only draw triangles and lines. </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Therefore, the only way to draw a cube solid is to </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">draw the triangles for every face of the  cube.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">As a cube has 6 face and two triangles for every </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">face, it is necessary to draw 12 triangles. </span>
<span class="org-keyword">function</span> <span class="org-function-name">buildCube</span>(<span class="org-variable-name">gl</span>, <span class="org-variable-name">attr_position</span>, <span class="org-variable-name">attr_color</span>, <span class="org-variable-name">size</span>)
{
  <span class="org-keyword">let</span> <span class="org-variable-name">k</span> = size; 
  <span class="org-comment-delimiter">// </span><span class="org-comment">Cube vertices </span>
  <span class="org-comment-delimiter">//       </span><span class="org-comment">x  y  z</span>
  <span class="org-keyword">let</span> <span class="org-variable-name">a</span> = [0, 0, k];
  <span class="org-keyword">let</span> <span class="org-variable-name">b</span> = [0, k, k];
  <span class="org-keyword">let</span> <span class="org-variable-name">c</span> = [k, k, k];
  <span class="org-keyword">let</span> <span class="org-variable-name">d</span> = [k, 0, k];
  <span class="org-keyword">let</span> <span class="org-variable-name">e</span> = [k, 0, 0];
  <span class="org-keyword">let</span> <span class="org-variable-name">f</span> = [k, k, 0];
  <span class="org-keyword">let</span> <span class="org-variable-name">g</span> = [0, k, 0];
  <span class="org-keyword">let</span> <span class="org-variable-name">h</span> = [0, 0, 0];

  <span class="org-keyword">let</span> <span class="org-variable-name">vertices</span> = [];

  <span class="org-keyword">function</span> <span class="org-function-name">triangle</span>(<span class="org-variable-name">t1</span>, <span class="org-variable-name">t2</span>, <span class="org-variable-name">t3</span>, <span class="org-variable-name">color</span>)
  {
    vertices.push(...t1, ...color);
    vertices.push(...t2, ...color);
    vertices.push(...t3, ...color);
  }
  <span class="org-comment-delimiter">// </span><span class="org-comment">Face 1 of cube </span>
  triangle(a, b, c, COLOR_BLUE);
  triangle(a, c, d, COLOR_BLUE);
  <span class="org-comment-delimiter">// </span><span class="org-comment">Face 2 of cube </span>
  triangle(c, d, e, COLOR_DARK_GREEN);
  triangle(c, f, e, COLOR_DARK_BLUE);
  <span class="org-comment-delimiter">// </span><span class="org-comment">Face 3 of cube </span>
  triangle(a, d, e, COLOR_GREEN);
  triangle(a, h, e, COLOR_GREEN);
  <span class="org-comment-delimiter">// </span><span class="org-comment">Face  4 of cube </span>
  triangle(a, h, g, COLOR_YELLLOW);
  triangle(a, b, g, COLOR_YELLLOW);
  <span class="org-comment-delimiter">// </span><span class="org-comment">Face  5 of cube </span>
  triangle(b, c, g, COLOR_GRAY);
  triangle(c, g, f, COLOR_GRAY);
  <span class="org-comment-delimiter">// </span><span class="org-comment">Face 6 of cube </span>
  triangle(g, h, f, COLOR_RED);
  triangle(h, f, e, COLOR_RED);

  console.log(<span class="org-string">" [TRACE] vertices = "</span>, vertices);

  <span class="org-keyword">let</span> <span class="org-variable-name">buffer</span> = <span class="org-keyword">new</span> <span class="org-type">Vbuffer</span>(gl, attr_position, attr_color);
  buffer.setData(vertices);
  <span class="org-keyword">return</span> buffer;
}


<span class="org-comment-delimiter">// </span><span class="org-comment">Vertices of (x, y) coordinates </span>
<span class="org-keyword">let</span> <span class="org-variable-name">vertices_triangle</span> = [
   <span class="org-comment-delimiter">// </span><span class="org-comment">--- Vertices ----- //  // (R, G, B) --- Colors -----//</span>
    -0.25,  -0.25,  0,      1.0, 0.0, 0.0
  ,  0.00,  +0.25,  0,      0.0, 1.0, 0.0
  , +0.25,  -0.25,  0,      0.0, 0.0, 1.0  
]; 

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload vertices GPU </span>

<span class="org-keyword">let</span> <span class="org-variable-name">vboGrid</span> = buildGridPlaneXY(gl, attr_position, attr_color, 20, 0.1);
<span class="org-keyword">let</span> <span class="org-variable-name">gridFactory</span> = <span class="org-keyword">new</span> <span class="org-type">EntityFactory</span>(gl, vboGrid, u_model).setDrawLines();
<span class="org-keyword">let</span> <span class="org-variable-name">gridXY</span> = gridFactory.create();
<span class="org-keyword">let</span> <span class="org-variable-name">gridXZ</span> = gridFactory.create().rotate(90.0, [1.0, 0.0, 0.0]);


<span class="org-keyword">let</span> <span class="org-variable-name">vboTetrahedron</span> = buildTetrahedron(gl, attr_position, attr_color, 0.50);
<span class="org-keyword">let</span> <span class="org-variable-name">TetrahedronFactory</span> = <span class="org-keyword">new</span> <span class="org-type">EntityFactory</span>(gl, vboTetrahedron, u_model);
<span class="org-keyword">let</span> <span class="org-variable-name">tetrahedron1</span> = TetrahedronFactory.create();
tetrahedron1.translate(0.6, 0.25, 0.70).rotate(70, [5, 2, 3]);

<span class="org-keyword">let</span> <span class="org-variable-name">tetrahedron2</span> = TetrahedronFactory.create();
tetrahedron2.setDrawLineLoop();
tetrahedron2.translate(1.0, 1.25, 0.9).rotate(70, [1, 2, 2]);

<span class="org-keyword">let</span> <span class="org-variable-name">vboCube</span> = buildCube(gl, attr_position, attr_color, 0.50);
<span class="org-keyword">let</span> <span class="org-variable-name">cubeFactory</span> = <span class="org-keyword">new</span> <span class="org-type">EntityFactory</span>(gl, vboCube, u_model);
<span class="org-keyword">let</span> <span class="org-variable-name">cube1</span> = cubeFactory.create().translate(0.9, 0.60, 0.50).rotate(80, [1, 1, 1]);


<span class="org-keyword">let</span> <span class="org-variable-name">vboTriangle</span> = <span class="org-keyword">new</span> <span class="org-type">Vbuffer</span>(gl, attr_position, attr_color);
vboTriangle.setData(vertices_triangle);
<span class="org-keyword">const</span> <span class="org-variable-name">triangleFactory</span> = <span class="org-keyword">new</span> <span class="org-type">EntityFactory</span>(gl, vboTriangle, u_model);

<span class="org-keyword">let</span> <span class="org-variable-name">triangle1</span> = triangleFactory.create();
triangle1.draw();

<span class="org-keyword">let</span> <span class="org-variable-name">triangle2</span> = triangleFactory.create();
triangle2.setPosition(0.60, 0.50, 0.0);
triangle2.setScale(1.25);
triangle2.draw();


gl.enableVertexAttribArray(attr_position);
gl.enableVertexAttribArray(attr_color);


<span class="org-keyword">let</span> <span class="org-variable-name">camera</span> = <span class="org-keyword">new</span> <span class="org-type">Camera</span>(gl, u_view, u_proj, u_camera_eye)
camera.setPosition( [2, 2, 2 ]).lookAt( [0, 0, 0] );



<span class="org-keyword">function</span> <span class="org-function-name">drawScene</span>()
{
    <span class="org-comment-delimiter">// </span><span class="org-comment">resizeCanvasToDisplaySize(gl.canvas);</span>
    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);
    <span class="org-comment-delimiter">// </span><span class="org-comment">Screen background color is black </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt; clearColor(Red intensity from 0 to 1, Green , Blue , Alpha)</span>
    gl.clearColor(0.0, 0.0, 0.0, 1.0);
    gl.clear(gl.COLOR_BUFFER_BIT);
    gl.clearDepth(1.0);         <span class="org-comment-delimiter">// </span><span class="org-comment">Clear everything</span>
    gl.enable(gl.DEPTH_TEST);   <span class="org-comment-delimiter">// </span><span class="org-comment">Enable depth testing</span>
    gl.depthFunc(gl.LEQUAL);    <span class="org-comment-delimiter">// </span><span class="org-comment">Near things obscure far things</span>
    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

    triangle1.draw();
    triangle2.draw();
    <span class="org-comment-delimiter">// </span><span class="org-comment">triangleA.draw();</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">triangleB.draw();</span>

    gridXY.draw(); 
    gridXZ.draw();

    tetrahedron1.draw();
    <span class="org-comment-delimiter">// </span><span class="org-comment">tetrahedron2.draw();</span>
    cube1.draw();

}

drawScene();

<span class="org-keyword">const</span> <span class="org-variable-name">KEY_ARROW_LEFT</span>  = 37; 
<span class="org-keyword">const</span> <span class="org-variable-name">KEY_ARROW_RIGHT</span> = 39;
<span class="org-keyword">const</span> <span class="org-variable-name">KEY_ARROW_DOWN</span>  = 40;
<span class="org-keyword">const</span> <span class="org-variable-name">KEY_ARROW_UP</span>    = 38;

<span class="org-keyword">function</span> <span class="org-function-name">precisionRound</span>(<span class="org-variable-name">vector</span>, <span class="org-variable-name">digits</span>)
{
  <span class="org-keyword">let</span> <span class="org-variable-name">factor</span> = Math.pow(10, digits);
  <span class="org-keyword">return</span> vector.map(x =&gt; Math.round(x * factor) / factor);
}

<span class="org-keyword">function</span> <span class="org-function-name">keyboardListener</span>(<span class="org-variable-name">event</span>)
{
    <span class="org-doc">/** @param {number} key */</span> 
    <span class="org-keyword">let</span> <span class="org-variable-name">key</span> = event.keyCode; 

    <span class="org-comment-delimiter">// </span><span class="org-comment">console.log(" [TRACE] type(event) = ", typeof(event));</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">console.log(" [TRACE] Event = ", event);</span>

    <span class="org-keyword">if</span>( key == KEY_ARROW_LEFT )
    {
      <span class="org-comment-delimiter">// </span><span class="org-comment">triangle1.translate(-0.10, 0.0, 0.0);</span>
      camera.rotateYaw(10.0);
    } 

    <span class="org-keyword">if</span>( key == KEY_ARROW_RIGHT  )
    {
      <span class="org-comment-delimiter">// </span><span class="org-comment">triangle1.translate(+0.10, 0.0, 0.0);</span>
      camera.rotateYaw(-10.0);
    } 

    <span class="org-keyword">if</span>( key == KEY_ARROW_UP  )
    {
      <span class="org-comment-delimiter">// </span><span class="org-comment">triangle1.translate(0.0, 0.1, 0.0);</span>
      camera.moveForward(0.2);
    } 

    <span class="org-keyword">if</span>( key == KEY_ARROW_DOWN  )
    {
      <span class="org-comment-delimiter">// </span><span class="org-comment">triangle1.translate(0.0, -0.1, 0.0);</span>
      camera.moveForward(-0.2);
    } 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Elevate camera view, rotate the forward vector upwards </span>
    <span class="org-keyword">if</span>( event.key == <span class="org-string">"a"</span> )
    {
      camera.rotatePitch(10.0);
    }

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate camera view downwards </span>
    <span class="org-keyword">if</span>( event.key == <span class="org-string">"s"</span>)
    {
      camera.rotatePitch(-10.0);
    }

    <span class="org-keyword">if</span>( event.key == <span class="org-string">"q"</span>)
    {
      cube1.rotate(25, [1, 2, 1]); 
    }

    <span class="org-keyword">if</span>( event.key == <span class="org-string">"w"</span>)
    {
      console.log(<span class="org-string">" Rotate -10 degrees "</span>);
      triangle1.rotateZ(-10.0);
    }

    <span class="org-keyword">if</span>( event.key == <span class="org-string">"o"</span>)
    {
      <span class="org-comment-delimiter">// </span><span class="org-comment">triangle1.setVisible(true);</span>
      cube1.setDrawTriangles();
    }

    <span class="org-keyword">if</span>(  event.key == <span class="org-string">"p"</span> )
    {
      <span class="org-comment-delimiter">// </span><span class="org-comment">triangle1.setVisible(false);</span>
      cube1.setDrawLineLoop();
    }

    <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera in the positive direction of Y axis </span>
    <span class="org-keyword">if</span>( event.key === <span class="org-string">"j"</span> ){ camera.moveCameraUpDow(+0.1); }
    <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera in the negative direction of Y axis </span>
    <span class="org-keyword">if</span>( event.key === <span class="org-string">"k"</span> ){ camera.moveCameraUpDow(-0.1); }

    <span class="org-comment-delimiter">// </span><span class="org-comment">Make the vector forward parallel to the plane XZ</span>
    <span class="org-keyword">if</span>( event.key == <span class="org-string">"h"</span>){ camera.parallelXZ(); }

    <span class="org-keyword">let</span> <span class="org-variable-name">eye</span> =  precisionRound(camera.eye, 3);
    <span class="org-keyword">let</span> <span class="org-variable-name">up</span> =   precisionRound(camera.up, 3);
    <span class="org-keyword">let</span> <span class="org-variable-name">forward</span> = precisionRound(camera.forward, 3);
    document.querySelector(<span class="org-string">"#output-camera"</span>).textContent = <span class="org-string">`eye = ${eye} ; up = ${up} ; forward = ${forward}`</span>;

    drawScene();
}

addEventListener(<span class="org-string">"keydown"</span>, keyboardListener);
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeaadfa1" class="outline-3">
<h3 id="orgeaadfa1"><span class="section-number-3">1.24</span> 3D - Quaternion</h3>
<div class="outline-text-3" id="text-1-24">
<p>
The class Transform has the fields, position for setting the object
position in world-coordinates; scale for adjusting object size and
rotation, which is a quaternion for encoding rotation around an
arbitrary axis. The use of quaternions saves the usage of many matrix
multiplications for each transform and also allows easier accumulation
of intermediate rotations.
</p>

<p>
Quaternions are also used in the camera class for providing
YRP (Yaw-Pitch-Roll) camera rotation and free movement in the
space. The keys arrow-left, arrow-right rotates the direction to where
camera is looking at to right or to the left. The key arrow-up, moves
the camera position in the direction to where the camera is looking
at. The key arrow-down moves the camera in the backward direction to
where the camera is looking at. The key 'S' rotates the camera up, the
key 'D' rotates the camera down.
</p>

<p>
The scene, has a blue square on the plane XY; a green square on plane
XZ; a teapot and torus. The torus can be moved, scaled and rotated in
the space by just changing its transform object parameters. By typing
the key 'B', the teapot scale is increased, and by typing 'N' its
scale is decrease. The keys 'J', 'L' rotates the teapot around the Y
axis. The key 'P' moves the teapot up across Y axis. The key 'O' moves
the teapot down across the Y axis.
</p>

<p>
Note: This code requires the GLUT library which provides the sample
wireframe teapot and torus.
</p>

<p>
<b>Screenshots</b>
</p>


<div class="figure">
<p><a href="images/opengl-draw3d-camera1.png"><img src="images/opengl-draw3d-camera1.png" alt="opengl-draw3d-camera1.png" /></a>
</p>
</div>


<div class="figure">
<p><a href="images/opengl-draw3d-camera2.png"><img src="images/opengl-draw3d-camera2.png" alt="opengl-draw3d-camera2.png" /></a>
</p>
</div>


<p>
<b>Code Highlights</b>
</p>

<p>
Transform class using quaternion:
</p>

<div class="org-src-container">
<pre class="src src-cpp">
<span class="org-comment-delimiter">// </span><span class="org-comment">Transform object that combines - translation, scale and rotation (quaternion)</span>
<span class="org-keyword">struct</span> <span class="org-type">Transform</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec4</span> <span class="org-variable-name">position</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.0, 0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">scale</span>    = <span class="org-rainbow-delimiters-depth-2">{</span>1.0, 1.0, 1.0<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">rotation</span> = <span class="org-rainbow-delimiters-depth-2">{</span>1.0, 0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">void</span> <span class="org-function-name">set_scale</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">k</span><span class="org-rainbow-delimiters-depth-2">){</span> scale<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>  = k; scale<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> = k;  scale<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span>  = k;  <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">add_scale</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">k</span><span class="org-rainbow-delimiters-depth-2">){</span> scale<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> += k; scale<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> += k; scale<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span> += k;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">set_position</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-type">float</span> <span class="org-variable-name">y</span>, <span class="org-type">float</span> <span class="org-variable-name">z</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>  <span class="org-keyword">this</span>-&gt;position = <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-3">(</span>x, y, z, 1.0<span class="org-rainbow-delimiters-depth-3">)</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">void</span> <span class="org-function-name">set_rotation</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">axis</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">this</span>-&gt;rotation = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span> <span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, axis <span class="org-rainbow-delimiters-depth-3">)</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">translate</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">dx</span>, <span class="org-type">float</span> <span class="org-variable-name">dy</span>, <span class="org-type">float</span> <span class="org-variable-name">dz</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;position<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> += dx;
        <span class="org-keyword">this</span>-&gt;position<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> += dy;
        <span class="org-keyword">this</span>-&gt;position<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span> += dz;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotation increment.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">axis</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span> <span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, axis <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;rotation = q * <span class="org-keyword">this</span>-&gt;rotation;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get model affine transform - comprised of scale, translation and translation.</span>
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-function-name">transform</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Get transformation matrix from quaternion</span>
        <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">trf</span> = <span class="org-constant">glm</span>::mat4_cast<span class="org-rainbow-delimiters-depth-3">(</span>rotation<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Multiply all elements of column X axis scale</span>
        trf<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> = scale<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> * <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-3">(</span>trf, 0<span class="org-rainbow-delimiters-depth-3">)</span>;
        trf<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> = scale<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> * <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-3">(</span>trf, 1<span class="org-rainbow-delimiters-depth-3">)</span>;
        trf<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span> = scale<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span> * <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-3">(</span>trf, 2<span class="org-rainbow-delimiters-depth-3">)</span>;
        trf<span class="org-rainbow-delimiters-depth-3">[</span>3<span class="org-rainbow-delimiters-depth-3">]</span> = position;
        <span class="org-keyword">return</span> trf;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Camera class using quaternions for rotating the camera:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-keyword">struct</span> <span class="org-type">Camera</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current location of camera in world coordinates</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">eye</span>  = <span class="org-rainbow-delimiters-depth-2">{</span> 2.0, 4.0, 5.0 <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Direction to where camera is looking at.</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">forward</span> =  <span class="org-rainbow-delimiters-depth-2">{</span>-1.0, 0.0, -1.0 <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current  camera up vector (orientation) - Y axis (default)</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">up</span> = <span class="org-rainbow-delimiters-depth-2">{</span> 0.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Field of view</span>
    <span class="org-type">float</span> <span class="org-variable-name">fov_angle</span> = <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>60.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span>   = 1.0;
    <span class="org-type">float</span> <span class="org-variable-name">zFar</span>     = 20.0;
    <span class="org-type">float</span> <span class="org-variable-name">zNear</span>    = 0.1;

    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's view uniform variable - for setting view matrix</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">shader_uniform_view</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's projection uniform variable for setting projection matrix.</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">shader_uniform_proj</span>;

    <span class="org-function-name">Camera</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">uniform_view</span>, <span class="org-type">GLuint</span> <span class="org-variable-name">uniform_proj</span>, <span class="org-type">float</span> <span class="org-variable-name">aspect</span><span class="org-rainbow-delimiters-depth-2">)</span>:
        shader_uniform_view<span class="org-rainbow-delimiters-depth-2">(</span>uniform_view<span class="org-rainbow-delimiters-depth-2">)</span>, shader_uniform_proj<span class="org-rainbow-delimiters-depth-2">(</span>uniform_proj<span class="org-rainbow-delimiters-depth-2">)</span>, aspect<span class="org-rainbow-delimiters-depth-2">(</span>aspect<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>  update_view<span class="org-rainbow-delimiters-depth-3">()</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">update_view</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Point to where camera is looking at.</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">cam_at</span> = <span class="org-keyword">this</span>-&gt;eye + <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Create View matrix (maps from world-space to camera-space)</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tview</span> = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-3">(</span>eye, cam_at, up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Create projection matrix maps - camera-space to NDC (Normalized Device Coordinates).</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tproj</span> = <span class="org-constant">glm</span>::perspective<span class="org-rainbow-delimiters-depth-3">(</span> fov_angle, aspect, zNear, zFar <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Set shader uniform variables.</span>
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_view, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tview</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_proj, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tproj</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's Up vecto.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_yaw</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Build quaternion from axis angle</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-keyword">this</span>-&gt;up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate current forward vector</span>
        forward = forward * q;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [FORWARD VECTOR ] "</span> &lt;&lt; <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-3">(</span>forward<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's pitch axis (X axis) elevate camera view.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_pitch</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">axis</span> = <span class="org-constant">glm</span>::cross<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">this</span>-&gt;up, <span class="org-keyword">this</span>-&gt;forward<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Build quaternion from axis angle</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, axis<span class="org-rainbow-delimiters-depth-3">)</span>;
        forward = q * forward;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">rotate_roll</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-keyword">this</span>-&gt;forward<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;up = q * <span class="org-keyword">this</span>-&gt;up;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Move at forward vector direction (to where camera is looking at).</span>
    <span class="org-type">void</span> <span class="org-function-name">move_forward</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">factor</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;eye = <span class="org-keyword">this</span>-&gt;eye + factor * <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera to specific point in the space.</span>
    <span class="org-type">void</span> <span class="org-function-name">set_position</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">dx</span>, <span class="org-type">float</span> <span class="org-variable-name">dy</span>, <span class="org-type">float</span> <span class="org-variable-name">dz</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;eye = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>dx, dy, dz<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set position to where camera is looking at.</span>
    <span class="org-type">void</span> <span class="org-function-name">look_at</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">vec3</span>&amp; <span class="org-variable-name">at</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;forward = at - <span class="org-keyword">this</span>-&gt;eye;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>


<p>
<b>Files</b>
</p>

<p>
Vertex Shader Code:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330 core

layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 0<span class="org-rainbow-delimiters-depth-1">)</span>  in <span class="org-type">vec3</span> <span class="org-variable-name">position</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">layout ( location = 1) in vec3 color;</span>
out <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_model</span>;       <span class="org-comment-delimiter">// </span><span class="org-comment">Model matrix</span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_view</span>;        <span class="org-comment-delimiter">// </span><span class="org-comment">Camera's view matrix</span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_projection</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">Camera's projection matrix</span>
uniform <span class="org-type">vec3</span> <span class="org-variable-name">u_color</span>;       <span class="org-comment-delimiter">// </span><span class="org-comment">Unique color to all vertices set by the C++-side</span>

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    gl_Position = u_projection * u_view * u_model * vec4<span class="org-rainbow-delimiters-depth-2">(</span>position, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Forward to fragment shader</span>
    out_color = u_color;  <span class="org-comment-delimiter">// </span><span class="org-comment">color; // vec3(0.56, 0.6, 0.0);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Fragment Shader Code:
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330

in <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set vertex colors</span>
    gl_FragColor =  vec4<span class="org-rainbow-delimiters-depth-2">(</span>out_color, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
File: <span class="underline">CMakeLists.txt</span>
</p>


<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(GLFW_project)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download GLM (OpenGL math library for matrix and vectors transformation)</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glm
  URL  https://github.com/g-truc/glm/archive/0.9.8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glm)

<span class="org-function-name">message</span>( [DEBUG] <span class="org-string">" glm_SOURCE_DIR = ${</span><span class="org-variable-name">glm_SOURCE_DIR</span><span class="org-string">} "</span>)
<span class="org-function-name">include_directories</span>(${<span class="org-variable-name">glm_SOURCE_DIR</span>})

  <span class="org-comment"># ======= TARGETS ===========================#</span>

       <span class="org-function-name">add_executable</span>( draw3d-camera  draw3d-camera.cpp        )
<span class="org-function-name">target_link_libraries</span>( draw3d-camera  glfw OpenGL::GL GLU glut )
</pre>
</div>


<p>
File: <span class="underline">draw3d-camera.cpp</span>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iomanip</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glew.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- OpenGL Math Librar ------------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_access.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#define</span> <span class="org-variable-name">GLUT_ENABLED</span>

<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>GLUT_ENABLED<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">    #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glut.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>

<span class="org-type">GLFWwindow</span>* <span class="org-function-name">make_glfwWindowi</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Compile some  shader</span>
<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">------------ Basic Data Structures -----------//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for 2D vertex coordinates</span>
<span class="org-keyword">struct</span> <span class="org-type">Vertex3D</span><span class="org-rainbow-delimiters-depth-1">{</span>  <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Wrapper for RGB colors</span>
<span class="org-keyword">struct</span> <span class="org-type">ColorRGB</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>; <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Transform object that combines - translation, scale and rotation (quaternion)</span>
<span class="org-keyword">struct</span> <span class="org-type">Transform</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec4</span> <span class="org-variable-name">position</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.0, 0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">scale</span>    = <span class="org-rainbow-delimiters-depth-2">{</span>1.0, 1.0, 1.0<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">rotation</span> = <span class="org-rainbow-delimiters-depth-2">{</span>1.0, 0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">void</span> <span class="org-function-name">set_scale</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">k</span><span class="org-rainbow-delimiters-depth-2">){</span> scale<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>  = k; scale<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> = k;  scale<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span>  = k;  <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">add_scale</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">k</span><span class="org-rainbow-delimiters-depth-2">){</span> scale<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> += k; scale<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> += k; scale<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span> += k;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">set_position</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-type">float</span> <span class="org-variable-name">y</span>, <span class="org-type">float</span> <span class="org-variable-name">z</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>  <span class="org-keyword">this</span>-&gt;position = <span class="org-constant">glm</span>::vec4<span class="org-rainbow-delimiters-depth-3">(</span>x, y, z, 1.0<span class="org-rainbow-delimiters-depth-3">)</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">void</span> <span class="org-function-name">set_rotation</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">axis</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">this</span>-&gt;rotation = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span> <span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, axis <span class="org-rainbow-delimiters-depth-3">)</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">translate</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">dx</span>, <span class="org-type">float</span> <span class="org-variable-name">dy</span>, <span class="org-type">float</span> <span class="org-variable-name">dz</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;position<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> += dx;
        <span class="org-keyword">this</span>-&gt;position<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> += dy;
        <span class="org-keyword">this</span>-&gt;position<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span> += dz;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotation increment.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">axis</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span> <span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, axis <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;rotation = q * <span class="org-keyword">this</span>-&gt;rotation;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get model affine transform - comprised of scale, translation and translation.</span>
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-function-name">transform</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Get transformation matrix from quaternion</span>
        <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">trf</span> = <span class="org-constant">glm</span>::mat4_cast<span class="org-rainbow-delimiters-depth-3">(</span>rotation<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Multiply all elements of column X axis scale</span>
        trf<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> = scale<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span> * <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-3">(</span>trf, 0<span class="org-rainbow-delimiters-depth-3">)</span>;
        trf<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> = scale<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span> * <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-3">(</span>trf, 1<span class="org-rainbow-delimiters-depth-3">)</span>;
        trf<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span> = scale<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span> * <span class="org-constant">glm</span>::column<span class="org-rainbow-delimiters-depth-3">(</span>trf, 2<span class="org-rainbow-delimiters-depth-3">)</span>;
        trf<span class="org-rainbow-delimiters-depth-3">[</span>3<span class="org-rainbow-delimiters-depth-3">]</span> = position;
        <span class="org-keyword">return</span> trf;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">Camera</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current location of camera in world coordinates</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">eye</span>  = <span class="org-rainbow-delimiters-depth-2">{</span> 2.0, 4.0, 5.0 <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Direction to where camera is looking at.</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">forward</span> =  <span class="org-rainbow-delimiters-depth-2">{</span>-1.0, -1.0, -1.0 <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current  camera up vector (orientation) - Y axis (default)</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">up</span> = <span class="org-rainbow-delimiters-depth-2">{</span> 0.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Field of view</span>
    <span class="org-type">float</span> <span class="org-variable-name">fov_angle</span> = <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>60.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span>   = 1.0;
    <span class="org-type">float</span> <span class="org-variable-name">zFar</span>     = 20.0;
    <span class="org-type">float</span> <span class="org-variable-name">zNear</span>    = 0.1;

    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's view uniform variable - for setting view matrix</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">shader_uniform_view</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's projection uniform variable for setting projection matrix.</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">shader_uniform_proj</span>;

    <span class="org-function-name">Camera</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">uniform_view</span>, <span class="org-type">GLuint</span> <span class="org-variable-name">uniform_proj</span>, <span class="org-type">float</span> <span class="org-variable-name">aspect</span><span class="org-rainbow-delimiters-depth-2">)</span>:
        shader_uniform_view<span class="org-rainbow-delimiters-depth-2">(</span>uniform_view<span class="org-rainbow-delimiters-depth-2">)</span>, shader_uniform_proj<span class="org-rainbow-delimiters-depth-2">(</span>uniform_proj<span class="org-rainbow-delimiters-depth-2">)</span>, aspect<span class="org-rainbow-delimiters-depth-2">(</span>aspect<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>  update_view<span class="org-rainbow-delimiters-depth-3">()</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">update_view</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Point to where camera is looking at.</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">cam_at</span> = <span class="org-keyword">this</span>-&gt;eye + <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Create View matrix (maps from world-space to camera-space)</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tview</span> = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-3">(</span>eye, cam_at, up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Create projection matrix maps - camera-space to NDC (Normalized Device Coordinates).</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tproj</span> = <span class="org-constant">glm</span>::perspective<span class="org-rainbow-delimiters-depth-3">(</span> fov_angle, aspect, zNear, zFar <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Set shader uniform variables.</span>
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_view, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tview</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_proj, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tproj</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's Up vecto.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_yaw</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Build quaternion from axis angle</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-keyword">this</span>-&gt;up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate current forward vector</span>
        forward = forward * q;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [FORWARD VECTOR ] "</span> &lt;&lt; <span class="org-constant">glm</span>::to_string<span class="org-rainbow-delimiters-depth-3">(</span>forward<span class="org-rainbow-delimiters-depth-3">)</span> &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's pitch axis (X axis) elevate camera view.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_pitch</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">axis</span> = <span class="org-constant">glm</span>::cross<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">this</span>-&gt;up, <span class="org-keyword">this</span>-&gt;forward<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Build quaternion from axis angle</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, axis<span class="org-rainbow-delimiters-depth-3">)</span>;
        forward = q * forward;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">rotate_roll</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-keyword">this</span>-&gt;forward<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;up = q * <span class="org-keyword">this</span>-&gt;up;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Move at forward vector direction (to where camera is looking at).</span>
    <span class="org-type">void</span> <span class="org-function-name">move_forward</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">factor</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;eye = <span class="org-keyword">this</span>-&gt;eye + factor * <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera to specific point in the space.</span>
    <span class="org-type">void</span> <span class="org-function-name">set_position</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">dx</span>, <span class="org-type">float</span> <span class="org-variable-name">dy</span>, <span class="org-type">float</span> <span class="org-variable-name">dz</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;eye = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>dx, dy, dz<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set position to where camera is looking at.</span>
    <span class="org-type">void</span> <span class="org-function-name">look_at</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">vec3</span>&amp; <span class="org-variable-name">at</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;forward = at - <span class="org-keyword">this</span>-&gt;eye;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>
        , <span class="org-type">void</span>* <span class="org-variable-name">pBufffer</span>, <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span>, <span class="org-type">GLint</span> <span class="org-variable-name">size</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_red</span>   = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_green</span> = <span class="org-rainbow-delimiters-depth-1">{</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_blue</span>  = <span class="org-rainbow-delimiters-depth-1">{</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_yellow</span>    = <span class="org-rainbow-delimiters-depth-1">{</span> 0.80,  1.000, 0.100 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_gray</span>       = <span class="org-rainbow-delimiters-depth-1">{</span> 0.47,  0.390, 0.380 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_dark_green</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.027, 0.392, 0.050 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_dark_blue</span>  = <span class="org-rainbow-delimiters-depth-1">{</span> 0.109, 0.066, 0.411 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">ColorRGB</span> <span class="org-variable-name">color_white</span>      = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 1.0, 1.0 <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">AXIS_X</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 1.0, 0.0, 0.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">AXIS_Y</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">AXIS_Z</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 0.0, 1.0 <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Initialize the library */</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-preprocessor">    #if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-2">(</span>GLUT_ENABLED<span class="org-rainbow-delimiters-depth-2">)</span>
        glutInit<span class="org-rainbow-delimiters-depth-2">(</span>&amp;argc, argv<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">    #endif</span>
                                              <span class="org-comment-delimiter">//</span>
    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = make_glfwWindowi<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"OpenGL quaternion"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The shader source code is at the end of file.</span>
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span>;
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== S H A D E R - C O M P I L A T I O N ====//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">prog</span> = glCreateProgram<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Compile shader code</span>
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_vertex_shader, GL_VERTEX_SHADER  <span class="org-rainbow-delimiters-depth-2">)</span> ;
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_frag_shader,   GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUseProgram<span class="org-rainbow-delimiters-depth-2">(</span>prog<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">--------- Shader Uniform Variables -------//</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_projection"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_view</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_view"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_model</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_color</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_color &gt;= 0 <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">------- Shader attribute locations -------//</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span>    = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">============== Set Shader Uniform Variables =============//</span>
    <span class="org-comment-delimiter">//                                                          </span><span class="org-comment">//</span>

    <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-variable-name">height</span>;
    glfwGetWindowSize<span class="org-rainbow-delimiters-depth-2">(</span>window, &amp;width, &amp;height<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Window aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span> = <span class="org-keyword">static_cast</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>width<span class="org-rainbow-delimiters-depth-2">)</span> / height;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Identity matrix</span>
    <span class="org-keyword">const</span> <span class="org-keyword">auto</span> identity = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-2">(</span>1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set projection matrix uniform variable</span>
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_proj, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>identity<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== U P L O A D - TO - G P U =========================//</span>

    <span class="org-type">Camera</span> <span class="org-variable-name">camera</span><span class="org-rainbow-delimiters-depth-2">(</span>u_view, u_proj, width / height<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Plane XY grid (vertical) - contains axis X and Y</span>
    <span class="org-type">Transform</span> <span class="org-variable-name">model_grid_xy</span>;
    model_grid_xy.set_position<span class="org-rainbow-delimiters-depth-2">(</span>0.0, 0.0, -2.0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Plane XZ grid (horizontal) - contains axis X and Z</span>
    <span class="org-type">Transform</span> <span class="org-variable-name">model_grid_xz</span>;
    model_grid_xz.set_rotation<span class="org-rainbow-delimiters-depth-2">(</span>90.0f, AXIS_X<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Transform</span> <span class="org-variable-name">model_teapot</span>;
    model_teapot.set_scale<span class="org-rainbow-delimiters-depth-2">(</span>0.4<span class="org-rainbow-delimiters-depth-2">)</span>;
    model_teapot.set_position<span class="org-rainbow-delimiters-depth-2">(</span>0.0, 0.50, 0.2<span class="org-rainbow-delimiters-depth-2">)</span>;
    model_teapot.set_rotation<span class="org-rainbow-delimiters-depth-2">(</span>-90.0, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-keyword">auto</span> <span class="org-variable-name">plane_vertices</span> = <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex3D</span><span class="org-rainbow-delimiters-depth-2">&gt;{</span>
          <span class="org-rainbow-delimiters-depth-3">{</span>0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-3">}</span>, <span class="org-rainbow-delimiters-depth-3">{</span>4.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-3">}</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span>4.0, 0.0, 4.0<span class="org-rainbow-delimiters-depth-3">}</span> ,<span class="org-rainbow-delimiters-depth-3">{</span>0.0, 0.0, 4.0<span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_plane</span>          = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_plane_vertices</span> = 0;
    send_buffer<span class="org-rainbow-delimiters-depth-2">(</span> &amp;vao_plane, &amp;vbo_plane_vertices, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex3D<span class="org-rainbow-delimiters-depth-3">)</span> * plane_vertices.size<span class="org-rainbow-delimiters-depth-3">()</span>
                , plane_vertices.data<span class="org-rainbow-delimiters-depth-3">()</span>, attr_position, 3, GL_FLOAT <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Transform</span> <span class="org-variable-name">model_plane_xz</span>;
    model_plane_xz.set_position<span class="org-rainbow-delimiters-depth-2">(</span>-2, 0, -2<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Transform</span> <span class="org-variable-name">model_plane_xy</span>;
    model_plane_xy.set_position<span class="org-rainbow-delimiters-depth-2">(</span>-2, 0, -2<span class="org-rainbow-delimiters-depth-2">)</span>;
    model_plane_xy.set_rotation<span class="org-rainbow-delimiters-depth-2">(</span>-90.0, AXIS_X<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Transform</span> <span class="org-variable-name">model_torus</span>;
    model_torus.set_position<span class="org-rainbow-delimiters-depth-2">(</span>-3, 2, 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    model_torus.rotate<span class="org-rainbow-delimiters-depth-2">(</span>90.0, AXIS_Y<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//                                             </span><span class="org-comment">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT  | GL_DEPTH_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//</span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">---- Draw horizontal plane XZ (square) ------------//</span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>model_plane_xz.transform<span class="org-rainbow-delimiters-depth-5">()</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            glUniform3fv<span class="org-rainbow-delimiters-depth-3">(</span>u_color, 1, &amp;color_green.r <span class="org-rainbow-delimiters-depth-3">)</span>;
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_plane<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_QUADS, 0, 4 <span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">---- Draw vertical plane XY (square) ------------//</span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>model_plane_xy.transform<span class="org-rainbow-delimiters-depth-5">()</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            glUniform3fv<span class="org-rainbow-delimiters-depth-3">(</span>u_color, 1, &amp;color_blue.r <span class="org-rainbow-delimiters-depth-3">)</span>;
            glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao_plane<span class="org-rainbow-delimiters-depth-3">)</span>;
            glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>GL_QUADS, 0, 4 <span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">----- Draw teapot over plane -----------------------//</span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>model_teapot.transform<span class="org-rainbow-delimiters-depth-5">()</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            glUniform3fv<span class="org-rainbow-delimiters-depth-3">(</span>u_color, 1, &amp;color_red.r <span class="org-rainbow-delimiters-depth-3">)</span>;
            glutWireTeapot<span class="org-rainbow-delimiters-depth-3">(</span>2.5<span class="org-rainbow-delimiters-depth-3">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">----- Draw Torus ------------------------------------//</span>
            glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-4">(</span>model_torus.transform<span class="org-rainbow-delimiters-depth-5">()</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
            glUniform3fv<span class="org-rainbow-delimiters-depth-3">(</span>u_color, 1, &amp;color_dark_green.r <span class="org-rainbow-delimiters-depth-3">)</span>;
            glutWireTorus<span class="org-rainbow-delimiters-depth-3">(</span>1.0f, 2.00f, 32, 32<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
        glfwWaitEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Q'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
             <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] User typed Q =&gt;&gt; Shutdown program. Ok. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
             <span class="org-keyword">break</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate camera around its Z axis or forward vector</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'T'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_roll<span class="org-rainbow-delimiters-depth-4">(</span>+5.0<span class="org-rainbow-delimiters-depth-4">)</span>;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Y'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_roll<span class="org-rainbow-delimiters-depth-4">(</span>-5.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate camera around its local X axis</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'S'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_pitch<span class="org-rainbow-delimiters-depth-4">(</span>+5.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'D'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_pitch<span class="org-rainbow-delimiters-depth-4">(</span>-5.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>


        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate camera.</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_UP <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS   <span class="org-rainbow-delimiters-depth-3">){</span> camera.move_forward<span class="org-rainbow-delimiters-depth-4">(</span>+0.2<span class="org-rainbow-delimiters-depth-4">)</span>;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_DOWN <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.move_forward<span class="org-rainbow-delimiters-depth-4">(</span>-0.2<span class="org-rainbow-delimiters-depth-4">)</span>;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_RIGHT<span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_yaw<span class="org-rainbow-delimiters-depth-4">(</span>+10.0<span class="org-rainbow-delimiters-depth-4">)</span>;   <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_LEFT <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_yaw<span class="org-rainbow-delimiters-depth-4">(</span>-10.0<span class="org-rainbow-delimiters-depth-4">)</span>;   <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Reset camera - look at origin</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'R'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span>
            camera.up = AXIS_Y;
            camera.set_position<span class="org-rainbow-delimiters-depth-4">(</span>4.0, 3.0, 2.5<span class="org-rainbow-delimiters-depth-4">)</span>;
            camera.look_at<span class="org-rainbow-delimiters-depth-4">(</span> <span class="org-rainbow-delimiters-depth-5">{</span>0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate teapot</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window,  <span class="org-string">'H'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS   <span class="org-rainbow-delimiters-depth-3">){</span> model_teapot.rotate<span class="org-rainbow-delimiters-depth-4">(</span>+10.0, AXIS_Y<span class="org-rainbow-delimiters-depth-4">)</span> ;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window,  <span class="org-string">'K'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS   <span class="org-rainbow-delimiters-depth-3">){</span> model_teapot.rotate<span class="org-rainbow-delimiters-depth-4">(</span>-10.0, AXIS_Y<span class="org-rainbow-delimiters-depth-4">)</span> ;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Move teapot up and down across Y axis</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window,  <span class="org-string">'P'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS   <span class="org-rainbow-delimiters-depth-3">){</span> model_teapot.translate<span class="org-rainbow-delimiters-depth-4">(</span>0.0, +0.1, 0.0<span class="org-rainbow-delimiters-depth-4">)</span> ;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window,  <span class="org-string">'O'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS   <span class="org-rainbow-delimiters-depth-3">){</span> model_teapot.translate<span class="org-rainbow-delimiters-depth-4">(</span>0.0, -0.1, 0.0<span class="org-rainbow-delimiters-depth-4">)</span> ;  <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Decrease or increase Teapot size</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window,  <span class="org-string">'B'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS   <span class="org-rainbow-delimiters-depth-3">){</span> model_teapot.add_scale<span class="org-rainbow-delimiters-depth-4">(</span>+0.1<span class="org-rainbow-delimiters-depth-4">)</span> ;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window,  <span class="org-string">'N'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS   <span class="org-rainbow-delimiters-depth-3">){</span> model_teapot.add_scale<span class="org-rainbow-delimiters-depth-4">(</span>-0.1<span class="org-rainbow-delimiters-depth-4">)</span> ;  <span class="org-rainbow-delimiters-depth-3">}</span>

    <span class="org-rainbow-delimiters-depth-2">}</span>

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;

<span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">--- End of main() -----//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">---------- S H A D E R - P R O G R A M S  -------------------------//</span>
<span class="org-comment-delimiter">//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Minimal vertex shader =&gt;&gt; Runs on the GPU and processes each vertex.</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330 core</span>

<span class="org-string">    layout ( location = 0)  in vec3 position;</span>
<span class="org-string">    // layout ( location = 1) in vec3 color;</span>
<span class="org-string">    out vec3 out_color;</span>
<span class="org-string">    uniform mat4 u_model;       // Model matrix</span>
<span class="org-string">    uniform mat4 u_view;        // Camera's view matrix</span>
<span class="org-string">    uniform mat4 u_projection;  // Camera's projection matrix</span>
<span class="org-string">    uniform vec3 u_color;       // Unique color to all vertices set by the C++-side</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        gl_Position = u_projection * u_view * u_model * vec4(position, 1.0);</span>
<span class="org-string">        // Forward to fragment shader</span>
<span class="org-string">        out_color = u_color;  // color; // vec3(0.56, 0.6, 0.0);</span>
<span class="org-string">    }</span>

<span class="org-string">)</span><span class="org-default">"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Fragment shader source code</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330</span>

<span class="org-string">    in vec3 out_color;</span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        // Set vertex colors</span>
<span class="org-string">        gl_FragColor =  vec4(out_color, 1.0);</span>
<span class="org-string">    }</span>
<span class="org-string">)</span><span class="org-default">"</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== I M P L E M E N T A T I O N S ==========//</span>

<span class="org-type">GLFWwindow</span>*
<span class="org-function-name">make_glfwWindowi</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    glfwSetErrorCallback<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">error</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">description</span><span class="org-rainbow-delimiters-depth-3">)</span>
                         <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span> stderr, <span class="org-string">" [GLFW ERROR] Error = %d ; Description = %s \n"</span>
                                        , error, description<span class="org-rainbow-delimiters-depth-4">)</span>;
                         <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>width, height, title, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> window != <span class="org-constant">nullptr</span> &amp;&amp; <span class="org-string">"Failed  to create Window"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL context</span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Pain whole screen as black - dark screen colors are better</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">for avoding eye strain due long hours staring on monitor.</span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.0f, 0.0f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set - OpenGL Core Profile - version 3.3</span>
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MAJOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MINOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE<span class="org-rainbow-delimiters-depth-2">)</span>;

    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_COLOR_MATERIAL<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_DEPTH_TEST<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_BLEND<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">return</span> window;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_id</span> = glCreateShader<span class="org-rainbow-delimiters-depth-2">(</span> type <span class="org-rainbow-delimiters-depth-2">)</span>;
    glShaderSource<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, 1, &amp;code, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glCompileShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLint</span> <span class="org-variable-name">is_compiled</span> = GL_FALSE;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check shader compilation result</span>
    glGetShaderiv<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, GL_COMPILE_STATUS, &amp;is_compiled<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">If there is any shader compilation result,</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">print the error message.</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> is_compiled == GL_FALSE<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [ERROR] Shader compilation error. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    glAttachShader<span class="org-rainbow-delimiters-depth-2">(</span>m_program, shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDeleteShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glLinkProgram<span class="org-rainbow-delimiters-depth-2">(</span>m_program<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">link_status</span> = GL_FALSE;
    glGetProgramiv<span class="org-rainbow-delimiters-depth-2">(</span>m_program, GL_LINK_STATUS, &amp;link_status<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> link_status != GL_FALSE <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUseProgram(m_program);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Upload buffer from main memory to GPU VBO</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">=&gt;&gt; Parameters VAO, VBO are allocated by the caller.</span>
<span class="org-type">void</span> <span class="org-function-name">send_buffer</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">GLuint</span>* <span class="org-variable-name">pVao</span>, <span class="org-type">GLuint</span>* <span class="org-variable-name">pVbo</span>, <span class="org-type">GLsizei</span> <span class="org-variable-name">sizeBuffer</span>
                , <span class="org-type">void</span>* <span class="org-variable-name">pBufffer</span>, <span class="org-type">GLint</span>   <span class="org-variable-name">shader_attr</span>, <span class="org-type">GLint</span> <span class="org-variable-name">size</span>
                , <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVao != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span>pVbo != <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = *pVao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = *pVbo;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>vao == 0<span class="org-rainbow-delimiters-depth-2">){</span> glGenVertexArrays<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU</span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, sizeBuffer, pBufffer, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr, size, type, GL_FALSE, 0, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO</span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute</span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>shader_attr<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge9dc045" class="outline-3">
<h3 id="orge9dc045"><span class="section-number-3">1.25</span> 3D - Surface wireframe chart</h3>
<div class="outline-text-3" id="text-1-25">
<p>
This code draws a wireframe surface of a function of two variables
y = f(x, z) using GL_LINE primitives. 
</p>

\begin{equation} 
   y = f(x, z) = \frac{10 \cdot \sin x \cdot \sin z}{z}
\end{equation}

<p>
<b>Screenshot</b> 
</p>


<div class="figure">
<p><a href="images/opengl-draw3d-surface-wireframe-plot.png"><img src="images/opengl-draw3d-surface-wireframe-plot.png" alt="opengl-draw3d-surface-wireframe-plot.png" /></a>
</p>
<p><span class="figure-number">Figure 21: </span>3D surface wireframe chart of f(x, z)</p>
</div>


<p>
<b>Code Highlights</b> 
</p>

<p>
Data structures: 
</p>

<div class="org-src-container">
<pre class="src src-cpp">
<span class="org-keyword">struct</span> <span class="org-type">Position</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">Normal</span>   <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">Color</span>    <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">Vertex</span>   <span class="org-rainbow-delimiters-depth-1">{</span>  
    <span class="org-type">Position</span> <span class="org-variable-name">position</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex position in space </span>
    <span class="org-type">Normal</span>   <span class="org-variable-name">normal</span>;   <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex normal vector for illumination (Future use)</span>
    <span class="org-type">Color</span>    <span class="org-variable-name">color</span>;    <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex color (RGB)</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">Mesh - set of vertices (position and attributes) that represents </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">some surface or solid. </span>
<span class="org-keyword">struct</span> <span class="org-type">Mesh</span> 
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">vertices</span><span class="org-rainbow-delimiters-depth-2">{}</span>;
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>GLuint<span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">indices</span><span class="org-rainbow-delimiters-depth-2">{}</span>; 
    <span class="org-type">GLfloat</span> <span class="org-variable-name">line_width</span> = 1.0;
    <span class="org-type">GLenum</span>  <span class="org-variable-name">draw_type</span>; 
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao</span> = 0, <span class="org-variable-name">vbo</span> = 0, <span class="org-variable-name">ibo</span> = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw mesh using indices </span>
    <span class="org-type">void</span> <span class="org-function-name">draw_indices</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Check wheter the mesh was sent to GPU.</span>
        assert<span class="org-rainbow-delimiters-depth-3">(</span> vao != 0 &amp;&amp; ibo != 0 <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The subroutine glLineWidth is stateful!!</span>
        glLineWidth<span class="org-rainbow-delimiters-depth-3">(</span>line_width<span class="org-rainbow-delimiters-depth-3">)</span>;
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glDrawElements<span class="org-rainbow-delimiters-depth-3">(</span>draw_type, indices.size<span class="org-rainbow-delimiters-depth-4">()</span>, GL_UNSIGNED_INT, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw mesh using vertices </span>
    <span class="org-type">void</span> <span class="org-function-name">draw_vertices</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        assert<span class="org-rainbow-delimiters-depth-3">(</span> vao != 0 <span class="org-rainbow-delimiters-depth-3">)</span>;
        glLineWidth<span class="org-rainbow-delimiters-depth-3">(</span>line_width<span class="org-rainbow-delimiters-depth-3">)</span>;       
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>draw_type, 0, vertices.size<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;
</pre>
</div>

<p>
Subroutine for generating surface mesh: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-type">Mesh</span> <span class="org-function-name">generate_surface_wireframe_mesh</span><span class="org-rainbow-delimiters-depth-1">(</span>  
                             <span class="org-type">float</span> <span class="org-variable-name">xmin</span>, <span class="org-type">float</span> <span class="org-variable-name">xmax</span>
                           , <span class="org-type">float</span> <span class="org-variable-name">zmin</span>, <span class="org-type">float</span> <span class="org-variable-name">zmax</span>
                           , <span class="org-type">size_t</span> <span class="org-variable-name">Nx</span>, <span class="org-type">size_t</span> <span class="org-variable-name">Nz</span>
                           , <span class="org-type">Color</span> <span class="org-variable-name">color</span> 
                           , <span class="org-type">SurfaceFunction</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">function</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span> xmax &gt; xmin <span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> zmax &gt; zmin <span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> Nx  != 0 &amp;&amp; Nz  != 0 <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] Nx = "</span> &lt;&lt; Nx &lt;&lt; <span class="org-string">" ; Nz = "</span> &lt;&lt; Nz &lt;&lt; <span class="org-string">'\n'</span>;

    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh</span>;
    mesh.draw_type = GL_LINES;

    <span class="org-type">float</span> <span class="org-variable-name">dx</span> = <span class="org-rainbow-delimiters-depth-2">(</span>xmax - xmin<span class="org-rainbow-delimiters-depth-2">)</span> / Nx;
    <span class="org-type">float</span> <span class="org-variable-name">dz</span> = <span class="org-rainbow-delimiters-depth-2">(</span>zmax - zmin<span class="org-rainbow-delimiters-depth-2">)</span> / Nz; 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Intial allocation for avoiding many dynamic allocations</span>
    mesh.vertices.reserve<span class="org-rainbow-delimiters-depth-2">(</span> Nx * Nz <span class="org-rainbow-delimiters-depth-2">)</span>;
    mesh.indices.reserve<span class="org-rainbow-delimiters-depth-2">(</span> 2 * Nx * Nz  <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>, <span class="org-variable-name">y_h</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw lines parallel to plane XY  </span>
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">j</span> = 0; j &lt; Nz; j++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>   <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0; i &lt; Nx; i++<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            x = xmin + i * dx;
            z = zmin + j * dz; 
            y = function<span class="org-rainbow-delimiters-depth-4">(</span>x, z<span class="org-rainbow-delimiters-depth-4">)</span>;
            y_h = function<span class="org-rainbow-delimiters-depth-4">(</span>x + dx, z<span class="org-rainbow-delimiters-depth-4">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw line segments in planes parallel to plane XY.</span>
            <span class="org-comment-delimiter">//</span><span class="org-comment">---------------------------------------------------------------------//</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">Initial vertex of line  segment</span>
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span> Vertex<span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>x, y, z<span class="org-rainbow-delimiters-depth-6">}</span>, zero_normal, color <span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;        
            <span class="org-comment-delimiter">// </span><span class="org-comment">Final vertex of line segment </span>
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span> Vertex<span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>x + dx, y_h, z<span class="org-rainbow-delimiters-depth-6">}</span>, zero_normal, color <span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;

        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0; i &lt; Nx; i++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>   <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">size_t</span> <span class="org-variable-name">j</span> = 0; j &lt; Nz; j++<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            x = xmin + i * dx;
            z = zmin + j * dz; 
            y = function<span class="org-rainbow-delimiters-depth-4">(</span>x, z<span class="org-rainbow-delimiters-depth-4">)</span>;
            y_h = function<span class="org-rainbow-delimiters-depth-4">(</span>x, z + dz<span class="org-rainbow-delimiters-depth-4">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw line segments in planes parallel to plane YZ.</span>
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span> Vertex<span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>x, y, z       <span class="org-rainbow-delimiters-depth-6">}</span>, zero_normal, color <span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span> Vertex<span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>x, y_h, z + dz<span class="org-rainbow-delimiters-depth-6">}</span>, zero_normal, color <span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;

         <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">return</span> mesh;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>

<p>
Vertex shader: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330 core 

layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 0<span class="org-rainbow-delimiters-depth-1">)</span>  in <span class="org-type">vec3</span> <span class="org-variable-name">position</span>;
layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 1<span class="org-rainbow-delimiters-depth-1">)</span> in <span class="org-type">vec3</span> <span class="org-variable-name">color</span>;   

out <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;
out <span class="org-type">vec3</span> <span class="org-variable-name">out_coord</span>; 
out <span class="org-type">vec3</span> <span class="org-variable-name">out_eye</span>;

uniform <span class="org-type">vec3</span> <span class="org-variable-name">u_eye</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">Cameras's position in space</span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_model</span>;       <span class="org-comment-delimiter">// </span><span class="org-comment">Model matrix </span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_view</span>;        <span class="org-comment-delimiter">// </span><span class="org-comment">Camera's view matrix    </span>
uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_projection</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">Camera's projection matrix </span>


<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    gl_Position = u_projection * u_view * u_model * vec4<span class="org-rainbow-delimiters-depth-2">(</span>position, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Forward to fragment shader </span>
    out_coord  = position;
    out_color = color; <span class="org-comment-delimiter">// </span><span class="org-comment">vec3(0.56, 0.6, 0.0);</span>
    out_eye = u_eye;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>


<p>
Fragment shader: 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#version</span> 330 

in <span class="org-type">vec3</span> <span class="org-variable-name">out_color</span>;
in <span class="org-type">vec3</span> <span class="org-variable-name">out_coord</span>;
in <span class="org-type">vec3</span> <span class="org-variable-name">out_eye</span>; 

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">float</span> <span class="org-variable-name">k</span>;

    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>gl_FrontFacing<span class="org-rainbow-delimiters-depth-2">)</span>
        k = 1.0; <span class="org-comment-delimiter">// </span><span class="org-comment">2.0;</span>
    <span class="org-keyword">else</span> 
        k = 0.1; <span class="org-comment-delimiter">// </span><span class="org-comment">0.01;</span>

    <span class="org-type">float</span> <span class="org-variable-name">factor</span> = distance<span class="org-rainbow-delimiters-depth-2">(</span>out_eye, out_coord<span class="org-rainbow-delimiters-depth-2">)</span> ;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set vertex colors</span>
    <span class="org-type">vec3</span> <span class="org-variable-name">color</span> = <span class="org-rainbow-delimiters-depth-2">(</span>out_coord / 2.0 / factor <span class="org-rainbow-delimiters-depth-2">)</span> + k * out_color * <span class="org-rainbow-delimiters-depth-2">(</span> 20.0 / factor <span class="org-rainbow-delimiters-depth-2">)</span> ;
    <span class="org-comment-delimiter">// </span><span class="org-comment">vec3 color =  k * out_color * ( 20.0 / factor ) ;</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">vec3 color = 1.0 / fac + (out_color / 2.0 + 0.5) * k;</span>

    gl_FragColor =  vec4<span class="org-rainbow-delimiters-depth-2">(</span> color , 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">gl_FragColor = vec4(0.3, 0.6, 0.0, 1.0);</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<b>Source code</b> 
</p>

<p>
File: <span class="underline">CMakeLists.txt</span> 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>(OpenGL_3D_Wireframe_Surface_Chart)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable</span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download GLM (OpenGL math library for matrix and vectors transformation)</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glm
  URL  https://github.com/g-truc/glm/archive/0.9.8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glm)
<span class="org-function-name">include_directories</span>(${<span class="org-variable-name">glm_SOURCE_DIR</span>})


<span class="org-comment"># Download pre-compiled GLEW when building under Windows NT OS (x64)</span>
<span class="org-keyword">IF</span>(WIN32)
   <span class="org-function-name">FetchContent_Declare</span>(
      glew-release 
      URL    https://ufpr.dl.sourceforge.net/project/glew/glew/2.1.0/glew-2.1.0-win32.zip 
      <span class="org-comment"># https://github.com/nigels-com/glew/archive/glew-2.2.0.zip</span>
   )
   <span class="org-function-name">FetchContent_MakeAvailable</span>(glew-release)
   <span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/include  ${<span class="org-variable-name">glm_SOURCE_DIR</span>} )        
   <span class="org-function-name">link_directories</span>(  ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64 )

   <span class="org-function-name">set</span>( GLEW_LIB_PATH1 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32.lib )
   <span class="org-function-name">set</span>( GLEW_LIB_PATH2 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32s.lib )
<span class="org-keyword">ENDIF</span>()


<span class="org-keyword">MACRO</span>(ADD_OPENGL_APP target sources)
   <span class="org-function-name">add_executable</span>( ${<span class="org-variable-name">target</span>} ${<span class="org-variable-name">sources</span>} )
   <span class="org-function-name">message</span>([TRACE] <span class="org-string">" Add OpenGL executable = ${</span><span class="org-variable-name">target</span><span class="org-string">} "</span>)

   <span class="org-function-name">target_link_libraries</span>( ${<span class="org-variable-name">target</span>} glfw
                                    OpenGL::GL
                                    ${<span class="org-variable-name">GLEW_LIB_PATH1</span>}
                                    ${<span class="org-variable-name">GLEW_LIB_PATH2</span>} )

    <span class="org-keyword">IF</span>(MINGW)
        <span class="org-comment"># Statically link against MINGW dependencies</span>
        <span class="org-comment"># for making easier to deploy on other machines. </span>
        <span class="org-function-name">target_link_options</span>( ${<span class="org-variable-name">target</span>} PRIVATE                                 
                                 -static-libgcc
                                 -static-libstdc++
                                 -Wl,-Bstatic,--whole-archive -lwinpthread
                                   -Wl,--no-whole-archive                                    
                                 )
     <span class="org-keyword">ENDIF</span>()       


     <span class="org-comment"># Copy GLEW DLL shared library to same directory as the executable.                 </span>
     <span class="org-keyword">IF</span>(WIN32)                           
        <span class="org-function-name">add_custom_command</span>(TARGET ${<span class="org-variable-name">target</span>} POST_BUILD 
                       COMMAND ${<span class="org-variable-name">CMAKE_COMMAND</span>} -E copy_if_different
                       <span class="org-string">"${</span><span class="org-variable-name">glew-release_SOURCE_DIR</span><span class="org-string">}/bin/Release/x64/glew32.dll"</span>              
                       $&lt;TARGET_FILE_DIR:${<span class="org-variable-name">target</span>}&gt;)
     <span class="org-keyword">ENDIF</span>()                                       
<span class="org-keyword">ENDMACRO</span>()     

     <span class="org-comment"># ======= T A R G E T S ============================#</span>
     <span class="org-comment">#                                                   #</span>

<span class="org-function-name">ADD_OPENGL_APP</span>( draw3d-plot-surface draw3d-plot-surface.cpp )
</pre>
</div>


<p>
File: <span class="underline">draw3d-plot-surface.cpp</span> 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">thread</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glew.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- OpenGL Math Librar ------------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#define GLUT_ENABLED </span>

<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>GLUT_ENABLED<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">    #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glut.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span> 

<span class="org-preprocessor">#define</span> <span class="org-function-name">GL_CHECK</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-variable-name">funcall</span><span class="org-rainbow-delimiters-depth-1">)</span>\
    <span class="org-keyword">do</span> <span class="org-rainbow-delimiters-depth-1">{</span> \
        <span class="org-rainbow-delimiters-depth-2">(</span>funcall<span class="org-rainbow-delimiters-depth-2">)</span>; \
        <span class="org-type">GLint</span> <span class="org-variable-name">error</span> = glGetError<span class="org-rainbow-delimiters-depth-2">()</span>;  \
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>error == GL_NO_ERROR<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">break</span>; <span class="org-rainbow-delimiters-depth-2">}</span> \
        <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [OPENGL ERROR] Error code = %d ; line = %d ; call = '%s'  \n"</span> \
                      , error, __LINE__, #funcall <span class="org-rainbow-delimiters-depth-2">)</span>; \
        abort<span class="org-rainbow-delimiters-depth-2">()</span>; \
    <span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-1">(</span>0<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-type">GLFWwindow</span>* <span class="org-function-name">make_glfwWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Compile some  shader </span>
<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">------------ Basic Data Structures -----------// </span>
<span class="org-keyword">struct</span> <span class="org-type">Position</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">Normal</span>   <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">Color</span>    <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">Vertex</span>   <span class="org-rainbow-delimiters-depth-1">{</span>  
    <span class="org-type">Position</span> <span class="org-variable-name">position</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex position in space </span>
    <span class="org-type">Normal</span>   <span class="org-variable-name">normal</span>;   <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex normal vector for illumination (Future use)</span>
    <span class="org-type">Color</span>    <span class="org-variable-name">color</span>;    <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex color (RGB)</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-function-name">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-keyword">operator</span>&lt;&lt;<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">ostream</span>&amp; <span class="org-variable-name">os</span>, <span class="org-variable-name">Vertex</span> <span class="org-keyword">const</span>&amp; v<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">return</span> os &lt;&lt; <span class="org-string">" Vertex{ x = "</span> &lt;&lt; v.position.x &lt;&lt; <span class="org-string">" ; "</span> 
              &lt;&lt; <span class="org-string">" y = "</span> &lt;&lt; v.position.y &lt;&lt; <span class="org-string">" ; z = "</span> &lt;&lt; v.position.z &lt;&lt; <span class="org-string">" } "</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Mesh - set of vertices (position and attributes) that represents </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">some surface or solid. </span>
<span class="org-keyword">struct</span> <span class="org-type">Mesh</span> 
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">vertices</span><span class="org-rainbow-delimiters-depth-2">{}</span>;
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">GLuint</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">indices</span><span class="org-rainbow-delimiters-depth-2">{}</span>; 
    <span class="org-type">GLfloat</span> <span class="org-variable-name">line_width</span> = 1.0;
    <span class="org-type">GLenum</span>  <span class="org-variable-name">draw_type</span>; 
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao</span> = 0, <span class="org-variable-name">vbo</span> = 0, <span class="org-variable-name">ibo</span> = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw mesh using indices </span>
    <span class="org-type">void</span> <span class="org-function-name">draw_indices</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Check wheter the mesh was sent to GPU.</span>
        assert<span class="org-rainbow-delimiters-depth-3">(</span> vao != 0 &amp;&amp; ibo != 0 <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The subroutine glLineWidth is stateful!!</span>
        glLineWidth<span class="org-rainbow-delimiters-depth-3">(</span>line_width<span class="org-rainbow-delimiters-depth-3">)</span>;
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glDrawElements<span class="org-rainbow-delimiters-depth-3">(</span>draw_type, indices.size<span class="org-rainbow-delimiters-depth-4">()</span>, GL_UNSIGNED_INT, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw mesh using vertices </span>
    <span class="org-type">void</span> <span class="org-function-name">draw_vertices</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        assert<span class="org-rainbow-delimiters-depth-3">(</span> vao != 0 <span class="org-rainbow-delimiters-depth-3">)</span>;
        glLineWidth<span class="org-rainbow-delimiters-depth-3">(</span>line_width<span class="org-rainbow-delimiters-depth-3">)</span>;       
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>draw_type, 0, vertices.size<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">Send/upload mesh data to GPU </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">attr_position =&gt;&gt; Shader attribute location for vertex position </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">attr_color    =&gt;&gt; Shader attribute location for vertex color </span>
<span class="org-type">void</span> <span class="org-function-name">send_mesh</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">Mesh</span>&amp; <span class="org-variable-name">mesh</span> , <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> , <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span> <span class="org-rainbow-delimiters-depth-1">)</span>; 

<span class="org-keyword">constexpr</span> <span class="org-type">Position</span> <span class="org-variable-name">origin</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">Position</span> <span class="org-function-name">position_x</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">){</span> <span class="org-keyword">return</span> <span class="org-rainbow-delimiters-depth-2">{</span>x, 0.0, 0.0<span class="org-rainbow-delimiters-depth-2">}</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>
<span class="org-keyword">constexpr</span> <span class="org-type">Position</span> <span class="org-function-name">position_y</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">y</span><span class="org-rainbow-delimiters-depth-1">){</span> <span class="org-keyword">return</span> <span class="org-rainbow-delimiters-depth-2">{</span>0.0, y, 0.0<span class="org-rainbow-delimiters-depth-2">}</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>
<span class="org-keyword">constexpr</span> <span class="org-type">Position</span> <span class="org-function-name">position_z</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">z</span><span class="org-rainbow-delimiters-depth-1">){</span> <span class="org-keyword">return</span> <span class="org-rainbow-delimiters-depth-2">{</span>0.0, 0.0, z<span class="org-rainbow-delimiters-depth-2">}</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-keyword">constexpr</span> <span class="org-type">Normal</span> <span class="org-variable-name">zero_normal</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 0.0 , 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">Color</span>  <span class="org-variable-name">color_red</span>   = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">Color</span>  <span class="org-variable-name">color_green</span> = <span class="org-rainbow-delimiters-depth-1">{</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;        
<span class="org-keyword">constexpr</span> <span class="org-type">Color</span>  <span class="org-variable-name">color_blue</span>  = <span class="org-rainbow-delimiters-depth-1">{</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">matrix_identity</span> = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-1">(</span>1.0<span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-keyword">struct</span> <span class="org-type">Camera</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current location of camera in world coordinates</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">eye</span>  = <span class="org-rainbow-delimiters-depth-2">{</span> 2.0, 4.0, 5.0 <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Direction to where camera is looking at.</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">forward</span> =  <span class="org-rainbow-delimiters-depth-2">{</span>-1.0, 0.0, -1.0 <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current  camera up vector (orientation) - Y axis (default)</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">up</span> = <span class="org-rainbow-delimiters-depth-2">{</span> 0.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Field of view</span>
    <span class="org-type">float</span> <span class="org-variable-name">fov_angle</span> = <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>60.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span>   = 1.0;
    <span class="org-type">float</span> <span class="org-variable-name">zFar</span>     = 100.0;
    <span class="org-type">float</span> <span class="org-variable-name">zNear</span>    = 0.1;

    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's view uniform variable - for setting view matrix</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_uniform_view</span> = -1;
    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's projection uniform variable for setting projection matrix.</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_uniform_proj</span> = -1;

    <span class="org-type">GLint</span> <span class="org-variable-name">shader_uniform_eye</span> = -1;

    <span class="org-function-name">Camera</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">uniform_view</span>, <span class="org-type">GLuint</span> <span class="org-variable-name">uniform_proj</span>, <span class="org-type">GLuint</span> <span class="org-variable-name">uniform_eye</span>, <span class="org-type">float</span> <span class="org-variable-name">aspect</span><span class="org-rainbow-delimiters-depth-2">)</span>:
         shader_uniform_view<span class="org-rainbow-delimiters-depth-2">(</span>uniform_view<span class="org-rainbow-delimiters-depth-2">)</span>
       , shader_uniform_proj<span class="org-rainbow-delimiters-depth-2">(</span>uniform_proj<span class="org-rainbow-delimiters-depth-2">)</span>
       , shader_uniform_eye<span class="org-rainbow-delimiters-depth-2">(</span>uniform_eye<span class="org-rainbow-delimiters-depth-2">)</span>
       , aspect<span class="org-rainbow-delimiters-depth-2">(</span>aspect<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>  update_view<span class="org-rainbow-delimiters-depth-3">()</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">update_view</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Point to where camera is looking at.</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">cam_at</span> = <span class="org-keyword">this</span>-&gt;eye + <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Create View matrix (maps from world-space to camera-space)</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tview</span> = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-3">(</span>eye, cam_at, up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Create projection matrix maps - camera-space to NDC (Normalized Device Coordinates).</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tproj</span> = <span class="org-constant">glm</span>::perspective<span class="org-rainbow-delimiters-depth-3">(</span> fov_angle, aspect, zNear, zFar <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Set shader uniform variables.</span>
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_view, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tview</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_proj, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tproj</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        glUniform3fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_eye, 1, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">eye</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's Up vecto.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_yaw</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Build quaternion from axis angle</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-keyword">this</span>-&gt;up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate current forward vector</span>
        forward = forward * q;
        <span class="org-comment-delimiter">// </span><span class="org-comment">std::cout &lt;&lt; " [FORWARD VECTOR ] " &lt;&lt; glm::to_string(forward) &lt;&lt; '\n';</span>
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's pitch axis (X axis) elevate camera view.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_pitch</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">axis</span> = <span class="org-constant">glm</span>::cross<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">this</span>-&gt;up, <span class="org-keyword">this</span>-&gt;forward<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Build quaternion from axis angle</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, axis<span class="org-rainbow-delimiters-depth-3">)</span>;
        forward = q * forward;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Move at forward vector direction (to where camera is looking at).</span>
    <span class="org-type">void</span> <span class="org-function-name">move_forward</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">factor</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;eye = <span class="org-keyword">this</span>-&gt;eye + factor * <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera to specific point in the space.</span>
    <span class="org-type">void</span> <span class="org-function-name">set_position</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-type">float</span> <span class="org-variable-name">y</span>, <span class="org-type">float</span> <span class="org-variable-name">z</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;eye = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>x, y, z<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set position to where camera is looking at.</span>
    <span class="org-type">void</span> <span class="org-function-name">look_at</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">vec3</span>&amp; <span class="org-variable-name">at</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;forward = at - <span class="org-keyword">this</span>-&gt;eye;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">using</span> <span class="org-type">SurfaceFunction</span> = <span class="org-constant">std</span>::<span class="org-type">function</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-type">float</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span>, <span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Nx - Number of points in the Xmin, Xmax interval </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Ny - Number of points in the Ymin, Ymax interval </span>
<span class="org-type">Mesh</span> <span class="org-function-name">generate_surface_wireframe_mesh</span><span class="org-rainbow-delimiters-depth-1">(</span>  
                             <span class="org-type">float</span> <span class="org-variable-name">xmin</span>, <span class="org-type">float</span> <span class="org-variable-name">xmax</span>
                           , <span class="org-type">float</span> <span class="org-variable-name">zmin</span>, <span class="org-type">float</span> <span class="org-variable-name">zmax</span>
                           , <span class="org-type">size_t</span> <span class="org-variable-name">Nx</span>, <span class="org-type">size_t</span> <span class="org-variable-name">Nz</span>
                           , <span class="org-type">Color</span> <span class="org-variable-name">color</span> 
                           , <span class="org-type">SurfaceFunction</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">function</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">Initialize the library */</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-preprocessor">    #if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-2">(</span>GLUT_ENABLED<span class="org-rainbow-delimiters-depth-2">)</span>
        glutInit<span class="org-rainbow-delimiters-depth-2">(</span>&amp;argc, argv<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">    #endif</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== S H A D E R - C O M P I L A T I O N ====//</span>
    <span class="org-comment-delimiter">//                                                </span><span class="org-comment">// </span>

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = make_glfwWindow<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"Plot 3D surface"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The shader source code is at the end of file.</span>
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span>;
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span>;

    <span class="org-type">GLuint</span> <span class="org-variable-name">prog</span> = glCreateProgram<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Compile shader code </span>
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_vertex_shader, GL_VERTEX_SHADER  <span class="org-rainbow-delimiters-depth-2">)</span> ;    
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, code_frag_shader,   GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUseProgram<span class="org-rainbow-delimiters-depth-2">(</span>prog<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable location for projection matrix</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">See shader code: "uniform mat4 projection;"</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_projection"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_proj &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find u_projection uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_view</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_view"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_proj &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find u_view uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform variable  location for model matrix.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_model</span>  = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_model &gt;= 0 &amp;&amp; <span class="org-string">"Failed to find uniform variable"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;  

    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_camera_eye</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_eye"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    printf<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" [TRACE] u_camera_eye = %d \n"</span>, u_camera_eye<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> u_camera_eye &gt;= 0 <span class="org-rainbow-delimiters-depth-2">)</span>;  

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader attribute location - the function glGetAttribLocation - returns (-1) on error.</span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> attr_position &gt;= 0 &amp;&amp; <span class="org-string">"Failed to get attribute location"</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Get shader attribute of color </span>
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> attr_color &lt; 0<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [WARNING] Shader color attribute location not found. \n"</span><span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>;

    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_model, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>u_proj,  1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== U P L O A D - TO - G P U =========================// </span>
    <span class="org-comment-delimiter">//                                                          </span><span class="org-comment">//</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">----- X, Y, Z axis for visual debugging ----------------</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">X axis (GREEN) ; Y axis (RED); Z axis (BLUE)</span>
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao_axis</span> = 0; 
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_axis_vertices</span> = 0;
    <span class="org-type">GLuint</span> <span class="org-variable-name">vbo_axis_colors</span> = 0;
    <span class="org-type">float</span> <span class="org-variable-name">axis_len</span> = 100.0;


    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_axis</span><span class="org-rainbow-delimiters-depth-2">{}</span>;
    mesh_axis.vertices = <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-comment-delimiter">// </span><span class="org-comment">X axis line  </span>
          <span class="org-rainbow-delimiters-depth-3">{</span> origin,                  zero_normal,  color_green <span class="org-rainbow-delimiters-depth-3">}</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span> position_x<span class="org-rainbow-delimiters-depth-4">(</span>axis_len<span class="org-rainbow-delimiters-depth-4">)</span>,    zero_normal,  color_green <span class="org-rainbow-delimiters-depth-3">}</span>
          <span class="org-comment-delimiter">// </span><span class="org-comment">Y axis line </span>
        , <span class="org-rainbow-delimiters-depth-3">{</span> origin,                   zero_normal,  color_red  <span class="org-rainbow-delimiters-depth-3">}</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span> position_y<span class="org-rainbow-delimiters-depth-4">(</span>axis_len<span class="org-rainbow-delimiters-depth-4">)</span>,     zero_normal,  color_red  <span class="org-rainbow-delimiters-depth-3">}</span>  
          <span class="org-comment-delimiter">//  </span><span class="org-comment">Z axis line</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span> origin,                   zero_normal,  color_blue <span class="org-rainbow-delimiters-depth-3">}</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span> position_z<span class="org-rainbow-delimiters-depth-4">(</span>axis_len<span class="org-rainbow-delimiters-depth-4">)</span>,     zero_normal,  color_blue <span class="org-rainbow-delimiters-depth-3">}</span> 
    <span class="org-rainbow-delimiters-depth-2">}</span>;
    mesh_axis.line_width = 10.0;
    mesh_axis.draw_type  = GL_LINES;
    send_mesh<span class="org-rainbow-delimiters-depth-2">(</span>mesh_axis, attr_position, attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_surface</span> = generate_surface_wireframe_mesh<span class="org-rainbow-delimiters-depth-2">(</span>
                              -20, +20.0  <span class="org-comment-delimiter">// </span><span class="org-comment">Xmax, Xmin </span>
                            , -20, +20.0  <span class="org-comment-delimiter">// </span><span class="org-comment">Zmax, Zmin </span>
                            ,  200, 200   <span class="org-comment-delimiter">// </span><span class="org-comment">Nx, Nz     =&gt; Number of points on X and Z axis</span>
                            , color_green <span class="org-comment-delimiter">// </span><span class="org-comment">Surface wireframe color </span>
                            <span class="org-comment-delimiter">// </span><span class="org-comment">, [&amp;](float x, float z){ return 25.0 - x * x - z * z ;}</span>
                            , <span class="org-rainbow-delimiters-depth-3">[</span>&amp;<span class="org-rainbow-delimiters-depth-3">](</span><span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-type">float</span> <span class="org-variable-name">z</span><span class="org-rainbow-delimiters-depth-3">){</span> <span class="org-keyword">return</span> 10.0 * sin<span class="org-rainbow-delimiters-depth-4">(</span>x<span class="org-rainbow-delimiters-depth-4">)</span> * sin<span class="org-rainbow-delimiters-depth-4">(</span>z<span class="org-rainbow-delimiters-depth-4">)</span> / z  ; <span class="org-rainbow-delimiters-depth-3">}</span>
                        <span class="org-rainbow-delimiters-depth-2">)</span>; 
    mesh_surface.line_width = 0.25;
    mesh_surface.draw_type  = GL_LINES;
    send_mesh<span class="org-rainbow-delimiters-depth-2">(</span>mesh_surface, attr_position, attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">============== Set Shader Uniform Variables =============// </span>
    <span class="org-comment-delimiter">//                                                          </span><span class="org-comment">// </span>

    <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-variable-name">height</span>;
    glfwGetWindowSize<span class="org-rainbow-delimiters-depth-2">(</span>window, &amp;width, &amp;height<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Window aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span> = <span class="org-keyword">static_cast</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>width<span class="org-rainbow-delimiters-depth-2">)</span> / height;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set projection matrix uniform variable</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUniformMatrix4fv(u_proj, 1, GL_FALSE, glm::value_ptr(identity) );</span>

    <span class="org-type">Camera</span> <span class="org-variable-name">camera</span><span class="org-rainbow-delimiters-depth-2">(</span>u_view, u_proj, u_camera_eye, width / height<span class="org-rainbow-delimiters-depth-2">)</span>;
    camera.set_position<span class="org-rainbow-delimiters-depth-2">(</span>-23.0, 21.0, -22.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    camera.look_at<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">{</span>0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//                                             </span><span class="org-comment">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT  | GL_DEPTH_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//    </span>

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw axis lines</span>
            mesh_axis.draw_vertices<span class="org-rainbow-delimiters-depth-3">()</span>;           

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw surface</span>
            mesh_surface.draw_vertices<span class="org-rainbow-delimiters-depth-3">()</span>; 
            <span class="org-comment-delimiter">// </span><span class="org-comment">mesh_surface.draw_indices();</span>


        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

        <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
        glfwWaitEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'Q'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
             <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] User typed Q =&gt;&gt; Shutdown program. Ok. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
             <span class="org-keyword">break</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera to direction to where it is looking at.</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_UP <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS    <span class="org-rainbow-delimiters-depth-3">){</span> camera.move_forward<span class="org-rainbow-delimiters-depth-4">(</span>+0.5<span class="org-rainbow-delimiters-depth-4">)</span>;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_DOWN <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span> camera.move_forward<span class="org-rainbow-delimiters-depth-4">(</span>-0.5<span class="org-rainbow-delimiters-depth-4">)</span>;  <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around its Y axis </span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_RIGHT<span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_yaw<span class="org-rainbow-delimiters-depth-4">(</span>+5.0<span class="org-rainbow-delimiters-depth-4">)</span>;   <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_LEFT <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_yaw<span class="org-rainbow-delimiters-depth-4">(</span>-5.0<span class="org-rainbow-delimiters-depth-4">)</span>;   <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate camera around its local X axis</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'S'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_pitch<span class="org-rainbow-delimiters-depth-4">(</span>+5.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'D'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_pitch<span class="org-rainbow-delimiters-depth-4">(</span>-5.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Reset camera - look at origin</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'R'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            camera.set_position<span class="org-rainbow-delimiters-depth-4">(</span>4.0, 3.0, 2.5<span class="org-rainbow-delimiters-depth-4">)</span>;
            camera.look_at<span class="org-rainbow-delimiters-depth-4">(</span> <span class="org-rainbow-delimiters-depth-5">{</span>0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

    <span class="org-rainbow-delimiters-depth-2">}</span>

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> 0;

<span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">--- End of main() -----//</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">---------- S H A D E R - P R O G R A M S  -------------------------//</span>
<span class="org-comment-delimiter">//</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Minimal vertex shader =&gt;&gt; Runs on the GPU and processes each vertex.</span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span> = R<span class="org-default">"</span><span class="org-string">(    </span>
<span class="org-string">    #version 330 core </span>

<span class="org-string">    layout ( location = 0)  in vec3 position;</span>
<span class="org-string">    layout ( location = 1) in vec3 color;   </span>

<span class="org-string">    out vec3 out_color;</span>
<span class="org-string">    out vec3 out_coord; </span>
<span class="org-string">    out vec3 out_eye;</span>

<span class="org-string">    uniform vec3 u_eye;  // Cameras's position in space</span>
<span class="org-string">    uniform mat4 u_model;       // Model matrix </span>
<span class="org-string">    uniform mat4 u_view;        // Camera's view matrix    </span>
<span class="org-string">    uniform mat4 u_projection;  // Camera's projection matrix </span>


<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        gl_Position = u_projection * u_view * u_model * vec4(position, 1.0);</span>

<span class="org-string">        // Forward to fragment shader </span>
<span class="org-string">        out_coord  = position;</span>
<span class="org-string">        out_color = color; // vec3(0.56, 0.6, 0.0);</span>
<span class="org-string">        out_eye = u_eye;</span>
<span class="org-string">    }</span>

<span class="org-string">)</span><span class="org-default">"</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Fragment shader source code </span>
<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">    #version 330 </span>

<span class="org-string">    in vec3 out_color;</span>
<span class="org-string">    in vec3 out_coord;</span>
<span class="org-string">    in vec3 out_eye; </span>

<span class="org-string">    void main()</span>
<span class="org-string">    {</span>
<span class="org-string">        float k;</span>

<span class="org-string">        if(gl_FrontFacing)</span>
<span class="org-string">            k = 1.0; // 2.0;</span>
<span class="org-string">        else </span>
<span class="org-string">            k = 0.1; // 0.01;</span>

<span class="org-string">        float factor = distance(out_eye, out_coord) ;</span>

<span class="org-string">        // Set vertex colors</span>
<span class="org-string">        vec3 color = (out_coord / 2.0 / factor ) + k * out_color * ( 20.0 / factor ) ;</span>
<span class="org-string">        // vec3 color =  k * out_color * ( 20.0 / factor ) ;</span>

<span class="org-string">        // vec3 color = 1.0 / fac + (out_color / 2.0 + 0.5) * k;</span>

<span class="org-string">        gl_FragColor =  vec4( color , 1.0);</span>
<span class="org-string">        // gl_FragColor = vec4(0.3, 0.6, 0.0, 1.0);</span>
<span class="org-string">    }</span>
<span class="org-string">)</span><span class="org-default">"</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">====== I M P L E M E N T A T I O N S ==========// </span>

<span class="org-type">GLFWwindow</span>* 
<span class="org-function-name">make_glfwWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    glfwSetErrorCallback<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">error</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">description</span><span class="org-rainbow-delimiters-depth-3">)</span>
                         <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span> stderr, <span class="org-string">" [GLFW ERROR] Error = %d ; Description = %s \n"</span>
                                        , error, description<span class="org-rainbow-delimiters-depth-4">)</span>;
                         <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>width, height, title, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> window != <span class="org-constant">nullptr</span> &amp;&amp; <span class="org-string">"Failed  to create Window"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL context </span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Pain whole screen as black - dark screen colors are better </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">for avoding eye strain due long hours staring on monitor.</span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.0f, 0.0f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set - OpenGL Core Profile - version 3.3</span>
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glfwWindowHint<span class="org-rainbow-delimiters-depth-3">(</span>GLFW_CONTEXT_VERSION_MAJOR, 3<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>; 
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glfwWindowHint<span class="org-rainbow-delimiters-depth-3">(</span>GLFW_CONTEXT_VERSION_MINOR, 3<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glfwWindowHint<span class="org-rainbow-delimiters-depth-3">(</span>GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glEnable<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_MATERIAL<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glEnable<span class="org-rainbow-delimiters-depth-3">(</span>GL_DEPTH_TEST<span class="org-rainbow-delimiters-depth-3">)</span>     <span class="org-rainbow-delimiters-depth-2">)</span>;
    GL_CHECK<span class="org-rainbow-delimiters-depth-2">(</span> glEnable<span class="org-rainbow-delimiters-depth-3">(</span>GL_BLEND<span class="org-rainbow-delimiters-depth-3">)</span>          <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">return</span> window;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_id</span> = glCreateShader<span class="org-rainbow-delimiters-depth-2">(</span> type <span class="org-rainbow-delimiters-depth-2">)</span>;
    glShaderSource<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, 1, &amp;code, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glCompileShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">is_compiled</span> = GL_FALSE;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check shader compilation result </span>
    glGetShaderiv<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, GL_COMPILE_STATUS, &amp;is_compiled<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">If there is any shader compilation result, </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">print the error message.</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> is_compiled == GL_FALSE<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">GLint</span> <span class="org-variable-name">length</span>;
        glGetShaderiv<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, GL_INFO_LOG_LENGTH, &amp;length<span class="org-rainbow-delimiters-depth-3">)</span>;
        assert<span class="org-rainbow-delimiters-depth-3">(</span> length &gt; 0 <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">out</span><span class="org-rainbow-delimiters-depth-3">(</span>length + 1, 0x00<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">GLint</span> <span class="org-variable-name">chars_written</span>;
        glGetShaderInfoLog<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, length, &amp;chars_written, out.data<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SHADER ERROR] = "</span> &lt;&lt; out &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Abort the exection of current process. </span>
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>          

    glAttachShader<span class="org-rainbow-delimiters-depth-2">(</span>m_program, shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;   
    glDeleteShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glLinkProgram<span class="org-rainbow-delimiters-depth-2">(</span>m_program<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">link_status</span> = GL_FALSE;
    glGetProgramiv<span class="org-rainbow-delimiters-depth-2">(</span>m_program, GL_LINK_STATUS, &amp;link_status<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> link_status != GL_FALSE <span class="org-rainbow-delimiters-depth-2">)</span>;   
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUseProgram(m_program);         </span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">//  </span><span class="org-comment">Send  mesh data to GPU ----//</span>
<span class="org-type">void</span> <span class="org-function-name">send_mesh</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">Mesh</span>&amp; <span class="org-variable-name">mesh</span> , <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> , <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span>   <span class="org-rainbow-delimiters-depth-1">)</span> 
<span class="org-rainbow-delimiters-depth-1">{</span> 
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = mesh.vao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = mesh.vbo;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">ibo</span> = mesh.ibo;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------------- Upload vertices --------------//</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>vao == 0<span class="org-rainbow-delimiters-depth-2">){</span> glGenVertexArrays<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload data to current VBO buffer in GPU </span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, mesh.vertices.size<span class="org-rainbow-delimiters-depth-3">()</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex<span class="org-rainbow-delimiters-depth-3">)</span>
                , mesh.vertices.data<span class="org-rainbow-delimiters-depth-3">()</span>, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;   

    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;    
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;    

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt; Each vertex has 2 coordinates. </span>
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_position, 3, GL_FLOAT, GL_FALSE, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex<span class="org-rainbow-delimiters-depth-3">)</span>, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_color, 3, GL_FLOAT, GL_FALSE, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex<span class="org-rainbow-delimiters-depth-3">)</span>     
                           <span class="org-comment-delimiter">// </span><span class="org-comment">Offset to color member variable in class Vertex2D</span>
                          , <span class="org-keyword">reinterpret_cast</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-3">&gt;(</span> offsetof<span class="org-rainbow-delimiters-depth-4">(</span>Vertex, color<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>
                          <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">-------- Upload indices ----------------------//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>mesh.indices.empty<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glGenBuffers<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;ibo<span class="org-rainbow-delimiters-depth-3">)</span>;
        glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ELEMENT_ARRAY_BUFFER, ibo<span class="org-rainbow-delimiters-depth-3">)</span>;
        glBufferData<span class="org-rainbow-delimiters-depth-3">(</span>GL_ELEMENT_ARRAY_BUFFER, mesh.indices.size<span class="org-rainbow-delimiters-depth-4">()</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-4">(</span>GLuint<span class="org-rainbow-delimiters-depth-4">)</span>
                     , mesh.indices.data<span class="org-rainbow-delimiters-depth-4">()</span>, GL_STATIC_DRAW <span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO </span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO </span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind IBO </span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span> GL_ELEMENT_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute </span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">Mesh</span> <span class="org-function-name">generate_surface_wireframe_mesh</span><span class="org-rainbow-delimiters-depth-1">(</span>  
                             <span class="org-type">float</span> <span class="org-variable-name">xmin</span>, <span class="org-type">float</span> <span class="org-variable-name">xmax</span>
                           , <span class="org-type">float</span> <span class="org-variable-name">zmin</span>, <span class="org-type">float</span> <span class="org-variable-name">zmax</span>
                           , <span class="org-type">size_t</span> <span class="org-variable-name">Nx</span>, <span class="org-type">size_t</span> <span class="org-variable-name">Nz</span>
                           , <span class="org-type">Color</span> <span class="org-variable-name">color</span> 
                           , <span class="org-type">SurfaceFunction</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">function</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    assert<span class="org-rainbow-delimiters-depth-2">(</span> xmax &gt; xmin <span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> zmax &gt; zmin <span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> Nx  != 0 &amp;&amp; Nz  != 0 <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] Nx = "</span> &lt;&lt; Nx &lt;&lt; <span class="org-string">" ; Nz = "</span> &lt;&lt; Nz &lt;&lt; <span class="org-string">'\n'</span>;

    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh</span>;
    mesh.draw_type = GL_LINES;

    <span class="org-type">float</span> <span class="org-variable-name">dx</span> = <span class="org-rainbow-delimiters-depth-2">(</span>xmax - xmin<span class="org-rainbow-delimiters-depth-2">)</span> / Nx;
    <span class="org-type">float</span> <span class="org-variable-name">dz</span> = <span class="org-rainbow-delimiters-depth-2">(</span>zmax - zmin<span class="org-rainbow-delimiters-depth-2">)</span> / Nz; 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Intial allocation for avoiding many dynamic allocations</span>
    mesh.vertices.reserve<span class="org-rainbow-delimiters-depth-2">(</span> Nx * Nz <span class="org-rainbow-delimiters-depth-2">)</span>;
    mesh.indices.reserve<span class="org-rainbow-delimiters-depth-2">(</span> 2 * Nx * Nz  <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>, <span class="org-variable-name">y_h</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw lines parallel to plane XY  </span>
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">j</span> = 0; j &lt; Nz; j++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>   <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0; i &lt; Nx; i++<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            x = xmin + i * dx;
            z = zmin + j * dz; 
            y = function<span class="org-rainbow-delimiters-depth-4">(</span>x, z<span class="org-rainbow-delimiters-depth-4">)</span>;
            y_h = function<span class="org-rainbow-delimiters-depth-4">(</span>x + dx, z<span class="org-rainbow-delimiters-depth-4">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw line segments in planes parallel to plane XY.</span>
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span> Vertex<span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>x, y, z<span class="org-rainbow-delimiters-depth-6">}</span>, zero_normal, color <span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span> Vertex<span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>x + dx, y_h, z<span class="org-rainbow-delimiters-depth-6">}</span>, zero_normal, color <span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;

        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">size_t</span> <span class="org-variable-name">i</span> = 0; i &lt; Nx; i++<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>   <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">size_t</span> <span class="org-variable-name">j</span> = 0; j &lt; Nz; j++<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            x = xmin + i * dx;
            z = zmin + j * dz; 
            y = function<span class="org-rainbow-delimiters-depth-4">(</span>x, z<span class="org-rainbow-delimiters-depth-4">)</span>;
            y_h = function<span class="org-rainbow-delimiters-depth-4">(</span>x, z + dz<span class="org-rainbow-delimiters-depth-4">)</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">Draw line segments in planes parallel to plane YZ.</span>
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span> Vertex<span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>x, y, z       <span class="org-rainbow-delimiters-depth-6">}</span>, zero_normal, color <span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span> Vertex<span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>x, y_h, z + dz<span class="org-rainbow-delimiters-depth-6">}</span>, zero_normal, color <span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;

         <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">return</span> mesh;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org189b732" class="outline-3">
<h3 id="org189b732"><span class="section-number-3">1.26</span> 3D - 3D model loading with illumination</h3>
<div class="outline-text-3" id="text-1-26">
<p>
This sample code loads 3D meshes from obj file with help from
tinyObjLoader library and draws the loaded meshes (3D models)
triangles using ambient and diffuse light. 
</p>

<p>
Libraries used: 
</p>

<ul class="org-ul">
<li><a href="https://www.glfw.org/">glfw</a>
<ul class="org-ul">
<li>Library for Window Abstraction and dealing with OpenGL context.</li>
</ul></li>

<li><a href="https://github.com/g-truc/glm">GLM math library</a>
<ul class="org-ul">
<li>Computer graphics linear algebra library</li>
</ul></li>

<li><a href="http://glew.sourceforge.net/">Glew</a>
<ul class="org-ul">
<li>Library for loading OpenGL function pointers. It is used only on
Windows in Pre-compiled form due to the difficulty to build the
library from source as it requires perl.</li>
</ul></li>

<li><a href="https://github.com/tinyobjloader/tinyobjloader">tinyobjloader</a> 
<ul class="org-ul">
<li>Library for loading 3D meshes from Obj files.</li>
</ul></li>

<li><a href="https://github.com/vector-of-bool/cmrc/">cmrc - Cmake Resource Compiler</a>
<ul class="org-ul">
<li>Single-file CMake library for embedding files in the executable,
shader scripts and 3D models. This Cmake utility makes easier to
distribute the binary, since just a single file is distributed or
deployed and the application does not have to deal with file
system path and relative path.</li>
</ul></li>
</ul>


<p>
See also: 
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/List_of_common_3D_test_models">List of common 3D test models</a></li>
</ul>

<p>
<b>Screenshot</b> 
</p>


<div class="figure">
<p><a href="images/opengl-draw3d-load-3dmodels.png"><img src="images/opengl-draw3d-load-3dmodels.png" alt="opengl-draw3d-load-3dmodels.png" /></a>
</p>
</div>

<p>
<b>Files</b> 
</p>

<p>
File: <span class="underline">CMakeLists.txt</span> 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.5)
<span class="org-function-name">project</span>( OpenGL_3D_Model_Loader )

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED ON)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment">#================ GLFW Settings  ===============#</span>

<span class="org-function-name">find_package</span>(OpenGL REQUIRED)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Set GLFW Options before FectchContent_MakeAvailable </span>
<span class="org-function-name">set</span>( GLFW_BUILD_EXAMPLES OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_TESTS    OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_DOCS     OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )
<span class="org-function-name">set</span>( GLFW_BUILD_INSTALL  OFF CACHE BOOL  <span class="org-string">"GLFW lib only"</span> )

<span class="org-comment"># Donwload GLFW library</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glfwlib
  URL   https://github.com/glfw/glfw/releases/download/3.3.2/glfw-3.3.2.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glfwlib)

<span class="org-comment"># Download GLM (OpenGL math library for matrix and vectors transformation)</span>
<span class="org-function-name">FetchContent_Declare</span>(
  glm  
  URL  https://github.com/g-truc/glm/archive/0.9.8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(glm)
<span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">glm_SOURCE_DIR</span>} )

<span class="org-function-name">FetchContent_Declare</span>(
  tinyobjloader 
  URL   https://github.com/tinyobjloader/tinyobjloader/archive/v2.0.0rc8.zip
)
<span class="org-function-name">FetchContent_MakeAvailable</span>(tinyobjloader)


<span class="org-comment"># Download pre-compiled GLEW when building under Windows NT OS (x64)</span>
<span class="org-keyword">IF</span>(WIN32)
   <span class="org-function-name">FetchContent_Declare</span>(
      glew-release 
      URL   https://ufpr.dl.sourceforge.net/project/glew/glew/2.1.0/glew-2.1.0-win32.zip 
      <span class="org-comment"># https://github.com/nigels-com/glew/archive/glew-2.2.0.zip</span>
   )
   <span class="org-function-name">FetchContent_MakeAvailable</span>(glew-release)
   <span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/include  ${<span class="org-variable-name">glm_SOURCE_DIR</span>} )        
   <span class="org-function-name">link_directories</span>(  ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64 )

   <span class="org-function-name">set</span>( GLEW_LIB_PATH1 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32.lib )
   <span class="org-function-name">set</span>( GLEW_LIB_PATH2 ${<span class="org-variable-name">glew-release_SOURCE_DIR</span>}/lib/Release/x64/glew32s.lib )
<span class="org-keyword">ENDIF</span>()

<span class="org-comment">## Fetch Cmake-Resource Compiler</span>
<span class="org-function-name">file</span>(DOWNLOAD <span class="org-string">"https://raw.githubusercontent.com/vector-of-bool/cmrc/master/CMakeRC.cmake"</span>
                 <span class="org-string">"${</span><span class="org-variable-name">CMAKE_BINARY_DIR</span><span class="org-string">}/CMakeRC.cmake"</span>)
<span class="org-function-name">include</span>(<span class="org-string">"${</span><span class="org-variable-name">CMAKE_BINARY_DIR</span><span class="org-string">}/CMakeRC.cmake"</span>)


<span class="org-keyword">MACRO</span>(ADD_OPENGL_APP target sources)
   <span class="org-function-name">add_executable</span>( ${<span class="org-variable-name">target</span>} ${<span class="org-variable-name">sources</span>} )
   <span class="org-function-name">message</span>([TRACE] <span class="org-string">" Add OpenGL executable = ${</span><span class="org-variable-name">target</span><span class="org-string">} "</span>)

   <span class="org-function-name">target_link_libraries</span>( ${<span class="org-variable-name">target</span>} glfw
                                    OpenGL::GL
                                    ${<span class="org-variable-name">GLEW_LIB_PATH1</span>}
                                    ${<span class="org-variable-name">GLEW_LIB_PATH2</span>} )

    <span class="org-keyword">IF</span>(MINGW)
        <span class="org-comment"># Statically link against MINGW dependencies</span>
        <span class="org-comment"># for making easier to deploy on other machines. </span>
        <span class="org-function-name">target_link_options</span>( ${<span class="org-variable-name">target</span>} PRIVATE                                 
                                 -static-libgcc
                                 -static-libstdc++
                                 -Wl,-Bstatic,--whole-archive -lwinpthread
                                   -Wl,--no-whole-archive                                    
                                 )
     <span class="org-keyword">ENDIF</span>()       


     <span class="org-comment"># Copy GLEW DLL shared library to same directory as the executable.                 </span>
     <span class="org-keyword">IF</span>(WIN32)                           
        <span class="org-function-name">add_custom_command</span>(TARGET ${<span class="org-variable-name">target</span>} POST_BUILD 
                       COMMAND ${<span class="org-variable-name">CMAKE_COMMAND</span>} -E copy_if_different
                       <span class="org-string">"${</span><span class="org-variable-name">glew-release_SOURCE_DIR</span><span class="org-string">}/bin/Release/x64/glew32.dll"</span>              
                       $&lt;TARGET_FILE_DIR:${<span class="org-variable-name">target</span>}&gt;)
     <span class="org-keyword">ENDIF</span>()                                       
<span class="org-keyword">ENDMACRO</span>()     


<span class="org-comment"># Download Suzanne 3D model </span>
<span class="org-function-name">file</span>(DOWNLOAD https://raw.githubusercontent.com/alecjacobson/common-3d-test-models/master/data/suzanne.obj
              ${<span class="org-variable-name">CMAKE_CURRENT_SOURCE_DIR</span>}/suzanne.obj 
              )

<span class="org-comment"># Download Teapot 3D model </span>
<span class="org-function-name">file</span>(DOWNLOAD https://raw.githubusercontent.com/kevinroast/phoria.js/master/teapot.obj
              ${<span class="org-variable-name">CMAKE_CURRENT_SOURCE_DIR</span>}/teapot.obj 
              )

 <span class="org-comment"># ----------- T A R G E T S ---------------------------$</span>

   <span class="org-function-name">ADD_OPENGL_APP</span>( model-loader model-loader.cpp )

   <span class="org-comment"># Define resourse files to be embedded in the executable (model-loader)</span>
   <span class="org-function-name">cmrc_add_resource_library</span>( model-loader-resources 
                              NAMESPACE resource
                              ./model_loader_vshader.glsl 
                              ./model_loader_fshader.glsl
                              ./suzanne.obj 
                              ./cube.obj  
                              ./teapot.obj 
                             )

  <span class="org-comment"># Append resources to the executable                            </span>
  <span class="org-function-name">target_link_libraries</span>( model-loader
                         model-loader-resources tinyobjloader )


</pre>
</div>

<p>
File: <span class="underline">model_loader_vshader.glsl</span> / Vertex Shader 
</p>

<div class="org-src-container">
<pre class="src src-cpp">  <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex Shader Source Code</span>
<span class="org-preprocessor">  #version</span> 330 core 

  layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 0 <span class="org-rainbow-delimiters-depth-1">)</span> in <span class="org-type">vec3</span> <span class="org-variable-name">position</span>;
  layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 1 <span class="org-rainbow-delimiters-depth-1">)</span> in <span class="org-type">vec3</span> <span class="org-variable-name">normal</span>;  
  layout <span class="org-rainbow-delimiters-depth-1">(</span> location = 2 <span class="org-rainbow-delimiters-depth-1">)</span> in <span class="org-type">vec3</span> <span class="org-variable-name">color</span>;   

  uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_model</span>;       <span class="org-comment-delimiter">// </span><span class="org-comment">Model matrix </span>
  uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_view</span>;        <span class="org-comment-delimiter">// </span><span class="org-comment">Camera's view matrix    </span>
  uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_projection</span>;  <span class="org-comment-delimiter">// </span><span class="org-comment">Camera's projection matrix </span>
  uniform <span class="org-type">mat4</span> <span class="org-variable-name">u_normal</span>;      <span class="org-comment-delimiter">// </span><span class="org-comment">Normal matrix (transpose of view-model inverse)</span>

  varying highp <span class="org-type">vec4</span> <span class="org-variable-name">out_color</span>;
  varying highp <span class="org-type">vec4</span> <span class="org-variable-name">out_light</span>;
  varying <span class="org-type">vec3</span> <span class="org-variable-name">mv_normal</span>, <span class="org-variable-name">mv_view</span>, <span class="org-variable-name">mv_position</span>;

  <span class="org-comment-delimiter">// </span><span class="org-comment">------ Pre-defined colors for debugging -----//</span>
   <span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
  <span class="org-rainbow-delimiters-depth-1">{</span>
      <span class="org-type">mat4</span> <span class="org-variable-name">model_view</span> = u_view * u_model; 
      <span class="org-comment-delimiter">// </span><span class="org-comment">Should be computed at the application-side </span>
      <span class="org-comment-delimiter">/// </span><span class="org-comment">mat4 normal_mat  = transpose(inverse(model_view));</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Convert normal to eye space coordinates (aka camera coordinates)</span>
      <span class="org-comment-delimiter">// </span><span class="org-comment">mv_normal = normalize( ( normal_mat * vec4(normal, 0.0)).xyz );</span>
      mv_normal = normalize<span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-rainbow-delimiters-depth-3">(</span>  u_normal * vec4<span class="org-rainbow-delimiters-depth-4">(</span>normal, 0.0<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>.xyz <span class="org-rainbow-delimiters-depth-2">)</span>;  

      <span class="org-comment-delimiter">// </span><span class="org-comment">Set #if argument to 1 in order to debug the normal</span>
<span class="org-preprocessor">      #if</span> 0
          <span class="org-type">vec3</span> <span class="org-variable-name">_position</span> = position + abs<span class="org-rainbow-delimiters-depth-2">(</span>mv_normal<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">      #else</span> 
          <span class="org-type">vec3</span> <span class="org-variable-name">_position</span> = position;
<span class="org-preprocessor">      #endif</span> 

      gl_Position = u_projection * u_view * u_model * vec4<span class="org-rainbow-delimiters-depth-2">(</span>_position, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;        

      <span class="org-comment-delimiter">// </span><span class="org-comment">------------- Lighting -----------------------//</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex coordinate in eye space (camera-space)</span>
      mv_position = <span class="org-rainbow-delimiters-depth-2">(</span> model_view * vec4<span class="org-rainbow-delimiters-depth-3">(</span>position, 1.0<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>.xyz;

      <span class="org-comment-delimiter">// </span><span class="org-comment">out_light = vec4(light, 1.0);</span>
      out_color = vec4<span class="org-rainbow-delimiters-depth-2">(</span>color, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
File: <span class="underline">model_loader_fshader.glsl</span> / Fragment Shader  
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-comment-delimiter">// </span><span class="org-comment">Fragment Shader Source Code</span>
<span class="org-preprocessor">#version</span> 330
precision <span class="org-type">mediump</span> <span class="org-type">float</span>; 

varying highp <span class="org-type">vec4</span> <span class="org-variable-name">out_color</span>;
varying highp <span class="org-type">vec4</span> <span class="org-variable-name">out_light</span>; 
varying <span class="org-type">vec3</span> <span class="org-variable-name">mv_normal</span>, <span class="org-variable-name">mv_light</span>, <span class="org-variable-name">mv_view</span>, <span class="org-variable-name">mv_position</span>;

uniform <span class="org-type">vec3</span> <span class="org-variable-name">u_product_diffuse</span>;
uniform <span class="org-type">vec3</span> <span class="org-variable-name">u_light_position</span>;
uniform <span class="org-type">vec3</span> <span class="org-variable-name">u_product_ambient</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Specular coefficient </span>
<span class="org-type">float</span> <span class="org-variable-name">spec</span> = 10.0;  

uniform <span class="org-type">vec3</span> <span class="org-variable-name">u_product_specular</span>;

<span class="org-keyword">const</span> <span class="org-type">vec3</span> <span class="org-variable-name">color_red</span>   = vec3<span class="org-rainbow-delimiters-depth-1">(</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-keyword">const</span> <span class="org-type">vec3</span> <span class="org-variable-name">color_green</span> = vec3<span class="org-rainbow-delimiters-depth-1">(</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-1">)</span>;  

<span class="org-type">void</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    <span class="org-type">vec3</span> <span class="org-variable-name">_normal</span> = mv_normal; <span class="org-comment-delimiter">//</span><span class="org-comment">;normalize( mv_normal );</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">vec3 light_direction = normalize(vec3(100, 100, 100)); </span>
    <span class="org-type">vec3</span> <span class="org-variable-name">light_direction</span> = normalize<span class="org-rainbow-delimiters-depth-2">(</span> u_light_position - mv_position <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">float</span> <span class="org-variable-name">lambert</span> = max<span class="org-rainbow-delimiters-depth-2">(</span> dot<span class="org-rainbow-delimiters-depth-3">(</span>_normal, light_direction<span class="org-rainbow-delimiters-depth-3">)</span>, -1.0<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">vec3</span>  <span class="org-variable-name">light_ambient</span> =  u_product_ambient;
    <span class="org-type">vec3</span>  <span class="org-variable-name">light_diffuse</span> =  u_product_diffuse * lambert;         

    <span class="org-comment-delimiter">// </span><span class="org-comment">View vector for specular light</span>
    <span class="org-type">vec3</span> <span class="org-variable-name">_view</span>   = normalize<span class="org-rainbow-delimiters-depth-2">(</span> mv_view<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Halfway vector</span>
    <span class="org-type">vec3</span> <span class="org-variable-name">H</span> = normalize<span class="org-rainbow-delimiters-depth-2">(</span> light_direction + _view <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">vec3</span> <span class="org-variable-name">light_specular</span> = pow<span class="org-rainbow-delimiters-depth-2">(</span> max<span class="org-rainbow-delimiters-depth-3">(</span>dot<span class="org-rainbow-delimiters-depth-4">(</span>H, _normal<span class="org-rainbow-delimiters-depth-4">)</span>, 0.0<span class="org-rainbow-delimiters-depth-3">)</span>, spec<span class="org-rainbow-delimiters-depth-2">)</span> * u_product_specular; 

    <span class="org-type">vec4</span> <span class="org-variable-name">light</span> = vec4<span class="org-rainbow-delimiters-depth-2">(</span>light_ambient + light_diffuse, 1.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">vec4 light = vec4(light_ambient + light_diffuse + light_specular, 1.0); </span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">gl_FragColor = out_light ; </span>
    gl_FragColor = light * out_color;

<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
File: <span class="underline">cube.obj</span> / Cube 3D model Obj file 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">cube.obj</span>
<span class="org-comment-delimiter">#</span>
mtllib cube.mtl
o cube

v -0.500000 -0.500000 0.500000
v 0.500000 -0.500000 0.500000
v -0.500000 0.500000 0.500000
v 0.500000 0.500000 0.500000
v -0.500000 0.500000 -0.500000
v 0.500000 0.500000 -0.500000
v -0.500000 -0.500000 -0.500000
v 0.500000 -0.500000 -0.500000

vt 0.000000 0.000000
vt 1.000000 0.000000
vt 0.000000 1.000000
vt 1.000000 1.000000

vn 0.000000 0.000000 1.000000
vn 0.000000 1.000000 0.000000
vn 0.000000 0.000000 -1.000000
vn 0.000000 -1.000000 0.000000
vn 1.000000 0.000000 0.000000
vn -1.000000 0.000000 0.000000

g cube
usemtl cube
s 1
f 1/1/1 2/2/1 3/3/1
f 3/3/1 2/2/1 4/4/1
s 2
f 3/1/2 4/2/2 5/3/2
f 5/3/2 4/2/2 6/4/2
s 3
f 5/4/3 6/3/3 7/2/3
f 7/2/3 6/3/3 8/1/3
s 4
f 7/1/4 8/2/4 1/3/4
f 1/3/4 8/2/4 2/4/4
s 5
f 2/1/5 8/2/5 4/3/5
f 4/3/5 8/2/5 6/4/5
s 6
f 7/1/6 1/2/6 5/3/6
f 5/3/6 1/2/6 3/4/6

</pre>
</div>

<p>
File: <span class="underline">model-loader.cpp</span> 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">array</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">thread</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-------- OpenGL headers ---------//</span>
<span class="org-comment-delimiter">//</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL_GLEXT_PROTOTYPES</span> 1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">GL3_PROTOTYPES</span>      1 <span class="org-comment-delimiter">// </span><span class="org-comment">Necessary for OpenGL &gt;= 3.0 functions</span>

<span class="org-preprocessor">#if</span> <span class="org-preprocessor">defined</span><span class="org-rainbow-delimiters-depth-1">(</span>_WIN32<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">windows.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">   #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glew.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>


<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/gl.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GLFW/glfw3.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glew.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">GL/glu.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">#include &lt;GL/glut.h&gt;</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------- OpenGL Math Librar ------------//</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/glm.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/matrix_transform.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtc/type_ptr.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/string_cast.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">glm/gtx/io.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">tiny_obj_loader.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmrc/cmrc.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
CMRC_DECLARE<span class="org-rainbow-delimiters-depth-1">(</span>resource<span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">struct</span> <span class="org-type">Position</span> <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">Normal</span>   <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">x</span>, <span class="org-variable-name">y</span>, <span class="org-variable-name">z</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">struct</span> <span class="org-type">Color</span>    <span class="org-rainbow-delimiters-depth-1">{</span> <span class="org-type">GLfloat</span> <span class="org-variable-name">r</span>, <span class="org-variable-name">g</span>, <span class="org-variable-name">b</span>;  <span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">struct</span> <span class="org-type">Vertex</span>   <span class="org-rainbow-delimiters-depth-1">{</span>  
    <span class="org-type">Position</span> <span class="org-variable-name">position</span>; <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex position in space </span>
    <span class="org-type">Normal</span>   <span class="org-variable-name">normal</span>;   <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex normal vector for illumination (Future use)</span>
    <span class="org-type">Color</span>    <span class="org-variable-name">color</span>;    <span class="org-comment-delimiter">// </span><span class="org-comment">Vertex color (RGB)</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Mesh - set of vertices (position and attributes) that represents </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">some surface or solid. </span>
<span class="org-keyword">struct</span> <span class="org-type">Mesh</span> 
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Vertex</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">vertices</span><span class="org-rainbow-delimiters-depth-2">{}</span>;
    <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span>GLuint<span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">indices</span><span class="org-rainbow-delimiters-depth-2">{}</span>; 
    <span class="org-type">GLfloat</span> <span class="org-variable-name">line_width</span> = 1.0;
    <span class="org-type">GLenum</span>  <span class="org-variable-name">draw_type</span>; 
    <span class="org-type">GLuint</span> <span class="org-variable-name">vao</span> = 0, <span class="org-variable-name">vbo</span> = 0, <span class="org-variable-name">ibo</span> = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw mesh using indices </span>
    <span class="org-type">void</span> <span class="org-function-name">draw_indices</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Check wheter the mesh was sent to GPU.</span>
        assert<span class="org-rainbow-delimiters-depth-3">(</span> vao != 0 &amp;&amp; ibo != 0 <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The subroutine glLineWidth is stateful!!</span>
        glLineWidth<span class="org-rainbow-delimiters-depth-3">(</span>line_width<span class="org-rainbow-delimiters-depth-3">)</span>;
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glDrawElements<span class="org-rainbow-delimiters-depth-3">(</span>draw_type, indices.size<span class="org-rainbow-delimiters-depth-4">()</span>, GL_UNSIGNED_INT, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Draw mesh using vertices </span>
    <span class="org-type">void</span> <span class="org-function-name">draw_vertices</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        assert<span class="org-rainbow-delimiters-depth-3">(</span> vao != 0 <span class="org-rainbow-delimiters-depth-3">)</span>;
        glLineWidth<span class="org-rainbow-delimiters-depth-3">(</span>line_width<span class="org-rainbow-delimiters-depth-3">)</span>;       
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glDrawArrays<span class="org-rainbow-delimiters-depth-3">(</span>draw_type, 0, vertices.size<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-type">GLFWwindow</span>* <span class="org-function-name">make_glfwWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">void</span>         <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">void</span>              <span class="org-function-name">send_mesh</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">Mesh</span>&amp; <span class="org-variable-name">mesh</span> , <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> , <span class="org-type">GLint</span> <span class="org-variable-name">attr_normal</span>, <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span><span class="org-rainbow-delimiters-depth-1">)</span>; 

<span class="org-comment-delimiter">// </span><span class="org-comment">Load  mesh data from obj file, often generated by tools such as Blender or 3D studio max.</span>
<span class="org-type">Mesh</span> <span class="org-function-name">load_model</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">string</span>&amp; <span class="org-variable-name">file</span>, <span class="org-keyword">const</span> <span class="org-type">Color</span>&amp; <span class="org-variable-name">color</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-type">void</span> <span class="org-function-name">set_uniform_matrix</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLint</span> <span class="org-variable-name">uniform</span>, <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">m</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-2">(</span>uniform, 1, GL_FALSE, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span>m<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform location and check return status code.</span>
<span class="org-type">GLint</span> <span class="org-function-name">shader_uniform</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">name</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-comment-delimiter">// </span><span class="org-comment">Get shader attribute location and return status code.</span>
<span class="org-type">GLint</span> <span class="org-function-name">shader_attr</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLint</span> <span class="org-variable-name">program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">name</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">Get content of resource file, embedded in the executable file, as string.</span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Requires:  #include &lt;cmrc/cmrc.hpp&gt; </span>
<span class="org-function-name">std</span>::string get_resource<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">file_name</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-keyword">constexpr</span> <span class="org-type">Normal</span> <span class="org-variable-name">zero_normal</span> = <span class="org-rainbow-delimiters-depth-1">{</span> 0.0, 0.0 , 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">Color</span>  <span class="org-variable-name">color_red</span>   = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">Color</span>  <span class="org-variable-name">color_green</span> = <span class="org-rainbow-delimiters-depth-1">{</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;        
<span class="org-keyword">constexpr</span> <span class="org-type">Color</span>  <span class="org-variable-name">color_blue</span>  = <span class="org-rainbow-delimiters-depth-1">{</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-1">}</span>;
<span class="org-keyword">constexpr</span> <span class="org-type">Color</span> <span class="org-variable-name">color_gold</span>  = <span class="org-rainbow-delimiters-depth-1">{</span>1.0, 0.843, 0.0<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">matrix_identity</span> = <span class="org-constant">glm</span>::mat4<span class="org-rainbow-delimiters-depth-1">(</span>1.0<span class="org-rainbow-delimiters-depth-1">)</span>;


<span class="org-keyword">struct</span> <span class="org-type">Camera</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current location of camera in world coordinates</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">eye</span>  = <span class="org-rainbow-delimiters-depth-2">{</span> 2.0, 4.0, 5.0 <span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Direction to where camera is looking at.</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">forward</span> =  <span class="org-constant">glm</span>::normalize<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">{</span>-1.0, 0.0, -1.0 <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Current  camera up vector (orientation) - Y axis (default)</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">up</span> = <span class="org-rainbow-delimiters-depth-2">{</span> 0.0, 1.0, 0.0 <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Field of view</span>
    <span class="org-type">float</span> <span class="org-variable-name">fov_angle</span> = <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-2">(</span>60.0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span>   = 1.0;
    <span class="org-type">float</span> <span class="org-variable-name">zFar</span>     = 100.0;
    <span class="org-type">float</span> <span class="org-variable-name">zNear</span>    = 0.1;

    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's view uniform variable - for setting view matrix</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_uniform_view</span> = -1;
    <span class="org-comment-delimiter">// </span><span class="org-comment">ID of shader's projection uniform variable for setting projection matrix.</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_uniform_proj</span> = -1;

    <span class="org-function-name">Camera</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">uniform_view</span>, <span class="org-type">GLuint</span> <span class="org-variable-name">uniform_proj</span>, <span class="org-type">GLfloat</span> <span class="org-variable-name">aspect</span><span class="org-rainbow-delimiters-depth-2">)</span>:
         shader_uniform_view<span class="org-rainbow-delimiters-depth-2">(</span>uniform_view<span class="org-rainbow-delimiters-depth-2">)</span>
       , shader_uniform_proj<span class="org-rainbow-delimiters-depth-2">(</span>uniform_proj<span class="org-rainbow-delimiters-depth-2">)</span>
       , aspect<span class="org-rainbow-delimiters-depth-2">(</span>aspect<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>  update_view<span class="org-rainbow-delimiters-depth-3">()</span>;  <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">update_view</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Point to where camera is looking at.</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">cam_at</span> = <span class="org-keyword">this</span>-&gt;eye + <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"  [CAMERA] Camera coordinate (eye)        = "</span> &lt;&lt; eye &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"  [CAMERA] Looking at direction (forward) = "</span> &lt;&lt; forward &lt;&lt; <span class="org-string">'\n'</span>; 

        <span class="org-comment-delimiter">// </span><span class="org-comment">Create View matrix (maps from world-space to camera-space)</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tview</span> = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-3">(</span>eye, cam_at, up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Create projection matrix maps - camera-space to NDC (Normalized Device Coordinates).</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tproj</span> = <span class="org-constant">glm</span>::perspective<span class="org-rainbow-delimiters-depth-3">(</span> fov_angle, aspect, zNear, zFar <span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Set shader uniform variables.</span>
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_view, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tview</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        glUniformMatrix4fv<span class="org-rainbow-delimiters-depth-3">(</span>shader_uniform_proj, 1, GL_FALSE, <span class="org-constant">glm</span>::<span class="org-type">value_ptr</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">Tproj</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Compute projection matrix </span>
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-function-name">get_proj</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>   <span class="org-keyword">return</span> <span class="org-constant">glm</span>::perspective<span class="org-rainbow-delimiters-depth-3">(</span> fov_angle, aspect, zNear, zFar <span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">//  </span><span class="org-comment">Compute view matrix </span>
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-function-name">get_view</span><span class="org-rainbow-delimiters-depth-2">()</span> 
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Point to where camera is looking at.</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">cam_at</span> = <span class="org-keyword">this</span>-&gt;eye + <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-keyword">auto</span> <span class="org-variable-name">Tview</span> = <span class="org-constant">glm</span>::lookAt<span class="org-rainbow-delimiters-depth-3">(</span>eye, cam_at, up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">return</span> Tview;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Compute normal view matrix for illumination</span>
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-function-name">normal_view</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">model</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">return</span> <span class="org-constant">glm</span>::transpose<span class="org-rainbow-delimiters-depth-3">(</span> <span class="org-constant">glm</span>::inverse<span class="org-rainbow-delimiters-depth-4">(</span> <span class="org-keyword">this</span>-&gt;get_view<span class="org-rainbow-delimiters-depth-5">()</span> * model <span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's Up vecto.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_yaw</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Build quaternion from axis angle</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, <span class="org-keyword">this</span>-&gt;up<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate current forward vector</span>
        forward = forward * q;
        <span class="org-comment-delimiter">// </span><span class="org-comment">std::cout &lt;&lt; " [FORWARD VECTOR ] " &lt;&lt; glm::to_string(forward) &lt;&lt; '\n';</span>
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around camera's pitch axis (X axis) elevate camera view.</span>
    <span class="org-type">void</span> <span class="org-function-name">rotate_pitch</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">axis</span> = <span class="org-constant">glm</span>::cross<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">this</span>-&gt;up, <span class="org-keyword">this</span>-&gt;forward<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Build quaternion from axis angle</span>
        <span class="org-constant">glm</span>::<span class="org-type">quat</span> <span class="org-variable-name">q</span> = <span class="org-constant">glm</span>::angleAxis<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">glm</span>::<span class="org-type">radians</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-variable-name">angle</span><span class="org-rainbow-delimiters-depth-4">)</span>, axis<span class="org-rainbow-delimiters-depth-3">)</span>;
        forward = q * forward;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

      <span class="org-comment-delimiter">// </span><span class="org-comment">Move at forward vector direction (to where camera is looking at).</span>
    <span class="org-type">void</span> <span class="org-function-name">move_forward</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">factor</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;eye = <span class="org-keyword">this</span>-&gt;eye + factor * <span class="org-keyword">this</span>-&gt;forward;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera to specific point in the space.</span>
    <span class="org-type">void</span> <span class="org-function-name">set_position</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">float</span> <span class="org-variable-name">x</span>, <span class="org-type">float</span> <span class="org-variable-name">y</span>, <span class="org-type">float</span> <span class="org-variable-name">z</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;eye = <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>x, y, z<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set position to where camera is looking at.</span>
    <span class="org-type">void</span> <span class="org-function-name">look_at</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">vec3</span>&amp; <span class="org-variable-name">at</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;forward = <span class="org-constant">glm</span>::normalize<span class="org-rainbow-delimiters-depth-3">(</span>at - <span class="org-keyword">this</span>-&gt;eye<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-keyword">this</span>-&gt;update_view<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-comment-delimiter">// </span><span class="org-comment">Create mesh for plane (represented by a square) on origin</span>
<span class="org-type">Mesh</span> <span class="org-function-name">make_plane_mesh</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">float</span> <span class="org-variable-name">side</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">VA</span>, <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">VB</span>
                    , <span class="org-type">Normal</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">normal</span>, <span class="org-type">Color</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">color</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">B</span> = side * VA, <span class="org-variable-name">C</span> = side * VB, <span class="org-variable-name">D</span> = B  + C;
    <span class="org-type">Position</span> <span class="org-variable-name">pA</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0, 0, 0<span class="org-rainbow-delimiters-depth-2">}</span>, <span class="org-variable-name">pB</span> = <span class="org-rainbow-delimiters-depth-2">{</span>B<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, B<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, B<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">}</span>, <span class="org-variable-name">pC</span> = <span class="org-rainbow-delimiters-depth-2">{</span>C<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, C<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, C<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">}</span>, <span class="org-variable-name">pD</span> = <span class="org-rainbow-delimiters-depth-2">{</span>D<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>, D<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span>, D<span class="org-rainbow-delimiters-depth-3">[</span>2<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">}</span> ;
    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_plane</span>;
    mesh_plane.draw_type = GL_TRIANGLES;
    mesh_plane.line_width = 1.0;

    mesh_plane.vertices = <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">----- Triagle 1 ------------// </span>
          <span class="org-rainbow-delimiters-depth-3">{</span> pA, normal, color <span class="org-rainbow-delimiters-depth-3">}</span>,<span class="org-rainbow-delimiters-depth-3">{</span> pB, normal, color <span class="org-rainbow-delimiters-depth-3">}</span>, <span class="org-rainbow-delimiters-depth-3">{</span> pC, normal, color <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">----- Triangle 2 -------------//</span>
        , <span class="org-rainbow-delimiters-depth-3">{</span> pB, normal, color <span class="org-rainbow-delimiters-depth-3">}</span>, <span class="org-rainbow-delimiters-depth-3">{</span> pC, normal, color <span class="org-rainbow-delimiters-depth-3">}</span> , Vertex<span class="org-rainbow-delimiters-depth-3">{</span> pD, normal, color <span class="org-rainbow-delimiters-depth-3">}</span> 
     <span class="org-rainbow-delimiters-depth-2">}</span>;  

    <span class="org-keyword">return</span> mesh_plane;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">glutInit(&amp;argc, argv);</span>

    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>glfwInit<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-keyword">return</span> -1; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = make_glfwWindow<span class="org-rainbow-delimiters-depth-2">(</span>640, 480, <span class="org-string">"Load 3D models. "</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">====== S H A D E R - C O M P I L A T I O N ====//</span>
    <span class="org-comment-delimiter">//                                                </span><span class="org-comment">//     </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The shader source code is at the end of file.</span>
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_vertex_shader</span>;
    <span class="org-keyword">extern</span> <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code_frag_shader</span>;

    <span class="org-type">GLuint</span> <span class="org-variable-name">prog</span> = glCreateProgram<span class="org-rainbow-delimiters-depth-2">()</span>;

    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">vertex_shader</span>   = get_resource<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"/model_loader_vshader.glsl"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">fragment_shader</span> = get_resource<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"/model_loader_fshader.glsl"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Compile shader code </span>
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, vertex_shader.c_str<span class="org-rainbow-delimiters-depth-3">()</span>,  GL_VERTEX_SHADER  <span class="org-rainbow-delimiters-depth-2">)</span> ;    
    compile_shader<span class="org-rainbow-delimiters-depth-2">(</span>prog, fragment_shader.c_str<span class="org-rainbow-delimiters-depth-3">()</span>, GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUseProgram<span class="org-rainbow-delimiters-depth-2">(</span>prog<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> = shader_attr<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_normal</span>   = shader_attr<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"normal"</span><span class="org-rainbow-delimiters-depth-2">)</span>;   
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span>    = shader_attr<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"color"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_proj</span>        = shader_uniform<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_projection"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_view</span>        = shader_uniform<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_view"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_model</span>       = shader_uniform<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_model"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_normal</span>      = shader_uniform<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_normal"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_product_ambient</span>  = shader_uniform<span class="org-rainbow-delimiters-depth-2">(</span>prog,  <span class="org-string">"u_product_ambient"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_product_diffuse</span>  = shader_uniform<span class="org-rainbow-delimiters-depth-2">(</span>prog,  <span class="org-string">"u_product_diffuse"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_product_specular</span> = shader_uniform<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_product_specular"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">const</span> <span class="org-type">GLint</span> <span class="org-variable-name">u_light_position</span>   = shader_uniform<span class="org-rainbow-delimiters-depth-2">(</span>prog, <span class="org-string">"u_light_position"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    set_uniform_matrix<span class="org-rainbow-delimiters-depth-2">(</span>u_proj,   matrix_identity<span class="org-rainbow-delimiters-depth-2">)</span>;
    set_uniform_matrix<span class="org-rainbow-delimiters-depth-2">(</span>u_view,   matrix_identity<span class="org-rainbow-delimiters-depth-2">)</span>;
    set_uniform_matrix<span class="org-rainbow-delimiters-depth-2">(</span>u_model,  matrix_identity<span class="org-rainbow-delimiters-depth-2">)</span>;
    set_uniform_matrix<span class="org-rainbow-delimiters-depth-2">(</span>u_normal, matrix_identity<span class="org-rainbow-delimiters-depth-2">)</span>; 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Ambient light RGB colors  </span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">La</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.0, 1.0, 0.5<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Diffuse light RGB colors </span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">Ld</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.6,  0.4, 0.9<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Specular light RGB colors </span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">Ls</span> = <span class="org-rainbow-delimiters-depth-2">{</span>1.0, 1.0, 1.0<span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">---- Material coefficients ------//</span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">ka</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.5, 0.2, 1.0<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">kd</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.8, 1.0, 1.0<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">ks</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.4, 0.3, 0.2<span class="org-rainbow-delimiters-depth-2">}</span>;
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">light_position</span> = <span class="org-rainbow-delimiters-depth-2">{</span> 1.0, 1.0, 1.0 <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [TRACE] Ambient =&gt;&gt; ka * La = "</span> &lt;&lt; <span class="org-rainbow-delimiters-depth-2">(</span>ka * La<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [TRACE] Diffuse =&gt;&gt; kd * Ld = "</span> &lt;&lt; <span class="org-rainbow-delimiters-depth-2">(</span>kd * Ld<span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">'\n'</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: The  product ka * La is an element-wise product.</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">It is not a dot product or cross product.</span>
    glUniform3fv<span class="org-rainbow-delimiters-depth-2">(</span>u_light_position,   1, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span> light_position <span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniform3fv<span class="org-rainbow-delimiters-depth-2">(</span>u_product_ambient,  1, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span> ka * La <span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniform3fv<span class="org-rainbow-delimiters-depth-2">(</span>u_product_diffuse,  1, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span> kd * Ld <span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glUniform3fv<span class="org-rainbow-delimiters-depth-2">(</span>u_product_specular, 1, <span class="org-constant">glm</span>::value_ptr<span class="org-rainbow-delimiters-depth-3">(</span> ks * Ls <span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;    

    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_planeXZ</span> = make_plane_mesh<span class="org-rainbow-delimiters-depth-2">(</span> 10.0, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">{</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-3">}</span>
                                    , <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">{</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-3">}</span>, Normal<span class="org-rainbow-delimiters-depth-3">{</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-3">}</span>, color_blue <span class="org-rainbow-delimiters-depth-2">)</span>;
    send_mesh<span class="org-rainbow-delimiters-depth-2">(</span>mesh_planeXZ, attr_position, attr_normal, attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_planeXY</span> = make_plane_mesh<span class="org-rainbow-delimiters-depth-2">(</span> 10.0, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">{</span>0.0, 1.0, 0.0<span class="org-rainbow-delimiters-depth-3">}</span>
                                    , <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">{</span>1.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-3">}</span>, Normal<span class="org-rainbow-delimiters-depth-3">{</span>0.0, 0.0, 1.0<span class="org-rainbow-delimiters-depth-3">}</span>, color_green <span class="org-rainbow-delimiters-depth-2">)</span>;
    send_mesh<span class="org-rainbow-delimiters-depth-2">(</span>mesh_planeXY, attr_position, attr_normal, attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_suzanne</span> = load_model<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"/suzanne.obj"</span>, Color<span class="org-rainbow-delimiters-depth-3">{</span>0.51, 0.56, 0.50<span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>; 
    send_mesh<span class="org-rainbow-delimiters-depth-2">(</span>mesh_suzanne, attr_position, attr_normal,  attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">transform_suzanne</span> =  matrix_identity;
    transform_suzanne = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span> transform_suzanne, -<span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span> -1.182, 1.306, 3.573<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    transform_suzanne = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span> transform_suzanne, +<span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span> 4.0, 3.0, 5.0<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;  
    <span class="org-comment-delimiter">// </span><span class="org-comment">model_matrix = glm::rotate( model_matrix, glm::radians(45.0f), glm::vec3(0, 0, 1));</span>

    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_cube</span> = load_model<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"/cube.obj"</span>, color_gold<span class="org-rainbow-delimiters-depth-2">)</span>;
    send_mesh<span class="org-rainbow-delimiters-depth-2">(</span>mesh_cube, attr_position, attr_normal, attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">transform_cube</span> = matrix_identity;
    transform_cube = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span> transform_cube, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>4.0, 2.0, 5.0<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    transform_cube = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-2">(</span> transform_cube, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-3">(</span>35.0f<span class="org-rainbow-delimiters-depth-3">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>1.0, 1.0, 2.0<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    transform_cube = <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-2">(</span> transform_cube, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>1.2, 1.2, 1.2<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh_teapot</span> = load_model<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"/teapot.obj"</span>, color_red<span class="org-rainbow-delimiters-depth-2">)</span>;
    send_mesh<span class="org-rainbow-delimiters-depth-2">(</span>mesh_teapot, attr_position, attr_normal, attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">transform_teapot</span> = matrix_identity;
    transform_teapot = <span class="org-constant">glm</span>::translate<span class="org-rainbow-delimiters-depth-2">(</span> transform_teapot, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>5.0, 5.0, 5.0<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    transform_teapot = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-2">(</span> transform_teapot, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-3">(</span>50.0f<span class="org-rainbow-delimiters-depth-3">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>3.0, 1.0, 5.0<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    transform_teapot = <span class="org-constant">glm</span>::scale<span class="org-rainbow-delimiters-depth-2">(</span> transform_teapot, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-3">(</span>1.0 / 8.0, 1.0 / 8.0, 1.0 / 8.0<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-type">int</span> <span class="org-variable-name">width</span>, <span class="org-variable-name">height</span>;
    glfwGetWindowSize<span class="org-rainbow-delimiters-depth-2">(</span>window, &amp;width, &amp;height<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Window aspect ratio</span>
    <span class="org-type">float</span> <span class="org-variable-name">aspect</span> = <span class="org-keyword">static_cast</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>width<span class="org-rainbow-delimiters-depth-2">)</span> / height;


    <span class="org-comment-delimiter">// </span><span class="org-comment">Set projection matrix uniform variable</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUniformMatrix4fv(u_proj, 1, GL_FALSE, glm::value_ptr(identity) );</span>

    <span class="org-type">Camera</span> <span class="org-variable-name">camera</span><span class="org-rainbow-delimiters-depth-2">(</span>u_view, u_proj, width / height<span class="org-rainbow-delimiters-depth-2">)</span>;
    camera.set_position<span class="org-rainbow-delimiters-depth-2">(</span>5.236, 4.078, 11.610<span class="org-rainbow-delimiters-depth-2">)</span>;
    camera.look_at<span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-rainbow-delimiters-depth-3">{</span> 4.0, 1.4, 5.166<span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set model matrix and update the normal matrix for </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">scene illumination calculations. </span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">set_model_matrix</span> = <span class="org-rainbow-delimiters-depth-2">[</span>&amp;<span class="org-variable-name">camera</span>, <span class="org-constant">u_normal</span>, <span class="org-constant">u_model</span><span class="org-rainbow-delimiters-depth-2">](</span><span class="org-keyword">const</span> <span class="org-constant">glm</span>::<span class="org-type">mat4</span>&amp; <span class="org-variable-name">model_transform</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        set_uniform_matrix<span class="org-rainbow-delimiters-depth-3">(</span>u_model, model_transform<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">glm</span>::<span class="org-type">mat4</span> <span class="org-variable-name">normal_matrix</span> = <span class="org-constant">glm</span>::transpose<span class="org-rainbow-delimiters-depth-3">(</span> <span class="org-constant">glm</span>::inverse<span class="org-rainbow-delimiters-depth-4">(</span>camera.get_view<span class="org-rainbow-delimiters-depth-5">()</span> * model_transform<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;
        set_uniform_matrix<span class="org-rainbow-delimiters-depth-3">(</span>u_normal, normal_matrix<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">//  </span><span class="org-comment">======= R E N D E R  - L O O P ============//</span>
    <span class="org-comment-delimiter">//                                             </span><span class="org-comment">//</span>
    <span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>glfwWindowShouldClose<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glClear<span class="org-rainbow-delimiters-depth-3">(</span>GL_COLOR_BUFFER_BIT  | GL_DEPTH_BUFFER_BIT<span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== BEGIN RENDERING ============//    </span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">set_uniform_matrix(u_model, matrix_identity);</span>
            set_model_matrix<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span>;
            mesh_planeXZ.draw_vertices<span class="org-rainbow-delimiters-depth-3">()</span>;

            <span class="org-comment-delimiter">// </span><span class="org-comment">set_uniform_matrix(u_model, matrix_identity);</span>
            set_model_matrix<span class="org-rainbow-delimiters-depth-3">(</span>matrix_identity<span class="org-rainbow-delimiters-depth-3">)</span>;
            mesh_planeXY.draw_vertices<span class="org-rainbow-delimiters-depth-3">()</span>;           

            set_uniform_matrix<span class="org-rainbow-delimiters-depth-3">(</span>u_model, transform_suzanne<span class="org-rainbow-delimiters-depth-3">)</span>;
            mesh_suzanne.draw_vertices<span class="org-rainbow-delimiters-depth-3">()</span>;

            set_uniform_matrix<span class="org-rainbow-delimiters-depth-3">(</span>u_model, transform_cube<span class="org-rainbow-delimiters-depth-3">)</span>;
            mesh_cube.draw_vertices<span class="org-rainbow-delimiters-depth-3">()</span>;          

            set_uniform_matrix<span class="org-rainbow-delimiters-depth-3">(</span>u_model, transform_teapot<span class="org-rainbow-delimiters-depth-3">)</span>;
            mesh_teapot.draw_vertices<span class="org-rainbow-delimiters-depth-3">()</span>;

        <span class="org-comment-delimiter">// </span><span class="org-comment">====== END RENDERING ==============//</span>

         <span class="org-comment-delimiter">// </span><span class="org-comment">Move camera to direction to where it is looking at.</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_UP <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS    <span class="org-rainbow-delimiters-depth-3">){</span> camera.move_forward<span class="org-rainbow-delimiters-depth-4">(</span>+2.0<span class="org-rainbow-delimiters-depth-4">)</span>;  <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_DOWN <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span> camera.move_forward<span class="org-rainbow-delimiters-depth-4">(</span>-2.0<span class="org-rainbow-delimiters-depth-4">)</span>;  <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around its Y axis </span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_RIGHT<span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_yaw<span class="org-rainbow-delimiters-depth-4">(</span>+5.0<span class="org-rainbow-delimiters-depth-4">)</span>;   <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, GLFW_KEY_LEFT <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_yaw<span class="org-rainbow-delimiters-depth-4">(</span>-5.0<span class="org-rainbow-delimiters-depth-4">)</span>;   <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate camera around its local X axis</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'S'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_pitch<span class="org-rainbow-delimiters-depth-4">(</span>+5.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'D'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">){</span> camera.rotate_pitch<span class="org-rainbow-delimiters-depth-4">(</span>-5.0<span class="org-rainbow-delimiters-depth-4">)</span>; <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'H'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around Z axis</span>
            transform_suzanne = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-4">(</span>transform_suzanne, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-5">(</span>10.0f<span class="org-rainbow-delimiters-depth-5">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-5">(</span>0, 0, 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'J'</span><span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">Rotate around Z axis</span>
            transform_suzanne = <span class="org-constant">glm</span>::rotate<span class="org-rainbow-delimiters-depth-4">(</span>transform_suzanne, <span class="org-constant">glm</span>::radians<span class="org-rainbow-delimiters-depth-5">(</span>10.0f<span class="org-rainbow-delimiters-depth-5">)</span>, <span class="org-constant">glm</span>::vec3<span class="org-rainbow-delimiters-depth-5">(</span>1, 0, 0<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">Reset camera - look at origin</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span> glfwGetKey<span class="org-rainbow-delimiters-depth-4">(</span>window, <span class="org-string">'R'</span> <span class="org-rainbow-delimiters-depth-4">)</span> == GLFW_PRESS  <span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            camera.set_position<span class="org-rainbow-delimiters-depth-4">(</span>4.0, 3.0, 2.5<span class="org-rainbow-delimiters-depth-4">)</span>;
            camera.look_at<span class="org-rainbow-delimiters-depth-4">(</span> <span class="org-rainbow-delimiters-depth-5">{</span>0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-5">}</span> <span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span>

        <span class="org-comment-delimiter">// </span><span class="org-comment">glm::mat4 normal_view_matrix = camera.normal_view( model_matrix ); </span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">set_uniform_matrix( u_normalview, normal_view_matrix );</span>


        <span class="org-comment-delimiter">/* </span><span class="org-comment">Swap front and back buffers */</span>
        glfwSwapBuffers<span class="org-rainbow-delimiters-depth-3">(</span>window<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-comment-delimiter">/* </span><span class="org-comment">Poll for and process events */</span>
        glfwWaitEvents<span class="org-rainbow-delimiters-depth-3">()</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-comment-delimiter">// </span><span class="org-comment">--- End while() --- //</span>

    glfwTerminate<span class="org-rainbow-delimiters-depth-2">()</span>;

    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">---------------------------------------//</span>

<span class="org-type">GLFWwindow</span>* 
<span class="org-function-name">make_glfwWindow</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span>  <span class="org-variable-name">width</span>, <span class="org-type">int</span> <span class="org-variable-name">height</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">title</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    glfwSetErrorCallback<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">error</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">description</span><span class="org-rainbow-delimiters-depth-3">)</span>
                         <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-4">(</span> stderr, <span class="org-string">" [GLFW ERROR] Error = %d ; Description = %s \n"</span>
                                        , error, description<span class="org-rainbow-delimiters-depth-4">)</span>;
                         <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">GLFWwindow</span>* <span class="org-variable-name">window</span> = glfwCreateWindow<span class="org-rainbow-delimiters-depth-2">(</span>width, height, title, <span class="org-constant">NULL</span>, <span class="org-constant">NULL</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> window != <span class="org-constant">nullptr</span> &amp;&amp; <span class="org-string">"Failed  to create Window"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">OpenGL context </span>
    glfwMakeContextCurrent<span class="org-rainbow-delimiters-depth-2">(</span>window<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Pain whole screen as black - dark screen colors are better </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">for avoding eye strain due long hours staring on monitor.</span>
    glClearColor<span class="org-rainbow-delimiters-depth-2">(</span>0.0f, 0.0f, 0.0f, 1.0f<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set - OpenGL Core Profile - version 3.3</span>
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MAJOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>; 
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_CONTEXT_VERSION_MINOR, 3<span class="org-rainbow-delimiters-depth-2">)</span>;
    glfwWindowHint<span class="org-rainbow-delimiters-depth-2">(</span>GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE<span class="org-rainbow-delimiters-depth-2">)</span>;

    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_COLOR_MATERIAL<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_DEPTH_TEST<span class="org-rainbow-delimiters-depth-2">)</span>;
    glEnable<span class="org-rainbow-delimiters-depth-2">(</span>GL_BLEND<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">--- Initialize GLEW library after OpenGL context --------- //</span>
<span class="org-preprocessor">    #if</span> _WIN32
    glewExperimental = GL_TRUE;
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span>glewInit<span class="org-rainbow-delimiters-depth-3">()</span> != GLEW_OK<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"GLEW::Error : failed to initialize GLEW"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-2">(</span>stderr, <span class="org-string">" [TRACE] Glew Initialized Ok. \n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">    #endif</span>


    <span class="org-keyword">return</span> window;
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Get shader uniform location and check error.</span>
<span class="org-type">GLint</span> <span class="org-function-name">shader_uniform</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">name</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">out</span> = glGetUniformLocation<span class="org-rainbow-delimiters-depth-2">(</span>program, name<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>out &lt; 0<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [SHADER ERROR] Uniform location not found = %s \n"</span>, name<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">return</span> out;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">GLint</span> <span class="org-function-name">shader_attr</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLint</span> <span class="org-variable-name">program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">name</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">out</span> = glGetAttribLocation<span class="org-rainbow-delimiters-depth-2">(</span>program, name<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>out &lt; 0<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-constant">std</span>::fprintf<span class="org-rainbow-delimiters-depth-3">(</span>stderr, <span class="org-string">" [SHADER ERROR] Attribute location not found = %s \n"</span>, name<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">return</span> out;
<span class="org-rainbow-delimiters-depth-1">}</span>



<span class="org-type">void</span> <span class="org-function-name">compile_shader</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">GLuint</span> <span class="org-variable-name">m_program</span>, <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span>, <span class="org-type">GLenum</span> <span class="org-variable-name">type</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">GLint</span> <span class="org-variable-name">shader_id</span> = glCreateShader<span class="org-rainbow-delimiters-depth-2">(</span> type <span class="org-rainbow-delimiters-depth-2">)</span>;
    glShaderSource<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, 1, &amp;code, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    glCompileShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">is_compiled</span> = GL_FALSE;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Check shader compilation result </span>
    glGetShaderiv<span class="org-rainbow-delimiters-depth-2">(</span>shader_id, GL_COMPILE_STATUS, &amp;is_compiled<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">shader_type</span> = <span class="org-rainbow-delimiters-depth-2">[</span>&amp;<span class="org-rainbow-delimiters-depth-2">]{</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>type == GL_VERTEX_SHADER   <span class="org-rainbow-delimiters-depth-3">){</span> <span class="org-keyword">return</span> <span class="org-string">"VERTEX_SHADER"</span>; <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>type == GL_FRAGMENT_SHADER <span class="org-rainbow-delimiters-depth-3">){</span> <span class="org-keyword">return</span> <span class="org-string">"FRAGMENT_SHADER"</span>; <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-keyword">return</span> <span class="org-string">"UNKNOWN"</span>; 
    <span class="org-rainbow-delimiters-depth-2">}()</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">If there is any shader compilation result, </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">print the error message.</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> is_compiled == GL_FALSE<span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">GLint</span> <span class="org-variable-name">length</span>;
        glGetShaderiv<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, GL_INFO_LOG_LENGTH, &amp;length<span class="org-rainbow-delimiters-depth-3">)</span>;
        assert<span class="org-rainbow-delimiters-depth-3">(</span> length &gt; 0 <span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">out</span><span class="org-rainbow-delimiters-depth-3">(</span>length + 1, 0x00<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">GLint</span> <span class="org-variable-name">chars_written</span>;
        glGetShaderInfoLog<span class="org-rainbow-delimiters-depth-3">(</span>shader_id, length, &amp;chars_written, out.data<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SHADER ERROR] = "</span> &lt;&lt; <span class="org-string">" ("</span> &lt;&lt; shader_type &lt;&lt; <span class="org-string">" ) =&gt;&gt; "</span> &lt;&lt; out &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Abort the exection of current process. </span>
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>          

    glAttachShader<span class="org-rainbow-delimiters-depth-2">(</span>m_program, shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;   
    glDeleteShader<span class="org-rainbow-delimiters-depth-2">(</span>shader_id<span class="org-rainbow-delimiters-depth-2">)</span>;
    glLinkProgram<span class="org-rainbow-delimiters-depth-2">(</span>m_program<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">GLint</span> <span class="org-variable-name">link_status</span> = GL_FALSE;
    glGetProgramiv<span class="org-rainbow-delimiters-depth-2">(</span>m_program, GL_LINK_STATUS, &amp;link_status<span class="org-rainbow-delimiters-depth-2">)</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> link_status != GL_FALSE <span class="org-rainbow-delimiters-depth-2">)</span>;   
    <span class="org-comment-delimiter">// </span><span class="org-comment">glUseProgram(m_program);         </span>
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-comment-delimiter">//  </span><span class="org-comment">Send mesh data to GPU  ----//</span>
<span class="org-type">void</span> <span class="org-function-name">send_mesh</span><span class="org-rainbow-delimiters-depth-1">(</span> <span class="org-type">Mesh</span>&amp; <span class="org-variable-name">mesh</span> , <span class="org-type">GLint</span> <span class="org-variable-name">attr_position</span> , <span class="org-type">GLint</span> <span class="org-variable-name">attr_normal</span>, <span class="org-type">GLint</span> <span class="org-variable-name">attr_color</span> <span class="org-rainbow-delimiters-depth-1">)</span> 
<span class="org-rainbow-delimiters-depth-1">{</span> 
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vao</span> = mesh.vao;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">vbo</span> = mesh.vbo;
    <span class="org-type">GLuint</span>&amp; <span class="org-variable-name">ibo</span> = mesh.ibo;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------------- Upload vertices --------------//</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VAO (Vertex Array Object)</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>vao == 0<span class="org-rainbow-delimiters-depth-2">){</span> glGenVertexArrays<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;vao<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>vao<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Generate and bind current VBO (Vertex Buffer Object)</span>
    glGenBuffers<span class="org-rainbow-delimiters-depth-2">(</span>1, &amp;vbo<span class="org-rainbow-delimiters-depth-2">)</span>;
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, vbo<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Upload vertex attributes (position, normal vector and color ) to GPU in a single call. </span>
    glBufferData<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, mesh.vertices.size<span class="org-rainbow-delimiters-depth-3">()</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex<span class="org-rainbow-delimiters-depth-3">)</span>
                , mesh.vertices.data<span class="org-rainbow-delimiters-depth-3">()</span>, GL_STATIC_DRAW<span class="org-rainbow-delimiters-depth-2">)</span>;   

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set data layout - how data will be interpreted.</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">=&gt; Each vertex has 3 coordinates.</span>
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_position<span class="org-rainbow-delimiters-depth-2">)</span>; 
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_position, 3, GL_FLOAT, GL_FALSE, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex<span class="org-rainbow-delimiters-depth-3">)</span>, <span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-preprocessor">    #if</span> 1 
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_normal<span class="org-rainbow-delimiters-depth-2">)</span>;          
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_normal, 3, GL_FLOAT, GL_FALSE, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex<span class="org-rainbow-delimiters-depth-3">)</span>     
                           <span class="org-comment-delimiter">// </span><span class="org-comment">Offset to color member variable in class Vertex</span>
                          , <span class="org-keyword">reinterpret_cast</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-3">&gt;(</span> offsetof<span class="org-rainbow-delimiters-depth-4">(</span>Vertex, normal<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>
                          <span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">    #endif</span> 

<span class="org-preprocessor">    #if</span> 1
    glEnableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;    
    glVertexAttribPointer<span class="org-rainbow-delimiters-depth-2">(</span> attr_color, 3, GL_FLOAT, GL_FALSE, <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-3">(</span>Vertex<span class="org-rainbow-delimiters-depth-3">)</span>     
                           <span class="org-comment-delimiter">// </span><span class="org-comment">Offset to color member variable in class Vertex</span>
                          , <span class="org-keyword">reinterpret_cast</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">void</span>*<span class="org-rainbow-delimiters-depth-3">&gt;(</span> offsetof<span class="org-rainbow-delimiters-depth-4">(</span>Vertex, color<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>
                          <span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">    #endif</span> 

    <span class="org-comment-delimiter">// </span><span class="org-comment">-------- Upload indices ----------------------//</span>
    <span class="org-comment-delimiter">//</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>mesh.indices.empty<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        glBindVertexArray<span class="org-rainbow-delimiters-depth-3">(</span>vao<span class="org-rainbow-delimiters-depth-3">)</span>;
        glGenBuffers<span class="org-rainbow-delimiters-depth-3">(</span>1, &amp;ibo<span class="org-rainbow-delimiters-depth-3">)</span>;
        glBindBuffer<span class="org-rainbow-delimiters-depth-3">(</span>GL_ELEMENT_ARRAY_BUFFER, ibo<span class="org-rainbow-delimiters-depth-3">)</span>;
        glBufferData<span class="org-rainbow-delimiters-depth-3">(</span>GL_ELEMENT_ARRAY_BUFFER, mesh.indices.size<span class="org-rainbow-delimiters-depth-4">()</span> * <span class="org-keyword">sizeof</span><span class="org-rainbow-delimiters-depth-4">(</span>GLuint<span class="org-rainbow-delimiters-depth-4">)</span>
                     , mesh.indices.data<span class="org-rainbow-delimiters-depth-4">()</span>, GL_STATIC_DRAW <span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ Disable Global state set by this function -----//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VAO </span>
    glBindVertexArray<span class="org-rainbow-delimiters-depth-2">(</span>0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind VBO </span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span>GL_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Unbind IBO </span>
    glBindBuffer<span class="org-rainbow-delimiters-depth-2">(</span> GL_ELEMENT_ARRAY_BUFFER, 0<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable current shader attribute </span>
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_position<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_normal<span class="org-rainbow-delimiters-depth-2">)</span>;
    glDisableVertexAttribArray<span class="org-rainbow-delimiters-depth-2">(</span>attr_color<span class="org-rainbow-delimiters-depth-2">)</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Load mesh from embedded resource file </span>
<span class="org-type">Mesh</span> <span class="org-function-name">load_model</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">const</span> <span class="org-constant">std</span>::<span class="org-type">string</span>&amp; <span class="org-variable-name">file</span>, <span class="org-keyword">const</span> <span class="org-type">Color</span>&amp; <span class="org-variable-name">color</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">reader_config</span> = <span class="org-constant">tinyobj</span>::ObjReaderConfig<span class="org-rainbow-delimiters-depth-2">{}</span>;
    reader_config.mtl_search_path = <span class="org-string">"./"</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">reader</span> = <span class="org-constant">tinyobj</span>::ObjReader<span class="org-rainbow-delimiters-depth-2">{}</span>;

    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">data</span> = get_resource<span class="org-rainbow-delimiters-depth-2">(</span>file<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Parse from file:</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">if( !reader.ParseFromString(file, reader_config) || !reader.Error().empty() </span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>reader.ParseFromString<span class="org-rainbow-delimiters-depth-3">(</span>data, <span class="org-string">""</span>, reader_config<span class="org-rainbow-delimiters-depth-3">)</span> || <span class="org-negation-char">!</span>reader.Error<span class="org-rainbow-delimiters-depth-3">()</span>.empty<span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [ERROR] "</span> &lt;&lt; reader.Error<span class="org-rainbow-delimiters-depth-3">()</span> &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-constant">std</span>::abort<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>reader.Warning<span class="org-rainbow-delimiters-depth-3">()</span>.empty<span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [WARNING] TinyObjReader = "</span> &lt;&lt; reader.Warning<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">auto</span> &amp;<span class="org-variable-name">attrib</span> = reader.GetAttrib<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">auto</span> &amp;<span class="org-variable-name">shapes</span> = reader.GetShapes<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">auto</span> &amp;<span class="org-variable-name">materials</span> = reader.GetMaterials<span class="org-rainbow-delimiters-depth-2">()</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> shapes.size<span class="org-rainbow-delimiters-depth-3">()</span> &gt;= 1 &amp;&amp; <span class="org-string">"It needs at least one shape."</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Mesh</span> <span class="org-variable-name">mesh</span>;
    mesh.draw_type = GL_TRIANGLES;

    <span class="org-type">size_t</span> <span class="org-variable-name">index_offset</span> = 0;
    <span class="org-type">int</span> <span class="org-variable-name">i</span> = 0;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Positive infinity point </span>
    <span class="org-constant">glm</span>::<span class="org-type">vec3</span> <span class="org-variable-name">current</span> = <span class="org-rainbow-delimiters-depth-2">{</span>0.0, 0.0, 0.0<span class="org-rainbow-delimiters-depth-2">}</span>, <span class="org-variable-name">a</span> = <span class="org-rainbow-delimiters-depth-2">{</span>2.0 / 0.0, 2.0, 2.0 / 0.0<span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Loop over face polygon </span>
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-type">size_t</span> <span class="org-variable-name">f</span>  = 0; f &lt; shapes<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>.mesh.num_face_vertices.size<span class="org-rainbow-delimiters-depth-3">()</span>; f++ <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">int</span> <span class="org-variable-name">fv</span> = shapes<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>.mesh.num_face_vertices<span class="org-rainbow-delimiters-depth-3">[</span>f<span class="org-rainbow-delimiters-depth-3">]</span>;
        <span class="org-comment-delimiter">// </span><span class="org-comment">Loop over vertices in the face </span>
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">size_t</span> <span class="org-variable-name">v</span> = 0; v &lt; fv; v++<span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-constant">tinyobj</span>::<span class="org-type">index_t</span> <span class="org-variable-name">idx</span> = shapes<span class="org-rainbow-delimiters-depth-4">[</span>0<span class="org-rainbow-delimiters-depth-4">]</span>.mesh.indices<span class="org-rainbow-delimiters-depth-4">[</span>index_offset + v<span class="org-rainbow-delimiters-depth-4">]</span>;
            <span class="org-constant">tinyobj</span>::<span class="org-type">real_t</span> <span class="org-variable-name">vx</span> = attrib.vertices<span class="org-rainbow-delimiters-depth-4">[</span>3 * idx.vertex_index + 0<span class="org-rainbow-delimiters-depth-4">]</span>;
            <span class="org-constant">tinyobj</span>::<span class="org-type">real_t</span> <span class="org-variable-name">vy</span> = attrib.vertices<span class="org-rainbow-delimiters-depth-4">[</span>3 * idx.vertex_index + 1<span class="org-rainbow-delimiters-depth-4">]</span>;
            <span class="org-constant">tinyobj</span>::<span class="org-type">real_t</span> <span class="org-variable-name">vz</span> = attrib.vertices<span class="org-rainbow-delimiters-depth-4">[</span>3 * idx.vertex_index + 2<span class="org-rainbow-delimiters-depth-4">]</span>;

            <span class="org-constant">tinyobj</span>::<span class="org-type">real_t</span> <span class="org-variable-name">nx</span> = attrib.normals<span class="org-rainbow-delimiters-depth-4">[</span>3 * idx.normal_index + 0<span class="org-rainbow-delimiters-depth-4">]</span>;
            <span class="org-constant">tinyobj</span>::<span class="org-type">real_t</span> <span class="org-variable-name">ny</span> = attrib.normals<span class="org-rainbow-delimiters-depth-4">[</span>3 * idx.normal_index + 1<span class="org-rainbow-delimiters-depth-4">]</span>;
            <span class="org-constant">tinyobj</span>::<span class="org-type">real_t</span> <span class="org-variable-name">nz</span> = attrib.normals<span class="org-rainbow-delimiters-depth-4">[</span>3 * idx.normal_index + 2<span class="org-rainbow-delimiters-depth-4">]</span>;
            <span class="org-comment-delimiter">// </span><span class="org-comment">Add vertex to mesh </span>
            mesh.vertices.push_back<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">{</span> Position<span class="org-rainbow-delimiters-depth-6">{</span>vx, vy, vz<span class="org-rainbow-delimiters-depth-6">}</span>, Normal<span class="org-rainbow-delimiters-depth-6">{</span>nx , ny, nz<span class="org-rainbow-delimiters-depth-6">}</span>, color<span class="org-rainbow-delimiters-depth-5">}</span><span class="org-rainbow-delimiters-depth-4">)</span>;
            current = <span class="org-rainbow-delimiters-depth-4">{</span>vx, vy, vz<span class="org-rainbow-delimiters-depth-4">}</span>;
            <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-4">(</span> <span class="org-constant">glm</span>::length<span class="org-rainbow-delimiters-depth-5">(</span> current <span class="org-rainbow-delimiters-depth-5">)</span> &lt; <span class="org-constant">glm</span>::length<span class="org-rainbow-delimiters-depth-5">(</span>a<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">){</span> a = current; <span class="org-rainbow-delimiters-depth-4">}</span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] i = %d; x = %f ; y = %f ; z = %f \n", i++, vx, vy, vz); </span>
            <span class="org-comment-delimiter">// </span><span class="org-comment">std::fprintf(stderr, " [TRACE] i = %d; nx = %f ; ny = %f ; nz = %f \n", i++, nx, ny, nz); </span>
        <span class="org-rainbow-delimiters-depth-3">}</span>

        index_offset += fv;
        shapes<span class="org-rainbow-delimiters-depth-3">[</span>0<span class="org-rainbow-delimiters-depth-3">]</span>.mesh.material_ids<span class="org-rainbow-delimiters-depth-3">[</span>f<span class="org-rainbow-delimiters-depth-3">]</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [DEBUG] Point with minimum distance from origin = "</span> &lt;&lt; a &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-keyword">return</span> mesh;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-function-name">std</span>::string 
get_resource<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">file_name</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] Before file "</span> &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">fs</span> = <span class="org-constant">cmrc</span>::<span class="org-constant">resource</span>::get_filesystem<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] Resource = "</span> &lt;&lt; fs.is_file<span class="org-rainbow-delimiters-depth-2">(</span>file_name <span class="org-rainbow-delimiters-depth-2">)</span> &lt;&lt; <span class="org-string">'\n'</span>;
    assert<span class="org-rainbow-delimiters-depth-2">(</span> fs.is_file<span class="org-rainbow-delimiters-depth-3">(</span>file_name<span class="org-rainbow-delimiters-depth-3">)</span> &amp;&amp; <span class="org-string">"Unable to resource find file."</span>  <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">fd</span> = fs.open<span class="org-rainbow-delimiters-depth-2">(</span>file_name<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">return</span> <span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-2">(</span>fd.begin<span class="org-rainbow-delimiters-depth-3">()</span>, fd.end<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<b>Building on Linux</b> 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build_linux -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build_linux --target
</pre>
</div>

<p>
<b>Cross-compiling for Windows from Linux via MINGW Docker</b> 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ docker run -it --rm -v $<span class="org-variable-name">PWD</span>:/cwd -w /cwd --entrypoint=bash dockcross/windows-static-x64
$ cmake -H. -B_build_windows -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build_windows --target
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2022-09-16 Fri 07:37</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
