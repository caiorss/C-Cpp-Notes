<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-06-22 Mon 02:13 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Embedded Scripting Languages</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="cpp/c++ embedded scripting languages survey"
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<link href="theme/org-nav-theme.css" rel="stylesheet">
<script src="theme/org-nav-theme.js"></script>
<link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Embedded Scripting Languages</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org29be665">1. Embedded Scripting Languages</a>
<ul>
<li><a href="#orgba9ab15">1.1. Overview</a></li>
<li><a href="#org8d3cbf3">1.2. Embedded Scripting Languages Selection</a></li>
<li><a href="#orgf7ac4d4">1.3. MuParser - Math expression parser</a></li>
<li><a href="#org2d6e577">1.4. Exprtk - Math expression parser</a></li>
<li><a href="#org8d237d9">1.5. Lua scripting engine</a>
<ul>
<li><a href="#orgaf9bad7">1.5.1. Overview</a></li>
<li><a href="#org803044b">1.5.2. Further Reading</a></li>
<li><a href="#org96c2d79">1.5.3. Example project with Sol2 C++ binding library</a></li>
</ul>
</li>
<li><a href="#org5681f02">1.6. Squirrel Scripting Language</a>
<ul>
<li><a href="#orge635665">1.6.1. Overview</a></li>
<li><a href="#orgb3149fd">1.6.2. Building Squirrel standalone REPL interpreter</a></li>
<li><a href="#org5b9a683">1.6.3. Example - embedding Squirrel with Squall Library</a></li>
</ul>
</li>
<li><a href="#org8c2cb1a">1.7. Duktape - Embeddable Javascript Engine</a>
<ul>
<li><a href="#org06ecfde">1.7.1. Overview</a></li>
<li><a href="#orgdf4fb3c">1.7.2. Example project with DukGlue C++ binding library</a></li>
<li><a href="#org3b58f47">1.7.3. Example project with Duktape-CC binding library</a></li>
</ul>
</li>
<li><a href="#orge64d625">1.8. Python Engine via Pybind11</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org29be665" class="outline-2">
<h2 id="org29be665"><span class="section-number-2">1</span> Embedded Scripting Languages</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgba9ab15" class="outline-3">
<h3 id="orgba9ab15"><span class="section-number-3">1.1</span> Overview</h3>
<div class="outline-text-3" id="text-1-1">
<p>
<b>Reasonable Features of Embedded Scripting Languages</b>
</p>

<p>
This section lsits some reasonable features that a language designed
to be embedded should have:
</p>

<ul class="org-ul">
<li><span class="underline">Ligthweight</span> -  Small footprint, small size and memory requirements.</li>

<li><span class="underline">Scripting Engine as a library</span>:
<ul class="org-ul">
<li>Must be available as C or C++ library which exposes the
interpreter API allowing the client code to evaluate scripting
code from strings or files and also to retrieve objects from the
virtual machine memory.</li>
</ul></li>

<li><span class="underline">Sandboxing or capability limitations</span>
<ul class="org-ul">
<li>A reasonable requirement for an embedded scripting language is
limiting the capabilities and APIs which can be used possibly
allowing the execution of non-trusted scripts. Example: the
Javascript engines of most web browsers do not allow the script
to interact with file systems or operating system APIs.</li>
</ul></li>

<li><span class="underline">Permissive License for static linking</span></li>

<li><span class="underline">Use Cases</span>
<ul class="org-ul">
<li>DSL - Domain Specific Languages</li>
<li>Game Engines</li>
<li>Configuration files =&gt; Data Description language.</li>
<li>User content</li>
<li>Allow application runtime changes without recompilation.</li>
<li>User extension without modification of source code.</li>
</ul></li>
</ul>

<p>
<b>Examples of embedded scripting languages usage and use-cases</b>
</p>

<ul class="org-ul">
<li>TCL - Tool Command Language =&gt; Used by many EDA - Electronic
Design Automation Sofware in electronic engineering.</li>

<li>JavaScript =&gt; Used in Web Browsers, which are written mostly in
C++, for controlling user interaction, animation and etc.</li>

<li>TinyScheme =&gt; Used by GNU GIMP drawing application ans Apple's
MacOSX sandbox configuration.</li>

<li>Lua language =&gt; Used by many game engines and also by
applications such as: Nginx web server; Linux Conky; Geany
Editor; NMap editor and so on.</li>

<li>Squirrel Language =&gt; Used in game engines</li>

<li>Python
<ul class="org-ul">
<li>=&gt; Python is used as embedded scripting language by GDB - GNU
Debugger ; WinDBG  - Windows Debugger; IDA - Debugger for
Reverse Engineering.</li>
<li>Disadvantages: Python has a large footprint; it was not
designed as an embedded scripting language and it is not
possible to forbid the interpreter from calling file system
and process creation APIs.</li>
</ul></li>

<li>AutoLisp [proprietary] =&gt; Lisp-like language used in Autocad.</li>

<li>SQL (Structured Query Language) =&gt; Many databases are
implemented in C or C++ uses SQL as scripting language and
domain specific language (DSL) for querying and storing
data. Example: SQLite, Postgres SQL, &#x2026;</li>

<li>Emacs Lisp =&gt; Emacs core, including the LISP
engine/interpreter, is written in C and other parts are
written in Emacs Lisp. This lisp dialect allows extending Emacs
at with custom extensions (plugins) and also modifying the
application behavior at runtime.</li>

<li>VBA - Visual Basic for Application [proprietary] =&gt; Used in
Microsft Office Suite, specially in Microsft Excel.</li>
</ul>

<p>
<b>Considerations for choosing embedded scripting languages</b>
</p>

<ul class="org-ul">
<li>Small footprint and small overhead</li>

<li>Stability of C or C++ API</li>

<li>C++ API bindings</li>

<li>Permissive license for static linking or option of dual license
for static linking.</li>

<li>Documentation and of C or C++ binding APIs, examples about binding
code</li>

<li>Garbage collector implementation</li>

<li>Heavy duty computations with significant overhead should be
performed on the C++-side, specially loops.</li>

<li>JIT - Just-In-Time compiler =&gt; can increase the performance by
translating bytecodes into machine code.
<ul class="org-ul">
<li>Example: Lua JIT, Javascript V8 engine used by Chrome browser.</li>
</ul></li>

<li>Features for running untrusted scripts or configuration: 

<ul class="org-ul">
<li>Ability for restricting capabilities such as creating process,
accessing the file system and so on.</li>

<li>Non-turing complete =&gt; better for configuration</li>
</ul></li>

<li>Familiarity of the targe audience

<ul class="org-ul">
<li>Lua is pervasive in Games</li>

<li>TCL is pervasive on Electronic Design Automation Software</li>

<li>Javascript is widely used on the Web, NodeJS and also as
embedded scripting language of web browsers.</li>
</ul></li>
</ul>

<p>
<b>Further Reading</b> 
</p>

<ul class="org-ul">
<li><a href="https://accu.org/index.php/journals/351">ACCU - Embedded Scripting Languages</a></li>

<li><a href="https://github.com/dbohdan/embedded-scripting-languages">GitHub - dbohdan/embedded-scripting-languages: A list of embedded scripting languages</a></li>

<li><a href="https://articles.emptycrate.com/2016/03/26/so-you-want-to-embed-a-scripting-language.html">EmptyCrate.com: So You Want to Embed A Scripting Language in Your Application</a></li>

<li><a href="https://softwareengineering.stackexchange.com/questions/403911/what-makes-a-scripting-language-embeddable">What makes a scripting language "embeddable"? - Software Engineering Stack Exchange</a></li>
</ul>
</div>
</div>

<div id="outline-container-org8d3cbf3" class="outline-3">
<h3 id="org8d3cbf3"><span class="section-number-3">1.2</span> Embedded Scripting Languages Selection</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Selection of embedded scripting languages and engines available as  libraries:
</p>

<p>
<b>Non categorized:</b>
</p>

<ul class="org-ul">
<li><a href="http://tcl-lang.org/">TCL</a> - Tool Command Language
<ul class="org-ul">
<li>License: akin to BSD</li>
<li>Implementation: C</li>
<li>Syntax Type: N/A</li>
<li>Note: pervasive in EDA - Electronic Design Automation software.</li>
<li>See:
<ul class="org-ul">
<li><a href="https://wiki.tcl-lang.org/page/How+to+embed+Tcl+in+C+applications">How to embed Tcl in C applications</a></li>
</ul></li>
</ul></li>

<li><a href="https://github.com/mruby/mruby">mruby</a> (Embeddable Ruby implementation)
<ul class="org-ul">
<li>License: BSD</li>
<li>Implementation: C</li>
<li>Syntax type: Ruby</li>
</ul></li>

<li><a href="https://github.com/munificent/wren">Wren</a>
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C</li>
<li>Syntax Type: N/A</li>
</ul></li>

<li><a href="https://www.jinx-lang.org/">Jinx</a>
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C++17</li>
<li>Syntax Type: N/A</li>
</ul></li>

<li><a href="https://marcobambini.github.io/gravity">Gravity</a>
<ul class="org-ul">
<li>License: -</li>
<li>Implementation: C</li>
<li>Syntax type: Apple's SWIFT language</li>
</ul></li>

<li><a href="https://github.com/GaijinEntertainment/daScript">DaScript</a> 
<ul class="org-ul">
<li>License: -</li>
<li>Implementation: C++14</li>
<li>Syntax type: Akin to Python</li>
</ul></li>
</ul>

<p>
<b>Lua or similar to Lua (mimics Lua syntax)</b>
</p>

<ul class="org-ul">
<li><a href="http://lua.org/">Lua</a>
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C</li>
<li>Syntax Type: syntax inspired by scheme.</li>
</ul></li>

<li><a href="http://luajit.org/">LuaJIT</a> (Lua with JIT - Just-in-Time compiler which translates
bytecodes to native machine code for better performance.)
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C</li>
<li>Syntax type:  lua</li>
</ul></li>

<li><a href="http://www.gmscript.com/">GameMonkey Script</a>
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C++</li>
<li>Syntax type: Akin to Lua</li>
</ul></li>

<li><a href="http://squirrel-lang.org/">Squirrel</a>
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C++</li>
<li>Syntax type:    Lua-like</li>
<li>Note: Despite be implemented in C++, does not expose a C++ API,
it exposes a C API.</li>
</ul></li>

<li><a href="https://github.com/mingodad/squilu">Squilu</a> (Squirrel fork)
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C++</li>
<li>Syntax type: Lua-like</li>
</ul></li>
</ul>

<p>
<b>Similar to C++ (syntax that mimics C++)</b>
</p>

<ul class="org-ul">
<li><a href="http://www.angelcode.com/angelscript/">AngelScript</a>  (Note: statically typed)
<ul class="org-ul">
<li>License: Zlib</li>
<li>Implementation: C++</li>
<li>Syntax type: C++-like</li>
</ul></li>

<li><a href="http://chaiscript.com/">ChaiScript</a> 
<ul class="org-ul">
<li>License: BSD</li>
<li>Implementation: C++</li>
<li>Syntax type: C++-like</li>
</ul></li>
</ul>


<p>
<b>Smiliar to Javascript or subset of Javascript (ECMAScript)</b>
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/SpiderMonkey">SpiderMonkey</a> - Java Script Engine (VM - Virtual Machine)
used by Mozzila Firefox. 
<ul class="org-ul">
<li>License: MPL 2.0</li>
<li>Implementation: C and C++</li>
<li>Syntax tyope: JavScript (ECMAscript)</li>
<li>Used by:
<ul class="org-ul">
<li>Firefox Web Browser</li>
<li>MongoDB Document Database</li>
<li><a href="https://blog.couchdb.org/2020/02/26/the-road-to-couchdb-3-0-update-to-javascript-engine/">CoucheDB</a></li>
<li>Adobe Acrobat Reader</li>
</ul></li>
<li>See:
<ul class="org-ul">
<li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey/How_to_embed_the_JavaScript_engine">Mozilla - How to embed the JavaScript engine</a></li>
</ul></li>
<li>Repository:
<ul class="org-ul">
<li><a href="https://github.com/ricardoquesada/Spidermonkey/">https://github.com/ricardoquesada/Spidermonkey/</a></li>
</ul></li>
</ul></li>

<li><a href="http://duktape.org/">Duktape</a>
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C</li>
<li>Syntax type: Javascript (aka ECMAScript) E5/E5.1</li>
</ul></li>

<li><a href="https://github.com/espruino/Espruino">Espruino</a>
<ul class="org-ul">
<li>License: MPL 2</li>
<li>Implementation: C</li>
<li>Syntax type: ES5 - Javascript (ECMaScript)</li>
</ul></li>

<li><a href="https://github.com/jerryscript-project/jerryscript">JerryScript</a>
<ul class="org-ul">
<li>License: Apache v2</li>
<li>Implementation: C</li>
<li>Syntax type: Javascript (ECMAScript)</li>
</ul></li>
</ul>


<p>
<b>Similar to Lisp or Scheme</b>
</p>

<ul class="org-ul">
<li><a href="https://gitlab.com/embeddable-common-lisp/ecl">ECL - Embeddable Common Lisp</a>
<ul class="org-ul">
<li>License: LGPL - 2</li>
<li>Implementation: C</li>
<li>Syntax type:    Lisp, Common Lisp</li>
</ul></li>

<li><a href="http://tinyscheme.sourceforge.net/">TinyScheme</a>
<ul class="org-ul">
<li>License: BSD</li>
<li>Implementation: C</li>
<li>Syntax tyope: scheme, lisp</li>
<li>Note: Used in GNU GIMP as scripting language and Apple MacOSX's
sandbox as configuration language.</li>
</ul></li>

<li><a href="https://ccrma.stanford.edu/software/snd/snd/s7.html">S7 Scheme</a> (Variant of TinyScheme)
<ul class="org-ul">
<li>License: BSD</li>
<li>Implementation: C</li>
<li>Syntax type: C</li>
</ul></li>

<li><a href="https://github.com/ashinn/chibi-scheme">Chibi Scheme</a>
<ul class="org-ul">
<li>Implementation: C</li>
<li>Syntax type: Scheme, Lisp</li>
</ul></li>

<li><a href="https://janet-lang.org/">Janet Language</a>
<ul class="org-ul">
<li>License: MIT</li>
<li>Implementation: C</li>
<li>Syntax type: Clojure, Lisp</li>
</ul></li>

<li><a href="https://github.com/SuperFola/Ark">ArkScript</a>  
<ul class="org-ul">
<li>License: MPL license</li>
<li>Implementation: C</li>
<li>Syntax type: Lisp-like, more clojure-like</li>
</ul></li>
</ul>

<p>
License obligations and requirements:
</p>

<ul class="org-ul">
<li><b>LGPL</b> allows dynamically linking of closed source
applications, but static linking requires source code disclosure
and release under the same license. Some LGPL libraries, such as
QT, allows static linking via commercial license.</li>

<li>MIT, BSD, APACHE and so on =&gt; Add a copy of the license; Give credit.</li>
</ul>
</div>
</div>

<div id="outline-container-orgf7ac4d4" class="outline-3">
<h3 id="orgf7ac4d4"><span class="section-number-3">1.3</span> MuParser - Math expression parser</h3>
<div class="outline-text-3" id="text-1-3">
<p>
MuParser is a non-turing complete embedded scripting engine for
evaluating math expressions. 
</p>

<p>
Web Site: 
</p>
<ul class="org-ul">
<li><a href="https://beltoforion.de/article.php?a=muparser">https://beltoforion.de/article.php?a=muparser</a></li>
</ul>

<p>
Repository: 
</p>
<ul class="org-ul">
<li><a href="https://github.com/beltoforion/muparser/">https://github.com/beltoforion/muparser/</a></li>
</ul>

<p>
Conan Reference: 
</p>
<ul class="org-ul">
<li><a href="https://bintray.com/conan-community/conan/muparser%3Aconan/2.2.6%3Astable">muparser/2.2.6@conan/stable</a></li>
</ul>

<p>
<b>Sample Project</b>
</p>

<p>
File: <b>CMakeLists.txt</b>
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.9)
<span class="org-function-name">project</span>(cppexperiments)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-comment"># ============= Conan Bootstrap =============================#</span>

<span class="org-comment"># Download automatically, you can also just copy the conan.cmake file</span>
<span class="org-keyword">if</span>(NOT EXISTS <span class="org-string">"${</span><span class="org-variable-name">CMAKE_BINARY_DIR</span><span class="org-string">}/conan.cmake"</span>)
   <span class="org-function-name">message</span>(STATUS <span class="org-string">"Downloading conan.cmake from https://github.com/conan-io/cmake-conan"</span>)
   <span class="org-function-name">file</span>(DOWNLOAD <span class="org-string">"https://github.com/conan-io/cmake-conan/raw/v0.13/conan.cmake"</span>
                 <span class="org-string">"${</span><span class="org-variable-name">CMAKE_BINARY_DIR</span><span class="org-string">}/conan.cmake"</span>)
<span class="org-keyword">endif</span>()

<span class="org-function-name">include</span>(${<span class="org-variable-name">CMAKE_BINARY_DIR</span>}/conan.cmake)

<span class="org-comment"># Possible values "default" and "llvm8"</span>
<span class="org-function-name">set</span>(CONAN_PROFILE default)

<span class="org-function-name">conan_cmake_run</span>(REQUIRES
                muparser/2.2.6@conan/stable
                BASIC_SETUP
                BUILD missing)

 <span class="org-comment">#======= Targets Settings ===============+#</span>

<span class="org-function-name">add_executable</span>(muparser1_formula muparser1_formula.cpp)
<span class="org-function-name">target_link_libraries</span>(muparser1_formula muparser)
</pre>
</div>

<p>
File: <b>muparser1_formula.cpp</b>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cmath</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">muParser.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Defined for UNIX-like: Linux, Mac OSX, QNX, ...</span>
<span class="org-preprocessor">#if</span> __unix__
<span class="org-preprocessor">  #include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">unistd.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#endif</span>

<span class="org-type">bool</span> <span class="org-function-name">isTTY_terminal</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-preprocessor">   #if</span> __unix__
      <span class="org-keyword">return</span> ::ttyname<span class="org-rainbow-delimiters-depth-2">(</span>STDIN_FILENO<span class="org-rainbow-delimiters-depth-2">)</span> != <span class="org-constant">nullptr</span>;
<span class="org-preprocessor">   #else</span>
      <span class="org-keyword">return</span> <span class="org-constant">false</span>;
<span class="org-preprocessor">   #endif</span>
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">double</span> <span class="org-function-name">future_value</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">PV</span>, <span class="org-type">double</span> <span class="org-variable-name">rate</span>, <span class="org-type">double</span> <span class="org-variable-name">nper</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">return</span> PV * <span class="org-constant">std</span>::pow<span class="org-rainbow-delimiters-depth-2">(</span>1 + rate / 100.0, nper<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>

    <span class="org-constant">mu</span>::<span class="org-type">Parser</span> <span class="org-variable-name">p1</span>;

    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n====== EXPERIMENT 1 - Simple math expression ======="</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    p1.SetExpr<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"2^1 + 2^3 + 2^4"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [*] p1-A value: "</span>
              &lt;&lt; p1.GetExpr<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; p1.Eval<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;

    p1.SetExpr<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"3.5 * 10 - sin(3.1415) * 2.0 + sqrt(10) / 100.0 + 2^3"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [*] p1-B value: "</span>
              &lt;&lt; p1.GetExpr<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; p1.Eval<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;

    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n====== EXPERIMENT 2 - Expression with variables ======="</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    p1.DefineConst<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"pi"</span>, 3.1415<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">double</span> <span class="org-variable-name">x</span> = 10.0, <span class="org-variable-name">y</span> = 4.5;
    p1.DefineVar<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"x"</span>, &amp;x<span class="org-rainbow-delimiters-depth-2">)</span>;
    p1.DefineVar<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"y"</span>, &amp;y<span class="org-rainbow-delimiters-depth-2">)</span>;
    p1.SetExpr<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" 3 * pi + sin(pi) + 4 * x + y - 5"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [*] p1-C value: "</span>
              &lt;&lt; p1.GetExpr<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; p1.Eval<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;

    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n====== EXPERIMENT 3 - Expression with custom function ======="</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    p1.DefineFun<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"fv"</span>, &amp;future_value<span class="org-rainbow-delimiters-depth-2">)</span>;

    p1.DefineFun<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"payoff"</span>, <span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">double</span> <span class="org-variable-name">S</span>, <span class="org-type">double</span> <span class="org-variable-name">K</span><span class="org-rainbow-delimiters-depth-3">){</span>
        <span class="org-keyword">return</span> <span class="org-constant">std</span>::max<span class="org-rainbow-delimiters-depth-4">(</span>S - K, 0.0<span class="org-rainbow-delimiters-depth-4">)</span>;
    <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    p1.SetExpr<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"fv(100, 2, 8) + payoff(100, 90)"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [*] p1-D value: "</span> &lt;&lt; p1.GetExpr<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">" = "</span> &lt;&lt; p1.Eval<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;


    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n====== EXPERIMENT 4 - Parser error handling ======="</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">When an error happens it throws an exception: mu::ParserError</span>
    <span class="org-keyword">try</span><span class="org-rainbow-delimiters-depth-2">{</span>
        p1.SetExpr<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"10.2 * 5.0 + a * 3"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">double</span> <span class="org-variable-name">value</span> = p1.Eval<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [*] p1-E value: "</span> &lt;&lt; value &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">mu</span>::<span class="org-type">ParserError</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [ERROR] p1-C Parser error: "</span> &lt;&lt; ex.GetMsg<span class="org-rainbow-delimiters-depth-3">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>


    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n====== EXPERIMENT 5 - Calutor Interactive Shell ======"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>isTTY_terminal<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" === Calculator Started OK. ====="</span> &lt;&lt; <span class="org-constant">std</span>::endl;

        <span class="org-constant">mu</span>::<span class="org-type">Parser</span> <span class="org-variable-name">p2</span>;
        <span class="org-type">double</span> <span class="org-variable-name">ans</span> = 0.0;
        p2.DefineVar<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"ans"</span>, &amp;ans<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">line</span>;

        <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">std</span>::cin.good<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span>
        <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" EXPR =&gt; "</span>;
            <span class="org-constant">std</span>::getline<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-constant">std</span>::cin, line<span class="org-rainbow-delimiters-depth-4">)</span>;

            <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-4">(</span>line == <span class="org-string">""</span><span class="org-rainbow-delimiters-depth-4">)</span>
                <span class="org-keyword">continue</span>;

            <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-4">(</span>line == <span class="org-string">"quit"</span><span class="org-rainbow-delimiters-depth-4">)</span>
                <span class="org-keyword">break</span>;

            p2.SetExpr<span class="org-rainbow-delimiters-depth-4">(</span>line<span class="org-rainbow-delimiters-depth-4">)</span>;
            <span class="org-keyword">try</span> <span class="org-rainbow-delimiters-depth-4">{</span>
                ans = p2.Eval<span class="org-rainbow-delimiters-depth-5">()</span>;
                <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" =&gt; ans = "</span> &lt;&lt; ans &lt;&lt; <span class="org-string">"\n\n"</span>;
            <span class="org-rainbow-delimiters-depth-4">}</span> <span class="org-keyword">catch</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-constant">mu</span>::<span class="org-type">ParserError</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-4">)</span>
            <span class="org-rainbow-delimiters-depth-4">{</span>
                <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [ERROR] Parser error "</span> &lt;&lt; ex.GetMsg<span class="org-rainbow-delimiters-depth-5">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
            <span class="org-rainbow-delimiters-depth-4">}</span>
        <span class="org-rainbow-delimiters-depth-3">}</span>

    <span class="org-rainbow-delimiters-depth-2">}</span>

<span class="org-preprocessor">#if</span> _WIN32
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"Enter RETURN to exit. "</span> &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-constant">std</span>::cin.get<span class="org-rainbow-delimiters-depth-2">()</span>;
<span class="org-preprocessor">#endif</span>
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
<b>Program output:</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ./muparser1_formula 

====== EXPERIMENT 1 - Simple math expression =======
 [*] p1-A value: 2^1 + 2^3 + 2^4  = 26
 [*] p1-B value: 3.5 * 10 - sin(3.1415) * 2.0 + sqrt(10) / 100.0 + 2^3  = 43.0314

====== EXPERIMENT 2 - Expression with variables =======
 [*] p1-C value:  3 * pi + sin(pi) + 4 * x + y - 5  = 48.9246

====== EXPERIMENT 3 - Expression with custom <span class="org-keyword">function</span> =======
 [*] p1-D value: fv(100, 2, 8) + payoff(100, 90)  = 127.166

====== EXPERIMENT 4 - Parser error handling =======
 [ERROR] p1-C Parser error: Unexpected token <span class="org-string">"a"</span> found at position 13.

====== EXPERIMENT 5 - Calutor Interactive Shell ======
 === Calculator Started OK. =====
 EXPR =&gt; 9.81 * sin(3.1415 / 2.0) + 100 * sqrt(285.6) + exp(3.65)
 =&gt; ans = 1738.26

 EXPR =&gt; ans / 100.0 - 80.0
 =&gt; ans = -62.6174

 EXPR =&gt; ans * ans
 =&gt; ans = 3920.94

 EXPR =&gt; 

</pre>
</div>
</div>
</div>

<div id="outline-container-org2d6e577" class="outline-3">
<h3 id="org2d6e577"><span class="section-number-3">1.4</span> Exprtk - Math expression parser</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Exprtk is a MIT-license single-header, header-only and turing-complete
math expression parsing engine.
</p>

<p>
Official Web Site: 
</p>

<ul class="org-ul">
<li><a href="http://www.partow.net/programming/exprtk/">http://www.partow.net/programming/exprtk/</a></li>
</ul>

<p>
Official repository: 
</p>

<ul class="org-ul">
<li><a href="https://github.com/ArashPartow/exprtk/">https://github.com/ArashPartow/exprtk/</a></li>
</ul>

<p>
Features: 
</p>

<ul class="org-ul">
<li>Header-only library in  a single file.</li>
<li>Turing-complete</li>
<li>Sandboxed</li>
<li>Supports binding to defined-functions in C++-side.</li>
<li>Functions can operate on vectors</li>
<li>Control structures: for-loop; if-else; ternary operator.</li>
</ul>

<p>
Drawbacks: 
</p>

<ul class="org-ul">
<li>The library exprtk.hpp has one megabyte (1 mb) in a single header
file which significantly slows down the compile-time. Header-only
design should only be used for small libraries.</li>
</ul>


<p>
<b>Sample Project</b> 
</p>

<ul class="org-ul">
<li>GIST: <a href="https://gist.github.com/2ff870b653b2ec1519bf0423165db1c5">https://gist.github.com/2ff870b653b2ec1519bf0423165db1c5</a></li>

<li>Note: The static library target 'mparser' makes the compile-time
of the client code 'main.cpp' faster by using the PIMPL
(Pointer-To-Implementation) design pattern and not exposing
exprtk.hpp in the library header file.</li>
</ul>

<p>
File: CMakeLists.txt 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.9)
<span class="org-function-name">project</span>(exprk-parser)

<span class="org-comment">#========== Global Configurations =============#</span>
<span class="org-comment">#----------------------------------------------#</span>

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)     
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)
<span class="org-function-name">set</span>(CMAKE_CXX_EXTENSIONS OFF)

<span class="org-comment">#----------- Add dependencies --------------------------#</span>

<span class="org-comment">#============= Functions and macros ===========================#</span>
<span class="org-keyword">macro</span>(Download_Single_Headerlib FILE URL)
    <span class="org-function-name">file</span>(DOWNLOAD ${<span class="org-variable-name">URL</span>} ${<span class="org-variable-name">CMAKE_BINARY_DIR</span>}/include/${<span class="org-variable-name">FILE</span>})
    <span class="org-keyword">IF</span>(NOT Download_Single_Headerlib_flag)
       <span class="org-function-name">include_directories</span>(${<span class="org-variable-name">CMAKE_BINARY_DIR</span>}/include)
       <span class="org-function-name">set</span>(Download_Single_Headerlib_flag TRUE)
    <span class="org-keyword">ENDIF</span>()
<span class="org-keyword">endmacro</span>()

<span class="org-function-name">Download_Single_Headerlib</span>( exprtk.hpp 
                           https://github.com/ArashPartow/exprtk/raw/d81ac1a2ddd9877a7981d32c731fd9a75544ec68/exprtk.hpp )

<span class="org-comment">#-----------  Target settings -------------------------------#</span>

          <span class="org-function-name">add_library</span>( mparser mparser.cpp mparser.hpp )
       <span class="org-function-name">add_executable</span>( main main.cpp )
<span class="org-function-name">target_link_libraries</span>( main mparser )
</pre>
</div>

<p>
File: mparser.hpp  (cmake target: mparser static library)
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#if</span><span class="org-negation-char"><span class="org-preprocessor">n</span></span><span class="org-preprocessor">def</span> _MPARSER_HPP_
<span class="org-preprocessor">#define</span> <span class="org-variable-name">_MPARSER_HPP_</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">memory</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">functional</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>


<span class="org-comment-delimiter">// </span><span class="org-comment">Unique-ownership smart pointer for implementing PimPl</span>
<span class="org-comment-delimiter">// </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Note: It was created because std::uniqe_ptr does </span>
<span class="org-comment-delimiter">//       </span><span class="org-comment">not support 'incomplete types'.</span>
<span class="org-comment-delimiter">//  </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">Note: PimPl (Pointer-To-Implementation) idiom </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">is a technique for reducing compile-time and </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">maintaining ABI stability which mitigates the </span>
<span class="org-comment-delimiter">// </span><span class="org-comment">fragile-ABI problem.</span>
<span class="org-comment-delimiter">// </span>
<span class="org-keyword">template</span><span class="org-rainbow-delimiters-depth-1">&lt;</span><span class="org-keyword">typename</span> <span class="org-type">T</span>, <span class="org-type">void</span> <span class="org-rainbow-delimiters-depth-2">(</span>*<span class="org-function-name">disposer</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">T</span>*<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">&gt;</span>
<span class="org-keyword">class</span> <span class="org-type">pimpl_ptr</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">T</span>*       <span class="org-variable-name">m_hnd</span>;    
<span class="org-function-name">public</span>:
    <span class="org-function-name">pimpl_ptr</span><span class="org-rainbow-delimiters-depth-2">()</span>
        : m_hnd<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">nullptr</span><span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-comment-delimiter">//</span><span class="org-comment">, m_disp(disp) </span>
        <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-function-name">pimpl_ptr</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">T</span>* <span class="org-variable-name">hnd</span><span class="org-rainbow-delimiters-depth-2">)</span>
        : m_hnd<span class="org-rainbow-delimiters-depth-2">(</span>hnd<span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-2">}</span>

    ~<span class="org-function-name">pimpl_ptr</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;release<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable copy constructor </span>
    <span class="org-function-name">pimpl_ptr</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">pimpl_ptr</span> <span class="org-keyword">const</span>&amp;<span class="org-rainbow-delimiters-depth-2">)</span> = <span class="org-keyword">delete</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Disable copy-</span>
    <span class="org-type">pimpl_ptr</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">=</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">pimpl_ptr</span> <span class="org-keyword">const</span>&amp;<span class="org-rainbow-delimiters-depth-2">)</span> = <span class="org-keyword">delete</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Move Ctor </span>
    <span class="org-function-name">pimpl_ptr</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">pimpl_ptr</span>&amp;&amp; <span class="org-variable-name">rhs</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::swap<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd, rhs.m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Move assignment operator </span>
    <span class="org-type">pimpl_ptr</span>&amp; <span class="org-keyword">operator</span><span class="org-function-name">=</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">pimpl_ptr</span>&amp;&amp; <span class="org-variable-name">rhs</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::swap<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd, rhs.m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">T</span>* <span class="org-function-name">get</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> m_hnd; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">release</span><span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-rainbow-delimiters-depth-2">{</span> 
        <span class="org-comment-delimiter">// </span><span class="org-comment">Note: it is not possible to delete incomplete type </span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">in this way: 'delete m_hnd;'</span>
        disposer<span class="org-rainbow-delimiters-depth-3">(</span>m_hnd<span class="org-rainbow-delimiters-depth-3">)</span>;
        m_hnd = <span class="org-constant">nullptr</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">reset</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">T</span>* <span class="org-variable-name">hnd</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">this</span>-&gt;release<span class="org-rainbow-delimiters-depth-3">()</span>;
        m_hnd = hnd;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">bool</span> <span class="org-function-name">empty</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> m_hnd == <span class="org-constant">nullptr</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">T</span>&amp;   <span class="org-keyword">operator</span><span class="org-function-name">*</span> <span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> *m_hnd; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">T</span>*   <span class="org-keyword">operator</span><span class="org-function-name">-&gt;</span> <span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> m_hnd; <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-keyword">class</span> <span class="org-type">MathEvaluator</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">struct</span> <span class="org-type">impl</span>;
    <span class="org-keyword">static</span> <span class="org-type">void</span> <span class="org-function-name">dispose</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">impl</span>* <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">pimpl_ptr</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">impl</span>, <span class="org-constant">MathEvaluator</span>::dispose<span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">m_pimpl</span>;
<span class="org-function-name">public</span>:
    <span class="org-function-name">MathEvaluator</span><span class="org-rainbow-delimiters-depth-2">()</span>;
    ~<span class="org-function-name">MathEvaluator</span><span class="org-rainbow-delimiters-depth-2">()</span> = <span class="org-keyword">default</span>;
    <span class="org-type">MathEvaluator</span>&amp; <span class="org-function-name">add_var</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">name</span>, <span class="org-type">double</span>&amp; <span class="org-variable-name">ref</span><span class="org-rainbow-delimiters-depth-2">)</span>;   

    <span class="org-comment-delimiter">// </span><span class="org-comment">Register function pointer callback or non-capture lambda </span>
    <span class="org-type">MathEvaluator</span>&amp; <span class="org-function-name">add_function</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">string</span>, <span class="org-type">double</span> <span class="org-function-name">fptr</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Register function of two variables </span>
    <span class="org-type">MathEvaluator</span>&amp; <span class="org-function-name">add_function</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">string</span>, <span class="org-type">double</span> <span class="org-function-name">fptr</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">double</span>, <span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">double</span>  <span class="org-function-name">eval_code</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">code</span><span class="org-rainbow-delimiters-depth-2">)</span>;    
    <span class="org-type">bool</span>    <span class="org-function-name">compile</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">code</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-type">double</span>  <span class="org-function-name">value</span><span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-type">void</span>    <span class="org-function-name">repl</span><span class="org-rainbow-delimiters-depth-2">()</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-preprocessor">#endif</span>
</pre>
</div>

<p>
File: mparser.cpp (cmake target: mparser static library)
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string">"mparser.hpp"</span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">exprtk.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-comment-delimiter">// </span><span class="org-comment">--------------------------------------------------// </span>

<span class="org-keyword">struct</span> <span class="org-constant">MathEvaluator</span>::<span class="org-type">impl</span> 
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">exprtk</span>::<span class="org-type">expression</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>   <span class="org-variable-name">expr</span>;
    <span class="org-constant">exprtk</span>::<span class="org-type">symbol_table</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">symbol_table</span>;
    <span class="org-constant">exprtk</span>::<span class="org-type">parser</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>       <span class="org-variable-name">parser</span>;     
    <span class="org-constant">std</span>::<span class="org-type">string</span>                  <span class="org-variable-name">code</span>; 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Println function </span>
    <span class="org-constant">exprtk</span>::<span class="org-constant">rtl</span>::<span class="org-constant">io</span>::<span class="org-type">println</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">println</span><span class="org-rainbow-delimiters-depth-2">{}</span>;

<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">static method </span>
<span class="org-type">void</span> 
<span class="org-function-name">MathEvaluator</span>::<span class="org-function-name">dispose</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">impl</span>* <span class="org-variable-name">p</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">delete</span> p;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-function-name">MathEvaluator</span>::MathEvaluator<span class="org-rainbow-delimiters-depth-1">()</span>: m_pimpl<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">new</span> <span class="org-type">impl</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>    
    m_pimpl-&gt;symbol_table.add_constants<span class="org-rainbow-delimiters-depth-2">()</span>;
    m_pimpl-&gt;expr.register_symbol_table<span class="org-rainbow-delimiters-depth-2">(</span>m_pimpl-&gt;symbol_table<span class="org-rainbow-delimiters-depth-2">)</span>;    
    m_pimpl-&gt;symbol_table.add_function<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"println"</span>, m_pimpl-&gt;println<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">MathEvaluator</span>&amp; 
<span class="org-function-name">MathEvaluator</span>::<span class="org-function-name">add_var</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">name</span>, <span class="org-type">double</span>&amp; <span class="org-variable-name">ref</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    m_pimpl-&gt;symbol_table.add_variable<span class="org-rainbow-delimiters-depth-2">(</span>name, ref<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">MathEvaluator</span>&amp; 
<span class="org-function-name">MathEvaluator</span>::<span class="org-function-name">add_function</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">name</span>, <span class="org-type">double</span> <span class="org-function-name">fptr</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    m_pimpl-&gt;symbol_table.add_function<span class="org-rainbow-delimiters-depth-2">(</span>name, fptr<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">MathEvaluator</span>&amp; 
<span class="org-function-name">MathEvaluator</span>::<span class="org-function-name">add_function</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">name</span>, <span class="org-type">double</span> <span class="org-function-name">fptr</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span>, <span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    m_pimpl-&gt;symbol_table.add_function<span class="org-rainbow-delimiters-depth-2">(</span>name, fptr<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">return</span> *<span class="org-keyword">this</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">bool</span> 
<span class="org-function-name">MathEvaluator</span>::<span class="org-function-name">compile</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">code</span><span class="org-rainbow-delimiters-depth-1">)</span>
 <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">bool</span> <span class="org-variable-name">r</span> = m_pimpl-&gt;parser.compile<span class="org-rainbow-delimiters-depth-2">(</span>code, m_pimpl-&gt;expr<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-negation-char">!</span>r<span class="org-rainbow-delimiters-depth-2">){</span> 
        <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">err</span> = <span class="org-string">"Error: "</span>;
        err = err + m_pimpl-&gt;parser.error<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" Error: "</span> &lt;&lt; err &lt;&lt; <span class="org-string">"\n"</span>;
         <span class="org-keyword">throw</span> <span class="org-constant">std</span>::runtime_error<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">" [PARSER] Unable to parse expression."</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">return</span> r;
 <span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">double</span> 
<span class="org-function-name">MathEvaluator</span>::<span class="org-function-name">value</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">return</span> m_pimpl-&gt;expr.value<span class="org-rainbow-delimiters-depth-2">()</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-constant">MathEvaluator</span>::<span class="org-function-name">repl</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">line</span>; 
    <span class="org-type">double</span> <span class="org-variable-name">result</span>;
    <span class="org-keyword">while</span><span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-constant">std</span>::cin.good<span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" EXPRTK $ &gt;&gt; "</span>;
        <span class="org-constant">std</span>::getline<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">std</span>::cin, line<span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>line.empty<span class="org-rainbow-delimiters-depth-4">()</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-keyword">continue</span>;
        <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>line == <span class="org-string">"exit"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-keyword">return</span>;
        <span class="org-keyword">try</span> <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-keyword">this</span>-&gt;compile<span class="org-rainbow-delimiters-depth-4">(</span>line<span class="org-rainbow-delimiters-depth-4">)</span>;            
            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-keyword">this</span>-&gt;value<span class="org-rainbow-delimiters-depth-4">()</span> &lt;&lt; <span class="org-string">'\n'</span>;
        <span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-keyword">catch</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-constant">std</span>::<span class="org-type">runtime_error</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">{</span>
            <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"Error: "</span> &lt;&lt; ex.what<span class="org-rainbow-delimiters-depth-4">()</span> &lt;&lt; <span class="org-string">'\n'</span>;

        <span class="org-rainbow-delimiters-depth-3">}</span>

    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
File: main.cpp  (cmake target: main)
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string">"mparser.hpp"</span>

<span class="org-type">double</span> <span class="org-function-name">myfun</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">a</span>, <span class="org-type">double</span> <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-1">)</span>;
<span class="org-type">void</span>   <span class="org-function-name">test_engine</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">MathEvaluator</span>&amp; <span class="org-variable-name">engine</span>, <span class="org-type">double</span>&amp; <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">)</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" [TRACE] I am up and running Ok. "</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">MathEvaluator</span> <span class="org-variable-name">engine</span>;    
    <span class="org-type">double</span> <span class="org-variable-name">x</span> = 1.0, <span class="org-variable-name">y</span> = 2.0, <span class="org-variable-name">z</span> = 3.0;
    engine.add_var<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"x"</span>, x<span class="org-rainbow-delimiters-depth-2">)</span>
        .add_var<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"y"</span>, y<span class="org-rainbow-delimiters-depth-2">)</span>
        .add_var<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"z"</span>, z<span class="org-rainbow-delimiters-depth-2">)</span>
        .add_function<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"myfun"</span>, &amp;myfun<span class="org-rainbow-delimiters-depth-2">)</span>;

    assert<span class="org-rainbow-delimiters-depth-2">(</span>argc == 2<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">command</span> = <span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-2">(</span>argv<span class="org-rainbow-delimiters-depth-3">[</span>1<span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>command == <span class="org-string">"test"</span> <span class="org-rainbow-delimiters-depth-2">){</span> test_engine<span class="org-rainbow-delimiters-depth-3">(</span>engine, x<span class="org-rainbow-delimiters-depth-3">)</span>; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>command == <span class="org-string">"repl"</span> <span class="org-rainbow-delimiters-depth-2">){</span> engine.repl<span class="org-rainbow-delimiters-depth-3">()</span>;          <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [TRACE] Shutdown engine Ok. "</span> &lt;&lt; <span class="org-string">'\n'</span>;
    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">-----------------------------------------//</span>


<span class="org-type">double</span> <span class="org-function-name">myfun</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">a</span>, <span class="org-type">double</span> <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"  [TRACE] a = "</span> &lt;&lt; a &lt;&lt; <span class="org-string">"\n"</span>;
    <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"  [TRACE] b = "</span> &lt;&lt; b &lt;&lt; <span class="org-string">"\n"</span>;
    <span class="org-type">double</span> <span class="org-variable-name">r</span> =  3.0 * a + 5.0 * b;
    <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"  [TRACE] result = "</span> &lt;&lt; r &lt;&lt; <span class="org-string">"\n"</span>;
    <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"---------------------------------\n"</span>;
    <span class="org-keyword">return</span> r;
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">void</span> <span class="org-function-name">test_engine</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">MathEvaluator</span>&amp; <span class="org-variable-name">engine</span>, <span class="org-type">double</span>&amp; <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">code</span> = R<span class="org-default">"</span><span class="org-string">( </span>
<span class="org-string">        // Define local variables </span>
<span class="org-string">        var a := 2.0 / exp(x) * x^2 + y;</span>
<span class="org-string">        var b := 10.0 * sqrt(x) + z;</span>

<span class="org-string">        // println('\n =&gt; x = ', x);</span>
<span class="org-string">        // println('\n =&gt; y = ', y);</span>

<span class="org-string">        // Call custom function</span>
<span class="org-string">        var k := myfun(x, y);</span>

<span class="org-string">        // Comment: the last expression is returned </span>
<span class="org-string">        4.0 * a + 3 * b + 10 * z + k;        </span>
<span class="org-string">    )</span><span class="org-default">"</span>;        
    engine.compile<span class="org-rainbow-delimiters-depth-2">(</span>code<span class="org-rainbow-delimiters-depth-2">)</span>;

    x = 3.0;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" =&gt; x = "</span> &lt;&lt; x &lt;&lt; <span class="org-string">" ; engine = "</span> &lt;&lt; engine.value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"\n"</span>;

    x = 5.0;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" =&gt; x = "</span> &lt;&lt; x &lt;&lt; <span class="org-string">" ; engine = "</span> &lt;&lt; engine.value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"\n"</span>;

    x = 15.0;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" =&gt; x = "</span> &lt;&lt; x &lt;&lt; <span class="org-string">" ; engine = "</span> &lt;&lt; engine.value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"\n"</span>;

    x = -15.0;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" =&gt; x = "</span> &lt;&lt; x &lt;&lt; <span class="org-string">" ; engine = "</span> &lt;&lt; engine.value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"\n"</span>;

    x = 20.0;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" =&gt; x = "</span> &lt;&lt; x &lt;&lt; <span class="org-string">" ; engine = "</span> &lt;&lt; engine.value<span class="org-rainbow-delimiters-depth-2">()</span> &lt;&lt; <span class="org-string">"\n"</span>;


    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">code2</span> = R<span class="org-default">"</span><span class="org-string">( </span>
<span class="org-string">        // Vector/array variable </span>
<span class="org-string">        var xs [6] := {  2.0, 10.2,   -2.50,  9.256, 100.0,  25.0 };</span>
<span class="org-string">        var ys [6] := { -2.0,  1.225, -5.56, 19.000, 125.0, 125.0 };</span>

<span class="org-string">        println(' =&gt; xs =', xs);</span>
<span class="org-string">        println(' =&gt; ys = ', ys);</span>
<span class="org-string">        println(' =&gt; 3 * xs + 4 * ys = ', 3 * xs + 4 * ys);</span>
<span class="org-string">        println(' =&gt; sum(xs) = ', sum(ys) );</span>
<span class="org-string">        println(' =&gt; sum(ys) = ', sum(xs) );</span>

<span class="org-string">    )</span><span class="org-default">"</span>;
    engine.compile<span class="org-rainbow-delimiters-depth-2">(</span>code2<span class="org-rainbow-delimiters-depth-2">)</span>;
    engine.value<span class="org-rainbow-delimiters-depth-2">()</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>

<p>
<b>Building</b> 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ git clone https://gist.github.com/2ff870b653b2ec1519bf0423165db1c5 gist &amp;&amp; <span class="org-builtin">cd</span> gist 
$ cmake --config Debug -H. -B_build  
$ cmake --build _build --target 
</pre>
</div>

<p>
<b>Running</b> 
</p>

<p>
Running 'test' subcommand. 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Redirect std::cerr or stderr to file </span>
$ _build/main test 2&gt; out.log
 [TRACE] I am up and running Ok. 
 =&gt; x = 3 ; engine = 121.546
 =&gt; x = 5 ; engine = 140.43
 =&gt; x = 15 ; engine = 218.19
 =&gt; x = -15 ; engine = -nan
 =&gt; x = 20 ; engine = 251.164
 =&gt; xs =   2.00000   10.20000   -2.50000    9.25600  100.00000   25.00000
 =&gt; ys =   -2.00000    1.22500   -5.56000   19.00000  125.00000  125.00000
 =&gt; 3 * xs + 4 * ys =   -2.00000   35.50000  -29.74000  103.76800  800.00000  575.00000
 =&gt; sum(xs) =  262.66500
 =&gt; sum(ys) =  143.95600

<span class="org-comment-delimiter"># </span><span class="org-comment">View log file </span>
$ _build/main test 2&gt; out.log
 [TRACE] I am up and running Ok. 
 =&gt; x = 3 ; engine = 121.546
 =&gt; x = 5 ; engine = 140.43
 =&gt; x = 15 ; engine = 218.19
 =&gt; x = -15 ; engine = -nan
 =&gt; x = 20 ; engine = 251.164
 =&gt; xs =   2.00000   10.20000   -2.50000    9.25600  100.00000   25.00000
 =&gt; ys =   -2.00000    1.22500   -5.56000   19.00000  125.00000  125.00000
 =&gt; 3 * xs + 4 * ys =   -2.00000   35.50000  -29.74000  103.76800  800.00000  575.00000
 =&gt; sum(xs) =  262.66500
 =&gt; sum(ys) =  143.95600
</pre>
</div>

<p>
Running 'repl' subcommand for interactive shell.
</p>

<div class="org-src-container">
<pre class="src src-sh"> rlwrap _build/main repl 
 [TRACE] I am up and running Ok. 
 EXPRTK $ &gt;&gt; sin(pi) * 2.0  + 5.3 * cos(3/2 * pi)
-7.28665e-16
 EXPRTK $ &gt;&gt; exp(3.1)
22.198
 EXPRTK $ &gt;&gt; var a := exp(2.5); var b := a * 3.0 + 10.0; 3 * a + b
83.095
 EXPRTK $ &gt;&gt; 
 EXPRTK $ &gt;&gt; println(<span class="org-string">' x = '</span>, x)
 x =    1.00000
0
 EXPRTK $ &gt;&gt; myfun(5.1, 2.56)
  [TRACE] a = 5.1
  [TRACE] b = 2.56
  [TRACE] result = 28.1
---------------------------------
28.1
 EXPRTK $ &gt;&gt; 
 EXPRTK $ &gt;&gt; myfun(5.1, 2.0 * pi + 10.0)
  [TRACE] a = 5.1
  [TRACE] b = 16.2832
  [TRACE] result = 96.7159
---------------------------------
96.7159
 EXPRTK $ &gt;&gt; 
 EXPRTK $ &gt;&gt; exit
 [TRACE] Shutdown engine Ok. 

</pre>
</div>
</div>
</div>
<div id="outline-container-org8d237d9" class="outline-3">
<h3 id="org8d237d9"><span class="section-number-3">1.5</span> Lua scripting engine</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-orgaf9bad7" class="outline-4">
<h4 id="orgaf9bad7"><span class="section-number-4">1.5.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Lua (moon in Portuguese) is a ligthweight multi paradigm scripting
language written in C. Due to Lua be available as small footprint
libraryn this language is widely used as embedded scripting by many
applications for scripting and as configuration or data description
language.
</p>

<p>
Use cases: 
</p>

<ul class="org-ul">
<li>Scripting for C or C++ applications</li>

<li>Extension language =&gt; Add new functionality and updates without
recompilation.</li>

<li>Provide interactive REPL or shell to C or C++ applications.</li>

<li>Program configuration (settings)</li>

<li>Data description language</li>
</ul>

<p>
Some applications using Lua: 
</p>

<ul class="org-ul">
<li><a href="https://nmap.org/book/nse-language.html">Nmap</a> network scanner</li>
<li>MediaWiki (engine used by Wikipedia)</li>
<li>Nginx Web Server</li>
<li>Redis Database</li>
<li>Linux Conky</li>
<li>LuaTex</li>
<li>NetBSD</li>
<li>Cheat Engine</li>
<li>Geany text editor</li>
<li><a href="https://github.com/xmake-io/xmake">Xmake</a> building system for C, C++, Objective-C, Swift, Assembly,
Golang, Rust, Dlang and Cuda</li>
<li><a href="https://en.wikipedia.org/wiki/Category:Lua-scripted_video_games">Lots of games</a> use lua for scripting and allow non-programmers,
such as end-users and game artists to contribute to the game
development, create animations, movements, finite state machines
and so on.</li>
<li>&#x2026; &#x2026;</li>
</ul>

<p>
More at: 
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/List_of_applications_using_Lua">List of applications using Lua - Wikipedia</a></li>

<li><a href="https://en.wikipedia.org/wiki/Category:Lua-scripted_video_games">Category:Lua-scripted video games - Wikipedia</a></li>
</ul>


<p>
<b>Repository and  C++ Binding Libraries</b> 
</p>

<ul class="org-ul">
<li>Official Repository Mirror
<ul class="org-ul">
<li><a href="https://github.com/lua/lua">https://github.com/lua/lua</a></li>
</ul></li>

<li>Lua Bind
<ul class="org-ul">
<li><a href="https://www.rasterbar.com/products/luabind/docs.html">https://www.rasterbar.com/products/luabind/docs.html</a></li>
<li><a href="https://sourceforge.net/projects/luabind/">https://sourceforge.net/projects/luabind/</a></li>
<li><a href="https://github.com/luabind/luabind">https://github.com/luabind/luabind</a></li>
</ul></li>

<li>Sol2 (means 'sun' 2 in Portuguese)
<ul class="org-ul">
<li><a href="https://github.com/ThePhD/sol2">https://github.com/ThePhD/sol2</a></li>
<li><a href="https://sol2.readthedocs.io/en/latest/">https://sol2.readthedocs.io/en/latest/</a></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org803044b" class="outline-4">
<h4 id="org803044b"><span class="section-number-4">1.5.2</span> Further Reading</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
<b>Documentation</b> 
</p>

<ul class="org-ul">
<li><a href="https://www.lua.org/manual/5.1/manual.html">Lua 5.1 Reference Manual</a> - Documentation</li>

<li><a href="https://en.wikipedia.org/wiki/Lua_(programming_language)">Lua (programming language) - Wikipedia</a></li>
</ul>

<p>
<b>Lua C API</b>
</p>

<ul class="org-ul">
<li><a href="https://www.lua.org/pil/24.1.html">Programming in Lua : 24.1</a></li>

<li><a href="http://lua-users.org/wiki/BindingCodeToLua">lua-users wiki: Binding Code To Lua</a></li>

<li><a href="http://lua-users.org/wiki/SimpleLuaApiExample">lua-users wiki: Simple Lua Api Example</a></li>

<li><a href="http://webserver2.tecgraf.puc-rio.br/lua/local/pil/24.html">Programming in Lua : 24</a></li>

<li><a href="https://chsasank.github.io/lua-c-wrapping.html">Exposing C functions to Lua</a></li>
</ul>

<p>
<b>Lua embedded in Geany Text Editor</b> 
</p>

<ul class="org-ul">
<li><a href="https://plugins.geany.org/geanylua/geanylua-intro.html">https://plugins.geany.org/geanylua/geanylua-intro.html</a></li>

<li><a href="https://github.com/geany/geany-plugins/tree/master/geanylua/examples">https://github.com/geany/geany-plugins/tree/master/geanylua/examples</a></li>

<li><a href="https://github.com/DGivney/geany-lua-scripts">https://github.com/DGivney/geany-lua-scripts</a>
<ul class="org-ul">
<li>Collection of Lua scripts for Geany text editor</li>
</ul></li>

<li><a href="https://github.com/geany/geany-plugins/tree/master/geanylua">https://github.com/geany/geany-plugins/tree/master/geanylua</a></li>
</ul>

<p>
<b>Lua scripting in NMap Network Scanner</b> 
</p>

<ul class="org-ul">
<li><a href="https://nmap.org/book/nse-language.html">Script Language | Nmap Network Scanning</a>
<ul class="org-ul">
<li>"The core of the Nmap Scripting Engine <b>is an embeddable Lua</b>
<b>interpreter</b>. <span class="underline">Lua is a lightweight language designed for</span>
<span class="underline">extensibility. It offers a powerful and well-documented API for</span>
interfacing with other software such as Nmap. The second part of
<span class="underline">the Nmap Scripting Engine is the NSE Library, which connects Lua</span>
<span class="underline">and Nmap</span>. This layer handles issues such as initialization of
the Lua interpreter, scheduling of parallel script execution,
script retrieval and more. It is also the heart of the NSE
network I/O framework and the exception handling mechanism. It
also includes utility libraries to make scripts more powerful
and convenient. The utility library modules and extensions are
described in the section called 'NSE Libraries'."</li>
</ul></li>

<li><a href="https://github.com/nmap/nmap/tree/master/nselib">Nmap Scripting Engine Source Code</a> / GITHUB</li>

<li><a href="https://dev.to/citizen428/extending-nmap-withlua-bpa">Extending Nmap WithLua - DEV</a></li>
</ul>


<p>
<b>Lua Scripting in Wireshark - Network Capture Application</b>
</p>

<ul class="org-ul">
<li><a href="https://wiki.wireshark.org/Lua">Lua - The Wireshark Wiki</a></li>

<li><a href="https://sharkfestus.wireshark.org/sharkfest.09/DT06_Bjorlykke_Lua%20Scripting%20in%20Wireshark.pdf">Lua Scripting in Wireshark</a></li>
</ul>

<p>
<b>Lua Scripting in XMake Building System</b> 
</p>

<ul class="org-ul">
<li><a href="https://github.com/xmake-io/xmake">https://github.com/xmake-io/xmake</a></li>

<li><a href="https://github.com/xmake-io/xmake/search?l=C%2B%2B&amp;q=lua&amp;type=">Search for usages of Lua C API in Xmake source code</a></li>
</ul>

<p>
<b>Lua scripting on NetBSD Kernel</b> 
</p>

<ul class="org-ul">
<li><a href="https://www.netbsd.org/gallery/presentations/mbalmer/fosdem2012/kernel_mode_lua.pdf">Lua in teh NetBSD Kernel</a></li>

<li><a href="https://2018.eurobsdcon.org/static/slides/Fast,%20Flexible%20Packet%20Filtering%20in%20NetBSD%20using%20Lua%20Kernel%20Scripts%20-%20Andrew%20von%20Dollen.pdf">Lua Kernel Scripting in NetBSD - Fast, Flexible Packet Filtering</a></li>

<li><a href="https://www.lua.org/wshop13/Cormack.pdf">Towards a Lua scripted operating system</a></li>

<li><a href="https://www.slideshare.net/eurobsdcon/lneto-npf-scripting">NPF scripting with Lua by Lourival Vieira Neto</a></li>
</ul>


<p>
<b>Lua scripting on Redis Database</b> 
</p>

<ul class="org-ul">
<li><a href="https://www.slideshare.net/itamarhaber/redis-lua-scripts">Redis Lua Scripts</a></li>

<li><a href="https://www.slideshare.net/RedisLabs/redis-lua-scripts-a-primer-and-use-cases">Redis: Lua scripts - a primer and use cases</a></li>
</ul>


<p>
<b>Lua scripting on Nginx Web Server</b> 
</p>

<ul class="org-ul">
<li><a href="https://www.nginx.com/resources/wiki/modules/lua/">Lua on NGINX web server</a></li>

<li><a href="https://blog.cloudflare.com/pushing-nginx-to-its-limit-with-lua/">Pushing Nginx to its limit with Lua</a> - CloudFlare</li>

<li><a href="https://www.slideshare.net/gakhov/implementing-a-fileserver-with-nginx-and-lua">Implementing a Fileserver with Nginx and Lua</a></li>
</ul>


<p>
<b>Lua scripting on Unreal Engine / game engine</b> 
</p>

<ul class="org-ul">
<li><a href="https://www.slideshare.net/Codemotion/roberto-de-ioris-scriptiamo-unreal-engine-con-lua-codemotion-rome-2019">Roberto De Ioris - Scriptiamo Unreal Engine con Lua - Codemotion Rome</a></li>

<li><a href="https://github.com/rdeioris/LuaMachine">GitHub - rdeioris/LuaMachine: Unreal Engine 4 Plugin for Lua APIs implementation</a></li>

<li><a href="https://www.unrealengine.com/marketplace/en-US/product/luamachine">LuaMachine by Roberto De Ioris in Code Plugins - UE4 Marketplace</a>
<ul class="org-ul">
<li>"Unreal Engine 4 Plugin for adding Lua scripting to your
projects: If you want modders to customize your game/project, or
you need to allow game designers to script parts of the logic,
this plugin is for you; Contrary to the other Unreal Engine 4
Lua plugins, this one does not try to expose the Unreal Engine 4
api, but completely hides it exposing to the user/scripter only
the features the developer decided to include (via Blueprints or
C++); Currently Windows 64bit, Mac, Linux x86_64 (both Runtime
and Editor), Linux AArch64, Android 32bit, Android 64bit, iOS
(Runtime only) are supported."</li>
</ul></li>
</ul>

<p>
<b>Lua for DSL - Domain Specific Language</b>  
</p>

<ul class="org-ul">
<li><a href="http://lua-users.org/wiki/LuaDataFormats">lua-users wiki: Lua Data Formats</a>
<ul class="org-ul">
<li>"Lua can be used as a language to represent data, not just as a
general programming language.  Different languages have been
devised for different types of data representation in text
format."</li>
</ul></li>

<li><a href="https://leafo.net/guides/dsl-in-lua.html">Writing a DSL in Lua</a></li>

<li><a href="https://www.slideshare.net/agladysh/luaws13-ag">A visual DSL toolkit in Lua: Past, present and future</a></li>

<li><a href="https://dnaeon.github.io/choosing-lua-as-the-ddl-and-config-language/">Choosing Lua as the data description and configuration language</a></li>

<li><a href="https://www.lua.org/wshop11/luaws11_ag.pdf">Declarative Internal DSLs in Lua / A Game-Changing Experience</a></li>

<li><a href="https://en.m.wikibooks.org/wiki/Lua_Programming/Tables">Lua Programming/Tables - Wikibooks, open books for an open world</a></li>

<li><a href="https://en.m.wikiversity.org/wiki/Lua/Tables">Lua/Tables - Wikiversity</a></li>

<li><a href="https://sudonull.com/post/184529-Lua-declarative-programming-basics">Lua declarative programming basics / Sudo Null IT News</a></li>

<li><a href="https://www.slideshare.net/ShuaiYuan/the-basics-and-design-of-lua-table">The basics and design of lua table</a></li>
</ul>

<p>
<b>Videos</b>
</p>

<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=pfwHCiP1HFM">CppCon 2017: Andreas Weis "Howling at the Moon: Lua for C++ Programmers"</a>
<ul class="org-ul">
<li>"C++ is a great tool for solving complex problems in a thorough
way. But every once in a while, the desire for a simpler
language emerges. For those parts of our code where performance
is of secondary concern, but the ability to perform rapid
iterations over the code is paramount, a scripting language
might be a tempting choice. But integrating a second language
besides C++ and managing the interaction between the two is also
scary. Lua is a lightweight, dynamic language that was designed
to be used as an embedded language within existing
applications. It is easy to learn, has very reasonable runtime
performance, and a memory footprint small enough that it is
usable even on embedded systems. Furthermore, it is almost
trivial to integrate with C++. This talk will give a brief
introduction to the Lua scripting language, highlighting
specifically how it can complement C++'s language features to
enrich a developer's toolbox. In the second part of the talk, we
will look at Lua's C API and give suggestions how to integrate
it with a modern C++17 codebase. In particular we will focus on
how to interface with the dynamic language Lua without
compromising the benefits of C++'s strong type system."</li>
</ul></li>

<li><a href="https://www.youtube.com/watch?v=xQAmGBfKnas">CppCon 2018: JeanHeyd Meneide Scripting at the Speed of Thought: Lua and C++ with sol3</a>
<ul class="org-ul">
<li>"A big part of accelerating development and promoting
collaboration often translates to deferring a lot of the typical
programmer work to a scripting language, to allow for those with
more design-oriented ideas and experience to handle some of the
workload. What happens, then, when you have to bind a scripting
language like Lua into C++ to allow for this workflow? This
session is going to be all about how you enable non-developers
and developers alike to rapidly increase their development
productivity by turning routines and algorithms into data that
can be shipped alongside your product in Lua. We will talk
primarily how you can use the library sol2 to abstract away the
muck of working with the Lua C API and instead focus on using
and describing both Lua and C++ with each other in a simple
manner. We will demonstrate some of the more interesting
properties of sol such as Overloading Support, Container
Support, Usertypes &#x2013; C++ classes made available with automatic
support for unique/shared pointers &#x2013; and Tables. By the time
this session is over, you will have a firm grasp over what a
good Lua Binding can offer you, and how you can accelerate your
C++ development with it."</li>
</ul></li>
</ul>

<p>
<b>General</b> 
</p>

<ul class="org-ul">
<li><a href="https://en.wikipedia.org/wiki/List_of_applications_using_Lua">List of applications using Lua - Wikipedia</a></li>

<li><a href="https://en.wikipedia.org/wiki/Category:Lua-scripted_video_games">Category:Lua-scripted video games - Wikipedia</a></li>

<li><a href="http://www.godpatterns.com/2005/07/using-lua-scripting-for-games.html">Godpatterns: Using Lua Scripting For Games</a></li>

<li><a href="https://gamedev.stackexchange.com/questions/73728/how-does-lua-work-as-a-scripting-language-in-games">c++ - How does Lua work as a scripting language in games? - Game Development Stack Exchange</a></li>

<li><a href="https://steamcommunity.com/sharedfiles/filedetails/?id=398177770">Steam Community - Guide - GameGuru LUA scripting summary and guide.</a></li>
</ul>
</div>
</div>

<div id="outline-container-org96c2d79" class="outline-4">
<h4 id="org96c2d79"><span class="section-number-4">1.5.3</span> Example project with Sol2 C++ binding library</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
This sample project builds a C++ statically linked executable
embedding the Lua scripting engine using the Sol2 binding library,
which is header only. Neither Sol2 nor Lua libraries need to be
installed before building this sample project as the CMake scripts
take care of downloading and building all dependencies.
</p>

<p>
Lua repostiory mirror: 
</p>

<ul class="org-ul">
<li><a href="https://github.com/lua/lua">https://github.com/lua/lua</a></li>
</ul>

<p>
Sol2 library repository: 
</p>

<ul class="org-ul">
<li><a href="https://github.com/ThePhD/sol2">https://github.com/ThePhD/sol2</a></li>
</ul>

<p>
Sol2 library documentation: 
</p>

<ul class="org-ul">
<li><a href="https://sol2.readthedocs.io/en/latest/">https://sol2.readthedocs.io/en/latest/</a></li>
</ul>


<p>
<b>Sample Project</b> 
</p>

<p>
GIST: 
</p>
<ul class="org-ul">
<li><a href="https://gist.github.com/17a37d905d3d71c0ae66661a189481b5">https://gist.github.com/17a37d905d3d71c0ae66661a189481b5</a></li>
</ul>

<p>
File: CMakeLists.txt 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.0)
<span class="org-function-name">project</span>(duktape-cc-trial)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-function-name">include</span>(lua-lib.cmake)

<span class="org-comment">#-----  Target Definitions ----------------------------#</span>

       <span class="org-function-name">add_executable</span>( embed-lua-sol embed-lua-sol.cpp)
<span class="org-function-name">target_link_libraries</span>( embed-lua-sol lua::lualib )

<span class="org-comment"># Lua REPL executable built from static library liblua.a (Linux)</span>
<span class="org-comment"># Note: the main() function is in the file main.c in the lua sources directory</span>
       <span class="org-function-name">add_executable</span>( lua-repl $&lt;TARGET_OBJECTS:lua::lualib&gt; )
<span class="org-function-name">target_link_libraries</span>( lua-repl m pthread )
</pre>
</div>

<p>
File: lua-lib.cmake 
</p>

<ul class="org-ul">
<li>CMake Script for downloading sol2 binding library and lua library
sources.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Note: the 'add_subriectory' line was commented becuyase </span>
<span class="org-comment">#       library that will be downloaded does not have </span>
<span class="org-comment">#       a CMakeListst.txt file at the root directory. </span>
<span class="org-keyword">macro</span>(Download_Library_Git  NAME TAG REPOSITORY_URL)
    <span class="org-function-name">FetchContent_Declare</span>(
        ${<span class="org-variable-name">NAME</span>}
        GIT_REPOSITORY  ${<span class="org-variable-name">REPOSITORY_URL</span>}
        GIT_TAG         ${<span class="org-variable-name">TAG</span>}
    )
    <span class="org-function-name">FetchContent_GetProperties</span>(${<span class="org-variable-name">NAME</span>})
    <span class="org-keyword">if</span>(NOT cpputest_POPULATED)
        <span class="org-function-name">FetchContent_Populate</span>(${<span class="org-variable-name">NAME</span>})
        <span class="org-function-name">message</span>(<span class="org-string">"${</span><span class="org-variable-name">NAME</span><span class="org-string">}_SOURCE_DIR} = ${${</span><span class="org-variable-name">NAME</span><span class="org-string">}_SOURCE_DIR}"</span>)        

        <span class="org-comment"># =&gt; Disable following line: the library does not have a CMakeLists.txt</span>
        <span class="org-comment">#    at the root directory.</span>
        <span class="org-comment"># add_subdirectory(${${</span><span class="org-variable-name">NAME</span><span class="org-comment">}_SOURCE_DIR} ${${</span><span class="org-variable-name">NAME</span><span class="org-comment">}_BINARY_DIR})</span>
    <span class="org-keyword">endif</span>()
<span class="org-keyword">endmacro</span>()


<span class="org-comment"># ====&gt;&gt; Download Lua library &lt;&lt;==========================#</span>

<span class="org-function-name">Download_Library_Git</span>( lua                       
                      v5.3.5
                      https://github.com/lua/lua
                    )

<span class="org-function-name">file</span>(GLOB_RECURSE lua_sources <span class="org-string">"${</span><span class="org-variable-name">lua_SOURCE_DIR</span><span class="org-string">}/*.c"</span>)
<span class="org-function-name">file</span>(GLOB_RECURSE lua_headers<span class="org-string">" ${</span><span class="org-variable-name">lua_SOURCE_DIR</span><span class="org-string">}/*.h"</span>)

<span class="org-function-name">message</span>( [TRACE] <span class="org-string">" lua_SOURCE_DIR = ${</span><span class="org-variable-name">lua_SOURCE_DIR</span><span class="org-string">} "</span>)

               <span class="org-function-name">add_library</span>( lua STATIC ${<span class="org-variable-name">lua_sources</span>} ${<span class="org-variable-name">lua_headers</span>} )
<span class="org-function-name">target_include_directories</span>( lua PUBLIC ${<span class="org-variable-name">lua_SOURCE_DIR</span>} )

<span class="org-function-name">add_library</span>( lua::lualib  ALIAS lua)

<span class="org-comment"># ====&gt;&gt; Download Sol C++ binding library &lt;&lt;====================#</span>

<span class="org-function-name">FetchContent_Declare</span>( sol2 
                      GIT_REPOSITORY  https://github.com/ThePhD/sol2
                      GIT_TAG         v3.2.0
                    )

<span class="org-function-name">FetchContent_MakeAvailable</span>( sol2 )
<span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">sol2_SOURCE_DIR</span>}/include )

</pre>
</div>

<p>
File: embed-lua-sol.cpp 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">algorithm</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sol/sol.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>


<span class="org-keyword">class</span> <span class="org-type">Counter</span> <span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-function-name">private</span>: 
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">m_name</span>;
    <span class="org-type">int</span>         <span class="org-variable-name">m_counter</span>;

<span class="org-function-name">public</span>: 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Ctor [1] =&gt; Default ctor </span>
    <span class="org-function-name">Counter</span><span class="org-rainbow-delimiters-depth-2">()</span>: Counter<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"untitled"</span>, 0<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Ctor [2]</span>
    <span class="org-function-name">Counter</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">name</span>, <span class="org-type">int</span> <span class="org-variable-name">counter</span><span class="org-rainbow-delimiters-depth-2">)</span>
      : m_name<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-constant">std</span>::move<span class="org-rainbow-delimiters-depth-3">(</span>name<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">}</span>, m_counter<span class="org-rainbow-delimiters-depth-2">{</span>counter<span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-rainbow-delimiters-depth-2">{</span> 
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] Counter created with =&gt;  { "</span> 
                  &lt;&lt;   <span class="org-string">" name = "</span> &lt;&lt; m_name 
                  &lt;&lt; <span class="org-string">" ; counter = "</span> &lt;&lt; m_counter 
                  &lt;&lt; <span class="org-string">" } \n"</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">int</span> <span class="org-function-name">getCounter</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> m_counter; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">setCounter</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">n</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>       
      m_counter = n; 
      <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] I was set to value "</span> &lt;&lt; n &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">increment</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-rainbow-delimiters-depth-2">{</span>       
      m_counter++; 
      <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] increment event =&gt;&gt; counter = {  "</span> 
                &lt;&lt; m_name &lt;&lt; <span class="org-string">" ; "</span> &lt;&lt; m_counter 
                &lt;&lt; <span class="org-string">" } "</span> &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>    
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">double</span> <span class="org-function-name">add_fun</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">a</span>, <span class="org-type">double</span> <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] addfun() =&gt; a = "</span> &lt;&lt; a 
              &lt;&lt; <span class="org-string">" ; b = "</span> &lt;&lt; b &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-keyword">return</span> a + b;             
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">sol_eval</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">sol</span>::<span class="org-type">state</span>&amp; <span class="org-variable-name">ctx</span>, <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">code</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">try</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        ctx.script<span class="org-rainbow-delimiters-depth-3">(</span> <span class="org-constant">std</span>::move<span class="org-rainbow-delimiters-depth-4">(</span>code<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;        
    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-constant">sol</span>::<span class="org-type">error</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SOL ERROR] "</span> &lt;&lt; ex.what<span class="org-rainbow-delimiters-depth-3">()</span> &lt;&lt; <span class="org-string">"\n"</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Create an instance of lua Engine (aka virtual Machine)</span>
    <span class="org-constant">sol</span>::<span class="org-type">state</span> <span class="org-variable-name">ctx</span><span class="org-rainbow-delimiters-depth-2">{}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Load basic libraries (such as print)</span>
    ctx.open_libraries<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">sol</span>::<span class="org-constant">lib</span>::base, <span class="org-constant">sol</span>::<span class="org-constant">lib</span>::coroutine, <span class="org-constant">sol</span>::<span class="org-constant">lib</span>::string, <span class="org-constant">sol</span>::<span class="org-constant">lib</span>::io<span class="org-rainbow-delimiters-depth-2">)</span>;    

    <span class="org-comment-delimiter">// </span><span class="org-comment">Register function pointer </span>
    ctx.set_function<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"add_fun"</span>, &amp;add_fun<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Register lambda object </span>
    ctx.set_function<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"make_vector"</span>, <span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">n</span> <span class="org-rainbow-delimiters-depth-3">)</span> -&gt; <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;</span> <span class="org-rainbow-delimiters-depth-3">{</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">vec</span> = <span class="org-constant">std</span>::vector<span class="org-rainbow-delimiters-depth-4">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-4">&gt;(</span>n<span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; n; i++ <span class="org-rainbow-delimiters-depth-4">)</span> vec<span class="org-rainbow-delimiters-depth-4">[</span>i<span class="org-rainbow-delimiters-depth-4">]</span>= i * 3;
        <span class="org-keyword">return</span> vec;
    <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set variables in the Lua engine </span>
    ctx<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"points"</span><span class="org-rainbow-delimiters-depth-2">]</span>    = 2000;
    ctx.set<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"character"</span>, <span class="org-string">"&lt;Marcus Tulius Cicero&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">/* </span><span class="org-comment">===========&gt;&gt;&gt; E X P E  R I M E N T / 1  &lt;&lt;=========*/</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n [EXPERIMENT 1] ==&gt;&gt; Evaluating string as code "</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">===&gt;&gt;&gt; Eval code as string &lt;&lt;=== </span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Throws exception sol::error </span>
        ctx.script<span class="org-rainbow-delimiters-depth-3">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">            print(" [LUA] Hello world lua "); </span>

<span class="org-string">            x = add_fun(10, 20);</span>
<span class="org-string">            print("\n  [LUA] result =  " .. x);</span>

<span class="org-string">            v = make_vector(5);</span>
<span class="org-string">            print("\n  [LUA] Printing a vector ");</span>

<span class="org-string">            for i = 1, 5 do </span>
<span class="org-string">                print("   -&gt; v[" .. i .. " ] = " .. v[i] );</span>
<span class="org-string">            end </span>

<span class="org-string">            print("  [LUA] VAR points    = " .. points );</span>
<span class="org-string">            print("  [LUA] VAR character = " .. character );</span>
<span class="org-string">        )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">===========&gt;&gt;&gt; E X P E  R I M E N T / 2  &lt;&lt;=========*/</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n\n [EXPERIMENT 2] ==&gt;&gt; Reading configuration "</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-rainbow-delimiters-depth-2">{</span>
        ctx.script<span class="org-rainbow-delimiters-depth-3">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">            -- Simulation of user configuration from script     </span>
<span class="org-string">            asset_path   = "C:\\\\Users\\myuser\\data\\files\\";</span>
<span class="org-string">            user_credits = 2000;</span>
<span class="org-string">            width        = 200.561;        </span>
<span class="org-string">        )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-keyword">auto</span> <span class="org-variable-name">asset_path</span> = ctx.get<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span><span class="org-string">"asset_path"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">int</span> <span class="org-variable-name">user_credits</span> = ctx<span class="org-rainbow-delimiters-depth-3">[</span><span class="org-string">"user_credits"</span><span class="org-rainbow-delimiters-depth-3">]</span>;

        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [*] =&gt; asset_path = "</span> &lt;&lt; asset_path &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [*] =&gt; user_credits = "</span> &lt;&lt; user_credits &lt;&lt; <span class="org-string">"\n"</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">===========&gt;&gt;&gt; E X P E  R I M E N T / 3  &lt;&lt;=========*/</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n\n [EXPERIMENT 3] ==&gt;&gt; Register C++ classes "</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">struct</span> <span class="org-type">StatefulFunctor</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">int</span> <span class="org-variable-name">state</span> = 0;
        <span class="org-function-name">StatefulFunctor</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">int</span> <span class="org-variable-name">state</span><span class="org-rainbow-delimiters-depth-3">)</span>: <span class="org-function-name">state</span><span class="org-rainbow-delimiters-depth-3">(</span>state<span class="org-rainbow-delimiters-depth-3">){</span> <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-type">int</span> <span class="org-keyword">operator</span><span class="org-function-name"><span class="org-rainbow-delimiters-depth-3">()</span></span><span class="org-rainbow-delimiters-depth-3">(){</span> 

            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  *=&gt;&gt; [StatefulFunctor] My new state is = "</span> 
                      &lt;&lt; <span class="org-keyword">this</span>-&gt;state &lt;&lt; <span class="org-string">"\n"</span>;
            <span class="org-keyword">return</span> state++; 
        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">stateful</span> = StatefulFunctor<span class="org-rainbow-delimiters-depth-2">(</span>10<span class="org-rainbow-delimiters-depth-2">)</span>;
    ctx.set_function<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"stateful"</span>, stateful<span class="org-rainbow-delimiters-depth-2">)</span>;

    ctx.script<span class="org-rainbow-delimiters-depth-2">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        stateful();</span>
<span class="org-string">        stateful();</span>
<span class="org-string">        stateful();</span>
<span class="org-string">    )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;


    ctx.new_usertype<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Counter</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Class name </span>
         <span class="org-string">"Counter"</span>          

        <span class="org-comment-delimiter">//  </span><span class="org-comment">--- Register methods  ------ //</span>
        ,<span class="org-string">"getCounter"</span>, &amp;<span class="org-constant">Counter</span>::getCounter
        ,<span class="org-string">"setCounter"</span>, &amp;<span class="org-constant">Counter</span>::setCounter
        ,<span class="org-string">"increment"</span>,  &amp;<span class="org-constant">Counter</span>::increment

        <span class="org-comment-delimiter">// </span><span class="org-comment">--- Register properties  ---- //</span>
        , <span class="org-string">"value"</span>,     <span class="org-constant">sol</span>::property<span class="org-rainbow-delimiters-depth-3">(</span> &amp;<span class="org-constant">Counter</span>::getCounter
                                    , &amp;<span class="org-constant">Counter</span>::setCounter<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-2">)</span>;


    sol_eval<span class="org-rainbow-delimiters-depth-2">(</span>ctx, R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        print("\n -----&gt;&gt;&gt; Calling C++ classes from Lua &lt;----- ");</span>

<span class="org-string">        -- Create new instance (object) of C++ class Counter </span>
<span class="org-string">        counter = Counter.new();</span>
<span class="org-string">        counter:increment();</span>
<span class="org-string">        counter:increment(); </span>
<span class="org-string">        counter:increment();</span>

<span class="org-string">        x = counter:getCounter(); </span>
<span class="org-string">        print("  [*] value of counter is equal to = " .. x);</span>

<span class="org-string">        counter.value = 2000;</span>
<span class="org-string">        print(" [*] Counter value is equal to = " .. counter.value );</span>
<span class="org-string">    )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Counter</span>* <span class="org-variable-name">ptr</span> = ctx.get<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Counter</span>*<span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"counter"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [FROM C++] counter value = "</span> 
              &lt;&lt; ptr-&gt;getCounter<span class="org-rainbow-delimiters-depth-2">()</span> 
              &lt;&lt; <span class="org-string">"\n"</span>;

    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Building =&gt; Debug build: 
</p>

<div class="org-src-container">
<pre class="src src-sh">   $ git clone https://gist.github.com/17a37d905d3d71c0ae66661a189481b5

<span class="org-function-name">File</span>: CMakeLists.txt 

<span class="org-comment-delimiter">#</span><span class="org-comment">+BEGIN_SRC cmake </span>
  cmake_minimum_required(VERSION 3.0)
  project(duktape-cc-trial)

  <span class="org-builtin">set</span>(CMAKE_CXX_STANDARD 17)
  <span class="org-builtin">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

  include(lua-lib.cmake)

  <span class="org-comment-delimiter">#</span><span class="org-comment">-----  Target Definitions ----------------------------#</span>

         add_executable( embed-lua-sol embed-lua-sol.cpp)
  target_link_libraries( embed-lua-sol lua::lualib )

  <span class="org-comment-delimiter"># </span><span class="org-comment">Lua REPL executable built from static library liblua.a (Linux)</span>
  <span class="org-comment-delimiter"># </span><span class="org-comment">Note: the main() function is in the file main.c in the lua sources directory</span>
         add_executable( lua-repl $&lt;TARGET_OBJECTS:lua::lualib&gt; )
  target_link_libraries( lua-repl m pthread )
</pre>
</div>

<p>
File: lua-lib.cmake 
</p>

<ul class="org-ul">
<li>CMake Script for downloading sol2 binding library and lua library
sources.</li>
</ul>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Note: the 'add_subriectory' line was commented becuyase </span>
<span class="org-comment">#       library that will be downloaded does not have </span>
<span class="org-comment">#       a CMakeListst.txt file at the root directory. </span>
<span class="org-keyword">macro</span>(Download_Library_Git  NAME TAG REPOSITORY_URL)
    <span class="org-function-name">FetchContent_Declare</span>(
        ${<span class="org-variable-name">NAME</span>}
        GIT_REPOSITORY  ${<span class="org-variable-name">REPOSITORY_URL</span>}
        GIT_TAG         ${<span class="org-variable-name">TAG</span>}
    )
    <span class="org-function-name">FetchContent_GetProperties</span>(${<span class="org-variable-name">NAME</span>})
    <span class="org-keyword">if</span>(NOT cpputest_POPULATED)
        <span class="org-function-name">FetchContent_Populate</span>(${<span class="org-variable-name">NAME</span>})
        <span class="org-function-name">message</span>(<span class="org-string">"${</span><span class="org-variable-name">NAME</span><span class="org-string">}_SOURCE_DIR} = ${${</span><span class="org-variable-name">NAME</span><span class="org-string">}_SOURCE_DIR}"</span>)        

        <span class="org-comment"># =&gt; Disable following line: the library does not have a CMakeLists.txt</span>
        <span class="org-comment">#    at the root directory.</span>
        <span class="org-comment"># add_subdirectory(${${</span><span class="org-variable-name">NAME</span><span class="org-comment">}_SOURCE_DIR} ${${</span><span class="org-variable-name">NAME</span><span class="org-comment">}_BINARY_DIR})</span>
    <span class="org-keyword">endif</span>()
<span class="org-keyword">endmacro</span>()


<span class="org-comment"># ====&gt;&gt; Download Lua library &lt;&lt;==========================#</span>

<span class="org-function-name">Download_Library_Git</span>( lua                       
                      v5.3.5
                      https://github.com/lua/lua
                    )

<span class="org-function-name">file</span>(GLOB_RECURSE lua_sources <span class="org-string">"${</span><span class="org-variable-name">lua_SOURCE_DIR</span><span class="org-string">}/*.c"</span>)
<span class="org-function-name">file</span>(GLOB_RECURSE lua_headers<span class="org-string">" ${</span><span class="org-variable-name">lua_SOURCE_DIR</span><span class="org-string">}/*.h"</span>)

<span class="org-function-name">message</span>( [TRACE] <span class="org-string">" lua_SOURCE_DIR = ${</span><span class="org-variable-name">lua_SOURCE_DIR</span><span class="org-string">} "</span>)

               <span class="org-function-name">add_library</span>( lua STATIC ${<span class="org-variable-name">lua_sources</span>} ${<span class="org-variable-name">lua_headers</span>} )
<span class="org-function-name">target_include_directories</span>( lua PUBLIC ${<span class="org-variable-name">lua_SOURCE_DIR</span>} )

<span class="org-function-name">add_library</span>( lua::lualib  ALIAS lua)

<span class="org-comment"># ====&gt;&gt; Download Sol C++ binding library &lt;&lt;====================#</span>

<span class="org-function-name">FetchContent_Declare</span>( sol2 
                      GIT_REPOSITORY  https://github.com/ThePhD/sol2
                      GIT_TAG         v3.2.0
                    )

<span class="org-function-name">FetchContent_MakeAvailable</span>( sol2 )
<span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">sol2_SOURCE_DIR</span>}/include )

</pre>
</div>

<p>
File: embed-lua-sol.cpp 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">algorithm</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sol/sol.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>


<span class="org-keyword">class</span> <span class="org-type">Counter</span> <span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-function-name">private</span>: 
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">m_name</span>;
    <span class="org-type">int</span>         <span class="org-variable-name">m_counter</span>;

<span class="org-function-name">public</span>: 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Ctor [1] =&gt; Default ctor </span>
    <span class="org-function-name">Counter</span><span class="org-rainbow-delimiters-depth-2">()</span>: Counter<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"untitled"</span>, 0<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Ctor [2]</span>
    <span class="org-function-name">Counter</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">name</span>, <span class="org-type">int</span> <span class="org-variable-name">counter</span><span class="org-rainbow-delimiters-depth-2">)</span>
      : m_name<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-constant">std</span>::move<span class="org-rainbow-delimiters-depth-3">(</span>name<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">}</span>, m_counter<span class="org-rainbow-delimiters-depth-2">{</span>counter<span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-rainbow-delimiters-depth-2">{</span> 
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] Counter created with =&gt;  { "</span> 
                  &lt;&lt;   <span class="org-string">" name = "</span> &lt;&lt; m_name 
                  &lt;&lt; <span class="org-string">" ; counter = "</span> &lt;&lt; m_counter 
                  &lt;&lt; <span class="org-string">" } \n"</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">int</span> <span class="org-function-name">getCounter</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> m_counter; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">setCounter</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">n</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>       
      m_counter = n; 
      <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] I was set to value "</span> &lt;&lt; n &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">increment</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-rainbow-delimiters-depth-2">{</span>       
      m_counter++; 
      <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] increment event =&gt;&gt; counter = {  "</span> 
                &lt;&lt; m_name &lt;&lt; <span class="org-string">" ; "</span> &lt;&lt; m_counter 
                &lt;&lt; <span class="org-string">" } "</span> &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>    
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">double</span> <span class="org-function-name">add_fun</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">double</span> <span class="org-variable-name">a</span>, <span class="org-type">double</span> <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] addfun() =&gt; a = "</span> &lt;&lt; a 
              &lt;&lt; <span class="org-string">" ; b = "</span> &lt;&lt; b &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-keyword">return</span> a + b;             
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">sol_eval</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">sol</span>::<span class="org-type">state</span>&amp; <span class="org-variable-name">ctx</span>, <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">code</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">try</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        ctx.script<span class="org-rainbow-delimiters-depth-3">(</span> <span class="org-constant">std</span>::move<span class="org-rainbow-delimiters-depth-4">(</span>code<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-3">)</span>;        
    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span> <span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-constant">sol</span>::<span class="org-type">error</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [SOL ERROR] "</span> &lt;&lt; ex.what<span class="org-rainbow-delimiters-depth-3">()</span> &lt;&lt; <span class="org-string">"\n"</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Create an instance of lua Engine (aka virtual Machine)</span>
    <span class="org-constant">sol</span>::<span class="org-type">state</span> <span class="org-variable-name">ctx</span><span class="org-rainbow-delimiters-depth-2">{}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Load basic libraries (such as print)</span>
    ctx.open_libraries<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">sol</span>::<span class="org-constant">lib</span>::base, <span class="org-constant">sol</span>::<span class="org-constant">lib</span>::coroutine, <span class="org-constant">sol</span>::<span class="org-constant">lib</span>::string, <span class="org-constant">sol</span>::<span class="org-constant">lib</span>::io<span class="org-rainbow-delimiters-depth-2">)</span>;    

    <span class="org-comment-delimiter">// </span><span class="org-comment">Register function pointer </span>
    ctx.set_function<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"add_fun"</span>, &amp;add_fun<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Register lambda object </span>
    ctx.set_function<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"make_vector"</span>, <span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">int</span> <span class="org-variable-name">n</span> <span class="org-rainbow-delimiters-depth-3">)</span> -&gt; <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;</span> <span class="org-rainbow-delimiters-depth-3">{</span>
        <span class="org-keyword">auto</span> <span class="org-variable-name">vec</span> = <span class="org-constant">std</span>::vector<span class="org-rainbow-delimiters-depth-4">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-4">&gt;(</span>n<span class="org-rainbow-delimiters-depth-4">)</span>;
        <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; n; i++ <span class="org-rainbow-delimiters-depth-4">)</span> vec<span class="org-rainbow-delimiters-depth-4">[</span>i<span class="org-rainbow-delimiters-depth-4">]</span>= i * 3;
        <span class="org-keyword">return</span> vec;
    <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Set variables in the Lua engine </span>
    ctx<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"points"</span><span class="org-rainbow-delimiters-depth-2">]</span>    = 2000;
    ctx.set<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"character"</span>, <span class="org-string">"&lt;Marcus Tulius Cicero&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">/* </span><span class="org-comment">===========&gt;&gt;&gt; E X P E  R I M E N T / 1  &lt;&lt;=========*/</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n [EXPERIMENT 1] ==&gt;&gt; Evaluating string as code "</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">===&gt;&gt;&gt; Eval code as string &lt;&lt;=== </span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Throws exception sol::error </span>
        ctx.script<span class="org-rainbow-delimiters-depth-3">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">            print(" [LUA] Hello world lua "); </span>

<span class="org-string">            x = add_fun(10, 20);</span>
<span class="org-string">            print("\n  [LUA] result =  " .. x);</span>

<span class="org-string">            v = make_vector(5);</span>
<span class="org-string">            print("\n  [LUA] Printing a vector ");</span>

<span class="org-string">            for i = 1, 5 do </span>
<span class="org-string">                print("   -&gt; v[" .. i .. " ] = " .. v[i] );</span>
<span class="org-string">            end </span>

<span class="org-string">            print("  [LUA] VAR points    = " .. points );</span>
<span class="org-string">            print("  [LUA] VAR character = " .. character );</span>
<span class="org-string">        )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">===========&gt;&gt;&gt; E X P E  R I M E N T / 2  &lt;&lt;=========*/</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n\n [EXPERIMENT 2] ==&gt;&gt; Reading configuration "</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-rainbow-delimiters-depth-2">{</span>
        ctx.script<span class="org-rainbow-delimiters-depth-3">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">            -- Simulation of user configuration from script     </span>
<span class="org-string">            asset_path   = "C:\\\\Users\\myuser\\data\\files\\";</span>
<span class="org-string">            user_credits = 2000;</span>
<span class="org-string">            width        = 200.561;        </span>
<span class="org-string">        )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-keyword">auto</span> <span class="org-variable-name">asset_path</span> = ctx.get<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span><span class="org-string">"asset_path"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-type">int</span> <span class="org-variable-name">user_credits</span> = ctx<span class="org-rainbow-delimiters-depth-3">[</span><span class="org-string">"user_credits"</span><span class="org-rainbow-delimiters-depth-3">]</span>;

        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [*] =&gt; asset_path = "</span> &lt;&lt; asset_path &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [*] =&gt; user_credits = "</span> &lt;&lt; user_credits &lt;&lt; <span class="org-string">"\n"</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">/* </span><span class="org-comment">===========&gt;&gt;&gt; E X P E  R I M E N T / 3  &lt;&lt;=========*/</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n\n [EXPERIMENT 3] ==&gt;&gt; Register C++ classes "</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">struct</span> <span class="org-type">StatefulFunctor</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-type">int</span> <span class="org-variable-name">state</span> = 0;
        <span class="org-function-name">StatefulFunctor</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-type">int</span> <span class="org-variable-name">state</span><span class="org-rainbow-delimiters-depth-3">)</span>: <span class="org-function-name">state</span><span class="org-rainbow-delimiters-depth-3">(</span>state<span class="org-rainbow-delimiters-depth-3">){</span> <span class="org-rainbow-delimiters-depth-3">}</span>
        <span class="org-type">int</span> <span class="org-keyword">operator</span><span class="org-function-name"><span class="org-rainbow-delimiters-depth-3">()</span></span><span class="org-rainbow-delimiters-depth-3">(){</span> 

            <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  *=&gt;&gt; [StatefulFunctor] My new state is = "</span> 
                      &lt;&lt; <span class="org-keyword">this</span>-&gt;state &lt;&lt; <span class="org-string">"\n"</span>;
            <span class="org-keyword">return</span> state++; 
        <span class="org-rainbow-delimiters-depth-3">}</span>
    <span class="org-rainbow-delimiters-depth-2">}</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">stateful</span> = StatefulFunctor<span class="org-rainbow-delimiters-depth-2">(</span>10<span class="org-rainbow-delimiters-depth-2">)</span>;
    ctx.set_function<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"stateful"</span>, stateful<span class="org-rainbow-delimiters-depth-2">)</span>;

    ctx.script<span class="org-rainbow-delimiters-depth-2">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        stateful();</span>
<span class="org-string">        stateful();</span>
<span class="org-string">        stateful();</span>
<span class="org-string">    )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;


    ctx.new_usertype<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Counter</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>
        <span class="org-comment-delimiter">// </span><span class="org-comment">Class name </span>
         <span class="org-string">"Counter"</span>          

        <span class="org-comment-delimiter">//  </span><span class="org-comment">--- Register methods  ------ //</span>
        ,<span class="org-string">"getCounter"</span>, &amp;<span class="org-constant">Counter</span>::getCounter
        ,<span class="org-string">"setCounter"</span>, &amp;<span class="org-constant">Counter</span>::setCounter
        ,<span class="org-string">"increment"</span>,  &amp;<span class="org-constant">Counter</span>::increment

        <span class="org-comment-delimiter">// </span><span class="org-comment">--- Register properties  ---- //</span>
        , <span class="org-string">"value"</span>,     <span class="org-constant">sol</span>::property<span class="org-rainbow-delimiters-depth-3">(</span> &amp;<span class="org-constant">Counter</span>::getCounter
                                    , &amp;<span class="org-constant">Counter</span>::setCounter<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-2">)</span>;


    sol_eval<span class="org-rainbow-delimiters-depth-2">(</span>ctx, R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        print("\n -----&gt;&gt;&gt; Calling C++ classes from Lua &lt;----- ");</span>

<span class="org-string">        -- Create new instance (object) of C++ class Counter </span>
<span class="org-string">        counter = Counter.new();</span>
<span class="org-string">        counter:increment();</span>
<span class="org-string">        counter:increment(); </span>
<span class="org-string">        counter:increment();</span>

<span class="org-string">        x = counter:getCounter(); </span>
<span class="org-string">        print("  [*] value of counter is equal to = " .. x);</span>

<span class="org-string">        counter.value = 2000;</span>
<span class="org-string">        print(" [*] Counter value is equal to = " .. counter.value );</span>
<span class="org-string">    )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">Counter</span>* <span class="org-variable-name">ptr</span> = ctx.get<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">Counter</span>*<span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"counter"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [FROM C++] counter value = "</span> 
              &lt;&lt; ptr-&gt;getCounter<span class="org-rainbow-delimiters-depth-2">()</span> 
              &lt;&lt; <span class="org-string">"\n"</span>;

    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Building =&gt; Debug build: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ git clone https://gist.github.com/17a37d905d3d71c0ae66661a189481b5 lua-sol &amp;&amp; <span class="org-builtin">cd</span> lua-sol 
$ cmake --config Debug -H. -B_build 
$ cmake --build _build --target 
</pre>
</div>

<p>
Building =&gt; Release build: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ git clone https://gist.github.com/17a37d905d3d71c0ae66661a189481b5 lua-sol &amp;&amp; <span class="org-builtin">cd</span> lua-sol 
$ cmake --config Release -H. -B_build 
$ cmake --build _build --target 
</pre>
</div>

<p>
Check executable: 
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Confirm whether the executable is statically linked against LuaLib </span>
$ ldd _build/embed-lua-sol 
       linux-vdso.so.1 (0x00007ffdf0fc4000)
       libstdc++.so.6 =&gt; /lib64/libstdc++.so.6 (0x00007fe4490e6000)
       libm.so.6 =&gt; /lib64/libm.so.6 (0x00007fe448fa0000)
       libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x00007fe448f85000)
       libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fe448dbb000)
       /lib64/ld-linux-x86-64.so.2 (0x00007fe4492fa000)

  <span class="org-comment-delimiter"># </span><span class="org-comment">Static library </span>
  $ file _build/liblua.a 
 _build/liblua.a: current ar archive
</pre>
</div>

<p>
Program output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ _build/embed-lua-sol 

[EXPERIMENT 1] ==&gt;&gt; Evaluating string as code 
[LUA] Hello world lua 
[TRACE] addfun() =&gt; a = 10 ; b = 20

 [LUA] result =  30.0

 [LUA] Printing a vector 
  -&gt; v[1 ] = 0
  -&gt; v[2 ] = 3
  -&gt; v[3 ] = 6
  -&gt; v[4 ] = 9
  -&gt; v[5 ] = 12
 [LUA] VAR points    = 2000
 [LUA] VAR character = &lt;Marcus Tulius Cicero&gt;


[EXPERIMENT 2] ==&gt;&gt; Reading configuration 
 [*] =&gt; asset_path = C:<span class="org-string">\\</span>Users\myuser\data\files<span class="org-sh-escaped-newline">\</span>
 [*] =&gt; user_credits = 2000


[EXPERIMENT 3] ==&gt;&gt; Register C++ classes 
 *=&gt;&gt; [StatefulFunctor] My new state is = 10
 *=&gt;&gt; [StatefulFunctor] My new state is = 11
 *=&gt;&gt; [StatefulFunctor] My new state is = 12

-----&gt;&gt;&gt; Calling C++ classes from Lua &lt;----- 
[TRACE] Counter created with =&gt;  {  name = untitled ; counter = 0 } 
[TRACE] increment event =&gt;&gt; counter = {  untitled ; 1 } 
[TRACE] increment event =&gt;&gt; counter = {  untitled ; 2 } 
[TRACE] increment event =&gt;&gt; counter = {  untitled ; 3 } 
 [*] value of counter is equal to = 3
[TRACE] I was set to value 2000
[*] Counter value is equal to = 2000
[FROM C++] counter value = 2000

</pre>
</div>

<p>
Run Lua repl executable (defined in CMake): 
</p>

<div class="org-src-container">
<pre class="src src-lua">$ rlwrap  _build/lua-repl 
Lua 5.3.5  Copyright (C) 1994-2018 Lua.org, PUC-Rio
&gt; 
&gt; 

&gt; <span class="org-builtin">print</span>(<span class="org-string">" Hello world Lua / Luna / Moon REPL "</span>)
 Hello world Lua / Luna / Moon REPL 

&gt; <span class="org-keyword">for</span> i = 1, 5 <span class="org-keyword">do</span> <span class="org-builtin">print</span>(<span class="org-string">" i = "</span> .. i ) <span class="org-keyword">end</span>
 i = 1
 i = 2
 i = 3
 i = 4
 i = 5


<span class="org-keyword">function</span> <span class="org-function-name">myfunction</span>(a, b) 
  <span class="org-keyword">return</span> <span class="org-builtin">math</span>.<span class="org-builtin">sin</span>(a) * <span class="org-builtin">math</span>.<span class="org-builtin">exp</span>(b) / a - a * b 
<span class="org-keyword">end</span> 

&gt; myfunction(3.5, 2.0)
-7.7405591279893

<span class="org-keyword">function</span> <span class="org-function-name">add</span> (a)
   <span class="org-keyword">local</span> <span class="org-variable-name">sum</span> = 0
   <span class="org-keyword">for</span> <span class="org-variable-name">i</span>,<span class="org-variable-name">v</span> <span class="org-keyword">in</span> <span class="org-builtin">ipairs</span>(a) <span class="org-keyword">do</span>
      sum = sum + v
   <span class="org-keyword">end</span>
   <span class="org-keyword">return</span> sum
<span class="org-keyword">end</span>

&gt; add({ 2.5, 10.2, -2.51, 8.251, 10.56})
29.001

<span class="org-keyword">function</span> <span class="org-function-name">add</span> (a)
      <span class="org-keyword">local</span> <span class="org-variable-name">sum</span> = 0
      <span class="org-keyword">for</span> <span class="org-variable-name">i</span>,<span class="org-variable-name">v</span> <span class="org-keyword">in</span> <span class="org-builtin">ipairs</span>(a) <span class="org-keyword">do</span>
        sum = sum + v
      <span class="org-keyword">end</span>
<span class="org-keyword">return</span> su
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org5681f02" class="outline-3">
<h3 id="org5681f02"><span class="section-number-3">1.6</span> Squirrel Scripting Language</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-orge635665" class="outline-4">
<h4 id="orge635665"><span class="section-number-4">1.6.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-6-1">
<ul class="org-ul">
<li>Squirrel is a embedded scripting language, similar to Lua, but with
C-like syntax, designed to be embedded in larger C or C++
applications such as game engines. Squirrel is written in C++, but
it only exposes a C API, which makes binding C++ code
cumbersome. However, there are many libraries which simplifies the
embedding of squirrel in C++ codebases.</li>
</ul>

<p>
<b>Official Web Site</b>
</p>

<ul class="org-ul">
<li><a href="http://www.squirrel-lang.org/">http://www.squirrel-lang.org/</a></li>
</ul>

<p>
<b>Official Repository</b> 
</p>

<ul class="org-ul">
<li><a href="https://github.com/albertodemichelis/squirrel">https://github.com/albertodemichelis/squirrel</a></li>
</ul>

<p>
<b>Squirrel fork with a more C++-like syntax</b>
</p>

<ul class="org-ul">
<li><a href="https://github.com/mingodad/squilu">https://github.com/mingodad/squilu</a></li>
</ul>

<p>
<b>Articles about squirrel language</b>
</p>

<ul class="org-ul">
<li><a href="https://developer.electricimp.com/squirrel/squirrelcrib">Squirrel Programming Guide | Dev Center</a></li>

<li><a href="https://www.ibm.com/developerworks/aix/library/au-spunix_squirrel/index.html">Speaking UNIX: The Squirrel portable shell and scripting language</a></li>

<li><a href="http://wiki.ogre3d.org/Squirrel+Scripting+Language">http://wiki.ogre3d.org/Squirrel+Scripting+Language</a></li>
</ul>

<p>
<b>Applications using Squirrel</b>
</p>

<ul class="org-ul">
<li>CodeBlocks IDE for C and C++</li>

<li>OpenTTD Game - <a href="http://www.openttd.org/en/">http://www.openttd.org/en/</a></li>
</ul>


<p>
<b>Libraries for simplifying embedding squirrel in C++ code</b> 
</p>

<p>
Libraries for simplifying squirrel embedding in C++ code (binding
C++ code):
</p>

<ul class="org-ul">
<li><b>SQPlus</b>
<ul class="org-ul">
<li><a href="http://wiki.squirrel-lang.org/default.aspx/SquirrelWiki/SqPlus.html">http://wiki.squirrel-lang.org/default.aspx/SquirrelWiki/SqPlus.html</a></li>
</ul></li>

<li><b>SQrat</b>
<ul class="org-ul">
<li><a href="http://scrat.sourceforge.net/">http://scrat.sourceforge.net/</a></li>
</ul></li>

<li><b>Squal</b>
<ul class="org-ul">
<li><a href="https://github.com/jonigata/squall">https://github.com/jonigata/squall</a></li>
</ul></li>

<li><b>SimpleSquirrel</b>
<ul class="org-ul">
<li><a href="https://github.com/matusnovak/simplesquirrel">https://github.com/matusnovak/simplesquirrel</a></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgb3149fd" class="outline-4">
<h4 id="orgb3149fd"><span class="section-number-4">1.6.2</span> Building Squirrel standalone REPL interpreter</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
Download and build: 
</p>


<div class="org-src-container">
<pre class="src src-sh">$ mkdir ~/build &amp;&amp; <span class="org-builtin">cd</span> build 
$ git clone https://github.com/albertodemichelis/squirrel
$ cmake -H. -B_build -DCMAKE_BUILD_TYPE=Debug 
$ cmake --build _build --target
</pre>
</div>

<p>
Play with squirrel interactive shell (REPL):
</p>

<div class="org-src-container">
<pre class="src src-sh">$ _build/bin/sq
Squirrel 3.1 stable Copyright (C) 2003-2017 Alberto Demichelis (64 bits)

sq&gt; print(<span class="org-string">" === Hello world Squirrel === "</span>)
 === Hello world Squirrel === 

sq&gt; <span class="org-keyword">function</span> <span class="org-function-name">add_to_10</span>(x){ <span class="org-keyword">return</span> x + 10; }

sq&gt;print(add_to_10(25))
35

sq&gt; x &lt;- cos(3.1415 / 2) + 10 

sq&gt;print(<span class="org-string">" x = "</span> + x.tostring())
 x = 10

sq&gt; for(<span class="org-builtin">local</span> i = 0; i &lt; 5; i++) print(<span class="org-string">" \n [TRACE] i = "</span> + i.tostring());

 [TRACE] i = 0 
 [TRACE] i = 1 
 [TRACE] i = 2 
 [TRACE] i = 3 
 [TRACE] i = 4
</pre>
</div>
</div>
</div>

<div id="outline-container-org5b9a683" class="outline-4">
<h4 id="org5b9a683"><span class="section-number-4">1.6.3</span> Example - embedding Squirrel with Squall Library</h4>
<div class="outline-text-4" id="text-1-6-3">
<p>
This example demonstrates how to embed the Squirrel programming
language in a C++ application using the Squall header-only library. 
</p>

<ul class="org-ul">
<li>Squal Repository: <a href="https://github.com/jonigata/squall">https://github.com/jonigata/squall</a></li>

<li>Note: This project is self-contained, no library needs to be
installed on the system as Squall automatically fetches Squirrel
sources using Cmake FetchContent.</li>
</ul>

<p>
<b>Sample Project</b> 
</p>

<p>
File: CMakeLists.txt 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span> (VERSION 3.11)
<span class="org-function-name">project</span>(squirrel_squall_test)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD_REQUIRED on)
<span class="org-function-name">set</span>(BUILD_EXAMPLES off)

<span class="org-comment"># -----------------------------------------------#</span>
<span class="org-function-name">include</span>(FetchContent)

<span class="org-function-name">FetchContent_Declare</span>(
  squall 
  URL      https://github.com/jonigata/squall/archive/master.zip
  )

<span class="org-function-name">FetchContent_MakeAvailable</span>(squall)

<span class="org-comment">#-------- TARGET DEFINITIONS --------------------#</span>
<span class="org-function-name">message</span>([TRACE] <span class="org-string">" squall_SOURCE_DIR = ${</span><span class="org-variable-name">squall_SOURCE_DIR</span><span class="org-string">}/squall  "</span>)

            <span class="org-function-name">add_executable</span> ( squirrel-test squirrel_test.cpp)
     <span class="org-function-name">target_link_libraries</span> ( squirrel-test squirrel_static sqstdlib_static)
<span class="org-function-name">target_include_directories</span> ( squirrel-test PUBLIC
                               ${<span class="org-variable-name">squirrel_SOURCE_DIR</span>}/include
                               ${<span class="org-variable-name">squall_SOURCE_DIR</span>}
                               )
</pre>
</div>

<p>
File: squirrel_test.cpp 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">algorithm</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">squall/squall_vmstd.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">squall/squall_klass.hpp</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-type">void</span> <span class="org-function-name">some_cpp_fun</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">n</span> <span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; n; i++<span class="org-rainbow-delimiters-depth-2">)</span>
        <span class="org-constant">std</span>::printf<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n   [some_cpp_function] =&gt; i = %d "</span>, i<span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-keyword">class</span> <span class="org-type">ChartXY</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-type">int</span> <span class="org-variable-name">m_width</span>; 
    <span class="org-type">int</span> <span class="org-variable-name">m_height</span>;
<span class="org-function-name">public</span>:
    <span class="org-function-name">ChartXY</span><span class="org-rainbow-delimiters-depth-2">()</span>: m_width<span class="org-rainbow-delimiters-depth-2">(</span>20<span class="org-rainbow-delimiters-depth-2">)</span>, m_height<span class="org-rainbow-delimiters-depth-2">(</span>50<span class="org-rainbow-delimiters-depth-2">)</span> 
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [ChartXY] Ctor() - I was created!. OK. "</span> &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">set_width</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-2">){</span> m_width = x; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">set_height</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-2">){</span> m_height = x; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">draw</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> 
    <span class="org-rainbow-delimiters-depth-2">{</span> 
        <span class="org-constant">std</span>::printf<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">" [ChartXY] draw() =&gt; Draw chart with: width = %d ; height = %d"</span>
                    , m_width, m_height<span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Create a virtual-machine object for Squirrel language </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Note: throws squall::squirrel_error</span>
    <span class="org-constant">squall</span>::<span class="org-type">VMStd</span> <span class="org-variable-name">vm</span>; 

    <span class="org-comment-delimiter">// </span><span class="org-comment">------------------------------------------------------------------------//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">[EXPERIMENT 1] Evaluate scripts provided as strings                     //</span>
    <span class="org-comment-delimiter">//</span><span class="org-comment">-------------------------------------------------------------------------//</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" =&gt;&gt; [EXPERIMENT] 1 - Evaluating code as string. "</span><span class="org-rainbow-delimiters-depth-2">)</span>;  
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" ---------------------------------------------\n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">try</span> <span class="org-rainbow-delimiters-depth-2">{</span>

        vm.dostring<span class="org-rainbow-delimiters-depth-3">(</span>R<span class="org-default">"</span><span class="org-string">( </span>
<span class="org-string">            // --- Squirrel Comment ----- // </span>
<span class="org-string">            print(" &lt;SQUIRREL&gt;  =&gt;&gt; Hello world squirrel!");</span>

<span class="org-string">            function myfunc(x) {  </span>
<span class="org-string">                local a = x + 5;</span>
<span class="org-string">                local b = 7 * a + x;</span>
<span class="org-string">                return b - a + 10;  </span>
<span class="org-string">            }</span>

<span class="org-string">            function myfunc2() {</span>
<span class="org-string">                print(" \n  &lt;SQUIRREL&gt; I was called by the C++ code ");</span>
<span class="org-string">            }</span>

<span class="org-string">            print("\n &lt;SQUIRREL&gt; =&gt;&gt; myfunc(4) = " + myfunc(4).tostring() );</span>

<span class="org-string">            print("\n\n &lt;SQUIRREL&gt; --- For Loop test ---- ");</span>
<span class="org-string">            for(local i = 0; i &lt; 5; i++) { </span>
<span class="org-string">                 print("\n   i = " + i.tostring() );  </span>
<span class="org-string">            }</span>
<span class="org-string">        )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span><span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-constant">squall</span>::<span class="org-type">squirrel_error</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">ex</span> <span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">"\n [SQUIRREL ERROR] Error =&gt;  "</span> &lt;&lt; ex.what<span class="org-rainbow-delimiters-depth-3">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;        
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">------------------------------------------------------------------------//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">[EXPERIMENT 2] Evaluate scripts provided as strings                     //</span>
    <span class="org-comment-delimiter">//</span><span class="org-comment">-------------------------------------------------------------------------//</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n =&gt;&gt; [EXPERIMENT] 2 - Getting variables defined in the code."</span><span class="org-rainbow-delimiters-depth-2">)</span>;  
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" -----------------------------------------------------------\n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-rainbow-delimiters-depth-2">{</span>
        vm.dostring<span class="org-rainbow-delimiters-depth-3">(</span>R<span class="org-default">"</span><span class="org-string">( </span>
<span class="org-string">            // ---- Global varibles for configuration ------ // </span>
<span class="org-string">            ::myvar_width &lt;- 100;</span>
<span class="org-string">            ::myvar_float &lt;- 122.56161;</span>
<span class="org-string">            ::myvar_string &lt;- "/path/to/interpreter.exe"; </span>
<span class="org-string">        )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

        <span class="org-constant">squall</span>::<span class="org-type">TableBase</span> <span class="org-variable-name">table</span> = vm.root_table<span class="org-rainbow-delimiters-depth-3">()</span>;
        <span class="org-keyword">auto</span> <span class="org-variable-name">myvar_float</span> = table.get<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span><span class="org-string">"myvar_float"</span><span class="org-rainbow-delimiters-depth-3">)</span>;       
        <span class="org-keyword">auto</span> <span class="org-variable-name">myvar_width</span> = table.get<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span><span class="org-string">"myvar_width"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-keyword">auto</span> <span class="org-variable-name">myvar_string</span> = table.get<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-3">&gt;(</span><span class="org-string">"myvar_string"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  =&gt;&gt;  myvar_width = "</span> &lt;&lt; myvar_width &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  =&gt;&gt;  myvar_float = "</span> &lt;&lt; myvar_float &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  =&gt;&gt; myvar_string = "</span> &lt;&lt; myvar_string &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span> 

    <span class="org-comment-delimiter">// </span><span class="org-comment">------------------------------------------------------------------------//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">[EXPERIMENT 3] Call functions defined in the script (Virtual Machine )  //</span>
    <span class="org-comment-delimiter">//</span><span class="org-comment">-------------------------------------------------------------------------//    </span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n\n =&gt;&gt; [EXPERIMENT] 3 - Calling functions defined in the script (VM)"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" ------------------------------------------------------------------\n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;    
    <span class="org-comment-delimiter">// </span><span class="org-comment">Throws: 'squall::squirrel_error' </span>
    <span class="org-type">int</span> <span class="org-variable-name">result</span> = vm.call<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"myfunc"</span>, 10<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"   =&gt;&gt;&gt; myfunc(4) = "</span> &lt;&lt; result &lt;&lt; <span class="org-constant">std</span>::endl;

    vm.call<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">void</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"myfunc2"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------------------------------------------------------------------------//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">[EXPERIMENT 4] Call C++ functions from the script                       //</span>
    <span class="org-comment-delimiter">//</span><span class="org-comment">-------------------------------------------------------------------------//    </span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n\n =&gt;&gt; [EXPERIMENT] 4 - Calling functions defined in the script (VM)"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" ------------------------------------------------------------------\n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Register C++ function pointer </span>
    vm.defun<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"some_cpp_fun"</span>, &amp;some_cpp_fun<span class="org-rainbow-delimiters-depth-2">)</span>;

    vm.dostring<span class="org-rainbow-delimiters-depth-2">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        print(" \n [SQUIRREL] =&gt; Call C++ function some_cpp_fun() ");</span>
<span class="org-string">        some_cpp_fun(5);</span>
<span class="org-string">     )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;


    <span class="org-comment-delimiter">// </span><span class="org-comment">Register C++ lambda object </span>
    vm.defun<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"call_me"</span>, <span class="org-rainbow-delimiters-depth-3">[</span>=<span class="org-rainbow-delimiters-depth-3">](</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">param</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">{</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"\n [TRACE] call_me() Parameter = "</span> &lt;&lt; param &lt;&lt; <span class="org-string">"\n"</span>;
        <span class="org-keyword">return</span>  <span class="org-string">" name = "</span> + param;
    <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    vm.dostring<span class="org-rainbow-delimiters-depth-2">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        local x = call_me("&lt;SQUIRREL-INTERPRETER&gt;");</span>
<span class="org-string">        print(" [SQUIRREL] \n x &lt;- " + x);</span>
<span class="org-string">     )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------------------------------------------------------------------------//</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">[EXPERIMENT 5] Call C++ classes from Squirrel-side                     //</span>
    <span class="org-comment-delimiter">//</span><span class="org-comment">-------------------------------------------------------------------------//    </span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n\n =&gt;&gt; [EXPERIMENT] 5 - Calling C++ classes from Squirrel        "</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" ------------------------------------------------------------------\n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Create metaobject 'k' that describes ChartXY class </span>
    <span class="org-constant">squall</span>::<span class="org-type">Klass</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">ChartXY</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-variable-name">k</span><span class="org-rainbow-delimiters-depth-2">(</span>vm, <span class="org-string">"ChartXY"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    k.func<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"set_width"</span>,  &amp;<span class="org-constant">ChartXY</span>::set_width<span class="org-rainbow-delimiters-depth-2">)</span>;
    k.func<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"set_height"</span>, &amp;<span class="org-constant">ChartXY</span>::set_height<span class="org-rainbow-delimiters-depth-2">)</span>;
    k.func<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"draw"</span>,       &amp;<span class="org-constant">ChartXY</span>::draw<span class="org-rainbow-delimiters-depth-2">)</span>;

    vm.dostring<span class="org-rainbow-delimiters-depth-2">(</span>R<span class="org-default">"</span><span class="org-string">( </span>
<span class="org-string">        function manipulate_chart(ch){           </span>
<span class="org-string">            ch.set_width(25);</span>
<span class="org-string">            ch.set_height(10);</span>
<span class="org-string">            ch.draw();</span>
<span class="org-string">        }</span>

<span class="org-string">        function draw_with(ch, w, h)</span>
<span class="org-string">        {</span>
<span class="org-string">            print(" \n [SQUIRREL LOG] Function draw_with called. OK. \n");</span>
<span class="org-string">            ch.set_width(w);</span>
<span class="org-string">            ch.set_height(h);</span>
<span class="org-string">            ch.draw();</span>
<span class="org-string">        }</span>
<span class="org-string">     )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-type">ChartXY</span> <span class="org-variable-name">mychart</span>;
    vm.call<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">void</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"manipulate_chart"</span>, &amp;mychart<span class="org-rainbow-delimiters-depth-2">)</span>;
    vm.call<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">void</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"draw_with"</span>, &amp;mychart, 100, 200<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"\n\n"</span>;

    <span class="org-constant">squall</span>::<span class="org-type">TableBase</span> <span class="org-variable-name">table</span> = vm.root_table<span class="org-rainbow-delimiters-depth-2">()</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Pass object to Squirrel side </span>
    table.set<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"mychart"</span>, mychart<span class="org-rainbow-delimiters-depth-2">)</span>;

    vm.dostring<span class="org-rainbow-delimiters-depth-2">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        mychart.set_width(250);</span>
<span class="org-string">        mychart.set_width(600);</span>
<span class="org-string">        mychart.draw();</span>
<span class="org-string">    )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;


<span class="org-preprocessor">#if</span> 0  
    <span class="org-comment-delimiter">// </span><span class="org-comment">Segmentation Falt Coredump if the C++ object </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">is created on the Squirrel-side.</span>
    vm.dostring<span class="org-rainbow-delimiters-depth-2">(</span>R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        local c = ChartXY();</span>
<span class="org-string">        c.set_width(150);</span>
<span class="org-string">        c.set_height(175);</span>
<span class="org-string">        c.draw();</span>
<span class="org-string">    )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-preprocessor">#endif</span> 

    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Build: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build -DCMAKE_BUILD_TYPE=Debug 
$ cmake --build _build --target 
</pre>
</div>

<p>
Check executable dependencies: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ldd _build/squirrel-test 
       linux-vdso.so.1 (0x00007ffe34dd6000)
       libstdc++.so.6 =&gt; /lib64/libstdc++.so.6 (0x00007fd3ebd2a000)
       libm.so.6 =&gt; /lib64/libm.so.6 (0x00007fd3ebbe4000)
       libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x00007fd3ebbc9000)
       libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fd3eb9ff000)
       /lib64/ld-linux-x86-64.so.2 (0x00007fd3ebf3e000)
</pre>
</div>

<p>
Run application: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ _build/squirrel-test 

=&gt;&gt; [EXPERIMENT] 1 - Evaluating code as string. 
---------------------------------------------

&lt;SQUIRREL&gt;  =&gt;&gt; Hello world squirrel!
&lt;SQUIRREL&gt; =&gt;&gt; myfunc(4) = 68

&lt;SQUIRREL&gt; --- For Loop test ---- 
  i = 0
  i = 1
  i = 2
  i = 3
  i = 4
=&gt;&gt; [EXPERIMENT] 2 - Getting variables defined<span class="org-keyword"> in</span> the code.
-----------------------------------------------------------

 =&gt;&gt;  myvar_width = 100
 =&gt;&gt;  myvar_float = 122.562
 =&gt;&gt; myvar_string = /path/to/interpreter.exe


=&gt;&gt; [EXPERIMENT] 3 - Calling functions defined<span class="org-keyword"> in</span> the script (VM)
------------------------------------------------------------------

  =&gt;&gt;&gt; myfunc(4) = 110

 &lt;SQUIRREL&gt; I was called by the C++ code 

=&gt;&gt; [EXPERIMENT] 4 - Calling functions defined<span class="org-keyword"> in</span> the script (VM)
------------------------------------------------------------------


[SQUIRREL] =&gt; Call C++ <span class="org-keyword">function</span> <span class="org-function-name">some_cpp_fun</span>() 
  [some_cpp_function] =&gt; i = 0 
  [some_cpp_function] =&gt; i = 1 
  [some_cpp_function] =&gt; i = 2 
  [some_cpp_function] =&gt; i = 3 
  [some_cpp_function] =&gt; i = 4 
[TRACE] call_me() Parameter = &lt;SQUIRREL-INTERPRETER&gt;
[SQUIRREL] 
x &lt;-  name = &lt;SQUIRREL-INTERPRETER&gt;

=&gt;&gt; [EXPERIMENT] 5 - Calling C++ classes from Squirrel        
------------------------------------------------------------------

[ChartXY] Ctor() - I was created!. OK. 
[ChartXY] draw() =&gt; Draw chart with: width = 25 ; height = 10 
[SQUIRREL LOG] Function draw_with called. OK. 
[ChartXY] draw() =&gt; Draw chart with: width = 100 ; height = 200

[ChartXY] draw() =&gt; Draw chart with: width = 600 ; height = 200


</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8c2cb1a" class="outline-3">
<h3 id="org8c2cb1a"><span class="section-number-3">1.7</span> Duktape - Embeddable Javascript Engine</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-org06ecfde" class="outline-4">
<h4 id="org06ecfde"><span class="section-number-4">1.7.1</span> Overview</h4>
<div class="outline-text-4" id="text-1-7-1">
<ul class="org-ul">
<li>Duktape is a small footprint embeddable Javascript (ECMAScript)
engine, written in C, which can be used for providing scripting
capabilities for C or C++ applications.</li>

<li>License: MIT</li>

<li>Possible Use Cases:
<ul class="org-ul">
<li>Configuration</li>
<li>Data description language</li>
<li>User plugins</li>
<li>User extensions</li>
<li>Scripting for games</li>
</ul></li>

<li>Features:
<ul class="org-ul">
<li>Embeddable, portable, compact: can run on platforms with 160kB
flash and 64kB RAM</li>
<li>Built-in debugger</li>
<li>Built-in regular expression engine</li>
<li>Minimal, retargetable platform dependencies</li>
<li>Combined reference counting and mark-and-sweep garbage
collection with finalization</li>
<li>Bytecode dump/load for caching compiled functions</li>
<li>Distributable includes an optional logging framework,
CommonJS-based module loading implementations, etc</li>
</ul></li>
</ul>

<p>
<b>Official Website</b> 
</p>

<ul class="org-ul">
<li><a href="https://duktape.org/">https://duktape.org/</a></li>

<li><a href="https://duktape.org/download.html">https://duktape.org/download.html</a></li>
</ul>

<p>
<b>Official Repository</b> 
</p>

<ul class="org-ul">
<li><a href="https://github.com/svaarala/duktape">https://github.com/svaarala/duktape</a></li>
</ul>

<p>
<b>C++ Binding Libraries</b>  
</p>

<ul class="org-ul">
<li><a href="https://github.com/Aloshi/dukglue/">https://github.com/Aloshi/dukglue/</a></li>

<li><a href="https://github.com/stfwi/duktape-cc">https://github.com/stfwi/duktape-cc</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgdf4fb3c" class="outline-4">
<h4 id="orgdf4fb3c"><span class="section-number-4">1.7.2</span> Example project with DukGlue C++ binding library</h4>
<div class="outline-text-4" id="text-1-7-2">
<p>
This following project CMakeLists.txt automatically downloads <span class="underline">dukglue</span>
binding library and <span class="underline">duktape</span> engine sources and builds a C++ demonstration
code embedding duktape JavaScript engine. 
</p>

<ul class="org-ul">
<li>DukGlue Binding Library: <a href="https://github.com/Aloshi/dukglue">https://github.com/Aloshi/dukglue</a>
<ul class="org-ul">
<li>Advantage:
<ul class="org-ul">
<li>Easy to use and lots of examples.</li>
</ul></li>
<li>Drawbacks:
<ul class="org-ul">
<li>Lack of namespaces which enhances API discoverability</li>
<li>Lack of C++ wrappers to some Duktape C-types</li>
<li>Lack of a CMakeLists.txt at the top directory.</li>
</ul></li>
</ul></li>
</ul>

<p>
File: CMakeLists.txt 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.0)
<span class="org-function-name">project</span>(duktap-embed)

<span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Download library archive (zip, *.tar.gz, ...) from URL</span>
<span class="org-keyword">macro</span>(Download_Library_Url NAME URL)
  <span class="org-function-name">FetchContent_Declare</span>(${<span class="org-variable-name">NAME</span>} URL  ${<span class="org-variable-name">URL</span>})
  <span class="org-function-name">FetchContent_GetProperties</span>(${<span class="org-variable-name">NAME</span>})
  <span class="org-keyword">if</span>(NOT ${<span class="org-variable-name">NAME</span>}_POPULATED)
    <span class="org-function-name">FetchContent_Populate</span>(${<span class="org-variable-name">NAME</span>})
   <span class="org-comment"># add_subdirectory(${${</span><span class="org-variable-name">NAME</span><span class="org-comment">}_SOURCE_DIR} ${${</span><span class="org-variable-name">NAME</span><span class="org-comment">}_BINARY_DIR})</span>
  <span class="org-keyword">endif</span>()
<span class="org-keyword">endmacro</span>()


<span class="org-comment"># ====&gt;&gt; Duktape JavaScript Engine Configuration &lt;&lt;===========#</span>

<span class="org-function-name">Download_Library_Url</span>(duktape
  <span class="org-string">"https://duktape.org/duktape-2.5.0.tar.xz"</span>
  )

<span class="org-comment"># FetchContent_MakeAvailable(duktape)</span>

<span class="org-function-name">message</span>( [TRACE] <span class="org-string">" =&gt;&gt; duktape_SOURCE_DIR = ${</span><span class="org-variable-name">duktape_SOURCE_DIR</span><span class="org-string">} "</span>)


<span class="org-function-name">file</span>(GLOB_RECURSE duktape_sources <span class="org-string">"${</span><span class="org-variable-name">duktape_SOURCE_DIR</span><span class="org-string">}/src/*.c"</span>)
<span class="org-function-name">file</span>(GLOB_RECURSE duktape_headers <span class="org-string">"${</span><span class="org-variable-name">duktape_SOURCE_DIR</span><span class="org-string">}/src/*.h"</span>)

<span class="org-function-name">message</span>( [TRACE] <span class="org-string">" duktape_sources = ${</span><span class="org-variable-name">duktape_sources</span><span class="org-string">} "</span>)

              <span class="org-function-name">add_library</span> (duktape ${<span class="org-variable-name">duktape_sources</span>} ${<span class="org-variable-name">duktape_headers</span>} )
<span class="org-function-name">target_include_directories</span>(duktape PUBLIC ${<span class="org-variable-name">duktape_SOURCE_DIR</span>}/src  )

<span class="org-comment"># ----------- DukGlue Library ----------------------------#</span>

<span class="org-function-name">FetchContent_Declare</span>(
  dukglue 
  URL       https://github.com/Aloshi/dukglue/archive/master.zip
  )

<span class="org-function-name">FetchContent_MakeAvailable</span>(dukglue)

<span class="org-comment">#----- Main Target Definition ----------------------------#</span>
<span class="org-function-name">add_executable</span>(duktape-embed duktape-embed.cpp)
<span class="org-function-name">target_link_libraries</span>(duktape-embed duktape dukglue)

</pre>
</div>

<p>
File: duktape-embed.cpp 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

<span class="org-comment-delimiter">// </span><span class="org-comment">Repository: https://github.com/Aloshi/dukglue</span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">dukglue/dukglue.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-type">void</span> <span class="org-function-name">print_number</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
  <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] number passed is = "</span> &lt;&lt; x &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">log_text</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">text</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::cout &lt;&lt;  <span class="org-string">" =&gt;&gt; [C++-LOG] - "</span> &lt;&lt; text &lt;&lt; <span class="org-constant">std</span>::endl;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">int</span> <span class="org-function-name">eval_code</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">duk_context</span>* <span class="org-variable-name">ctx</span>, <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">code</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">return</span> duk_peval_string<span class="org-rainbow-delimiters-depth-2">(</span>ctx, code.c_str<span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-type">void</span> <span class="org-function-name">plot_points</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">float</span><span class="org-rainbow-delimiters-depth-2">&gt;</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">points</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
  <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  =&gt;&gt; [TRACE] Plot points  =&gt;&gt; "</span>;
  <span class="org-keyword">for</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">auto</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">x</span>: points<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" x = "</span> &lt;&lt; x; <span class="org-rainbow-delimiters-depth-2">}</span>
  <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" \n"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-keyword">class</span> <span class="org-type">Counter</span> <span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-function-name">private</span>: 
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">m_name</span>;
    <span class="org-type">int</span>         <span class="org-variable-name">m_counter</span>;

<span class="org-function-name">public</span>: 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Ctor [1] =&gt; Default ctor </span>
    <span class="org-function-name">Counter</span><span class="org-rainbow-delimiters-depth-2">()</span>: Counter<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"untitled"</span>, 0<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Ctor [2]</span>
    <span class="org-function-name">Counter</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">name</span>, <span class="org-type">int</span> <span class="org-variable-name">counter</span><span class="org-rainbow-delimiters-depth-2">)</span>
      : m_name<span class="org-rainbow-delimiters-depth-2">{</span><span class="org-constant">std</span>::move<span class="org-rainbow-delimiters-depth-3">(</span>name<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">}</span>, m_counter<span class="org-rainbow-delimiters-depth-2">{</span>counter<span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-rainbow-delimiters-depth-2">{</span> 
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] Counter created with =&gt;  { "</span> 
                  &lt;&lt;   <span class="org-string">" name = "</span> &lt;&lt; m_name 
                  &lt;&lt; <span class="org-string">" ; counter = "</span> &lt;&lt; m_counter 
                  &lt;&lt; <span class="org-string">" } \n"</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">int</span> <span class="org-function-name">getCounter</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span> <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> m_counter; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span> <span class="org-function-name">setCounter</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">int</span> <span class="org-variable-name">n</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>       
      m_counter = n; 
      <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] I was set to value "</span> &lt;&lt; n &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">increment</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-rainbow-delimiters-depth-2">{</span>       
      m_counter++; 
      <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [TRACE] increment event =&gt;&gt; counter = {  "</span> 
                &lt;&lt; m_name &lt;&lt; <span class="org-string">" ; "</span> &lt;&lt; m_counter 
                &lt;&lt; <span class="org-string">" } "</span> &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>    

<span class="org-rainbow-delimiters-depth-1">}</span>;


<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
      <span class="org-comment-delimiter">// </span><span class="org-comment">Create Duktape Virtual machine </span>
      <span class="org-type">duk_context</span>* <span class="org-variable-name">ctx</span> = duk_create_heap_default<span class="org-rainbow-delimiters-depth-2">()</span>;

      <span class="org-comment-delimiter">/* </span><span class="org-comment">========================== EXPERIMENT 1 =============*/</span>
      <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n === [EXPERIMENT 1] ==&gt;&gt; Register and call C++ functions &lt;&lt;===== "</span><span class="org-rainbow-delimiters-depth-2">)</span>;
      <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-comment-delimiter">// </span><span class="org-comment">Register pointer to functions function (function pointer) in </span>
          <span class="org-comment-delimiter">// </span><span class="org-comment">the JS engine (aka virtual machine)</span>
          dukglue_register_function<span class="org-rainbow-delimiters-depth-3">(</span>ctx, &amp;print_number, <span class="org-string">"print_number"</span><span class="org-rainbow-delimiters-depth-3">)</span>; 
          dukglue_register_function<span class="org-rainbow-delimiters-depth-3">(</span>ctx, log_text, <span class="org-string">"log_text"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
          dukglue_register_function<span class="org-rainbow-delimiters-depth-3">(</span>ctx, plot_points, <span class="org-string">"plot_points"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

          <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code1</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">              print_number(10);</span>
<span class="org-string">              log_text(" Hello world from Javascript" ); </span>
<span class="org-string">              log_text(" Toke is equal to " + 100 ); </span>
<span class="org-string">              log_text( " " + 1000 );      </span>

<span class="org-string">              plot_points( [ 20.5, 100.23, -125.254, 8.251, 100.0 ]);</span>
<span class="org-string">          )</span><span class="org-default">"</span>;

          <span class="org-comment-delimiter">// </span><span class="org-comment">Evaluate code, returns false on error </span>
          <span class="org-keyword">auto</span> <span class="org-variable-name">n</span> = eval_code<span class="org-rainbow-delimiters-depth-3">(</span>ctx, code1<span class="org-rainbow-delimiters-depth-3">)</span>;

          <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-3">(</span>n<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">{</span> <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [ERROR] A duktape evaluation error has happened. "</span>  &lt;&lt; <span class="org-constant">std</span>::endl; <span class="org-rainbow-delimiters-depth-3">}</span>

      <span class="org-rainbow-delimiters-depth-2">}</span>

      <span class="org-comment-delimiter">/* </span><span class="org-comment">========================== EXPERIMENT 2 ====================*/</span>
      <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n === [EXPERIMENT 2] ==&gt;&gt; Register and call C++ classes &lt;&lt;===== \n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
      <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-comment-delimiter">// </span><span class="org-comment">Register class counter </span>
          dukglue_register_constructor<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">Counter</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>ctx, <span class="org-string">"Counter"</span><span class="org-rainbow-delimiters-depth-3">)</span>;      
          dukglue_register_constructor<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">Counter</span>, <span class="org-constant">std</span>::<span class="org-type">string</span>, <span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>ctx,  <span class="org-string">"Counter"</span><span class="org-rainbow-delimiters-depth-3">)</span>;     
          dukglue_register_method<span class="org-rainbow-delimiters-depth-3">(</span>ctx, &amp;<span class="org-constant">Counter</span>::getCounter , <span class="org-string">"getCounter"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
          dukglue_register_method<span class="org-rainbow-delimiters-depth-3">(</span>ctx, &amp;<span class="org-constant">Counter</span>::setCounter , <span class="org-string">"setCounter"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
          dukglue_register_method<span class="org-rainbow-delimiters-depth-3">(</span>ctx, &amp;<span class="org-constant">Counter</span>::increment , <span class="org-string">"increment"</span><span class="org-rainbow-delimiters-depth-3">)</span>;

          dukglue_register_property<span class="org-rainbow-delimiters-depth-3">(</span>ctx                   <span class="org-comment-delimiter">// </span><span class="org-comment">Pointer to engine (VM)</span>
                                  , &amp;<span class="org-constant">Counter</span>::getCounter  <span class="org-comment-delimiter">// </span><span class="org-comment">Getter </span>
                                  , &amp;<span class="org-constant">Counter</span>::setCounter  <span class="org-comment-delimiter">// </span><span class="org-comment">Setter </span>
                                  , <span class="org-string">"number"</span>              <span class="org-comment-delimiter">// </span><span class="org-comment">Property name </span>
                                  <span class="org-rainbow-delimiters-depth-3">)</span>;

          <span class="org-type">int</span> <span class="org-variable-name">ret</span> = eval_code<span class="org-rainbow-delimiters-depth-3">(</span>ctx, R<span class="org-default">"</span><span class="org-string">( </span>
<span class="org-string">              var counter = new Counter("mycounter", 10); </span>

<span class="org-string">              for(i = 0 ; i &lt; 5; i++) { counter.increment(); }</span>

<span class="org-string">              var n = counter.getCounter(); </span>
<span class="org-string">              log_text(" [BEFORE] Counter value = " + n );</span>

<span class="org-string">              counter.setCounter(100);</span>
<span class="org-string">              log_text(" [AFTER 1 ] Counter value = " + counter.getCounter() );</span>

<span class="org-string">              counter.number = 400;</span>
<span class="org-string">              log_text(" [AFTER 2] Counter value = " + counter.number );</span>
<span class="org-string">          )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
          assert<span class="org-rainbow-delimiters-depth-3">(</span> ret == 0 <span class="org-rainbow-delimiters-depth-3">)</span>;

      <span class="org-rainbow-delimiters-depth-2">}</span>

      <span class="org-comment-delimiter">/* </span><span class="org-comment">======= Calling Javascript Engine from C++ ====================*/</span>
      <span class="org-comment-delimiter">// </span><span class="org-comment">Note: It is useful for reading data or user configuration </span>
      <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n === [EXPERIMENT 3] ==&gt;&gt; Calling engine objects from C++ &lt;&lt;===== \n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
      <span class="org-rainbow-delimiters-depth-2">{</span>
          <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">code</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">            // Global variables for configuration </span>
<span class="org-string">            points = 200; </span>
<span class="org-string">            asset_path = "C:\\\\Users\\dummy\\data\\graphics";</span>

<span class="org-string">            function my_js_function(n){</span>
<span class="org-string">                log_text( " &lt;my_js_function&gt; =&gt;&gt; n = " + n );</span>
<span class="org-string">                var k = 20 * n + 100;</span>
<span class="org-string">                return k; </span>
<span class="org-string">            }</span>

<span class="org-string">          )</span><span class="org-default">"</span>;
          eval_code<span class="org-rainbow-delimiters-depth-3">(</span>ctx, code<span class="org-rainbow-delimiters-depth-3">)</span>;

          <span class="org-comment-delimiter">// </span><span class="org-comment">Throws error: DukErrorException</span>
          <span class="org-keyword">auto</span> <span class="org-variable-name">points</span> = dukglue_peval<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>ctx, <span class="org-string">"points"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
          <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [*] =&gt;&gt; points = "</span> &lt;&lt; points &lt;&lt; <span class="org-constant">std</span>::endl;

          <span class="org-comment-delimiter">// </span><span class="org-comment">Throws error: DukErrorException</span>
          <span class="org-keyword">auto</span> <span class="org-variable-name">asset_path</span> = dukglue_peval<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>ctx, <span class="org-string">"asset_path"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
          <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [*] =&gt;&gt; asset_path = "</span> &lt;&lt; asset_path &lt;&lt; <span class="org-constant">std</span>::endl;

          <span class="org-keyword">auto</span> <span class="org-variable-name">jsexpr</span> = dukglue_peval<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>ctx, <span class="org-string">"3.51 * 10.52 - 8.251 / 100"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
          <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [*] jsexpr = "</span> &lt;&lt; jsexpr &lt;&lt; <span class="org-constant">std</span>::endl;

          <span class="org-comment-delimiter">// </span><span class="org-comment">Call Javascript function from C++ </span>
          <span class="org-keyword">auto</span> <span class="org-variable-name">func</span> = dukglue_peval<span class="org-rainbow-delimiters-depth-3">&lt;</span>DukValue<span class="org-rainbow-delimiters-depth-3">&gt;(</span>ctx, <span class="org-string">"my_js_function"</span><span class="org-rainbow-delimiters-depth-3">)</span>;
          <span class="org-type">int</span> <span class="org-variable-name">res</span> = dukglue_pcall<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-3">&gt;(</span>ctx, func, 20<span class="org-rainbow-delimiters-depth-3">)</span>;
          <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"  [*] res = "</span> &lt;&lt; res &lt;&lt; <span class="org-constant">std</span>::endl;

      <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">Release Javascript engine object (aka virtual machine)</span>
    ::duk_destroy_heap<span class="org-rainbow-delimiters-depth-2">(</span>ctx<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>

</pre>
</div>

<p>
Build: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build --target 
</pre>
</div>

<p>
Program output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ ./build/duktape-embed 

=== [EXPERIMENT 1] ==&gt;&gt; Register and call C++ functions &lt;&lt;===== 
[TRACE] number passed is = 10
=&gt;&gt; [C++-LOG] -  Hello world from Javascript
=&gt;&gt; [C++-LOG] -  Toke is equal to 100
=&gt;&gt; [C++-LOG] -  1000
 =&gt;&gt; [TRACE] Plot points  =&gt;&gt;  x = 20.5 x = 100.23 x = -125.254 x = 8.251 x = 100 

=== [EXPERIMENT 2] ==&gt;&gt; Register and call C++ classes &lt;&lt;===== 

[TRACE] Counter created with =&gt;  {  name = mycounter ; counter = 10 } 
[TRACE] increment event =&gt;&gt; counter = {  mycounter ; 11 } 
[TRACE] increment event =&gt;&gt; counter = {  mycounter ; 12 } 
[TRACE] increment event =&gt;&gt; counter = {  mycounter ; 13 } 
[TRACE] increment event =&gt;&gt; counter = {  mycounter ; 14 } 
[TRACE] increment event =&gt;&gt; counter = {  mycounter ; 15 } 
=&gt;&gt; [C++-LOG] -  [BEFORE] Counter value = 15
[TRACE] I was set to value 100
=&gt;&gt; [C++-LOG] -  [AFTER 1 ] Counter value = 100
[TRACE] I was set to value 400
=&gt;&gt; [C++-LOG] -  [AFTER 2] Counter value = 400

=== [EXPERIMENT 3] ==&gt;&gt; Calling engine objects from C++ &lt;&lt;===== 

 [*] =&gt;&gt; points = 200
 [*] =&gt;&gt; asset_path = C:<span class="org-string">\\</span>Users\dummy\data\graphics
 [*] jsexpr = 36.8427
=&gt;&gt; [C++-LOG] -  &lt;my_js_function&gt; =&gt;&gt; n = 20
 [*] res = 500


</pre>
</div>
</div>
</div>
<div id="outline-container-org3b58f47" class="outline-4">
<h4 id="org3b58f47"><span class="section-number-4">1.7.3</span> Example project with Duktape-CC binding library</h4>
<div class="outline-text-4" id="text-1-7-3">
<ul class="org-ul">
<li>Duktape-CC binding library: <a href="https://github.com/stfwi/duktape-cc/">https://github.com/stfwi/duktape-cc/</a>
<ul class="org-ul">
<li>Benefits 
<ul class="org-ul">
<li>Namespace</li>
<li>RAII for duktape C-API</li>
<li>Javascript common known APIs such as console.log()</li>
</ul></li>
<li>Disadvantage:
<ul class="org-ul">
<li>No possible to bind lambda function.</li>
<li>No possible to bind C++ classes or objects</li>
<li>No CMakeLists.txt at top directory, which makes the library
usage easier, but the following cmake scripts solves this
problem.</li>
</ul></li>
</ul></li>
</ul>


<p>
File: CMakeLists.txt 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.0)
<span class="org-function-name">project</span>(duktape-cc-trial)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)

<span class="org-function-name">include</span>(duktape.cmake)

<span class="org-comment">#----- Main Target Definition ----------------------------#</span>
       <span class="org-function-name">add_executable</span>( duktape-script duktape-script.cpp)
<span class="org-function-name">target_link_libraries</span>( duktape-script duktape-cc )
</pre>
</div>

<p>
File: duktape.cmake 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">include</span>(FetchContent)

<span class="org-comment"># Note: the 'add_subriectory' line was commented becuyase </span>
<span class="org-comment">#       library that will be downloaded does not have </span>
<span class="org-comment">#       a CMakeListst.txt file at the root directory. </span>
<span class="org-keyword">macro</span>(Download_Library_Git  NAME TAG REPOSITORY_URL)
    <span class="org-function-name">FetchContent_Declare</span>(
        ${<span class="org-variable-name">NAME</span>}
        GIT_REPOSITORY  ${<span class="org-variable-name">REPOSITORY_URL</span>}
        GIT_TAG         ${<span class="org-variable-name">TAG</span>}
    )
    <span class="org-function-name">FetchContent_GetProperties</span>(${<span class="org-variable-name">NAME</span>})
    <span class="org-keyword">if</span>(NOT cpputest_POPULATED)
        <span class="org-function-name">FetchContent_Populate</span>(${<span class="org-variable-name">NAME</span>})
        <span class="org-function-name">message</span>(<span class="org-string">"${</span><span class="org-variable-name">NAME</span><span class="org-string">}_SOURCE_DIR} = ${${</span><span class="org-variable-name">NAME</span><span class="org-string">}_SOURCE_DIR}"</span>)        

        <span class="org-comment"># =&gt; Disable following line: the library does not have a CMakeLists.txt</span>
        <span class="org-comment">#    at the root directory.</span>
        <span class="org-comment"># add_subdirectory(${${</span><span class="org-variable-name">NAME</span><span class="org-comment">}_SOURCE_DIR} ${${</span><span class="org-variable-name">NAME</span><span class="org-comment">}_BINARY_DIR})</span>
    <span class="org-keyword">endif</span>()
<span class="org-keyword">endmacro</span>()


<span class="org-comment"># ====&gt;&gt; Duktape JavaScript Engine Configuration &lt;&lt;===========#</span>

<span class="org-function-name">Download_Library_Git</span>( duktape-cc 
                      51fed200b0c3353a60fa560aa8a13a480f0ec0c7
                      https://github.com/stfwi/duktape-cc/
                    )

<span class="org-function-name">file</span>(GLOB_RECURSE duktape_sources <span class="org-string">"${</span><span class="org-variable-name">duktape-cc_SOURCE_DIR</span><span class="org-string">}/duktape/*.c"</span>)
<span class="org-function-name">file</span>(GLOB_RECURSE duktape_headers1 <span class="org-string">"${</span><span class="org-variable-name">duktape-cc_SOURCE_DIR</span><span class="org-string">}/duktape/*.hh"</span>)
<span class="org-function-name">file</span>(GLOB_RECURSE duktape_headers2 <span class="org-string">"${</span><span class="org-variable-name">duktape-cc_SOURCE_DIR</span><span class="org-string">}/duktape/*.h"</span>)

               <span class="org-function-name">add_library</span>( duktape-cc ${<span class="org-variable-name">duktape_sources</span>} ${<span class="org-variable-name">duktape_headers1</span>} ${<span class="org-variable-name">duktape_headers2</span>} )
<span class="org-function-name">target_include_directories</span>( duktape-cc PUBLIC ${<span class="org-variable-name">duktape-cc_SOURCE_DIR</span>} )

</pre>
</div>

<p>
File: duktape-script.cpp 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">fstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">duktape/duktape.hh</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">duktape/mod/mod.stdio.hh</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" [TRACE] Program started Ok. "</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Create Duktape Engine object (Virtual Machine)</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">ctx</span> = <span class="org-constant">duktape</span>::engine<span class="org-rainbow-delimiters-depth-2">{}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Load all functions from stdio module </span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">==&gt; Note: It is necessary for console.log() work </span>
    <span class="org-constant">duktape</span>::<span class="org-constant">mod</span>::<span class="org-constant">stdio</span>::define_in<span class="org-rainbow-delimiters-depth-2">(</span>ctx<span class="org-rainbow-delimiters-depth-2">)</span>;   


    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n [EXPERIMENT 1] ======= Evaluate string as code ========"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    ctx.eval<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">void</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>R<span class="org-default">"</span><span class="org-string">( </span>
<span class="org-string">        console.log(" [INFO] Hello world Javascript Engine ");</span>

<span class="org-string">        var i = 0;</span>
<span class="org-string">        while(i &lt; 5) {</span>
<span class="org-string">            console.log(" [TRACE] &lt;ducktape&gt;  i = " + i);</span>
<span class="org-string">            i++;</span>
<span class="org-string">        }</span>
<span class="org-string">    )</span><span class="org-default">"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n [EXPERIMENT 2] == Read/write values to the engine the engine ="</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Write or pass values to the engine. </span>
    ctx.define<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"app.version"</span>, <span class="org-string">"0.251"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    ctx.define<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"user.points"</span>, 1000<span class="org-rainbow-delimiters-depth-2">)</span>;
    ctx.define<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"array1"</span>, <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">&gt;{</span> 4.51, 9.25, -25.154, 205.2 <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    ctx.define<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"array2"</span>, <span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-constant">std</span>::string<span class="org-rainbow-delimiters-depth-3">&gt;{</span> <span class="org-string">"C++"</span>, <span class="org-string">"ADA-Spark"</span>, <span class="org-string">"Rust"</span>, <span class="org-string">"Dlang"</span>, <span class="org-string">"OCaml"</span> <span class="org-rainbow-delimiters-depth-3">}</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">script_file</span> = <span class="org-string">"/tmp/myscript.js"</span>;

    <span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-variable-name">script_code</span> = R<span class="org-default">"</span><span class="org-string">(</span>
<span class="org-string">        console.log("  =&gt; app.version = " + app.version );</span>
<span class="org-string">        console.log("  =&gt; user.points = " + user.points );</span>
<span class="org-string">        console.log("  =&gt; array1 = " + array1);</span>
<span class="org-string">        console.log("  =&gt; array2 = " + array2);</span>

<span class="org-string">        myconfig_path = "/Users/data/osx/config";</span>
<span class="org-string">        user_credits = 1020; </span>
<span class="org-string">        vector = [100.25, 90.251, -120.5150];</span>
<span class="org-string">    )</span><span class="org-default">"</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Write script code to file     </span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">fs</span> = <span class="org-constant">std</span>::ofstream<span class="org-rainbow-delimiters-depth-2">(</span>script_file<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-comment-delimiter">// </span><span class="org-comment">Flush forces writing to the IO</span>
    fs &lt;&lt; script_code &lt;&lt; <span class="org-constant">std</span>::flush;          
    <span class="org-comment-delimiter">// </span><span class="org-comment">Execute script from file </span>
    ctx.include<span class="org-rainbow-delimiters-depth-2">(</span>script_file<span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" ---- Read configuration from file "</span> &lt;&lt; <span class="org-constant">std</span>::endl; 

    <span class="org-comment-delimiter">// </span><span class="org-comment">Throws exception: duktape::detail::basic_script_error&lt;void&gt;</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">myconfig_path</span> = ctx.eval<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"myconfig_path"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">credits</span>       = ctx.eval<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">int</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"user_credits"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">vec</span>           = ctx.eval<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::<span class="org-type">vector</span><span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">&gt;</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span><span class="org-string">"vector"</span><span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"\n\n[*] my_config_path = "</span> &lt;&lt; myconfig_path &lt;&lt; <span class="org-string">"\n"</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"[*]   user_credits = "</span> &lt;&lt; credits &lt;&lt; <span class="org-string">"\n"</span>;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">"[*] vec[0] = "</span> &lt;&lt; vec<span class="org-rainbow-delimiters-depth-2">[</span>0<span class="org-rainbow-delimiters-depth-2">]</span> &lt;&lt; <span class="org-string">" ; vec[1] = "</span> &lt;&lt; vec<span class="org-rainbow-delimiters-depth-2">[</span>1<span class="org-rainbow-delimiters-depth-2">]</span> &lt;&lt; <span class="org-string">"\n"</span>;    

    <span class="org-keyword">return</span> 0;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
Build: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -B_build -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build --target 
</pre>
</div>

<p>
Program output: 
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ _build/duktape-script 
 [TRACE] Program started Ok. 

 [EXPERIMENT 1] ======= Evaluate string as code ========

 [EXPERIMENT 2] == Read/write values to the engine the engine =
 [INFO] Hello world Javascript Engine 
 [TRACE] &lt;ducktape&gt;  i = 0
 [TRACE] &lt;ducktape&gt;  i = 1
 [TRACE] &lt;ducktape&gt;  i = 2
 [TRACE] &lt;ducktape&gt;  i = 3
 [TRACE] &lt;ducktape&gt;  i = 4
  =&gt; app.version = 0.251
  =&gt; user.points = 1000
  =&gt; array1 = 4.51,9.25,-25.154,205.2
  =&gt; array2 = C++,ADA-Spark,Rust,Dlang,OCaml
 ---- Read configuration from file 


[*] my_config_path = /Users/data/osx/config
[*]   user_credits = 1020
[*] vec[0] = 100.25 ; vec[1] = 90.251

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge64d625" class="outline-3">
<h3 id="orge64d625"><span class="section-number-3">1.8</span> Python Engine via Pybind11</h3>
<div class="outline-text-3" id="text-1-8">
<p>
Documentation: 
</p>

<ul class="org-ul">
<li><a href="https://pybind11.readthedocs.io/en/stable/advanced/embedding.html">Pybind11 Embedding</a></li>
</ul>

<p>
Advantages: 
</p>
<ul class="org-ul">
<li>High popularity</li>
<li>Lost of libraries</li>
<li>Easy usage</li>
</ul>

<p>
Drawbacks: 
</p>
<ul class="org-ul">
<li>Hard to static link</li>
<li>Not ligthweight and designed to be embedded as Lua.</li>
<li>It is not possible to run multiple instances of the Python
interpreter.</li>
<li>It is not possible to sandbox the interpreter and restrict
accessing files or process manipulation APIs.</li>
<li>Requires pre-installation of Python development headers. But, it
can be mitigated by using Anaconda or miniconda Python distributions.</li>
</ul>

<p>
Known Cases: 
</p>
<ul class="org-ul">
<li>GDB - GNU Debugger</li>
<li>IDA Debugger</li>
<li>Sublime Text Editor</li>
</ul>

<p>
<b>Sample Project</b> 
</p>

<p>
GIST containing the sources: 
</p>
<ul class="org-ul">
<li><a href="https://gist.github.com/d7fda02034757374a0b0114e54c7daff">https://gist.github.com/d7fda02034757374a0b0114e54c7daff</a></li>
</ul>

<p>
File: CMakeLists.txt 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.9)
<span class="org-function-name">project</span>(embed-python-scripting)

<span class="org-comment">#========== Global Configurations =============#</span>
<span class="org-comment">#----------------------------------------------#</span>

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)     
<span class="org-function-name">set</span>(CMAKE_VERBOSE_MAKEFILE ON)
<span class="org-function-name">set</span>(CMAKE_CXX_EXTENSIONS OFF)

<span class="org-comment"># ------------ Download CPM CMake Script ----------------#</span>

<span class="org-comment">## Automatically donwload and use module CPM.cmake</span>
<span class="org-function-name">file</span>(DOWNLOAD https://raw.githubusercontent.com/TheLartians/CPM.cmake/v0.26.2/cmake/CPM.cmake
                 <span class="org-string">"${</span><span class="org-variable-name">CMAKE_BINARY_DIR</span><span class="org-string">}/CPM.cmake"</span>)
<span class="org-function-name">include</span>(<span class="org-string">"${</span><span class="org-variable-name">CMAKE_BINARY_DIR</span><span class="org-string">}/CPM.cmake"</span>)

<span class="org-comment">#----------- Add dependencies --------------------------#</span>

<span class="org-function-name">find_package</span>(PythonLibs REQUIRED)

<span class="org-function-name">CPMAddPackage</span>(
    NAME pybind11 
    URL  https://github.com/pybind/pybind11/archive/v2.5.zip    
    DOWNLOAD_ONLY true  
)

<span class="org-comment"># add_subdirectory( {pybind11_SOURCE_DIR} )</span>
<span class="org-function-name">include_directories</span>( ${<span class="org-variable-name">pybind11_SOURCE_DIR</span>}/include
                     ${<span class="org-variable-name">PYTHON_INCLUDE_PATH</span>} )

<span class="org-function-name">message</span>( [TRACE] <span class="org-string">"  pybind11_SOURCE_DIR = ${</span><span class="org-variable-name">pybind11_SOURCE_DIR</span><span class="org-string">} "</span>)

<span class="org-comment"># configure_file(script.py ${</span><span class="org-variable-name">CMAKE_BINARY_DIR</span><span class="org-comment">} COPYONLY )</span>

<span class="org-comment">#----------- Set targets -------------------------------#</span>

<span class="org-function-name">add_executable</span>(app1 app1.cpp)
<span class="org-function-name">target_link_libraries</span>( app1 ${<span class="org-variable-name">PYTHON_LIBRARIES</span>} )

<span class="org-function-name">add_custom_command</span>(
        TARGET app1 POST_BUILD
        COMMAND ${<span class="org-variable-name">CMAKE_COMMAND</span>} -E copy
                ${<span class="org-variable-name">CMAKE_SOURCE_DIR</span>}/script.py 
                ${<span class="org-variable-name">CMAKE_CURRENT_BINARY_DIR</span>}/script.py)

</pre>
</div>

<p>
File: app.cpp 
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">iostream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">string</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">sstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">fstream</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">cassert</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>
<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">vector</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span> 

<span class="org-preprocessor">#include</span> <span class="org-string"><span class="org-rainbow-delimiters-depth-1">&lt;</span></span><span class="org-string">pybind11/embed.h</span><span class="org-string"><span class="org-rainbow-delimiters-depth-1">&gt;</span></span>

<span class="org-keyword">namespace</span> <span class="org-constant">py</span> = pybind11;

<span class="org-comment-delimiter">// </span><span class="org-comment">Requires: &lt;string&gt;, &lt;stream&gt;, &lt;sstream&gt;</span>
<span class="org-function-name">std</span>::string readFile<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">file</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">auto</span> <span class="org-variable-name">is</span> = <span class="org-constant">std</span>::ifstream<span class="org-rainbow-delimiters-depth-2">(</span>file<span class="org-rainbow-delimiters-depth-2">)</span>;
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span> <span class="org-negation-char">!</span>is.good<span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-2">){</span>
        <span class="org-keyword">throw</span> <span class="org-constant">std</span>::runtime_error<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"Error: stream has errors."</span><span class="org-rainbow-delimiters-depth-3">)</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-constant">std</span>::<span class="org-type">stringstream</span> <span class="org-variable-name">ss</span>;
    ss &lt;&lt; is.rdbuf<span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-keyword">return</span> ss.str<span class="org-rainbow-delimiters-depth-2">()</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>


<span class="org-type">int</span> <span class="org-function-name">main</span><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-type">int</span> <span class="org-variable-name">argc</span>, <span class="org-type">char</span>** <span class="org-variable-name">argv</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">extern</span> <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-variable-name">pycode</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">guard</span> = <span class="org-constant">py</span>::scoped_interpreter<span class="org-rainbow-delimiters-depth-2">{}</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ EXPERIMENT 1 ------------------------------------// </span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">" [EXPERIMENT 1] ===== Execute Python code ======================\n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">code</span> = readFile<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"./script.py"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">std::cout &lt;&lt; " code = " &lt;&lt; code &lt;&lt; "\n";</span>

    <span class="org-keyword">auto</span> <span class="org-variable-name">g</span> = <span class="org-constant">py</span>::globals<span class="org-rainbow-delimiters-depth-2">()</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Define global variables for the interpreter global scope </span>
    g<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"game_assets"</span><span class="org-rainbow-delimiters-depth-2">]</span> = <span class="org-string">"/Users/myuser/game_assets"</span>;
    g<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"speed"</span><span class="org-rainbow-delimiters-depth-2">]</span>       = 20.151;
    g<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"z_value"</span><span class="org-rainbow-delimiters-depth-2">]</span>     = 100;    

    <span class="org-comment-delimiter">// </span><span class="org-comment">Evaluate Python code</span>
    <span class="org-keyword">try</span> <span class="org-rainbow-delimiters-depth-2">{</span>        
        <span class="org-constant">py</span>::exec<span class="org-rainbow-delimiters-depth-3">(</span> code, g <span class="org-rainbow-delimiters-depth-3">)</span>;

    <span class="org-rainbow-delimiters-depth-2">}</span> <span class="org-keyword">catch</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">pybind11</span>::<span class="org-type">error_already_set</span> <span class="org-keyword">const</span>&amp; <span class="org-variable-name">ex</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cerr &lt;&lt; <span class="org-string">" [PYBIND11 ERROR] "</span> &lt;&lt; ex.what<span class="org-rainbow-delimiters-depth-3">()</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-keyword">return</span> EXIT_FAILURE;
    <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-comment-delimiter">// </span><span class="org-comment">------ EXPERIMENT 2 ------------------------------------// </span>
    <span class="org-constant">std</span>::puts<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\n [EXPERIMENT 2] == Read user defined configuration variables ===\n"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-keyword">auto</span> <span class="org-variable-name">v_x</span>    = g<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"x"</span><span class="org-rainbow-delimiters-depth-2">]</span>.cast<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">double</span><span class="org-rainbow-delimiters-depth-2">&gt;()</span>;
    <span class="org-keyword">auto</span> <span class="org-variable-name">v_path</span> = g<span class="org-rainbow-delimiters-depth-2">[</span><span class="org-string">"path"</span><span class="org-rainbow-delimiters-depth-2">]</span>.cast<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-constant">std</span>::<span class="org-type">string</span><span class="org-rainbow-delimiters-depth-2">&gt;()</span>;

    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [*]    v_x = "</span> &lt;&lt; v_x &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" [*] v_path = "</span> &lt;&lt; v_path &lt;&lt; <span class="org-constant">std</span>::endl;

    <span class="org-keyword">return</span> EXIT_SUCCESS;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">----- Internal Python Embedded Module ---------------------------// </span>


<span class="org-keyword">const</span> <span class="org-type">char</span>* <span class="org-function-name">version</span><span class="org-rainbow-delimiters-depth-1">()</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-keyword">return</span> <span class="org-string">"SampleModule Version 3.451-ZETA"</span>;
<span class="org-rainbow-delimiters-depth-1">}</span>

<span class="org-comment-delimiter">// </span><span class="org-comment">Sample "function-object class"</span>
<span class="org-keyword">class</span> <span class="org-type">LinearFunctor</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
<span class="org-function-name">public</span>:
    <span class="org-type">double</span> <span class="org-variable-name">A</span> = 0, <span class="org-variable-name">B</span> = 0;

    <span class="org-function-name">LinearFunctor</span><span class="org-rainbow-delimiters-depth-2">()</span>;
    <span class="org-function-name">LinearFunctor</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">a</span>, <span class="org-type">double</span> <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-2">)</span>: A<span class="org-rainbow-delimiters-depth-2">(</span>a<span class="org-rainbow-delimiters-depth-2">)</span>, B<span class="org-rainbow-delimiters-depth-2">(</span>b<span class="org-rainbow-delimiters-depth-2">){</span> <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">double</span> <span class="org-function-name">GetA</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span>   <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> A; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span>   <span class="org-function-name">SetA</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">a</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span> A = a; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">double</span> <span class="org-function-name">GetB</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span>   <span class="org-rainbow-delimiters-depth-2">{</span> <span class="org-keyword">return</span> B; <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-type">void</span>   <span class="org-function-name">SetB</span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">b</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">{</span> B = b; <span class="org-rainbow-delimiters-depth-2">}</span>

    <span class="org-type">void</span> <span class="org-function-name">show</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" LinearFunction: y(x) = A * x + B"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-constant">std</span>::cout &lt;&lt; <span class="org-string">" =&gt; A = "</span> &lt;&lt; <span class="org-keyword">this</span>-&gt;A &lt;&lt; <span class="org-string">" ; B = "</span> &lt;&lt; <span class="org-keyword">this</span>-&gt;B &lt;&lt; <span class="org-constant">std</span>::endl;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-constant">std</span>::<span class="org-type">string</span> <span class="org-function-name">toString</span><span class="org-rainbow-delimiters-depth-2">()</span> <span class="org-keyword">const</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-constant">std</span>::<span class="org-type">stringstream</span> <span class="org-variable-name">ss</span>;
        ss &lt;&lt; <span class="org-string">" LinearFunction: y(x) = A * x + B"</span> &lt;&lt; <span class="org-constant">std</span>::endl;
        ss &lt;&lt; <span class="org-string">" =&gt; A = "</span> &lt;&lt; <span class="org-keyword">this</span>-&gt;A &lt;&lt; <span class="org-string">" ; B = "</span> &lt;&lt; <span class="org-keyword">this</span>-&gt;B &lt;&lt; <span class="org-constant">std</span>::endl;
        <span class="org-keyword">return</span> ss.str<span class="org-rainbow-delimiters-depth-3">()</span>;
    <span class="org-rainbow-delimiters-depth-2">}</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">Function-call operator</span>
    <span class="org-type">double</span> <span class="org-keyword">operator</span><span class="org-function-name"><span class="org-rainbow-delimiters-depth-2">()</span></span><span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">double</span> <span class="org-variable-name">x</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">{</span>
        <span class="org-keyword">return</span> A * x + B;
    <span class="org-rainbow-delimiters-depth-2">}</span>
<span class="org-rainbow-delimiters-depth-1">}</span>;

<span class="org-comment-delimiter">// </span><span class="org-comment">---- Internal Module -----------------------// </span>

<span class="org-function-name">PYBIND11_EMBEDDED_MODULE</span><span class="org-rainbow-delimiters-depth-1">(</span>SampleModule, m<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">// </span><span class="org-comment">optional module docstring</span>
    m.doc<span class="org-rainbow-delimiters-depth-2">()</span> = <span class="org-string">"Sample Python built with C++ CeePlusPlus "</span>;
    m.def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"version"</span>, &amp;version, <span class="org-string">"Show Library Version"</span><span class="org-rainbow-delimiters-depth-2">)</span>;

    m.def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"cppLambda"</span>
          ,<span class="org-rainbow-delimiters-depth-3">[](</span><span class="org-type">double</span> <span class="org-variable-name">x</span>, <span class="org-type">double</span> <span class="org-variable-name">y</span><span class="org-rainbow-delimiters-depth-3">){</span> <span class="org-keyword">return</span> 3.0 * x + y;<span class="org-rainbow-delimiters-depth-3">}</span>
          ,<span class="org-string">"A C++ lambda object or functor"</span>
          <span class="org-comment-delimiter">//</span><span class="org-comment">,py::arg("x"), py::args("y") = 15</span>
    <span class="org-rainbow-delimiters-depth-2">)</span>;

    <span class="org-comment-delimiter">// </span><span class="org-comment">Register LinearFunction</span>
    <span class="org-constant">py</span>::class_<span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">LinearFunctor</span><span class="org-rainbow-delimiters-depth-2">&gt;(</span>m, <span class="org-string">"LinearFunctor"</span><span class="org-rainbow-delimiters-depth-2">)</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-constant">py</span>::init<span class="org-rainbow-delimiters-depth-3">&lt;</span><span class="org-type">double</span>, <span class="org-type">double</span><span class="org-rainbow-delimiters-depth-3">&gt;()</span><span class="org-rainbow-delimiters-depth-2">)</span>             <span class="org-comment-delimiter">// </span><span class="org-comment">Register overloaded consructor</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"GetA"</span>, &amp;<span class="org-constant">LinearFunctor</span>::GetA<span class="org-rainbow-delimiters-depth-2">)</span>            <span class="org-comment-delimiter">// </span><span class="org-comment">Reister method GetA()</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"GetB"</span>, &amp;<span class="org-constant">LinearFunctor</span>::GetB<span class="org-rainbow-delimiters-depth-2">)</span>            <span class="org-comment-delimiter">// </span><span class="org-comment">Register method GetB()</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"SetA"</span>, &amp;<span class="org-constant">LinearFunctor</span>::SetA<span class="org-rainbow-delimiters-depth-2">)</span>            <span class="org-comment-delimiter">// </span><span class="org-comment">Reister method GetA()</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"SetB"</span>, &amp;<span class="org-constant">LinearFunctor</span>::SetB<span class="org-rainbow-delimiters-depth-2">)</span>            <span class="org-comment-delimiter">// </span><span class="org-comment">Register method GetB()</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"show"</span>, &amp;<span class="org-constant">LinearFunctor</span>::show<span class="org-rainbow-delimiters-depth-2">)</span>            <span class="org-comment-delimiter">// </span><span class="org-comment">Register method show</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"call"</span>, &amp;<span class="org-constant">LinearFunctor</span>::<span class="org-keyword">operator</span><span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span>      <span class="org-comment-delimiter">// </span><span class="org-comment">Register function-call operator with name 'call'</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"__call__"</span>, &amp;<span class="org-constant">LinearFunctor</span>::<span class="org-keyword">operator</span> <span class="org-rainbow-delimiters-depth-3">()</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-comment-delimiter">// </span><span class="org-comment">Register fun-call operator</span>
            .def<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"__repr__"</span>, &amp;<span class="org-constant">LinearFunctor</span>::toString<span class="org-rainbow-delimiters-depth-2">)</span>    <span class="org-comment-delimiter">// </span><span class="org-comment">Register strin representation</span>
            .def_readwrite<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"A"</span>, &amp;<span class="org-constant">LinearFunctor</span>::A<span class="org-rainbow-delimiters-depth-2">)</span>        <span class="org-comment-delimiter">// </span><span class="org-comment">Register field A</span>
            .def_readwrite<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"B"</span>, &amp;<span class="org-constant">LinearFunctor</span>::B<span class="org-rainbow-delimiters-depth-2">)</span>;       <span class="org-comment-delimiter">// </span><span class="org-comment">Register field B</span>

<span class="org-rainbow-delimiters-depth-1">}</span> <span class="org-comment-delimiter">/** </span><span class="org-comment">--- End of PYBIND11_MODULE registration --- */</span>

</pre>
</div>

<p>
File: script.py 
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">print</span>(<span class="org-string">"   =&gt; game_assets = "</span>, game_assets)
<span class="org-keyword">print</span>(<span class="org-string">"   =&gt;       speed = "</span>, speed)
<span class="org-keyword">print</span>(<span class="org-string">"   =&gt;     z_value = "</span>, z_value)

<span class="org-function-name">x</span>: <span class="org-builtin">float</span> = 10.0 * 20.51 / 200

<span class="org-variable-name">path</span> = <span class="org-string">"C:\\\\Users\\dummy\\Documents\\data"</span>

<span class="org-keyword">print</span>(<span class="org-string">" [PYTHON] The value of x = "</span>, x)

<span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(5):
    <span class="org-keyword">print</span>(<span class="org-string">"   [PYTHON] i = "</span>, i)

<span class="org-comment-delimiter"># </span><span class="org-comment">It is not possible to restrict the interpreter!</span>
<span class="org-keyword">import</span> os 
<span class="org-keyword">print</span>(<span class="org-string">" [*] Current path = "</span>, os.getcwd() )

<span class="org-keyword">print</span>(<span class="org-string">"\n ------------------------------------------"</span>)
<span class="org-keyword">print</span>(<span class="org-string">"\n =&gt;&gt;&gt; Test Python Internal Module (C++) &lt;&lt;=\n"</span>)

<span class="org-keyword">import</span> SampleModule <span class="org-keyword">as</span> m 
<span class="org-keyword">from</span> SampleModule <span class="org-keyword">import</span> LinearFunctor 

<span class="org-keyword">print</span>(f<span class="org-string">"    -&gt;   Module Information = [{m.__doc__}] "</span>)
<span class="org-keyword">print</span>( <span class="org-string">"    -&gt;       Module Version = "</span>, m.version())
<span class="org-keyword">print</span>( <span class="org-string">"    -&gt; m.cppLambda(100, 25) = "</span>, m.cppLambda(100, 25) )

<span class="org-variable-name">functor</span> = LinearFunctor(8.0, -10.0)
<span class="org-keyword">print</span>(f<span class="org-string">"\n C++ Functor -&gt; ${functor} "</span>)

<span class="org-keyword">print</span>(<span class="org-string">" functor(5.0) = "</span>, functor(5.0))
<span class="org-keyword">print</span>(<span class="org-string">" functor(8.0) = "</span>, functor(8.0))

</pre>
</div>

<p>
Build and running: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cd /tmp 
$ git clone https://gist.github.com/d7fda02034757374a0b0114e54c7daff python-embed-script 
$ cd python-embed-script

$ cmake -H. -B_build -DCMAKE_BUILD_TYPE=Debug
$ cmake --build _build --target 
</pre>
</div>

<p>
Program output: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ _build/app1 

 [EXPERIMENT 1] ===== Execute Python code ======================

   =&gt; game_assets =  /Users/myuser/game_assets
   =&gt;       speed =  20.151
   =&gt;     z_value =  100
 [PYTHON] The value of x =  1.0255
   [PYTHON] i =  0
   [PYTHON] i =  1
   [PYTHON] i =  2
   [PYTHON] i =  3
   [PYTHON] i =  4
 [*] Current path =  /home/mxpkf8/temp-projects/python-embed-script

 ------------------------------------------

 =&gt;&gt;&gt; Test Python Internal Module (C++) &lt;&lt;=

    -&gt;   Module Information = [Sample Python built with C++ CeePlusPlus ] 
    -&gt;       Module Version =  SampleModule Version 3.451-ZETA
    -&gt; m.cppLambda(100, 25) =  325.0

 C++ Functor -&gt; $ LinearFunction: y(x) = A * x + B
 =&gt; A = 8 ; B = -10

 functor(5.0) =  30.0
 functor(8.0) =  54.0

 [EXPERIMENT 2] == Read user defined configuration variables ===

 [*]    v_x = 1.0255
 [*] v_path = C:<span class="org-string">\\</span>Users\dummy\Documents\data

</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2020-06-22 Mon 02:13</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
