<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-12-24 Mon 17:19 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CPP / C++ - Building Systems and Build Automation</title>
<meta name="generator" content="Org mode" />
<meta name="description" content="cpp/c++ code examples and demonstrations."
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
<link href="theme/org-nav-theme.css" rel="stylesheet">
<script src="theme/org-nav-theme.js"></script>
<link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">CPP / C++ - Building Systems and Build Automation</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org6c83dd3">1. Building Systems and Build Automation</a></li>
<li><a href="#orgea6a50b">2. CMake - Reference Card</a>
<ul>
<li><a href="#org65e8754">2.1. Overview</a></li>
<li><a href="#org18eb89c">2.2. Build a project from command line.</a></li>
<li><a href="#org64c2b60">2.3. Show system information</a></li>
<li><a href="#orgb6c8db4">2.4. Show all modules</a></li>
<li><a href="#org02010bd">2.5. SNIPPET - Common Variables</a>
<ul>
<li><a href="#orge667974">2.5.1. CMAKE_CURRENT_LIST_DIR - Directory where is CMakeLists.txt</a></li>
<li><a href="#org67d4164">2.5.2. CMAKE_CXX_STANDARD - Set C++ Standard</a></li>
<li><a href="#orgae19237">2.5.3. CMAKE_BUILD_TYPE - Set default building type to DEBUG</a></li>
<li><a href="#org13499e6">2.5.4. CMAKE_CXX_FLAGS - Compiler flags</a></li>
</ul>
</li>
<li><a href="#orgfb3e206">2.6. SNIPPET - Detect Operating System</a></li>
<li><a href="#orgcd9fee8">2.7. SNIPPET - Detect Compiler</a></li>
<li><a href="#orgfc02244">2.8. SNIPPET - Detect whether current build is 32 bits or 64 bits</a></li>
<li><a href="#orgb276b7c">2.9. SNIPPET - Copy some target binaries to a directory</a></li>
<li><a href="#org30ce398">2.10. SNIPPET - Create target to run compiled executable</a></li>
<li><a href="#orgf09cd90">2.11. SNIPPET - Issue an error if condition is not met</a></li>
<li><a href="#org0133407">2.12. SNIPPET - Set target subsystem - Win32 API Specific</a></li>
</ul>
</li>
</ul>
</div>
</div>
<ul class="org-ul">
<li><a href='index.html'>Index</a></li>
</ul>

<div id="outline-container-org6c83dd3" class="outline-2">
<h2 id="org6c83dd3"><span class="section-number-2">1</span> Building Systems and Build Automation</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li><a href="https://cmake.org/">CMake</a> (<b>De-facto standard</b>) Meta building system which can generate
project files and building scripts for platform-preferred building
systems. For instance, it can generate Makefile for U*nix-like
system, Ninja build scripts, Visual Studio solutions and so on.
<ul class="org-ul">
<li>Note: CMake is being used by many projects and supported by many
IDEs. Now, it is supported by Microsft's Visual Studio and
JetBrains' Clion IDE and others.</li>
<li>See:
<ul class="org-ul">
<li><a href="http://cliutils.gitlab.io/modern-cmake/">An Introduction to Modern CMake</a></li>
<li><a href="https://gist.github.com/mbinna/c61dbb39bca0e4fb7d1f73b0d66a4fd1">Effective Modern CMake</a></li>
<li><a href="https://github.com/ttroy50/cmake-examples">https://github.com/ttroy50/cmake-examples</a></li>
<li><a href="https://cristianadam.eu/20181202/a-better-qnx-cmake-toolchain-file/">A Better QNX CMake Toolchain File - Cristian Adam</a></li>
</ul></li>
</ul></li>

<li><a href="https://build2.org/">build2</a> - "build2 is an open source (MIT), cross-platform build
toolchain for developing and packaging C++ code. It is a hierarchy
of tools that includes the build system, package dependency manager
(for package consumption), and project dependency manager (for
project development)."
<ul class="org-ul">
<li>See: <a href="https://news.ycombinator.com/item?id=17188851">Build2, a Cargo-like dependency and build manager for C/C++ | Hacker News</a></li>
</ul></li>

<li><a href="https://xmake.io">xmake</a> -  "xmake is a cross-platform build utility based on lua. The
project focuses on making development and building easier and
provides many features (.e.g package, install, plugin, macro,
action, option, task &#x2026;), so that any developer can quickly pick
it up and enjoy the productivity boost when developing and building
project. "
<ul class="org-ul">
<li>Github: <a href="https://github.com/tboox/xmake">https://github.com/tboox/xmake</a></li>
<li>Advatange:
<ul class="org-ul">
<li>Lua-like syntax</li>
<li>Less verbose than CMake</li>
<li>Run lua scripts</li>
<li>Generation of projects, for instance Visual studio solutions.</li>
</ul></li>
</ul></li>

<li><b>Make</b> (GNU Make, BSD Make and NMake) - Simple and quick building
system more used on U*nix-like operating systems.</li>
</ul>
</div>
</div>

<div id="outline-container-orgea6a50b" class="outline-2">
<h2 id="orgea6a50b"><span class="section-number-2">2</span> CMake - Reference Card</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org65e8754" class="outline-3">
<h3 id="org65e8754"><span class="section-number-3">2.1</span> Overview</h3>
<div class="outline-text-3" id="text-2-1">
<p>
<b>CMake can be used in following ways:</b>
</p>

<ul class="org-ul">
<li><span class="underline">Build a software directly from command line</span> in a similar way to
Unix's make - $ make and $ make install.</li>

<li><span class="underline">Generate IDE-specific or preferred project files</span> in IDEs that does
not supports CMake, for instance cmake can generate projects from
the file CMakeLists.txt for the IDEs and text editors: Microsoft
Visual Studio, CodeBlocks, Kate projects, Sublime and Eclipse CDT.</li>

<li><span class="underline">Manage a project in IDEs which supports CMake</span>. In this case, it is
not necessary to generate IDE-specific project files.</li>
</ul>


<p>
<b>IDE Supporting Cmake for managing and building projects:</b>
</p>

<ul class="org-ul">
<li>Microsft - <a href="https://blogs.msdn.microsoft.com/vcblog/2016/10/05/cmake-support-in-visual-studio/">Visual Studio</a></li>
<li>JetBrains - <a href="https://www.youtube.com/watch?v=Rbb0fVCz41w">Clion IDE</a></li>
<li>QTCreator</li>
<li><a href="https://www.kdevelop.org/">KDevelop IDE</a> 
<ul class="org-ul">
<li>Note: KDevelop allows managing project with CMake, visualization
of all CMake targets, run individual targets with mouse click,
run install target and so on.</li>
</ul></li>
</ul>

<p>
<b>Capabilities:</b>
</p>

<ul class="org-ul">
<li>Generate IDE-specific project files.</li>
<li>Generate Visual Studio Solutions (projects)</li>
<li>Generate Makefiles (GNU Make) or NMake (Windows make) for direct
compilation.</li>
<li>Run targets like GNU make</li>
<li>Build a software or library directly from command line.</li>
</ul>

<p>
<b>Possibilities</b> 
</p>

<p>
A CMake project can contain one or more target (taks), similar to
Makefile rules:
</p>

<ul class="org-ul">
<li><span class="underline">Multiples targets for build executables</span> - the same CMake file can
be used to build multiple applications.</li>

<li><span class="underline">Target to build shared library</span></li>

<li><span class="underline">Target to build static library</span></li>

<li><span class="underline">Target to install aplications or libraries</span></li>

<li><span class="underline">Custom targets</span></li>
</ul>

<p>
<b>CMake Project Examples</b>
</p>

<ul class="org-ul">
<li><a href="https://github.com/caiorss/winapi-snippets-cmake">winapi snippets</a>
<ul class="org-ul">
<li>Code snippets and examples for Windows API in modern C++ managed
by CMake.</li>
</ul></li>
<li><a href="https://gist.github.com/caiorss/2bba4c50866d9467aaa8c7792b337f71">shared library</a>
<ul class="org-ul">
<li>Example containibng: Cross platform shared library exporting
functions, classes, polymorphic classes and C-interfaces
(wrapper functions with C-linkage). It also contains a C++
client-code and Python wrapper which uses Python ctype FFI
foreign function interface.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org18eb89c" class="outline-3">
<h3 id="org18eb89c"><span class="section-number-3">2.2</span> Build a project from command line.</h3>
<div class="outline-text-3" id="text-2-2">
<p>
A project using Cmake as building system contains a build script at
top level directory named CMakeLists.txt. To build a project with
CMake, it is necessary to consider that CMake, is not a building
system and does not build anything. Actually, Cmake generates building
scripts for the platform preferred building scripts. For instance, on
Linux, it can generate Makefile, Eclipse Makefiles; on Windows it can
generate MSBuild scripts, NMake (Windows SDK's make) and so on.
</p>

<ul class="org-ul">
<li>Check all possible building system for which CMake can generate
build scripts.
<ul class="org-ul">
<li>Command: $ <b>cmake -G</b></li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Running on Windows 10 </span>
$ cmake -G
CMake Error: No generator specified for -G

Generators
  Visual Studio 15 2017 [arch] = Generates Visual Studio 2017 project files.
                                 Optional [arch] can be <span class="org-string">"Win64"</span> or <span class="org-string">"ARM"</span>.
  Visual Studio 14 2015 [arch] = Generates Visual Studio 2015 project files.
                                 Optional [arch] can be <span class="org-string">"Win64"</span> or <span class="org-string">"ARM"</span>.
  Visual Studio 12 2013 [arch] = Generates Visual Studio 2013 project files.
                                 Optional [arch] can be <span class="org-string">"Win64"</span> or <span class="org-string">"ARM"</span>.
  Visual Studio 11 2012 [arch] = Generates Visual Studio 2012 project files.
                                 Optional [arch] can be <span class="org-string">"Win64"</span> or <span class="org-string">"ARM"</span>.
  Visual Studio 10 2010 [arch] = Generates Visual Studio 2010 project files.
                                 Optional [arch] can be <span class="org-string">"Win64"</span> or <span class="org-string">"IA64"</span>.
  Visual Studio 9 2008 [arch]  = Generates Visual Studio 2008 project files.
                                 Optional [arch] can be <span class="org-string">"Win64"</span> or <span class="org-string">"IA64"</span>.
  Borland Makefiles            = Generates Borland makefiles.
  NMake Makefiles              = Generates NMake makefiles.
  NMake Makefiles JOM          = Generates JOM makefiles.
  Green Hills MULTI            = Generates Green Hills MULTI files
                                 (experimental, work-in-progress)<span class="org-builtin">.</span>
  MSYS Makefiles               = Generates MSYS makefiles.
  MinGW Makefiles              = Generates a make file for use with
                                 mingw32-make.
  Unix Makefiles               = Generates standard UNIX makefiles.
  Ninja                        = Generates build.ninja files.
  Watcom WMake                 = Generates Watcom WMake makefiles.
  CodeBlocks - MinGW Makefiles = Generates CodeBlocks project files.
  CodeBlocks - NMake Makefiles = Generates CodeBlocks project files.
  CodeBlocks - NMake Makefiles JOM
                               = Generates CodeBlocks project files.
  CodeBlocks - Ninja           = Generates CodeBlocks project files.
  CodeBlocks - Unix Makefiles  = Generates CodeBlocks project files.
  CodeLite - MinGW Makefiles   = Generates CodeLite project files.
  CodeLite - NMake Makefiles   = Generates CodeLite project files.
  CodeLite - Ninja             = Generates CodeLite project files.
  CodeLite - Unix Makefiles    = Generates CodeLite project files.
  Sublime Text 2 - MinGW Makefiles
                               = Generates Sublime Text 2 project files.
  Sublime Text 2 - NMake Makefiles
                               = Generates Sublime Text 2 project files.
  Sublime Text 2 - Ninja       = Generates Sublime Text 2 project files.
  Sublime Text 2 - Unix Makefiles
                               = Generates Sublime Text 2 project files.
  Kate - MinGW Makefiles       = Generates Kate project files.
  Kate - NMake Makefiles       = Generates Kate project files.
  Kate - Ninja                 = Generates Kate project files.
  Kate - Unix Makefiles        = Generates Kate project files.
  Eclipse CDT4 - NMake Makefiles
                               = Generates Eclipse CDT 4.0 project files.
  Eclipse CDT4 - MinGW Makefiles
                               = Generates Eclipse CDT 4.0 project files.
  Eclipse CDT4 - Ninja         = Generates Eclipse CDT 4.0 project files.
  Eclipse CDT4 - Unix <span class="org-variable-name">Makefiles</span>= Generates Eclipse CDT 4.0 project files.
</pre>
</div>

<p>
<b>STEP 1: Generate Building Script</b>
</p>

<p>
Project directory listing:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ tree .
<span class="org-builtin">.</span>
&#9500;&#9472;&#9472; build.bat
&#9500;&#9472;&#9472; client1.cpp
&#9500;&#9472;&#9472; CMakeLists.txt
&#9500;&#9472;&#9472; Makefile
&#9500;&#9472;&#9472; pywrapper.py
&#9500;&#9472;&#9472; testlib.cpp
&#9492;&#9472;&#9472; testlib.hpp
</pre>
</div>

<p>
<b>Generate building scripts for platform-preferred building system:</b>
</p>

<ul class="org-ul">
<li>$ cmake -H&lt;SOURCE&gt; -B&lt;BUILD&gt;
<ul class="org-ul">
<li>&lt;SOURCE&gt; =&gt; Source directory where all *.cpp, *.hpp code. In this
case it is (.) dot, current directory. If the directory was
./src, the command would be -Hsrc or -H./src</li>
<li>&lt;BUILD&gt; =&gt; Compilation output, directory where are all building
scripts.</li>
</ul></li>
</ul>

<p>
Command output on Windows 10 - MSVC 2017. Note: It will set VC++ for
32 bits target, not 64 bits.
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -Bbuild
-- Building for: Visual Studio 15 2017
-- The C compiler identification is MSVC 19.16.27025.1
-- The CXX compiler identification is MSVC 19.16.27025.1  
... ...   ... ...   ... ...   ... ...   ... ... 
-- Configuring done
-- Generating done
-- Build files have been written to: C:/Users/archbox/Desktop/experiments/dll/build
</pre>
</div>

<p>
Command output on Linux: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -Bbuild
-- The C compiler identification is GNU 8.2.1
-- The CXX compiler identification is GNU 8.2.1
-- Check for working C compiler: /usr/lib64/ccache/cc
-- Check for working C compiler: /usr/lib64/ccache/cc -- works
... ...   ... ...   ... ...   ... ...   ... ... 
 [INFO] Libtest location is at: libtest_location-NOTFOUND
-- Configuring done
-- Generating done
-- Build files have been written to: /home/archbox/root-scripts/gist/build

<span class="org-comment-delimiter"># </span><span class="org-comment">List ./build directory </span>
$ tree -L 1 build
build
&#9500;&#9472;&#9472; CMakeCache.txt
&#9500;&#9472;&#9472; CMakeFiles
&#9500;&#9472;&#9472; cmake_install.cmake
&#9492;&#9472;&#9472; Makefile

1 directory, 3 files
</pre>
</div>

<p>
<b>Generate building script for specific building system:</b>
</p>

<ul class="org-ul">
<li>$ cmake -H&lt;SOURCE&gt; -B&lt;BUILD&gt; -G &lt;BUILD-SYSTEM&gt;
<ul class="org-ul">
<li>&lt;SOURCE&gt; =&gt; Source directory where all *.cpp, *.hpp code. In this
case it is (.) dot, current directory. If the directory was
./src, the command would be -Hsrc or -H./src</li>
<li>&lt;BUILD&gt; =&gt; Compilation output, directory where are all building
scripts.</li>
<li>&lt;BUILD-SYSTEM&gt; =&gt; All available build system can be listed with $ cmake -G.</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Generate MSbuild building scripts for 32 bits target </span>
 $ cmake -H. -Bbuild -G <span class="org-string">"Visual Studio 15 2017"</span>

 <span class="org-comment-delimiter"># </span><span class="org-comment">Generate MSbuild building scripts for 64 bits target </span>
 $ cmake -H. -Bbuild -G <span class="org-string">"Visual Studio 15 2017 Win64"</span>
</pre>
</div>

<p>
<b>Generate building script with debug symbols enabled:</b>
</p>

<p>
It automatically adds the debugging flags (/Zi) for VC++ Microsoft
Visual C++ Compiler which necessary for debugging a program with GDB,
LLDB or WinDBG. 
</p>

<ul class="org-ul">
<li>Add the flag <b>-DCMAKE_BUILD_TYPE=DEBUG</b></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter"># </span><span class="org-comment">Example 1:</span>
$ cmake -H. -Bbuild -DCMAKE_BUILD_TYPE=DEBUG

<span class="org-comment-delimiter"># </span><span class="org-comment">Example 2:</span>
$ cmake -H. -Bbuild -DCMAKE_BUILD_TYPE=RELEASE

<span class="org-comment-delimiter"># </span><span class="org-comment">Example 3: </span>
cmake -H. -Bbuild -DCMAKE_BUILD_TYPE=DEBUG -G <span class="org-string">"Visual Studio 15 2017 Win64"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Example 4: </span>
cmake -H. -Bbuild -DCMAKE_BUILD_TYPE=DEBUG -G <span class="org-string">"Visual Studio 15 2017 Win64"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Example 5: </span>
cmake -H. -Bbuild -DCMAKE_BUILD_TYPE=RELEASE -G <span class="org-string">"Visual Studio 15 2017 Win64"</span>
</pre>
</div>


<p>
<b>STEP 2: Compile the project invoking the generated building scripts</b>
</p>

<p>
Invoke the building scripts indirectly using CMake:
</p>

<ul class="org-ul">
<li>$ cmake &#x2013;build &lt;BUILD&gt;
<ul class="org-ul">
<li>&lt;BUILD&gt; Is the build directory generated at step 1.</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ cmake --build build
<span class="org-comment-delimiter"># </span><span class="org-comment">OR</span>
$ cmake --build build --config Debug 
<span class="org-comment-delimiter"># </span><span class="org-comment">OR</span>
$ cmake --build build --config Release
</pre>
</div>

<p>
Invoke the building script directly, call the building tool:
</p>
<ul class="org-ul">
<li>This building method depends on the current building system.</li>
</ul>

<p>
For MSBuild, the compilation becomes:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ MSBuild build\testlib.vcxproj

<span class="org-function-name">Microsoft</span> (R) Build Engine version 15.5.180.51428 for .NET Framework
<span class="org-function-name">Copyright</span> (C) Microsoft Corporation. All rights reserved.

Build started 12/21/2018 12:49:38 PM.
Project <span class="org-string">"C:\Users\archbox\Desktop\experiments\dll\build\testlib.vcxproj"</span> on node 1 (default targets)<span class="org-builtin">.</span>
Project <span class="org-string">"C:\Users\archbox\Desktop\experiments\dll\build\testlib.vcxproj"</span> (1) is building <span class="org-string">"C:\Users\archbox\ Desktop\experiments\dll\build\ZERO_CHECK.vcxproj"</span> (2) on node 1 (default targets)<span class="org-builtin">.</span>
... ... ... ... ... ... ... ... ... ... ... ... ... ... 
testlib.vcxproj -&gt; C:\Users\archbox\Desktop\experiments\dll\build\Debug\testlib.dll
<span class="org-function-name">FinalizeBuildStatus</span>:
  Deleting file <span class="org-string">"testlib.dir\Debug\testlib.tlog\unsuccessfulbuild"</span>.
  Touching <span class="org-string">"testlib.dir\Debug\testlib.tlog\testlib.lastbuildstate"</span>.
Done Building Project <span class="org-string">"C:\Users\archbox\Desktop\experiments\dll\build\testlib.vcxproj"</span> (default targets)<span class="org-builtin">.</span>
</pre>
</div>

<p>
For Linux or Unix GNU-Make, the compilation becomes:
</p>

<div class="org-src-container">
<pre class="src src-sh"> $ cd build

 $ make
 /usr/bin/cmake -H/home/archbox/root-scripts/gist -B/home/archbox/root-scripts/gist/build --check-build-system CMakeFiles/Makefile.cmake 0
 /usr/bin/cmake -E cmake_progress_start /home/archbox/root-scripts/gist/build/CMakeFiles /home/archbox/root-scripts/gist/build/CMakeFiles/progress.marks
 make -f CMakeFiles/Makefile2 all
 make[1]: Entering directory <span class="org-string">'/home/archbox/root-scripts/gist/build'</span>
 make -f CMakeFiles/testlib.dir/build.make CMakeFiles/testlib.dir/depend
 make[2]: Entering directory <span class="org-string">'/home/archbox/root-scripts/gist/build'</span>
 ... ... ... ... ... ... ... ... ... ... ... ... 
 [100%] Built target client1-executable
 make[1]: Leaving directory <span class="org-string">'/home/archbox/root-scripts/gist/build'</span>
 /usr/bin/cmake -E cmake_progress_start /home/archbox/root-scripts/gist/build/CMakeFiles 0  


<span class="org-comment-delimiter"># </span><span class="org-comment">Built executables: </span>
<span class="org-comment-delimiter">#</span><span class="org-comment">--------------------------------</span>
$ file libtestlib.so 
<span class="org-function-name">libtestlib.so</span>: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically 
linked, <span class="org-variable-name">BuildID</span>[sha1]=ce79ed7580a16cbc27bf113a2967eb1d66f496a3, not stripped

$ file client1-executable.bin 
<span class="org-function-name">client1-executable.bin</span>: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, 
<span class="org-keyword">for</span> GNU/Linux 3.2.0, <span class="org-variable-name">BuildID</span>[sha1]=8103d822a6d58497b63346dfcc1f7375599114f7, not stripped
</pre>
</div>

<p>
Or just in a single step: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cd build &amp;&amp; make &amp;&amp; <span class="org-builtin">cd</span> ..
</pre>
</div>
</div>
</div>

<div id="outline-container-org64c2b60" class="outline-3">
<h3 id="org64c2b60"><span class="section-number-3">2.3</span> Show system information</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-sh">cmake --sytem-information 
</pre>
</div>

<p>
Output on Linux: 
</p>

<div class="org-src-container">
<pre class="src src-sh">Avoid ctest truncation of output: CTEST_FULL_OUTPUT
========================================================
=== MAIN VARIABLES
========================================================
CMAKE_STATIC_LIBRARY_PREFIX == <span class="org-string">"lib"</span>
CMAKE_STATIC_LIBRARY_SUFFIX == <span class="org-string">".a"</span>
CMAKE_SHARED_LIBRARY_PREFIX == <span class="org-string">"lib"</span>
CMAKE_SHARED_LIBRARY_SUFFIX == <span class="org-string">".so"</span>
CMAKE_SHARED_MODULE_PREFIX == <span class="org-string">"lib"</span>
CMAKE_SHARED_MODULE_SUFFIX == <span class="org-string">".so"</span>


CMAKE_DL_LIBS == <span class="org-string">"dl"</span>
CMAKE_LIBRARY_PATH_FLAG == <span class="org-string">"-L"</span>
CMAKE_LINK_LIBRARY_FLAG == <span class="org-string">"-l"</span>
CMAKE_SKIP_RPATH == <span class="org-string">"NO"</span>
CMAKE_SYSTEM_INFO_FILE == <span class="org-string">"Platform/Linux"</span>
CMAKE_SYSTEM_NAME == <span class="org-string">"Linux"</span>
CMAKE_SYSTEM == <span class="org-string">"Linux-4.18.18-200.fc28.x86_64"</span>
CMAKE_CXX_COMPILER == <span class="org-string">"/usr/lib64/ccache/c++"</span>
CMAKE_C_COMPILER == <span class="org-string">"/usr/lib64/ccache/cc"</span>
CMAKE_COMPILER_IS_GNUCC == <span class="org-string">"1"</span>
CMAKE_COMPILER_IS_GNUCXX == <span class="org-string">"1"</span>

// C shared library flag
CMAKE_SHARED_LIBRARY_C_FLAGS == <span class="org-string">"-fPIC"</span>
CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS == <span class="org-string">"-shared"</span>
CMAKE_SHARED_LIBRARY_LINK_FLAGS == <span class="org-string">""</span>
... ...    ... ...    ... ...    ... ...    ... ... 
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6c8db4" class="outline-3">
<h3 id="orgb6c8db4"><span class="section-number-3">2.4</span> Show all modules</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">
<pre class="src src-sh">$ cmake --help-module-list
</pre>
</div>

<p>
Output: 
</p>

<div class="org-src-container">
<pre class="src src-text">AddFileDependencies
AndroidTestUtilities
BundleUtilities
CMakeAddFortranSubdirectory
CMakeBackwardCompatibilityCXX
CMakeDependentOption
CMakeDetermineVSServicePack
CMakeExpandImportedTargets
CMakeFindDependencyMacro
CMakeFindFrameworks
CMakeFindPackageMode
CMakeForceCompiler
CMakeGraphVizOptions

... ... ... ... ... ... 

FindLAPACK
FindLATEX
FindLTTngUST
FindLibArchive
FindLibLZMA
FindLibXml2
FindLibXslt
FindLua
FindLua50
FindLua51
FindMFC
FindMPEG
FindMPEG2
FindMPI
FindMatlab
FindMotif
FindOpenACC

... ... ... ... ... ... ... ... 

</pre>
</div>
</div>
</div>

<div id="outline-container-org02010bd" class="outline-3">
<h3 id="org02010bd"><span class="section-number-3">2.5</span> SNIPPET - Common Variables</h3>
<div class="outline-text-3" id="text-2-5">
</div>
<div id="outline-container-orge667974" class="outline-4">
<h4 id="orge667974"><span class="section-number-4">2.5.1</span> CMAKE_CURRENT_LIST_DIR - Directory where is CMakeLists.txt</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
Prints the directory where CMAkeLists.
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">message</span>(<span class="org-string">" [INFO] CMakeLists.txt is in the directory ${</span><span class="org-variable-name">CMAKE_CURRENT_LIST_DIR</span><span class="org-string">}"</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org67d4164" class="outline-4">
<h4 id="org67d4164"><span class="section-number-4">2.5.2</span> CMAKE_CXX_STANDARD - Set C++ Standard</h4>
<div class="outline-text-4" id="text-2-5-2">
<p>
The variable <code>CMAKE_CXX_STANDARD</code> sets the project current C++
standard. This variable can be set to 98 (for C++98); 11 (C++11); 14
(C++14); 17 (C++17) and 20 (C++20 - experimental yet.)
</p>

<ul class="org-ul">
<li>Documentation: <a href="https://cmake.org/cmake/help/latest/prop_tgt/CXX_STANDARD.html#prop_tgt:CXX_STANDARD">CXX_STANDARD â€” CMake 3.13.2 Documentation</a></li>
</ul>

<p>
Example: Set project to compile with C++11 ISO standard.
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 11)
</pre>
</div>

<p>
Usage: (File CMAKELists.txt)
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.9)
<span class="org-function-name">project</span>(MY_PROJECT_NAME)

<span class="org-function-name">set</span>(CMAKE_CXX_STANDARD 17)
... ... .... .... 
</pre>
</div>
</div>
</div>

<div id="outline-container-orgae19237" class="outline-4">
<h4 id="orgae19237"><span class="section-number-4">2.5.3</span> CMAKE_BUILD_TYPE - Set default building type to DEBUG</h4>
<div class="outline-text-4" id="text-2-5-3">
<p>
In the debug building type optimization flags are disabled and flags
for generating debugging symbols are enabled, for GGC or GCC/Mingw and
Clang the (-g) is automatically added and for MSVC, aka VC++ (cl.exe),
the flag /Zi is also passed to the compiler. The default building type
can be set to DEBUG with the following code.
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-comment"># Set default building type to debug if it was not set</span>
<span class="org-comment"># in command line with -DCMAKE_BUILD_TYPE=release</span>
<span class="org-keyword">if</span>(NOT DEFINED CMAKE_BUILD_TYPE OR CMAKE_BUILD_TYPE MATCHES <span class="org-string">""</span>)
  <span class="org-function-name">set</span>(CMAKE_BUILD_TYPE  debug)
<span class="org-keyword">endif</span>()
</pre>
</div>

<p>
The building type can be changed by running cmake with the flag
 (-DCMAKE_BUILD_TYPE=release). Example: 
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cmake -H. -Bbuild -DCMAKE_BUILD_TYPE=DEBUG -G <span class="org-string">"Visual Studio 15 2017 Win64"</span>
</pre>
</div>

<p>
Note: CMake is not case sensitive, so it does not matter using
'release' or RELEASE; if or IF; endif or ENDIF and so on. 
</p>
</div>
</div>

<div id="outline-container-org13499e6" class="outline-4">
<h4 id="org13499e6"><span class="section-number-4">2.5.4</span> CMAKE_CXX_FLAGS - Compiler flags</h4>
<div class="outline-text-4" id="text-2-5-4">
<p>
The globals compiler flags used to build all targets can be extended
by setting the variable CMAKE_CXX_FLAGS. However, as the compiler
flags depends on the compiler, the custom settings may not be portable
if one uses a different compiler, for instance the (-g) flag used to
generate debug symbols with GCC or Clang does not work with MSVC
(visual c++ compiler, vc++) as it uses the flag /Zi for generating
debugging symbols.
</p>

<p>
Example 1: 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">set</span>(CMAKE_CXX_FLAGS <span class="org-string">"${</span><span class="org-variable-name">CMAKE_CXX_FLAGS</span><span class="org-string">}"</span>  <span class="org-string">"-std=c++17 -g -Wall -Wextra -pendantic -O0"</span> )
</pre>
</div>

<p>
Example 2 (better):
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(NOT MSVC)
   <span class="org-function-name">set</span>(CMAKE_CXX_FLAGS <span class="org-string">"${</span><span class="org-variable-name">CMAKE_CXX_FLAGS</span><span class="org-string">}"</span>  <span class="org-string">"-std=c++17 -g -Wall -Wextra -pendantic -O0"</span> )
<span class="org-keyword">endif</span>()
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfb3e206" class="outline-3">
<h3 id="orgfb3e206"><span class="section-number-3">2.6</span> SNIPPET - Detect Operating System</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Check whether current OS is Microsft Windows NT:
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(WIN32)
  <span class="org-comment"># actions ... </span>
  <span class="org-function-name">message</span>(<span class="org-string">"Compiling for Windows NT"</span>)
<span class="org-keyword">else</span>()
  <span class="org-comment"># else actions .... ...</span>
<span class="org-keyword">endif</span>()
</pre>
</div>

<p>
Check whether current OS is a Unix-like operating system (Linux, BSD,
MacOSX, Android and so on): 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(UNIX)
  <span class="org-comment"># actions ... </span>
  <span class="org-function-name">message</span>(<span class="org-string">"Running on Unix-like OS"</span>)
<span class="org-keyword">endif</span>()  
</pre>
</div>

<p>
Check if current OS is MacOSX:
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(APPLE)
  <span class="org-comment"># actions ... </span>
  <span class="org-function-name">message</span>(<span class="org-string">"Running on Unix-like OS"</span>)
<span class="org-keyword">endif</span>()  
</pre>
</div>

<p>
Check if current OS is Linux:
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(LINUX)
  <span class="org-comment"># actions ... </span>
  <span class="org-function-name">message</span>(<span class="org-string">"Running on Unix-like OS"</span>)
<span class="org-keyword">endif</span>()  
</pre>
</div>

<p>
Check if current OS is UNIX, but not MacOSX:
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(UNIX AND NOT APPLE)
  <span class="org-comment"># actions ... </span>
  <span class="org-function-name">message</span>(<span class="org-string">"Running on Unix-like OS"</span>)
<span class="org-keyword">endif</span>()  
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd9fee8" class="outline-3">
<h3 id="orgcd9fee8"><span class="section-number-3">2.7</span> SNIPPET - Detect Compiler</h3>
<div class="outline-text-3" id="text-2-7">
<p>
<b>MSVC</b>
</p>

<p>
Check if current compiler is MSVC - Microsft - Visual C/C++ Compiler
(Visual C++, vc++ for short):
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(MSVC)
  <span class="org-function-name">message</span>(STATUS &lt;&lt; <span class="org-string">"Running MSVC"</span>)
<span class="org-keyword">endif</span>()
</pre>
</div>

<p>
<b>MSVC for 32 bits target</b>
</p>

<p>
Detect MSVC set up for 32 bits target (buids 32 bits binaries):
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(MSVC AND NOT CMAKE_CL_64)
  <span class="org-function-name">message</span>(<span class="org-string">" [INFO] Building for 32 bits Windows target."</span>)
<span class="org-keyword">endif</span>()
</pre>
</div>

<p>
<b>MSVC for 64 bits target</b>
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(MSVC AND CMAKE_CL_64)
  <span class="org-function-name">message</span>(<span class="org-string">" [INFO] Building for 64 bits Windows target."</span>)
<span class="org-keyword">endif</span>()
</pre>
</div>

<p>
<b>Mingw</b> 
</p>

<p>
Check if current compiler is GCC/Mingw, GCC compiler ported to
Windows.
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(MSVC)
  <span class="org-function-name">message</span>(<span class="org-string">"Running Mingw/GCC maybe on Windows"</span>)
<span class="org-keyword">endif</span>()
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfc02244" class="outline-3">
<h3 id="orgfc02244"><span class="section-number-3">2.8</span> SNIPPET - Detect whether current build is 32 bits or 64 bits</h3>
<div class="outline-text-3" id="text-2-8">
<p>
Check whether current configuration is for 64 bits build:
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(CMAKE_SIZEOF_VOID_P EQUAL 8)
    <span class="org-function-name">message</span>(<span class="org-string">" [INFO] 64 bits build."</span>)
<span class="org-keyword">else</span>()
   <span class="org-function-name">message</span>(<span class="org-string">" [INFO] 32 bits build."</span>)
<span class="org-keyword">endif</span>()
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb276b7c" class="outline-3">
<h3 id="orgb276b7c"><span class="section-number-3">2.9</span> SNIPPET - Copy some target binaries to a directory</h3>
<div class="outline-text-3" id="text-2-9">
<p>
This piece of code copies the target binaries (compiled code) to a
directory relative to project's root directory where is CMakeLists.txt 
</p>

<p>
Targets:
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-comment"># TARGET: testlib Shared library =&gt; Builds liblinalg.so on Unix or</span>
<span class="org-comment"># linalg.dll on Windows.</span>
<span class="org-function-name">add_library</span>(linalg SHARED  src/testlib.cpp)

<span class="org-comment"># TARGET: app Executable =&gt; Builds 'app' on Unix-like Oses and</span>
<span class="org-comment"># unix.exe on Windows.</span>
<span class="org-function-name">add_executable</span>(app src/main/main-app.cpp src/main/file1.cpp src/main/file2.cpp)
</pre>
</div>

<p>
Copy target files to top level directory where is CMakeLists.txt 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-comment"># If not set the install directory, attemp set the install directory</span>
<span class="org-comment"># CMAKE_INSTALL_PREFIX to the directory ./bin </span>
<span class="org-keyword">if</span>(NOT DEFINED CMAKE_INSTALL_PREFIX OR CMAKE_INSTALL_PREFIX MATCHES <span class="org-string">""</span>)
  <span class="org-function-name">set</span>(CMAKE_INSTALL_PREFIX  <span class="org-string">"./bin"</span>)
<span class="org-keyword">endif</span>()

<span class="org-function-name">message</span>(<span class="org-string">" [INFO] CMakeLists.txt is in the directory ${</span><span class="org-variable-name">CMAKE_CURRENT_LIST_DIR</span><span class="org-string">}"</span>)

<span class="org-comment"># Copy targets to ./ - Directory where is this file CMakeLists.txt (project top level dir)</span>
<span class="org-function-name">install</span>(TARGETS app linalg DESTINATION  ${<span class="org-variable-name">CMAKE_CURRENT_LIST_DIR</span>})
</pre>
</div>

<p>
This target can be run with: 
</p>

<ul class="org-ul">
<li>STEP 1: Set CMake building system or the project type with -G.</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">$ cd project-directory 

<span class="org-comment-delimiter">#</span><span class="org-comment">===&gt; Set build system </span>
<span class="org-comment-delimiter"># </span><span class="org-comment">-H&lt;SOURCE&gt; -B&lt;COMPILATION-OUTPUT&gt; -G &lt;BUILDING-SYSTEM&gt;</span>
$ cmake -H. -G <span class="org-string">"Unix Makefiles"</span> -Bbuild 
</pre>
</div>

<ul class="org-ul">
<li>STEP 2: Run targets</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter">#</span><span class="org-comment">===&gt; Run all targets [all default.]</span>
$ cmake --build build --target all 

<span class="org-comment-delimiter">#</span><span class="org-comment">===&gt; Run target install and copy the binaries to ./bin </span>
$ cmake --build build --target install 
</pre>
</div>
</div>
</div>





<div id="outline-container-org30ce398" class="outline-3">
<h3 id="org30ce398"><span class="section-number-3">2.10</span> SNIPPET - Create target to run compiled executable</h3>
<div class="outline-text-3" id="text-2-10">
<p>
The piece following piece of code runs an executable target after it
is built in a similar way to a command $ make run. 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-function-name">cmake_minimum_required</span>(VERSION 3.9)

 ... ...  ... ...  ... ...

<span class="org-comment"># TARGET: myapplication </span>
<span class="org-function-name">add_executable</span>(myapplication src/main.cpp src/code1.cpp code2.cpp ...)

<span class="org-comment"># TARGET: run -&gt; Runs the executable myapplication </span>
<span class="org-comment"># On Unix-like Oses, it runs  /&lt;build-directory&gt;/myapplication </span>
<span class="org-comment"># On Windows: it runs  &lt;build-directory&gt;/myapplication.exe </span>
<span class="org-function-name">add_custom_target</span>(run
    COMMAND myapplication
    DEPENDS myapplication
    WORKING_DIRECTORY ${<span class="org-variable-name">CMAKE_PROJECT_DIR</span>}
)
</pre>
</div>

<p>
After the building system is set and output directory ./build, run:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-comment-delimiter">#</span><span class="org-comment">===&gt; Run all targets [all default.]</span>
$ cmake --build build --target run
</pre>
</div>
</div>
</div>




<div id="outline-container-orgf09cd90" class="outline-3">
<h3 id="orgf09cd90"><span class="section-number-3">2.11</span> SNIPPET - Issue an error if condition is not met</h3>
<div class="outline-text-3" id="text-2-11">
<p>
In this piece of code, if the compiler is not MSVC (vc++, aka cl.exe),
CMake stops the generation of the building script showing an error
message to the user.
</p>

<div class="org-src-container">
<pre class="src src-cmake">... ... 

<span class="org-keyword">if</span>(MSVC)
   <span class="org-function-name">set_target_properties</span>(WindowApp1 PROPERTIES LINK_FLAGS <span class="org-string">"/entry:mainCRTStartup"</span>)
<span class="org-keyword">else</span>() 
   <span class="org-function-name">message</span>(FATAL_ERROR <span class="org-string">" [ERROR] Linker flags of target WindowApp1 not set for this compiler"</span>)
<span class="org-keyword">endif</span>()
... ... 
</pre>
</div>
</div>
</div>
<div id="outline-container-org0133407" class="outline-3">
<h3 id="org0133407"><span class="section-number-3">2.12</span> SNIPPET - Set target subsystem - Win32 API Specific</h3>
<div class="outline-text-3" id="text-2-12">
<p>
Set target subsystem. 
</p>

<div class="org-src-container">
<pre class="src src-cmake"><span class="org-keyword">if</span>(WIN32)
   <span class="org-function-name">set_target_properties</span>(WindowApplicationExample PROPERTIES LINK_FLAGS_DEBUG <span class="org-string">"/SUBSYSTEM:CONSOLE"</span>)
   <span class="org-function-name">set_target_properties</span>(WindowApplicationExample PROPERTIES COMPILE_DEFINITIONS_DEBUG <span class="org-string">"_CONSOLE"</span>)
   <span class="org-function-name">set_target_properties</span>(WindowApplicationExample PROPERTIES LINK_FLAGS_RELWITHDEBINFO <span class="org-string">"/SUBSYSTEM:CONSOLE"</span>)
   <span class="org-function-name">set_target_properties</span>(WindowApplicationExample PROPERTIES COMPILE_DEFINITIONS_RELWITHDEBINFO <span class="org-string">"_CONSOLE"</span>)
   <span class="org-function-name">set_target_properties</span>(WindowApplicationExample PROPERTIES LINK_FLAGS_RELEASE <span class="org-string">"/SUBSYSTEM:WINDOWS"</span>)
   <span class="org-function-name">set_target_properties</span>(WindowApplicationExample PROPERTIES LINK_FLAGS_MINSIZEREL <span class="org-string">"/SUBSYSTEM:WINDOWS"</span>)
<span class="org-keyword">endif</span>(WIN32)
</pre>
</div>

<p>
Taken from: 
</p>
<ul class="org-ul">
<li><a href="https://gitlab.kitware.com/cmake/community/wikis/doc/cmake/recipe/VSConfigSpecificSettings">Vsconfigspecificsettings Â· Wiki Â· CMake / Community Â· GitLab</a></li>
<li><a href="https://developercommunity.visualstudio.com/content/problem/46678/cmake-set-subsystem-to-console.html">cmake: Set subsystem to console - Developer Community</a></li>
<li><a href="https://stackoverflow.com/questions/33873735/correctly-set-visual-studio-linker-flag-subsystem-in-cmake">c++ - Correctly set Visual Studio linker flag /SUBSYSTEM in CMAKE - Stack Overflow</a></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2018-12-24 Mon 17:19</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
